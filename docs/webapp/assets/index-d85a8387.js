var vp=Object.defineProperty;var Sp=(e,t,i)=>t in e?vp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var M=(e,t,i)=>(Sp(e,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();function hl(e,t){const i=Object.create(null),n=e.split(",");for(let s=0;s<n.length;s++)i[n[s]]=!0;return t?s=>!!i[s.toLowerCase()]:s=>!!i[s]}function Fe(e){if(Pe(e)){const t={};for(let i=0;i<e.length;i++){const n=e[i],s=vt(n)?Ip(n):Fe(n);if(s)for(const o in s)t[o]=s[o]}return t}else{if(vt(e))return e;if(lt(e))return e}}const wp=/;(?![^(]*\))/g,Ep=/:([^]+)/,kp=/\/\*.*?\*\//gs;function Ip(e){const t={};return e.replace(kp,"").split(wp).forEach(i=>{if(i){const n=i.split(Ep);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Zt(e){let t="";if(vt(e))t=e;else if(Pe(e))for(let i=0;i<e.length;i++){const n=Zt(e[i]);n&&(t+=n+" ")}else if(lt(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const Pp="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ap=hl(Pp);function Gh(e){return!!e||e===""}const k=e=>vt(e)?e:e==null?"":Pe(e)||lt(e)&&(e.toString===qh||!Te(e.toString))?JSON.stringify(e,Vh,2):String(e),Vh=(e,t)=>t&&t.__v_isRef?Vh(e,t.value):Hn(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[n,s])=>(i[`${n} =>`]=s,i),{})}:jh(t)?{[`Set(${t.size})`]:[...t.values()]}:lt(t)&&!Pe(t)&&!Yh(t)?String(t):t,at={},$n=[],fi=()=>{},Cp=()=>!1,xp=/^on[^a-z]/,vr=e=>xp.test(e),dl=e=>e.startsWith("onUpdate:"),Ut=Object.assign,fl=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},Mp=Object.prototype.hasOwnProperty,He=(e,t)=>Mp.call(e,t),Pe=Array.isArray,Hn=e=>Sr(e)==="[object Map]",jh=e=>Sr(e)==="[object Set]",Te=e=>typeof e=="function",vt=e=>typeof e=="string",pl=e=>typeof e=="symbol",lt=e=>e!==null&&typeof e=="object",Kh=e=>lt(e)&&Te(e.then)&&Te(e.catch),qh=Object.prototype.toString,Sr=e=>qh.call(e),Tp=e=>Sr(e).slice(8,-1),Yh=e=>Sr(e)==="[object Object]",gl=e=>vt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Io=hl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),wr=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},Rp=/-(\w)/g,Ai=wr(e=>e.replace(Rp,(t,i)=>i?i.toUpperCase():"")),Op=/\B([A-Z])/g,ts=wr(e=>e.replace(Op,"-$1").toLowerCase()),Er=wr(e=>e.charAt(0).toUpperCase()+e.slice(1)),$r=wr(e=>e?`on${Er(e)}`:""),Ts=(e,t)=>!Object.is(e,t),Hr=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},Wo=(e,t,i)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:i})},Np=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let rc;const Lp=()=>rc||(rc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let ci;class Bp{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ci,!t&&ci&&(this.index=(ci.scopes||(ci.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const i=ci;try{return ci=this,t()}finally{ci=i}}}on(){ci=this}off(){ci=this.parent}stop(t){if(this._active){let i,n;for(i=0,n=this.effects.length;i<n;i++)this.effects[i].stop();for(i=0,n=this.cleanups.length;i<n;i++)this.cleanups[i]();if(this.scopes)for(i=0,n=this.scopes.length;i<n;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Dp(e,t=ci){t&&t.active&&t.effects.push(e)}function Fp(){return ci}const ml=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Xh=e=>(e.w&en)>0,Jh=e=>(e.n&en)>0,$p=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=en},Hp=e=>{const{deps:t}=e;if(t.length){let i=0;for(let n=0;n<t.length;n++){const s=t[n];Xh(s)&&!Jh(s)?s.delete(e):t[i++]=s,s.w&=~en,s.n&=~en}t.length=i}},Aa=new WeakMap;let hs=0,en=1;const Ca=30;let ui;const kn=Symbol(""),xa=Symbol("");class bl{constructor(t,i=null,n){this.fn=t,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,Dp(this,n)}run(){if(!this.active)return this.fn();let t=ui,i=Ji;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=ui,ui=this,Ji=!0,en=1<<++hs,hs<=Ca?$p(this):ac(this),this.fn()}finally{hs<=Ca&&Hp(this),en=1<<--hs,ui=this.parent,Ji=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ui===this?this.deferStop=!0:this.active&&(ac(this),this.onStop&&this.onStop(),this.active=!1)}}function ac(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let Ji=!0;const Qh=[];function is(){Qh.push(Ji),Ji=!1}function ns(){const e=Qh.pop();Ji=e===void 0?!0:e}function qt(e,t,i){if(Ji&&ui){let n=Aa.get(e);n||Aa.set(e,n=new Map);let s=n.get(i);s||n.set(i,s=ml()),Zh(s)}}function Zh(e,t){let i=!1;hs<=Ca?Jh(e)||(e.n|=en,i=!Xh(e)):i=!e.has(ui),i&&(e.add(ui),ui.deps.push(e))}function Ui(e,t,i,n,s,o){const r=Aa.get(e);if(!r)return;let a=[];if(t==="clear")a=[...r.values()];else if(i==="length"&&Pe(e)){const l=Number(n);r.forEach((c,u)=>{(u==="length"||u>=l)&&a.push(c)})}else switch(i!==void 0&&a.push(r.get(i)),t){case"add":Pe(e)?gl(i)&&a.push(r.get("length")):(a.push(r.get(kn)),Hn(e)&&a.push(r.get(xa)));break;case"delete":Pe(e)||(a.push(r.get(kn)),Hn(e)&&a.push(r.get(xa)));break;case"set":Hn(e)&&a.push(r.get(kn));break}if(a.length===1)a[0]&&Ma(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);Ma(ml(l))}}function Ma(e,t){const i=Pe(e)?e:[...e];for(const n of i)n.computed&&lc(n);for(const n of i)n.computed||lc(n)}function lc(e,t){(e!==ui||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Up=hl("__proto__,__v_isRef,__isVue"),ed=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(pl)),zp=_l(),Wp=_l(!1,!0),Gp=_l(!0),cc=Vp();function Vp(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...i){const n=We(this);for(let o=0,r=this.length;o<r;o++)qt(n,"get",o+"");const s=n[t](...i);return s===-1||s===!1?n[t](...i.map(We)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...i){is();const n=We(this)[t].apply(this,i);return ns(),n}}),e}function jp(e){const t=We(this);return qt(t,"has",e),t.hasOwnProperty(e)}function _l(e=!1,t=!1){return function(n,s,o){if(s==="__v_isReactive")return!e;if(s==="__v_isReadonly")return e;if(s==="__v_isShallow")return t;if(s==="__v_raw"&&o===(e?t?lg:od:t?sd:nd).get(n))return n;const r=Pe(n);if(!e){if(r&&He(cc,s))return Reflect.get(cc,s,o);if(s==="hasOwnProperty")return jp}const a=Reflect.get(n,s,o);return(pl(s)?ed.has(s):Up(s))||(e||qt(n,"get",s),t)?a:Ot(a)?r&&gl(s)?a:a.value:lt(a)?e?rd(a):Ci(a):a}}const Kp=td(),qp=td(!0);function td(e=!1){return function(i,n,s,o){let r=i[n];if(qn(r)&&Ot(r)&&!Ot(s))return!1;if(!e&&(!Go(s)&&!qn(s)&&(r=We(r),s=We(s)),!Pe(i)&&Ot(r)&&!Ot(s)))return r.value=s,!0;const a=Pe(i)&&gl(n)?Number(n)<i.length:He(i,n),l=Reflect.set(i,n,s,o);return i===We(o)&&(a?Ts(s,r)&&Ui(i,"set",n,s):Ui(i,"add",n,s)),l}}function Yp(e,t){const i=He(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&i&&Ui(e,"delete",t,void 0),n}function Xp(e,t){const i=Reflect.has(e,t);return(!pl(t)||!ed.has(t))&&qt(e,"has",t),i}function Jp(e){return qt(e,"iterate",Pe(e)?"length":kn),Reflect.ownKeys(e)}const id={get:zp,set:Kp,deleteProperty:Yp,has:Xp,ownKeys:Jp},Qp={get:Gp,set(e,t){return!0},deleteProperty(e,t){return!0}},Zp=Ut({},id,{get:Wp,set:qp}),yl=e=>e,kr=e=>Reflect.getPrototypeOf(e);function to(e,t,i=!1,n=!1){e=e.__v_raw;const s=We(e),o=We(t);i||(t!==o&&qt(s,"get",t),qt(s,"get",o));const{has:r}=kr(s),a=n?yl:i?wl:Rs;if(r.call(s,t))return a(e.get(t));if(r.call(s,o))return a(e.get(o));e!==s&&e.get(t)}function io(e,t=!1){const i=this.__v_raw,n=We(i),s=We(e);return t||(e!==s&&qt(n,"has",e),qt(n,"has",s)),e===s?i.has(e):i.has(e)||i.has(s)}function no(e,t=!1){return e=e.__v_raw,!t&&qt(We(e),"iterate",kn),Reflect.get(e,"size",e)}function uc(e){e=We(e);const t=We(this);return kr(t).has.call(t,e)||(t.add(e),Ui(t,"add",e,e)),this}function hc(e,t){t=We(t);const i=We(this),{has:n,get:s}=kr(i);let o=n.call(i,e);o||(e=We(e),o=n.call(i,e));const r=s.call(i,e);return i.set(e,t),o?Ts(t,r)&&Ui(i,"set",e,t):Ui(i,"add",e,t),this}function dc(e){const t=We(this),{has:i,get:n}=kr(t);let s=i.call(t,e);s||(e=We(e),s=i.call(t,e)),n&&n.call(t,e);const o=t.delete(e);return s&&Ui(t,"delete",e,void 0),o}function fc(){const e=We(this),t=e.size!==0,i=e.clear();return t&&Ui(e,"clear",void 0,void 0),i}function so(e,t){return function(n,s){const o=this,r=o.__v_raw,a=We(r),l=t?yl:e?wl:Rs;return!e&&qt(a,"iterate",kn),r.forEach((c,u)=>n.call(s,l(c),l(u),o))}}function oo(e,t,i){return function(...n){const s=this.__v_raw,o=We(s),r=Hn(o),a=e==="entries"||e===Symbol.iterator&&r,l=e==="keys"&&r,c=s[e](...n),u=i?yl:t?wl:Rs;return!t&&qt(o,"iterate",l?xa:kn),{next(){const{value:h,done:f}=c.next();return f?{value:h,done:f}:{value:a?[u(h[0]),u(h[1])]:u(h),done:f}},[Symbol.iterator](){return this}}}}function Vi(e){return function(...t){return e==="delete"?!1:this}}function eg(){const e={get(o){return to(this,o)},get size(){return no(this)},has:io,add:uc,set:hc,delete:dc,clear:fc,forEach:so(!1,!1)},t={get(o){return to(this,o,!1,!0)},get size(){return no(this)},has:io,add:uc,set:hc,delete:dc,clear:fc,forEach:so(!1,!0)},i={get(o){return to(this,o,!0)},get size(){return no(this,!0)},has(o){return io.call(this,o,!0)},add:Vi("add"),set:Vi("set"),delete:Vi("delete"),clear:Vi("clear"),forEach:so(!0,!1)},n={get(o){return to(this,o,!0,!0)},get size(){return no(this,!0)},has(o){return io.call(this,o,!0)},add:Vi("add"),set:Vi("set"),delete:Vi("delete"),clear:Vi("clear"),forEach:so(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{e[o]=oo(o,!1,!1),i[o]=oo(o,!0,!1),t[o]=oo(o,!1,!0),n[o]=oo(o,!0,!0)}),[e,i,t,n]}const[tg,ig,ng,sg]=eg();function vl(e,t){const i=t?e?sg:ng:e?ig:tg;return(n,s,o)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(He(i,s)&&s in n?i:n,s,o)}const og={get:vl(!1,!1)},rg={get:vl(!1,!0)},ag={get:vl(!0,!1)},nd=new WeakMap,sd=new WeakMap,od=new WeakMap,lg=new WeakMap;function cg(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ug(e){return e.__v_skip||!Object.isExtensible(e)?0:cg(Tp(e))}function Ci(e){return qn(e)?e:Sl(e,!1,id,og,nd)}function hg(e){return Sl(e,!1,Zp,rg,sd)}function rd(e){return Sl(e,!0,Qp,ag,od)}function Sl(e,t,i,n,s){if(!lt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=s.get(e);if(o)return o;const r=ug(e);if(r===0)return e;const a=new Proxy(e,r===2?n:i);return s.set(e,a),a}function Un(e){return qn(e)?Un(e.__v_raw):!!(e&&e.__v_isReactive)}function qn(e){return!!(e&&e.__v_isReadonly)}function Go(e){return!!(e&&e.__v_isShallow)}function ad(e){return Un(e)||qn(e)}function We(e){const t=e&&e.__v_raw;return t?We(t):e}function ld(e){return Wo(e,"__v_skip",!0),e}const Rs=e=>lt(e)?Ci(e):e,wl=e=>lt(e)?rd(e):e;function cd(e){Ji&&ui&&(e=We(e),Zh(e.dep||(e.dep=ml())))}function ud(e,t){e=We(e);const i=e.dep;i&&Ma(i)}function Ot(e){return!!(e&&e.__v_isRef===!0)}function W(e){return dg(e,!1)}function dg(e,t){return Ot(e)?e:new fg(e,t)}class fg{constructor(t,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?t:We(t),this._value=i?t:Rs(t)}get value(){return cd(this),this._value}set value(t){const i=this.__v_isShallow||Go(t)||qn(t);t=i?t:We(t),Ts(t,this._rawValue)&&(this._rawValue=t,this._value=i?t:Rs(t),ud(this))}}function pg(e){return Ot(e)?e.value:e}const gg={get:(e,t,i)=>pg(Reflect.get(e,t,i)),set:(e,t,i,n)=>{const s=e[t];return Ot(s)&&!Ot(i)?(s.value=i,!0):Reflect.set(e,t,i,n)}};function hd(e){return Un(e)?e:new Proxy(e,gg)}var dd;class mg{constructor(t,i,n,s){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this[dd]=!1,this._dirty=!0,this.effect=new bl(t,()=>{this._dirty||(this._dirty=!0,ud(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=n}get value(){const t=We(this);return cd(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}dd="__v_isReadonly";function bg(e,t,i=!1){let n,s;const o=Te(e);return o?(n=e,s=fi):(n=e.get,s=e.set),new mg(n,s,o||!s,i)}function Qi(e,t,i,n){let s;try{s=n?e(...n):e()}catch(o){Ir(o,t,i)}return s}function pi(e,t,i,n){if(Te(e)){const o=Qi(e,t,i,n);return o&&Kh(o)&&o.catch(r=>{Ir(r,t,i)}),o}const s=[];for(let o=0;o<e.length;o++)s.push(pi(e[o],t,i,n));return s}function Ir(e,t,i,n=!0){const s=t?t.vnode:null;if(t){let o=t.parent;const r=t.proxy,a=i;for(;o;){const c=o.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](e,r,a)===!1)return}o=o.parent}const l=t.appContext.config.errorHandler;if(l){Qi(l,null,10,[e,r,a]);return}}_g(e,i,s,n)}function _g(e,t,i,n=!0){console.error(e)}let Os=!1,Ta=!1;const Tt=[];let Ei=0;const zn=[];let Ni=null,yn=0;const fd=Promise.resolve();let El=null;function yg(e){const t=El||fd;return e?t.then(this?e.bind(this):e):t}function vg(e){let t=Ei+1,i=Tt.length;for(;t<i;){const n=t+i>>>1;Ns(Tt[n])<e?t=n+1:i=n}return t}function kl(e){(!Tt.length||!Tt.includes(e,Os&&e.allowRecurse?Ei+1:Ei))&&(e.id==null?Tt.push(e):Tt.splice(vg(e.id),0,e),pd())}function pd(){!Os&&!Ta&&(Ta=!0,El=fd.then(md))}function Sg(e){const t=Tt.indexOf(e);t>Ei&&Tt.splice(t,1)}function wg(e){Pe(e)?zn.push(...e):(!Ni||!Ni.includes(e,e.allowRecurse?yn+1:yn))&&zn.push(e),pd()}function pc(e,t=Os?Ei+1:0){for(;t<Tt.length;t++){const i=Tt[t];i&&i.pre&&(Tt.splice(t,1),t--,i())}}function gd(e){if(zn.length){const t=[...new Set(zn)];if(zn.length=0,Ni){Ni.push(...t);return}for(Ni=t,Ni.sort((i,n)=>Ns(i)-Ns(n)),yn=0;yn<Ni.length;yn++)Ni[yn]();Ni=null,yn=0}}const Ns=e=>e.id==null?1/0:e.id,Eg=(e,t)=>{const i=Ns(e)-Ns(t);if(i===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function md(e){Ta=!1,Os=!0,Tt.sort(Eg);const t=fi;try{for(Ei=0;Ei<Tt.length;Ei++){const i=Tt[Ei];i&&i.active!==!1&&Qi(i,null,14)}}finally{Ei=0,Tt.length=0,gd(),Os=!1,El=null,(Tt.length||zn.length)&&md()}}function kg(e,t,...i){if(e.isUnmounted)return;const n=e.vnode.props||at;let s=i;const o=t.startsWith("update:"),r=o&&t.slice(7);if(r&&r in n){const u=`${r==="modelValue"?"model":r}Modifiers`,{number:h,trim:f}=n[u]||at;f&&(s=i.map(g=>vt(g)?g.trim():g)),h&&(s=i.map(Np))}let a,l=n[a=$r(t)]||n[a=$r(Ai(t))];!l&&o&&(l=n[a=$r(ts(t))]),l&&pi(l,e,6,s);const c=n[a+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,pi(c,e,6,s)}}function bd(e,t,i=!1){const n=t.emitsCache,s=n.get(e);if(s!==void 0)return s;const o=e.emits;let r={},a=!1;if(!Te(e)){const l=c=>{const u=bd(c,t,!0);u&&(a=!0,Ut(r,u))};!i&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!o&&!a?(lt(e)&&n.set(e,null),null):(Pe(o)?o.forEach(l=>r[l]=null):Ut(r,o),lt(e)&&n.set(e,r),r)}function Pr(e,t){return!e||!vr(t)?!1:(t=t.slice(2).replace(/Once$/,""),He(e,t[0].toLowerCase()+t.slice(1))||He(e,ts(t))||He(e,t))}let Ht=null,Ar=null;function Vo(e){const t=Ht;return Ht=e,Ar=e&&e.type.__scopeId||null,t}function qs(e){Ar=e}function Ys(){Ar=null}function Si(e,t=Ht,i){if(!t||e._n)return e;const n=(...s)=>{n._d&&Ec(-1);const o=Vo(t);let r;try{r=e(...s)}finally{Vo(o),n._d&&Ec(1)}return r};return n._n=!0,n._c=!0,n._d=!0,n}function Ur(e){const{type:t,vnode:i,proxy:n,withProxy:s,props:o,propsOptions:[r],slots:a,attrs:l,emit:c,render:u,renderCache:h,data:f,setupState:g,ctx:_,inheritAttrs:b}=e;let v,y;const E=Vo(e);try{if(i.shapeFlag&4){const P=s||n;v=wi(u.call(P,P,h,o,g,f,_)),y=l}else{const P=t;v=wi(P.length>1?P(o,{attrs:l,slots:a,emit:c}):P(o,null)),y=t.props?l:Ig(l)}}catch(P){ws.length=0,Ir(P,e,1),v=Y(tn)}let w=v;if(y&&b!==!1){const P=Object.keys(y),{shapeFlag:A}=w;P.length&&A&7&&(r&&P.some(dl)&&(y=Pg(y,r)),w=Yn(w,y))}return i.dirs&&(w=Yn(w),w.dirs=w.dirs?w.dirs.concat(i.dirs):i.dirs),i.transition&&(w.transition=i.transition),v=w,Vo(E),v}const Ig=e=>{let t;for(const i in e)(i==="class"||i==="style"||vr(i))&&((t||(t={}))[i]=e[i]);return t},Pg=(e,t)=>{const i={};for(const n in e)(!dl(n)||!(n.slice(9)in t))&&(i[n]=e[n]);return i};function Ag(e,t,i){const{props:n,children:s,component:o}=e,{props:r,children:a,patchFlag:l}=t,c=o.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&l>=0){if(l&1024)return!0;if(l&16)return n?gc(n,r,c):!!r;if(l&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const f=u[h];if(r[f]!==n[f]&&!Pr(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===r?!1:n?r?gc(n,r,c):!0:!!r;return!1}function gc(e,t,i){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let s=0;s<n.length;s++){const o=n[s];if(t[o]!==e[o]&&!Pr(i,o))return!0}return!1}function Cg({vnode:e,parent:t},i){for(;t&&t.subTree===e;)(e=t.vnode).el=i,t=t.parent}const xg=e=>e.__isSuspense;function Mg(e,t){t&&t.pendingBranch?Pe(e)?t.effects.push(...e):t.effects.push(e):wg(e)}function Tg(e,t){if(bt){let i=bt.provides;const n=bt.parent&&bt.parent.provides;n===i&&(i=bt.provides=Object.create(n)),i[e]=t}}function Po(e,t,i=!1){const n=bt||Ht;if(n){const s=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return i&&Te(t)?t.call(n.proxy):t}}const ro={};function In(e,t,i){return _d(e,t,i)}function _d(e,t,{immediate:i,deep:n,flush:s,onTrack:o,onTrigger:r}=at){const a=Fp()===(bt==null?void 0:bt.scope)?bt:null;let l,c=!1,u=!1;if(Ot(e)?(l=()=>e.value,c=Go(e)):Un(e)?(l=()=>e,n=!0):Pe(e)?(u=!0,c=e.some(w=>Un(w)||Go(w)),l=()=>e.map(w=>{if(Ot(w))return w.value;if(Un(w))return Bn(w);if(Te(w))return Qi(w,a,2)})):Te(e)?t?l=()=>Qi(e,a,2):l=()=>{if(!(a&&a.isUnmounted))return h&&h(),pi(e,a,3,[f])}:l=fi,t&&n){const w=l;l=()=>Bn(w())}let h,f=w=>{h=y.onStop=()=>{Qi(w,a,4)}},g;if(Bs)if(f=fi,t?i&&pi(t,a,3,[l(),u?[]:void 0,f]):l(),s==="sync"){const w=Sm();g=w.__watcherHandles||(w.__watcherHandles=[])}else return fi;let _=u?new Array(e.length).fill(ro):ro;const b=()=>{if(y.active)if(t){const w=y.run();(n||c||(u?w.some((P,A)=>Ts(P,_[A])):Ts(w,_)))&&(h&&h(),pi(t,a,3,[w,_===ro?void 0:u&&_[0]===ro?[]:_,f]),_=w)}else y.run()};b.allowRecurse=!!t;let v;s==="sync"?v=b:s==="post"?v=()=>Vt(b,a&&a.suspense):(b.pre=!0,a&&(b.id=a.uid),v=()=>kl(b));const y=new bl(l,v);t?i?b():_=y.run():s==="post"?Vt(y.run.bind(y),a&&a.suspense):y.run();const E=()=>{y.stop(),a&&a.scope&&fl(a.scope.effects,y)};return g&&g.push(E),E}function Rg(e,t,i){const n=this.proxy,s=vt(e)?e.includes(".")?yd(n,e):()=>n[e]:e.bind(n,n);let o;Te(t)?o=t:(o=t.handler,i=t);const r=bt;Xn(this);const a=_d(s,o.bind(n),i);return r?Xn(r):Pn(),a}function yd(e,t){const i=t.split(".");return()=>{let n=e;for(let s=0;s<i.length&&n;s++)n=n[i[s]];return n}}function Bn(e,t){if(!lt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Ot(e))Bn(e.value,t);else if(Pe(e))for(let i=0;i<e.length;i++)Bn(e[i],t);else if(jh(e)||Hn(e))e.forEach(i=>{Bn(i,t)});else if(Yh(e))for(const i in e)Bn(e[i],t);return e}function Ge(e){return Te(e)?{setup:e,name:e.name}:e}const vs=e=>!!e.type.__asyncLoader,vd=e=>e.type.__isKeepAlive;function Og(e,t){Sd(e,"a",t)}function Ng(e,t){Sd(e,"da",t)}function Sd(e,t,i=bt){const n=e.__wdc||(e.__wdc=()=>{let s=i;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Cr(t,n,i),i){let s=i.parent;for(;s&&s.parent;)vd(s.parent.vnode)&&Lg(n,t,i,s),s=s.parent}}function Lg(e,t,i,n){const s=Cr(t,e,n,!0);Js(()=>{fl(n[t],s)},i)}function Cr(e,t,i=bt,n=!1){if(i){const s=i[e]||(i[e]=[]),o=t.__weh||(t.__weh=(...r)=>{if(i.isUnmounted)return;is(),Xn(i);const a=pi(t,i,e,r);return Pn(),ns(),a});return n?s.unshift(o):s.push(o),o}}const zi=e=>(t,i=bt)=>(!Bs||e==="sp")&&Cr(e,(...n)=>t(...n),i),Bg=zi("bm"),st=zi("m"),wd=zi("bu"),Xs=zi("u"),zt=zi("bum"),Js=zi("um"),Dg=zi("sp"),Fg=zi("rtg"),$g=zi("rtc");function Hg(e,t=bt){Cr("ec",e,t)}function ln(e,t,i,n){const s=e.dirs,o=t&&t.dirs;for(let r=0;r<s.length;r++){const a=s[r];o&&(a.oldValue=o[r].value);let l=a.dir[n];l&&(is(),pi(l,i,8,[e.el,a,e,t]),ns())}}const Ed="components";function ye(e,t){return zg(Ed,e,!0,t)||e}const Ug=Symbol();function zg(e,t,i=!0,n=!1){const s=Ht||bt;if(s){const o=s.type;if(e===Ed){const a=bm(o,!1);if(a&&(a===t||a===Ai(t)||a===Er(Ai(t))))return o}const r=mc(s[e]||o[e],t)||mc(s.appContext[e],t);return!r&&n?o:r}}function mc(e,t){return e&&(e[t]||e[Ai(t)]||e[Er(Ai(t))])}function Ye(e,t,i,n){let s;const o=i&&i[n];if(Pe(e)||vt(e)){s=new Array(e.length);for(let r=0,a=e.length;r<a;r++)s[r]=t(e[r],r,void 0,o&&o[r])}else if(typeof e=="number"){s=new Array(e);for(let r=0;r<e;r++)s[r]=t(r+1,r,void 0,o&&o[r])}else if(lt(e))if(e[Symbol.iterator])s=Array.from(e,(r,a)=>t(r,a,void 0,o&&o[a]));else{const r=Object.keys(e);s=new Array(r.length);for(let a=0,l=r.length;a<l;a++){const c=r[a];s[a]=t(e[c],c,a,o&&o[a])}}else s=[];return i&&(i[n]=s),s}function Ra(e,t,i={},n,s){if(Ht.isCE||Ht.parent&&vs(Ht.parent)&&Ht.parent.isCE)return t!=="default"&&(i.name=t),Y("slot",i,n&&n());let o=e[t];o&&o._c&&(o._d=!1),R();const r=o&&kd(o(i)),a=je(Ce,{key:i.key||r&&r.key||`_${t}`},r||(n?n():[]),r&&e._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),o&&o._c&&(o._d=!0),a}function kd(e){return e.some(t=>Ko(t)?!(t.type===tn||t.type===Ce&&!kd(t.children)):!0)?e:null}const Oa=e=>e?Ld(e)?Cl(e)||e.proxy:Oa(e.parent):null,Ss=Ut(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Oa(e.parent),$root:e=>Oa(e.root),$emit:e=>e.emit,$options:e=>Il(e),$forceUpdate:e=>e.f||(e.f=()=>kl(e.update)),$nextTick:e=>e.n||(e.n=yg.bind(e.proxy)),$watch:e=>Rg.bind(e)}),zr=(e,t)=>e!==at&&!e.__isScriptSetup&&He(e,t),Wg={get({_:e},t){const{ctx:i,setupState:n,data:s,props:o,accessCache:r,type:a,appContext:l}=e;let c;if(t[0]!=="$"){const g=r[t];if(g!==void 0)switch(g){case 1:return n[t];case 2:return s[t];case 4:return i[t];case 3:return o[t]}else{if(zr(n,t))return r[t]=1,n[t];if(s!==at&&He(s,t))return r[t]=2,s[t];if((c=e.propsOptions[0])&&He(c,t))return r[t]=3,o[t];if(i!==at&&He(i,t))return r[t]=4,i[t];Na&&(r[t]=0)}}const u=Ss[t];let h,f;if(u)return t==="$attrs"&&qt(e,"get",t),u(e);if((h=a.__cssModules)&&(h=h[t]))return h;if(i!==at&&He(i,t))return r[t]=4,i[t];if(f=l.config.globalProperties,He(f,t))return f[t]},set({_:e},t,i){const{data:n,setupState:s,ctx:o}=e;return zr(s,t)?(s[t]=i,!0):n!==at&&He(n,t)?(n[t]=i,!0):He(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(o[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:n,appContext:s,propsOptions:o}},r){let a;return!!i[r]||e!==at&&He(e,r)||zr(t,r)||(a=o[0])&&He(a,r)||He(n,r)||He(Ss,r)||He(s.config.globalProperties,r)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:He(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};let Na=!0;function Gg(e){const t=Il(e),i=e.proxy,n=e.ctx;Na=!1,t.beforeCreate&&bc(t.beforeCreate,e,"bc");const{data:s,computed:o,methods:r,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:f,beforeUpdate:g,updated:_,activated:b,deactivated:v,beforeDestroy:y,beforeUnmount:E,destroyed:w,unmounted:P,render:A,renderTracked:O,renderTriggered:U,errorCaptured:z,serverPrefetch:te,expose:G,inheritAttrs:Q,components:Se,directives:ae,filters:Re}=t;if(c&&Vg(c,n,null,e.appContext.config.unwrapInjectedRef),r)for(const ee in r){const ne=r[ee];Te(ne)&&(n[ee]=ne.bind(i))}if(s){const ee=s.call(i,i);lt(ee)&&(e.data=Ci(ee))}if(Na=!0,o)for(const ee in o){const ne=o[ee],ie=Te(ne)?ne.bind(i,i):Te(ne.get)?ne.get.bind(i,i):fi,Le=!Te(ne)&&Te(ne.set)?ne.set.bind(i):fi,ke=Me({get:ie,set:Le});Object.defineProperty(n,ee,{enumerable:!0,configurable:!0,get:()=>ke.value,set:ge=>ke.value=ge})}if(a)for(const ee in a)Id(a[ee],n,i,ee);if(l){const ee=Te(l)?l.call(i):l;Reflect.ownKeys(ee).forEach(ne=>{Tg(ne,ee[ne])})}u&&bc(u,e,"c");function we(ee,ne){Pe(ne)?ne.forEach(ie=>ee(ie.bind(i))):ne&&ee(ne.bind(i))}if(we(Bg,h),we(st,f),we(wd,g),we(Xs,_),we(Og,b),we(Ng,v),we(Hg,z),we($g,O),we(Fg,U),we(zt,E),we(Js,P),we(Dg,te),Pe(G))if(G.length){const ee=e.exposed||(e.exposed={});G.forEach(ne=>{Object.defineProperty(ee,ne,{get:()=>i[ne],set:ie=>i[ne]=ie})})}else e.exposed||(e.exposed={});A&&e.render===fi&&(e.render=A),Q!=null&&(e.inheritAttrs=Q),Se&&(e.components=Se),ae&&(e.directives=ae)}function Vg(e,t,i=fi,n=!1){Pe(e)&&(e=La(e));for(const s in e){const o=e[s];let r;lt(o)?"default"in o?r=Po(o.from||s,o.default,!0):r=Po(o.from||s):r=Po(o),Ot(r)&&n?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:a=>r.value=a}):t[s]=r}}function bc(e,t,i){pi(Pe(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,i)}function Id(e,t,i,n){const s=n.includes(".")?yd(i,n):()=>i[n];if(vt(e)){const o=t[e];Te(o)&&In(s,o)}else if(Te(e))In(s,e.bind(i));else if(lt(e))if(Pe(e))e.forEach(o=>Id(o,t,i,n));else{const o=Te(e.handler)?e.handler.bind(i):t[e.handler];Te(o)&&In(s,o,e)}}function Il(e){const t=e.type,{mixins:i,extends:n}=t,{mixins:s,optionsCache:o,config:{optionMergeStrategies:r}}=e.appContext,a=o.get(t);let l;return a?l=a:!s.length&&!i&&!n?l=t:(l={},s.length&&s.forEach(c=>jo(l,c,r,!0)),jo(l,t,r)),lt(t)&&o.set(t,l),l}function jo(e,t,i,n=!1){const{mixins:s,extends:o}=t;o&&jo(e,o,i,!0),s&&s.forEach(r=>jo(e,r,i,!0));for(const r in t)if(!(n&&r==="expose")){const a=jg[r]||i&&i[r];e[r]=a?a(e[r],t[r]):t[r]}return e}const jg={data:_c,props:mn,emits:mn,methods:mn,computed:mn,beforeCreate:Dt,created:Dt,beforeMount:Dt,mounted:Dt,beforeUpdate:Dt,updated:Dt,beforeDestroy:Dt,beforeUnmount:Dt,destroyed:Dt,unmounted:Dt,activated:Dt,deactivated:Dt,errorCaptured:Dt,serverPrefetch:Dt,components:mn,directives:mn,watch:qg,provide:_c,inject:Kg};function _c(e,t){return t?e?function(){return Ut(Te(e)?e.call(this,this):e,Te(t)?t.call(this,this):t)}:t:e}function Kg(e,t){return mn(La(e),La(t))}function La(e){if(Pe(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function Dt(e,t){return e?[...new Set([].concat(e,t))]:t}function mn(e,t){return e?Ut(Ut(Object.create(null),e),t):t}function qg(e,t){if(!e)return t;if(!t)return e;const i=Ut(Object.create(null),e);for(const n in t)i[n]=Dt(e[n],t[n]);return i}function Yg(e,t,i,n=!1){const s={},o={};Wo(o,Mr,1),e.propsDefaults=Object.create(null),Pd(e,t,s,o);for(const r in e.propsOptions[0])r in s||(s[r]=void 0);i?e.props=n?s:hg(s):e.type.props?e.props=s:e.props=o,e.attrs=o}function Xg(e,t,i,n){const{props:s,attrs:o,vnode:{patchFlag:r}}=e,a=We(s),[l]=e.propsOptions;let c=!1;if((n||r>0)&&!(r&16)){if(r&8){const u=e.vnode.dynamicProps;for(let h=0;h<u.length;h++){let f=u[h];if(Pr(e.emitsOptions,f))continue;const g=t[f];if(l)if(He(o,f))g!==o[f]&&(o[f]=g,c=!0);else{const _=Ai(f);s[_]=Ba(l,a,_,g,e,!1)}else g!==o[f]&&(o[f]=g,c=!0)}}}else{Pd(e,t,s,o)&&(c=!0);let u;for(const h in a)(!t||!He(t,h)&&((u=ts(h))===h||!He(t,u)))&&(l?i&&(i[h]!==void 0||i[u]!==void 0)&&(s[h]=Ba(l,a,h,void 0,e,!0)):delete s[h]);if(o!==a)for(const h in o)(!t||!He(t,h))&&(delete o[h],c=!0)}c&&Ui(e,"set","$attrs")}function Pd(e,t,i,n){const[s,o]=e.propsOptions;let r=!1,a;if(t)for(let l in t){if(Io(l))continue;const c=t[l];let u;s&&He(s,u=Ai(l))?!o||!o.includes(u)?i[u]=c:(a||(a={}))[u]=c:Pr(e.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,r=!0)}if(o){const l=We(i),c=a||at;for(let u=0;u<o.length;u++){const h=o[u];i[h]=Ba(s,l,h,c[h],e,!He(c,h))}}return r}function Ba(e,t,i,n,s,o){const r=e[i];if(r!=null){const a=He(r,"default");if(a&&n===void 0){const l=r.default;if(r.type!==Function&&Te(l)){const{propsDefaults:c}=s;i in c?n=c[i]:(Xn(s),n=c[i]=l.call(null,t),Pn())}else n=l}r[0]&&(o&&!a?n=!1:r[1]&&(n===""||n===ts(i))&&(n=!0))}return n}function Ad(e,t,i=!1){const n=t.propsCache,s=n.get(e);if(s)return s;const o=e.props,r={},a=[];let l=!1;if(!Te(e)){const u=h=>{l=!0;const[f,g]=Ad(h,t,!0);Ut(r,f),g&&a.push(...g)};!i&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!o&&!l)return lt(e)&&n.set(e,$n),$n;if(Pe(o))for(let u=0;u<o.length;u++){const h=Ai(o[u]);yc(h)&&(r[h]=at)}else if(o)for(const u in o){const h=Ai(u);if(yc(h)){const f=o[u],g=r[h]=Pe(f)||Te(f)?{type:f}:Object.assign({},f);if(g){const _=wc(Boolean,g.type),b=wc(String,g.type);g[0]=_>-1,g[1]=b<0||_<b,(_>-1||He(g,"default"))&&a.push(h)}}}const c=[r,a];return lt(e)&&n.set(e,c),c}function yc(e){return e[0]!=="$"}function vc(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function Sc(e,t){return vc(e)===vc(t)}function wc(e,t){return Pe(t)?t.findIndex(i=>Sc(i,e)):Te(t)&&Sc(t,e)?0:-1}const Cd=e=>e[0]==="_"||e==="$stable",Pl=e=>Pe(e)?e.map(wi):[wi(e)],Jg=(e,t,i)=>{if(t._n)return t;const n=Si((...s)=>Pl(t(...s)),i);return n._c=!1,n},xd=(e,t,i)=>{const n=e._ctx;for(const s in e){if(Cd(s))continue;const o=e[s];if(Te(o))t[s]=Jg(s,o,n);else if(o!=null){const r=Pl(o);t[s]=()=>r}}},Md=(e,t)=>{const i=Pl(t);e.slots.default=()=>i},Qg=(e,t)=>{if(e.vnode.shapeFlag&32){const i=t._;i?(e.slots=We(t),Wo(t,"_",i)):xd(t,e.slots={})}else e.slots={},t&&Md(e,t);Wo(e.slots,Mr,1)},Zg=(e,t,i)=>{const{vnode:n,slots:s}=e;let o=!0,r=at;if(n.shapeFlag&32){const a=t._;a?i&&a===1?o=!1:(Ut(s,t),!i&&a===1&&delete s._):(o=!t.$stable,xd(t,s)),r=t}else t&&(Md(e,t),r={default:1});if(o)for(const a in s)!Cd(a)&&!(a in r)&&delete s[a]};function Td(){return{app:null,config:{isNativeTag:Cp,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let em=0;function tm(e,t){return function(n,s=null){Te(n)||(n=Object.assign({},n)),s!=null&&!lt(s)&&(s=null);const o=Td(),r=new Set;let a=!1;const l=o.app={_uid:em++,_component:n,_props:s,_container:null,_context:o,_instance:null,version:wm,get config(){return o.config},set config(c){},use(c,...u){return r.has(c)||(c&&Te(c.install)?(r.add(c),c.install(l,...u)):Te(c)&&(r.add(c),c(l,...u))),l},mixin(c){return o.mixins.includes(c)||o.mixins.push(c),l},component(c,u){return u?(o.components[c]=u,l):o.components[c]},directive(c,u){return u?(o.directives[c]=u,l):o.directives[c]},mount(c,u,h){if(!a){const f=Y(n,s);return f.appContext=o,u&&t?t(f,c):e(f,c,h),a=!0,l._container=c,c.__vue_app__=l,Cl(f.component)||f.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,u){return o.provides[c]=u,l}};return l}}function Da(e,t,i,n,s=!1){if(Pe(e)){e.forEach((f,g)=>Da(f,t&&(Pe(t)?t[g]:t),i,n,s));return}if(vs(n)&&!s)return;const o=n.shapeFlag&4?Cl(n.component)||n.component.proxy:n.el,r=s?null:o,{i:a,r:l}=e,c=t&&t.r,u=a.refs===at?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==l&&(vt(c)?(u[c]=null,He(h,c)&&(h[c]=null)):Ot(c)&&(c.value=null)),Te(l))Qi(l,a,12,[r,u]);else{const f=vt(l),g=Ot(l);if(f||g){const _=()=>{if(e.f){const b=f?He(h,l)?h[l]:u[l]:l.value;s?Pe(b)&&fl(b,o):Pe(b)?b.includes(o)||b.push(o):f?(u[l]=[o],He(h,l)&&(h[l]=u[l])):(l.value=[o],e.k&&(u[e.k]=l.value))}else f?(u[l]=r,He(h,l)&&(h[l]=r)):g&&(l.value=r,e.k&&(u[e.k]=r))};r?(_.id=-1,Vt(_,i)):_()}}}const Vt=Mg;function im(e){return nm(e)}function nm(e,t){const i=Lp();i.__VUE__=!0;const{insert:n,remove:s,patchProp:o,createElement:r,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:f,setScopeId:g=fi,insertStaticContent:_}=e,b=(C,T,D,V=null,j=null,X=null,se=!1,J=null,Z=!!T.dynamicChildren)=>{if(C===T)return;C&&!ss(C,T)&&(V=Pt(C),ge(C,j,X,!0),C=null),T.patchFlag===-2&&(Z=!1,T.dynamicChildren=null);const{type:q,ref:he,shapeFlag:de}=T;switch(q){case xr:v(C,T,D,V);break;case tn:y(C,T,D,V);break;case Wr:C==null&&E(T,D,V,se);break;case Ce:Se(C,T,D,V,j,X,se,J,Z);break;default:de&1?A(C,T,D,V,j,X,se,J,Z):de&6?ae(C,T,D,V,j,X,se,J,Z):(de&64||de&128)&&q.process(C,T,D,V,j,X,se,J,Z,wt)}he!=null&&j&&Da(he,C&&C.ref,X,T||C,!T)},v=(C,T,D,V)=>{if(C==null)n(T.el=a(T.children),D,V);else{const j=T.el=C.el;T.children!==C.children&&c(j,T.children)}},y=(C,T,D,V)=>{C==null?n(T.el=l(T.children||""),D,V):T.el=C.el},E=(C,T,D,V)=>{[C.el,C.anchor]=_(C.children,T,D,V,C.el,C.anchor)},w=({el:C,anchor:T},D,V)=>{let j;for(;C&&C!==T;)j=f(C),n(C,D,V),C=j;n(T,D,V)},P=({el:C,anchor:T})=>{let D;for(;C&&C!==T;)D=f(C),s(C),C=D;s(T)},A=(C,T,D,V,j,X,se,J,Z)=>{se=se||T.type==="svg",C==null?O(T,D,V,j,X,se,J,Z):te(C,T,j,X,se,J,Z)},O=(C,T,D,V,j,X,se,J)=>{let Z,q;const{type:he,props:de,shapeFlag:pe,transition:me,dirs:xe}=C;if(Z=C.el=r(C.type,X,de&&de.is,de),pe&8?u(Z,C.children):pe&16&&z(C.children,Z,null,V,j,X&&he!=="foreignObject",se,J),xe&&ln(C,null,V,"created"),U(Z,C,C.scopeId,se,V),de){for(const d in de)d!=="value"&&!Io(d)&&o(Z,d,null,de[d],X,C.children,V,j,Xe);"value"in de&&o(Z,"value",null,de.value),(q=de.onVnodeBeforeMount)&&bi(q,V,C)}xe&&ln(C,null,V,"beforeMount");const S=(!j||j&&!j.pendingBranch)&&me&&!me.persisted;S&&me.beforeEnter(Z),n(Z,T,D),((q=de&&de.onVnodeMounted)||S||xe)&&Vt(()=>{q&&bi(q,V,C),S&&me.enter(Z),xe&&ln(C,null,V,"mounted")},j)},U=(C,T,D,V,j)=>{if(D&&g(C,D),V)for(let X=0;X<V.length;X++)g(C,V[X]);if(j){let X=j.subTree;if(T===X){const se=j.vnode;U(C,se,se.scopeId,se.slotScopeIds,j.parent)}}},z=(C,T,D,V,j,X,se,J,Z=0)=>{for(let q=Z;q<C.length;q++){const he=C[q]=J?ji(C[q]):wi(C[q]);b(null,he,T,D,V,j,X,se,J)}},te=(C,T,D,V,j,X,se)=>{const J=T.el=C.el;let{patchFlag:Z,dynamicChildren:q,dirs:he}=T;Z|=C.patchFlag&16;const de=C.props||at,pe=T.props||at;let me;D&&cn(D,!1),(me=pe.onVnodeBeforeUpdate)&&bi(me,D,T,C),he&&ln(T,C,D,"beforeUpdate"),D&&cn(D,!0);const xe=j&&T.type!=="foreignObject";if(q?G(C.dynamicChildren,q,J,D,V,xe,X):se||ne(C,T,J,null,D,V,xe,X,!1),Z>0){if(Z&16)Q(J,T,de,pe,D,V,j);else if(Z&2&&de.class!==pe.class&&o(J,"class",null,pe.class,j),Z&4&&o(J,"style",de.style,pe.style,j),Z&8){const S=T.dynamicProps;for(let d=0;d<S.length;d++){const m=S[d],I=de[m],x=pe[m];(x!==I||m==="value")&&o(J,m,I,x,j,C.children,D,V,Xe)}}Z&1&&C.children!==T.children&&u(J,T.children)}else!se&&q==null&&Q(J,T,de,pe,D,V,j);((me=pe.onVnodeUpdated)||he)&&Vt(()=>{me&&bi(me,D,T,C),he&&ln(T,C,D,"updated")},V)},G=(C,T,D,V,j,X,se)=>{for(let J=0;J<T.length;J++){const Z=C[J],q=T[J],he=Z.el&&(Z.type===Ce||!ss(Z,q)||Z.shapeFlag&70)?h(Z.el):D;b(Z,q,he,null,V,j,X,se,!0)}},Q=(C,T,D,V,j,X,se)=>{if(D!==V){if(D!==at)for(const J in D)!Io(J)&&!(J in V)&&o(C,J,D[J],null,se,T.children,j,X,Xe);for(const J in V){if(Io(J))continue;const Z=V[J],q=D[J];Z!==q&&J!=="value"&&o(C,J,q,Z,se,T.children,j,X,Xe)}"value"in V&&o(C,"value",D.value,V.value)}},Se=(C,T,D,V,j,X,se,J,Z)=>{const q=T.el=C?C.el:a(""),he=T.anchor=C?C.anchor:a("");let{patchFlag:de,dynamicChildren:pe,slotScopeIds:me}=T;me&&(J=J?J.concat(me):me),C==null?(n(q,D,V),n(he,D,V),z(T.children,D,he,j,X,se,J,Z)):de>0&&de&64&&pe&&C.dynamicChildren?(G(C.dynamicChildren,pe,D,j,X,se,J),(T.key!=null||j&&T===j.subTree)&&Rd(C,T,!0)):ne(C,T,D,he,j,X,se,J,Z)},ae=(C,T,D,V,j,X,se,J,Z)=>{T.slotScopeIds=J,C==null?T.shapeFlag&512?j.ctx.activate(T,D,V,se,Z):Re(T,D,V,j,X,se,Z):Ee(C,T,Z)},Re=(C,T,D,V,j,X,se)=>{const J=C.component=dm(C,V,j);if(vd(C)&&(J.ctx.renderer=wt),fm(J),J.asyncDep){if(j&&j.registerDep(J,we),!C.el){const Z=J.subTree=Y(tn);y(null,Z,T,D)}return}we(J,C,T,D,j,X,se)},Ee=(C,T,D)=>{const V=T.component=C.component;if(Ag(C,T,D))if(V.asyncDep&&!V.asyncResolved){ee(V,T,D);return}else V.next=T,Sg(V.update),V.update();else T.el=C.el,V.vnode=T},we=(C,T,D,V,j,X,se)=>{const J=()=>{if(C.isMounted){let{next:he,bu:de,u:pe,parent:me,vnode:xe}=C,S=he,d;cn(C,!1),he?(he.el=xe.el,ee(C,he,se)):he=xe,de&&Hr(de),(d=he.props&&he.props.onVnodeBeforeUpdate)&&bi(d,me,he,xe),cn(C,!0);const m=Ur(C),I=C.subTree;C.subTree=m,b(I,m,h(I.el),Pt(I),C,j,X),he.el=m.el,S===null&&Cg(C,m.el),pe&&Vt(pe,j),(d=he.props&&he.props.onVnodeUpdated)&&Vt(()=>bi(d,me,he,xe),j)}else{let he;const{el:de,props:pe}=T,{bm:me,m:xe,parent:S}=C,d=vs(T);if(cn(C,!1),me&&Hr(me),!d&&(he=pe&&pe.onVnodeBeforeMount)&&bi(he,S,T),cn(C,!0),de&&mi){const m=()=>{C.subTree=Ur(C),mi(de,C.subTree,C,j,null)};d?T.type.__asyncLoader().then(()=>!C.isUnmounted&&m()):m()}else{const m=C.subTree=Ur(C);b(null,m,D,V,C,j,X),T.el=m.el}if(xe&&Vt(xe,j),!d&&(he=pe&&pe.onVnodeMounted)){const m=T;Vt(()=>bi(he,S,m),j)}(T.shapeFlag&256||S&&vs(S.vnode)&&S.vnode.shapeFlag&256)&&C.a&&Vt(C.a,j),C.isMounted=!0,T=D=V=null}},Z=C.effect=new bl(J,()=>kl(q),C.scope),q=C.update=()=>Z.run();q.id=C.uid,cn(C,!0),q()},ee=(C,T,D)=>{T.component=C;const V=C.vnode.props;C.vnode=T,C.next=null,Xg(C,T.props,V,D),Zg(C,T.children,D),is(),pc(),ns()},ne=(C,T,D,V,j,X,se,J,Z=!1)=>{const q=C&&C.children,he=C?C.shapeFlag:0,de=T.children,{patchFlag:pe,shapeFlag:me}=T;if(pe>0){if(pe&128){Le(q,de,D,V,j,X,se,J,Z);return}else if(pe&256){ie(q,de,D,V,j,X,se,J,Z);return}}me&8?(he&16&&Xe(q,j,X),de!==q&&u(D,de)):he&16?me&16?Le(q,de,D,V,j,X,se,J,Z):Xe(q,j,X,!0):(he&8&&u(D,""),me&16&&z(de,D,V,j,X,se,J,Z))},ie=(C,T,D,V,j,X,se,J,Z)=>{C=C||$n,T=T||$n;const q=C.length,he=T.length,de=Math.min(q,he);let pe;for(pe=0;pe<de;pe++){const me=T[pe]=Z?ji(T[pe]):wi(T[pe]);b(C[pe],me,D,null,j,X,se,J,Z)}q>he?Xe(C,j,X,!0,!1,de):z(T,D,V,j,X,se,J,Z,de)},Le=(C,T,D,V,j,X,se,J,Z)=>{let q=0;const he=T.length;let de=C.length-1,pe=he-1;for(;q<=de&&q<=pe;){const me=C[q],xe=T[q]=Z?ji(T[q]):wi(T[q]);if(ss(me,xe))b(me,xe,D,null,j,X,se,J,Z);else break;q++}for(;q<=de&&q<=pe;){const me=C[de],xe=T[pe]=Z?ji(T[pe]):wi(T[pe]);if(ss(me,xe))b(me,xe,D,null,j,X,se,J,Z);else break;de--,pe--}if(q>de){if(q<=pe){const me=pe+1,xe=me<he?T[me].el:V;for(;q<=pe;)b(null,T[q]=Z?ji(T[q]):wi(T[q]),D,xe,j,X,se,J,Z),q++}}else if(q>pe)for(;q<=de;)ge(C[q],j,X,!0),q++;else{const me=q,xe=q,S=new Map;for(q=xe;q<=pe;q++){const Oe=T[q]=Z?ji(T[q]):wi(T[q]);Oe.key!=null&&S.set(Oe.key,q)}let d,m=0;const I=pe-xe+1;let x=!1,N=0;const H=new Array(I);for(q=0;q<I;q++)H[q]=0;for(q=me;q<=de;q++){const Oe=C[q];if(m>=I){ge(Oe,j,X,!0);continue}let Be;if(Oe.key!=null)Be=S.get(Oe.key);else for(d=xe;d<=pe;d++)if(H[d-xe]===0&&ss(Oe,T[d])){Be=d;break}Be===void 0?ge(Oe,j,X,!0):(H[Be-xe]=q+1,Be>=N?N=Be:x=!0,b(Oe,T[Be],D,null,j,X,se,J,Z),m++)}const Ae=x?sm(H):$n;for(d=Ae.length-1,q=I-1;q>=0;q--){const Oe=xe+q,Be=T[Oe],et=Oe+1<he?T[Oe+1].el:V;H[q]===0?b(null,Be,D,et,j,X,se,J,Z):x&&(d<0||q!==Ae[d]?ke(Be,D,et,2):d--)}}},ke=(C,T,D,V,j=null)=>{const{el:X,type:se,transition:J,children:Z,shapeFlag:q}=C;if(q&6){ke(C.component.subTree,T,D,V);return}if(q&128){C.suspense.move(T,D,V);return}if(q&64){se.move(C,T,D,wt);return}if(se===Ce){n(X,T,D);for(let de=0;de<Z.length;de++)ke(Z[de],T,D,V);n(C.anchor,T,D);return}if(se===Wr){w(C,T,D);return}if(V!==2&&q&1&&J)if(V===0)J.beforeEnter(X),n(X,T,D),Vt(()=>J.enter(X),j);else{const{leave:de,delayLeave:pe,afterLeave:me}=J,xe=()=>n(X,T,D),S=()=>{de(X,()=>{xe(),me&&me()})};pe?pe(X,xe,S):S()}else n(X,T,D)},ge=(C,T,D,V=!1,j=!1)=>{const{type:X,props:se,ref:J,children:Z,dynamicChildren:q,shapeFlag:he,patchFlag:de,dirs:pe}=C;if(J!=null&&Da(J,null,D,C,!0),he&256){T.ctx.deactivate(C);return}const me=he&1&&pe,xe=!vs(C);let S;if(xe&&(S=se&&se.onVnodeBeforeUnmount)&&bi(S,T,C),he&6)St(C.component,D,V);else{if(he&128){C.suspense.unmount(D,V);return}me&&ln(C,null,T,"beforeUnmount"),he&64?C.type.remove(C,T,D,j,wt,V):q&&(X!==Ce||de>0&&de&64)?Xe(q,T,D,!1,!0):(X===Ce&&de&384||!j&&he&16)&&Xe(Z,T,D),V&&ut(C)}(xe&&(S=se&&se.onVnodeUnmounted)||me)&&Vt(()=>{S&&bi(S,T,C),me&&ln(C,null,T,"unmounted")},D)},ut=C=>{const{type:T,el:D,anchor:V,transition:j}=C;if(T===Ce){ht(D,V);return}if(T===Wr){P(C);return}const X=()=>{s(D),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(C.shapeFlag&1&&j&&!j.persisted){const{leave:se,delayLeave:J}=j,Z=()=>se(D,X);J?J(C.el,X,Z):Z()}else X()},ht=(C,T)=>{let D;for(;C!==T;)D=f(C),s(C),C=D;s(T)},St=(C,T,D)=>{const{bum:V,scope:j,update:X,subTree:se,um:J}=C;V&&Hr(V),j.stop(),X&&(X.active=!1,ge(se,C,T,D)),J&&Vt(J,T),Vt(()=>{C.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&C.asyncDep&&!C.asyncResolved&&C.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},Xe=(C,T,D,V=!1,j=!1,X=0)=>{for(let se=X;se<C.length;se++)ge(C[se],T,D,V,j)},Pt=C=>C.shapeFlag&6?Pt(C.component.subTree):C.shapeFlag&128?C.suspense.next():f(C.anchor||C.el),Ke=(C,T,D)=>{C==null?T._vnode&&ge(T._vnode,null,null,!0):b(T._vnode||null,C,T,null,null,null,D),pc(),gd(),T._vnode=C},wt={p:b,um:ge,m:ke,r:ut,mt:Re,mc:z,pc:ne,pbc:G,n:Pt,o:e};let ii,mi;return t&&([ii,mi]=t(wt)),{render:Ke,hydrate:ii,createApp:tm(Ke,ii)}}function cn({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function Rd(e,t,i=!1){const n=e.children,s=t.children;if(Pe(n)&&Pe(s))for(let o=0;o<n.length;o++){const r=n[o];let a=s[o];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[o]=ji(s[o]),a.el=r.el),i||Rd(r,a)),a.type===xr&&(a.el=r.el)}}function sm(e){const t=e.slice(),i=[0];let n,s,o,r,a;const l=e.length;for(n=0;n<l;n++){const c=e[n];if(c!==0){if(s=i[i.length-1],e[s]<c){t[n]=s,i.push(n);continue}for(o=0,r=i.length-1;o<r;)a=o+r>>1,e[i[a]]<c?o=a+1:r=a;c<e[i[o]]&&(o>0&&(t[n]=i[o-1]),i[o]=n)}}for(o=i.length,r=i[o-1];o-- >0;)i[o]=r,r=t[r];return i}const om=e=>e.__isTeleport,Ce=Symbol(void 0),xr=Symbol(void 0),tn=Symbol(void 0),Wr=Symbol(void 0),ws=[];let hi=null;function R(e=!1){ws.push(hi=e?null:[])}function rm(){ws.pop(),hi=ws[ws.length-1]||null}let Ls=1;function Ec(e){Ls+=e}function Od(e){return e.dynamicChildren=Ls>0?hi||$n:null,rm(),Ls>0&&hi&&hi.push(e),e}function B(e,t,i,n,s,o){return Od(p(e,t,i,n,s,o,!0))}function je(e,t,i,n,s){return Od(Y(e,t,i,n,s,!0))}function Ko(e){return e?e.__v_isVNode===!0:!1}function ss(e,t){return e.type===t.type&&e.key===t.key}const Mr="__vInternal",Nd=({key:e})=>e??null,Ao=({ref:e,ref_key:t,ref_for:i})=>e!=null?vt(e)||Ot(e)||Te(e)?{i:Ht,r:e,k:t,f:!!i}:e:null;function p(e,t=null,i=null,n=0,s=null,o=e===Ce?0:1,r=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Nd(t),ref:t&&Ao(t),scopeId:Ar,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Ht};return a?(Al(l,i),o&128&&e.normalize(l)):i&&(l.shapeFlag|=vt(i)?8:16),Ls>0&&!r&&hi&&(l.patchFlag>0||o&6)&&l.patchFlag!==32&&hi.push(l),l}const Y=am;function am(e,t=null,i=null,n=0,s=null,o=!1){if((!e||e===Ug)&&(e=tn),Ko(e)){const a=Yn(e,t,!0);return i&&Al(a,i),Ls>0&&!o&&hi&&(a.shapeFlag&6?hi[hi.indexOf(e)]=a:hi.push(a)),a.patchFlag|=-2,a}if(_m(e)&&(e=e.__vccOpts),t){t=lm(t);let{class:a,style:l}=t;a&&!vt(a)&&(t.class=Zt(a)),lt(l)&&(ad(l)&&!Pe(l)&&(l=Ut({},l)),t.style=Fe(l))}const r=vt(e)?1:xg(e)?128:om(e)?64:lt(e)?4:Te(e)?2:0;return p(e,t,i,n,s,r,o,!0)}function lm(e){return e?ad(e)||Mr in e?Ut({},e):e:null}function Yn(e,t,i=!1){const{props:n,ref:s,patchFlag:o,children:r}=e,a=t?cm(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Nd(a),ref:t&&t.ref?i&&s?Pe(s)?s.concat(Ao(t)):[s,Ao(t)]:Ao(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ce?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Yn(e.ssContent),ssFallback:e.ssFallback&&Yn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Qe(e=" ",t=0){return Y(xr,null,e,t)}function re(e="",t=!1){return t?(R(),je(tn,null,e)):Y(tn,null,e)}function wi(e){return e==null||typeof e=="boolean"?Y(tn):Pe(e)?Y(Ce,null,e.slice()):typeof e=="object"?ji(e):Y(xr,null,String(e))}function ji(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Yn(e)}function Al(e,t){let i=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Pe(t))i=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),Al(e,s()),s._c&&(s._d=!0));return}else{i=32;const s=t._;!s&&!(Mr in t)?t._ctx=Ht:s===3&&Ht&&(Ht.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Te(t)?(t={default:t,_ctx:Ht},i=32):(t=String(t),n&64?(i=16,t=[Qe(t)]):i=8);e.children=t,e.shapeFlag|=i}function cm(...e){const t={};for(let i=0;i<e.length;i++){const n=e[i];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=Zt([t.class,n.class]));else if(s==="style")t.style=Fe([t.style,n.style]);else if(vr(s)){const o=t[s],r=n[s];r&&o!==r&&!(Pe(o)&&o.includes(r))&&(t[s]=o?[].concat(o,r):r)}else s!==""&&(t[s]=n[s])}return t}function bi(e,t,i,n=null){pi(e,t,7,[i,n])}const um=Td();let hm=0;function dm(e,t,i){const n=e.type,s=(t?t.appContext:e.appContext)||um,o={uid:hm++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Bp(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ad(n,s),emitsOptions:bd(n,s),emit:null,emitted:null,propsDefaults:at,inheritAttrs:n.inheritAttrs,ctx:at,data:at,props:at,attrs:at,slots:at,refs:at,setupState:at,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=kg.bind(null,o),e.ce&&e.ce(o),o}let bt=null;const Xn=e=>{bt=e,e.scope.on()},Pn=()=>{bt&&bt.scope.off(),bt=null};function Ld(e){return e.vnode.shapeFlag&4}let Bs=!1;function fm(e,t=!1){Bs=t;const{props:i,children:n}=e.vnode,s=Ld(e);Yg(e,i,s,t),Qg(e,n);const o=s?pm(e,t):void 0;return Bs=!1,o}function pm(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=ld(new Proxy(e.ctx,Wg));const{setup:n}=i;if(n){const s=e.setupContext=n.length>1?mm(e):null;Xn(e),is();const o=Qi(n,e,0,[e.props,s]);if(ns(),Pn(),Kh(o)){if(o.then(Pn,Pn),t)return o.then(r=>{kc(e,r,t)}).catch(r=>{Ir(r,e,0)});e.asyncDep=o}else kc(e,o,t)}else Bd(e,t)}function kc(e,t,i){Te(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:lt(t)&&(e.setupState=hd(t)),Bd(e,i)}let Ic;function Bd(e,t,i){const n=e.type;if(!e.render){if(!t&&Ic&&!n.render){const s=n.template||Il(e).template;if(s){const{isCustomElement:o,compilerOptions:r}=e.appContext.config,{delimiters:a,compilerOptions:l}=n,c=Ut(Ut({isCustomElement:o,delimiters:a},r),l);n.render=Ic(s,c)}}e.render=n.render||fi}Xn(e),is(),Gg(e),ns(),Pn()}function gm(e){return new Proxy(e.attrs,{get(t,i){return qt(e,"get","$attrs"),t[i]}})}function mm(e){const t=n=>{e.exposed=n||{}};let i;return{get attrs(){return i||(i=gm(e))},slots:e.slots,emit:e.emit,expose:t}}function Cl(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(hd(ld(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in Ss)return Ss[i](e)},has(t,i){return i in t||i in Ss}}))}function bm(e,t=!0){return Te(e)?e.displayName||e.name:e.name||t&&e.__name}function _m(e){return Te(e)&&"__vccOpts"in e}const Me=(e,t)=>bg(e,t,Bs);function ym(e,t,i){const n=arguments.length;return n===2?lt(t)&&!Pe(t)?Ko(t)?Y(e,null,[t]):Y(e,t):Y(e,null,t):(n>3?i=Array.prototype.slice.call(arguments,2):n===3&&Ko(i)&&(i=[i]),Y(e,t,i))}const vm=Symbol(""),Sm=()=>Po(vm),wm="3.2.47",Em="http://www.w3.org/2000/svg",vn=typeof document<"u"?document:null,Pc=vn&&vn.createElement("template"),km={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,n)=>{const s=t?vn.createElementNS(Em,e):vn.createElement(e,i?{is:i}:void 0);return e==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:e=>vn.createTextNode(e),createComment:e=>vn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>vn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,n,s,o){const r=i?i.previousSibling:t.lastChild;if(s&&(s===o||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),i),!(s===o||!(s=s.nextSibling)););else{Pc.innerHTML=n?`<svg>${e}</svg>`:e;const a=Pc.content;if(n){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,i)}return[r?r.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function Im(e,t,i){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}function Pm(e,t,i){const n=e.style,s=vt(i);if(i&&!s){if(t&&!vt(t))for(const o in t)i[o]==null&&Fa(n,o,"");for(const o in i)Fa(n,o,i[o])}else{const o=n.display;s?t!==i&&(n.cssText=i):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=o)}}const Ac=/\s*!important$/;function Fa(e,t,i){if(Pe(i))i.forEach(n=>Fa(e,t,n));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const n=Am(e,t);Ac.test(i)?e.setProperty(ts(n),i.replace(Ac,""),"important"):e[n]=i}}const Cc=["Webkit","Moz","ms"],Gr={};function Am(e,t){const i=Gr[t];if(i)return i;let n=Ai(t);if(n!=="filter"&&n in e)return Gr[t]=n;n=Er(n);for(let s=0;s<Cc.length;s++){const o=Cc[s]+n;if(o in e)return Gr[t]=o}return t}const xc="http://www.w3.org/1999/xlink";function Cm(e,t,i,n,s){if(n&&t.startsWith("xlink:"))i==null?e.removeAttributeNS(xc,t.slice(6,t.length)):e.setAttributeNS(xc,t,i);else{const o=Ap(t);i==null||o&&!Gh(i)?e.removeAttribute(t):e.setAttribute(t,o?"":i)}}function xm(e,t,i,n,s,o,r){if(t==="innerHTML"||t==="textContent"){n&&r(n,s,o),e[t]=i??"";return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=i;const l=i??"";(e.value!==l||e.tagName==="OPTION")&&(e.value=l),i==null&&e.removeAttribute(t);return}let a=!1;if(i===""||i==null){const l=typeof e[t];l==="boolean"?i=Gh(i):i==null&&l==="string"?(i="",a=!0):l==="number"&&(i=0,a=!0)}try{e[t]=i}catch{}a&&e.removeAttribute(t)}function Mm(e,t,i,n){e.addEventListener(t,i,n)}function Tm(e,t,i,n){e.removeEventListener(t,i,n)}function Rm(e,t,i,n,s=null){const o=e._vei||(e._vei={}),r=o[t];if(n&&r)r.value=n;else{const[a,l]=Om(t);if(n){const c=o[t]=Bm(n,s);Mm(e,a,c,l)}else r&&(Tm(e,a,r,l),o[t]=void 0)}}const Mc=/(?:Once|Passive|Capture)$/;function Om(e){let t;if(Mc.test(e)){t={};let n;for(;n=e.match(Mc);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ts(e.slice(2)),t]}let Vr=0;const Nm=Promise.resolve(),Lm=()=>Vr||(Nm.then(()=>Vr=0),Vr=Date.now());function Bm(e,t){const i=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=i.attached)return;pi(Dm(n,i.value),t,5,[n])};return i.value=e,i.attached=Lm(),i}function Dm(e,t){if(Pe(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(n=>s=>!s._stopped&&n&&n(s))}else return t}const Tc=/^on[a-z]/,Fm=(e,t,i,n,s=!1,o,r,a,l)=>{t==="class"?Im(e,n,s):t==="style"?Pm(e,i,n):vr(t)?dl(t)||Rm(e,t,i,n,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):$m(e,t,n,s))?xm(e,t,n,o,r,a,l):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),Cm(e,t,n,s))};function $m(e,t,i,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&Tc.test(t)&&Te(i)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Tc.test(t)&&vt(i)?!1:t in e}const Hm=Ut({patchProp:Fm},km);let Rc;function Um(){return Rc||(Rc=im(Hm))}const zm=(...e)=>{const t=Um().createApp(...e),{mount:i}=t;return t.mount=n=>{const s=Wm(n);if(!s)return;const o=t._component;!Te(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.innerHTML="";const r=i(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},t};function Wm(e){return vt(e)?document.querySelector(e):e}function qo(e,t){return(e?Oc(e):"")+Oc(t)}function Oc(e){return e+(e.endsWith(`
`)?"":`
`)}function Dd(e){return e instanceof Error?e.message:e instanceof Object?JSON.stringify(e):String(e)}function Nc(e,t,i){return t===0?"0%":(e/t*100).toFixed(i)+"%"}function Gm(e){switch(e%100){case 11:case 12:case 13:return e+"th"}switch(e%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd";default:return e+"th"}}var mt=(e=>(e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error",e))(mt||{}),Yo=(e=>(e.JA="ja",e.EN="en",e))(Yo||{}),xl=(e=>(e.STANDARD="standard",e.CHERRY_BLOSSOM="cherry-blossom",e.AUTUMN="autumn",e.SNOW="snow",e.DARK="dark",e))(xl||{}),wn=(e=>(e.HITOMOJI="hitomoji",e.HITOMOJI_DARK="hitomojiDark",e.HITOMOJI_GOTHIC="hitomojiGothic",e.HITOMOJI_GOTHIC_DARK="hitomojiGothicDark",e))(wn||{}),De=(e=>(e.LIGHT="light",e.WARM="warm",e.RESIN="resin",e.RESIN2="resin2",e.RESIN3="resin3",e.DARK="dark",e.GREEN="green",e.CHERRY_BLOSSOM="cherry-blossom",e))(De||{}),Es=(e=>(e.NONE="none",e.STANDARD="standard",e))(Es||{}),Xo=(e=>(e.SINGLE="single",e.DOUBLE="double",e))(Xo||{}),$t=(e=>(e.RECORD_INFO="recordInfo",e.COMMENT="comment",e.SEARCH="search",e.PV="pv",e.CHART="chart",e.PERCENTAGE_CHART="percentageChart",e.INVISIBLE="invisible",e))($t||{}),Ml=(e=>(e.BLACK="black",e.EACH="each",e))(Ml||{}),$a=(e=>(e.ALL="all",e.ONLY_USER="onlyUser",e))($a||{});function Vm(e,t){const i={...e,...t};switch(i.tabPaneType){case"double":switch(i.tab){case"comment":i.tab="recordInfo";break;case"chart":case"percentageChart":i.tab="pv";break}break}return e.topPaneHeightPercentage!==0&&e.topPaneHeightPercentage!==100&&(i.topPanePreviousHeightPercentage=e.topPaneHeightPercentage),jm(i)||i}function Ha(e){return{language:"ja",thema:"standard",pieceImage:"hitomoji",boardImage:"resin2",boardLabelType:"standard",pieceVolume:30,clockVolume:30,clockPitch:500,clockSoundTarget:"onlyUser",boardFlipping:!1,tabPaneType:"double",tab:"recordInfo",tab2:"comment",topPaneHeightPercentage:60,topPanePreviousHeightPercentage:60,bottomLeftPaneWidthPercentage:60,returnCode:(e==null?void 0:e.returnCode)||`\r
`,autoSaveDirectory:(e==null?void 0:e.autoSaveDirectory)||"",engineTimeoutSeconds:10,evaluationViewFrom:"each",coefficientInSigmoid:600,badMoveLevelThreshold1:5,badMoveLevelThreshold2:10,badMoveLevelThreshold3:20,badMoveLevelThreshold4:50,showElapsedTimeInRecordView:!0,showCommentInRecordView:!0,enableAppLog:!1,enableUSILog:!1,enableCSALog:!1,logLevel:mt.INFO}}function jm(e){if(e.pieceVolume<0||e.pieceVolume>100)return new Error("0%100%");if(e.clockVolume<0||e.clockVolume>100)return new Error("0%100%");if(e.clockPitch<220||e.clockPitch>880)return new Error("220Hz880Hz");if(e.engineTimeoutSeconds<1)return new Error(" 1 ");if(e.engineTimeoutSeconds>300)return new Error(" 300 ");if(e.coefficientInSigmoid<=0)return new Error("0");if(e.badMoveLevelThreshold1<1||e.badMoveLevelThreshold1>100)return new Error("1%100%");if(e.badMoveLevelThreshold2<1||e.badMoveLevelThreshold2>100)return new Error("1%100%");if(e.badMoveLevelThreshold3<1||e.badMoveLevelThreshold3>100)return new Error("1%100%");if(e.badMoveLevelThreshold4<1||e.badMoveLevelThreshold4>100)return new Error("1%100%");if(e.badMoveLevelThreshold1>=e.badMoveLevelThreshold2)return new Error("");if(e.badMoveLevelThreshold2>=e.badMoveLevelThreshold3)return new Error("");if(e.badMoveLevelThreshold3>=e.badMoveLevelThreshold4)return new Error("")}const Ua={[Yo.JA]:{electronShogi:"Electron",clear:"",open:"",saveOverwrite:"",newRecord:"",newRecordWithBrackets:"",openRecord:"",saveRecord:"",saveRecordAs:"",openAutoSavingDirectory:"",close:"",quit:"",editing:"",copyAsKIF:"KIF",copyAsCSA:"CSA",copyAsUSI:"USI",copyAsSFEN:"SFEN",paste:"",copyRecord:"",asKIF:"KIF",asCSA:"CSA",asUSIUntilCurrentMove:"USI()",asUSIAll:"USI()",copyPositionAsSFEN:"(SFEN)",pasteRecordOrPosition:"",appendSpecialMove:"",deleteMoves:"",view:"",toggleFullScreen:"",defaultFontSize:"",largerFontSize:"",smallerFontSize:"",settings:"",config:"",debug:"",toggleDevTools:"",openAppDirectory:"",openSettingDirectory:"",openLogDirectory:"",help:"",openWebSite:"Web",howToUse:"",checkForUpdates:"",game:"",player:"",selectFromHistory:"",noHistory:"",saveHistory:"",version:"",gameProgress:"",allGamesCompleted:"",gameEnded:"",offlineGame:"",csaOnlineGame:"CSA",csaProtocolOnlineGame:"CSA",csaProtocolV121:"CSA1.2.1 ",csaProtocolV121WithPVComment:"CSA1.2.1 ",hostToConnect:"",portNumber:"",password:"",showPassword:"",logout:"",displayGameResults:"",interrupt:"",stopGame:"",resign:"",draw:"",impass:"",repetitionDraw:"",mate:"",timeout:"",foulWin:"",foulLose:"",enteringOfKing:"",winByDefault:"",loseByDefault:"",winByDeclaration:"",declareWinning:"",research:"",startResearch:"",endResearch:"",recordAnalysis:"",analysis:"",analyze:"",stopAnalysis:"",setupPosition:"",startPositionSetup:"",completePositionSetup:"",changeTurn:"",initializePosition:"",appSettings:"",language:"",theme:"",standardGreen:"",green:"",cherryBlossom:"",autumn:"",snow:"",dark:"",pieceImages:"",singleKanjiPiece:"",singleKanjiGothicPiece:"",singleKanjiDarkPiece:"",singleKanjiGothicDarkPiece:"",boardImage:"",lightWoodyTexture:"",warmWoodTexture:"",regin:"",displayFileAndRank:"",tabViewStyle:"",oneColumn:"1",twoColumns:"2",sounds:"",pieceLoudness:"",clockLoudness:"",clockPitch:"",clockSoundTarget:"",anyTurn:"",onlyHumanTurn:"",newlineCharacter:"",old90sMac:"90Mac",autoSavingDirectory:"",select:"",usiProtocol:"USI",maxStartupTime:"",forDevelopers:"",enableAppLog:"",enableUSILog:"USI",enableCSALog:"CSA",logLevel:"",engineSettings:"",flipBoard:"",file:"",remove:"",deleteMove:"",recordProperties:"",comments:"",moveComments:"",searchLog:"",pv:"",mateShort:"",displayPVShort:"",evaluation:"",eval:"",estimatedWinRate:"",evaluationAndEstimatedWinRate:"",swapEachTurnChange:"",alwaysSenteIsPositive:"",signOfEvaluation:"",winRateCoefficient:"",hideTabView:"",expandTabView:"",sente:"",senteOrShitate:"",gote:"",goteOrUwate:"",swapSenteGote:"",currentPosition:"",time:"",enableEngineTimeout:"",others:"",nextTurn:"",elapsedTime:"",elapsed:"",rank:"",depth:"",searchEngine:"",ponder:"(Ponder)",numberOfThreads:"",multiPV:"PV",startPosition:"",maxMoves:"",gameRepetition:"",autoRelogin:"",swapTurnWhenGameRepetition:"1",outputComments:"",saveRecordAutomatically:"",adjustBoardToHumanPlayer:"",adjustBoardAutomatically:"",startGame:"",startCriteria:"",endCriteria:"",endCriteria1Move:"",outputSettings:"",noOutputs:"",insertCommentToTop:"",appendCommentToBottom:"",overwrite:"",fromPrefix:"",fromSuffix:"",toPrefix:"",toSuffix:"",plySuffix:"",hoursSuffix:"",minutesSuffix:"",secondsSuffix:"",engineManagement:"",engineName:"",author:"",enginePath:"",openDirectory:"",displayName:"",invoke:"",resetToEngineDefaultValues:"",defaultValue:"",noEngineRegistered:"",duplicate:"",add:"",recommended:"",import:"",saveAndClose:"",save:"",saveAs:"",cancel:"",back:"",name:"",prediction:"",best:"",nodes:"Node",hashUsage:"Hash",nonHandicap:"",lanceHandicap:"",rightLanceHandicap:"",bishopHandicap:"",rookHandicap:"",rookLanceHandicap:"",twoPiecesHandicap:"",fourPiecesHandicap:"",sixPiecesHandicap:"",eightPiecesHandicap:"",tsumeShogi:"",reciprocalKingTsumeShogi:"",inBrowserLogsOutputToConsoleAndIgnoreThisSetting:"",shouldRestartToApplyLogSettings:"",canOpenLogDirectoryFromMenu:"-",hasNoOldLogCleanUpFeature:"",processingPleaseWait:"",importingFollowingRecordOrPosition:"()",supportsKIFCSAUSI:"KIF/CSA/SFEN",plesePasteRecordIntoTextArea:"",desktopVersionPastesAutomatically:"",someLogsDisabled:"",logsRecommendedForCSAProtocol:"CSA",pleaseEnableLogsAndRestart:"",notSendPVOnStandardCSAProtocol:"CSA",sendPVDoNotUseOnWCSC:"FloodgateWCSC",csaProtocolSendPlaintextPassword:"CSA",passwordWillSavedPlaintextBecauseOSSideEncryptionNotAvailable:"OS",pleaseUncheckSaveHistoryIfNotWantSave:"",csaProtocolSendPlaintextPasswordRegardlessOfHistory:"CSA",areYouSureWantToQuitGames:"",areYouSureWantToRequestQuit:"",areYouSureWantToClearRecord:"",areYouSureWantToDiscardPosition:"",errorsOccurred:e=>`${e} `,between:(e,t)=>`${e}  ${t} `,addNthEngine:e=>`${e} `,copyOf:e=>`${e} `,keepLatest:e=>`${e}`,areYouSureWantToDeleteFollowingMove:e=>`${e}`},[Yo.EN]:{electronShogi:"Electron Shogi",clear:"Clear",open:"Open",saveOverwrite:"Overwrite",newRecord:"New Record",newRecordWithBrackets:"(New Record)",openRecord:"Open Record",saveRecord:"Save Record",saveRecordAs:"Save Record As",openAutoSavingDirectory:"Open Auto-Saving Directory",close:"Close",quit:"Quit",editing:"Edit",copyAsKIF:"Copy (KIF)",copyAsCSA:"Copy (CSA)",copyAsUSI:"Copy (USI)",copyAsSFEN:"Copy (SFEN)",paste:"Paste",copyRecord:"Copy Record",asKIF:"as KIF",asCSA:"as CSA",asUSIUntilCurrentMove:"as USI (until current move)",asUSIAll:"as USI (all)",copyPositionAsSFEN:"Copy Position (as SFEN)",pasteRecordOrPosition:"Paste Record/Position",appendSpecialMove:"Append Special Move",deleteMoves:"Delete Current Move and Following Moves",view:"View",toggleFullScreen:"Toggle Full Screen",defaultFontSize:"Default Font Size",largerFontSize:"Larger Font Size",smallerFontSize:"Smaller Font Size",settings:"Settings",config:"Config",debug:"Debug",toggleDevTools:"Toggle Developer Tools",openAppDirectory:"Open App Directory",openSettingDirectory:"Open Setting Directory",openLogDirectory:"Open Log Directory",help:"Help",openWebSite:"Open Web Site",howToUse:"How to Use",checkForUpdates:"Check for Updates",game:"Game",player:"Player",selectFromHistory:"Select from History",noHistory:"Empty",saveHistory:"Save History",version:"Version",gameProgress:"Game Progress",allGamesCompleted:"All Games Completed",gameEnded:"Game Ended",offlineGame:"Offline Game",csaOnlineGame:"CSA Online Game",csaProtocolOnlineGame:"Online Game (CSA Protocol)",csaProtocolV121:"CSA Protocol 1.2.1 Standard",csaProtocolV121WithPVComment:"CSA Protocol 1.2.1 with PV Comment",hostToConnect:"Hostname",portNumber:"Port",password:"Password",showPassword:"Show Password",logout:"Logout",displayGameResults:"Display Results",interrupt:"Stop",stopGame:"Stop",resign:"Resign",draw:"Draw",impass:"Impass",repetitionDraw:"Repetition Draw",mate:"Mate",timeout:"Timeout",foulWin:"Foul Win",foulLose:"Foul Lose",enteringOfKing:"Entering of King",winByDefault:"Win by Default",loseByDefault:"Lose by Default",winByDeclaration:"Win by Declaration",declareWinning:"Declare Winning",research:"Research",startResearch:"Start Research",endResearch:"End Research",recordAnalysis:"Record Analysis",analysis:"Analyze",analyze:"Analyze",stopAnalysis:"Stop Analysis",setupPosition:"Setup Position",startPositionSetup:"Start Position Setup",completePositionSetup:"Complete Setup",changeTurn:"Change Turn",initializePosition:"Initialize Position",appSettings:"Preferences",language:"Languages",theme:"Theme",standardGreen:"Green (Standard)",green:"Green",cherryBlossom:"Cherry Blossom",autumn:"Autumn",snow:"Snow",dark:"Dark",pieceImages:"Piece Images",singleKanjiPiece:"Single Kanji",singleKanjiGothicPiece:"Single Kanji (Gothic)",singleKanjiDarkPiece:"Single Kanji (Dark)",singleKanjiGothicDarkPiece:"Single Kanji (Gothic, Dark)",boardImage:"Board Image",lightWoodyTexture:"Woody Texture (Light)",warmWoodTexture:"Woody Texture (Warm)",regin:"Regin",displayFileAndRank:"Display File & Rank",tabViewStyle:"Tab View Style",oneColumn:"1 Column",twoColumns:"2 Columns",sounds:"Sounds",pieceLoudness:"Piece Loudness",clockLoudness:"Clock Loudness",clockPitch:"Clock Pitch",clockSoundTarget:"Clock Sound Target",anyTurn:"Any",onlyHumanTurn:"Human",newlineCharacter:"Newline Character",old90sMac:"90's Mac",autoSavingDirectory:"Auto-Saving Directory",select:"Select",usiProtocol:"USI Protocol",maxStartupTime:"Max Startup Time",forDevelopers:"For Developers",enableAppLog:"Enable App Log",enableUSILog:"Enable USI Log",enableCSALog:"Enable CSA Log",logLevel:"Log Level",engineSettings:"Engine Settings",flipBoard:"Flip Board",file:"File",remove:"Remove",deleteMove:"Delete Move",recordProperties:"Record Properties",comments:"Comments",moveComments:"Move Comments",searchLog:"Search Log",pv:"PV",mateShort:"M",displayPVShort:"Play",evaluation:"Evaluation",eval:"Eval",estimatedWinRate:"Estimated Win Rate",evaluationAndEstimatedWinRate:"Evaluation & Estimated Win Rate",swapEachTurnChange:"Swap Each Turn Change",alwaysSenteIsPositive:"Always Sente is Positive",signOfEvaluation:"Sign of Evaluation",winRateCoefficient:"Win Rate Coefficient",hideTabView:"Hide",expandTabView:"Expand Tab View",sente:"Sente",senteOrShitate:"Sente (Shitate)",gote:"Gote",goteOrUwate:"Gote (Uwate)",swapSenteGote:"Swap Sente/Gote",currentPosition:"Current Position",time:"Time",enableEngineTimeout:"Enable Engine Timeout",others:"Others",nextTurn:"Next Move",elapsedTime:"Time",elapsed:"Elapsed",rank:"Rank",depth:"Depth",searchEngine:"Search Engine",ponder:"Ponder",numberOfThreads:"Threads",multiPV:"Multi PV",startPosition:"Position",maxMoves:"Max Moves",gameRepetition:"Repeat",autoRelogin:"Auto Re-Login",swapTurnWhenGameRepetition:"Swap Turns When Repeat",outputComments:"Output Comments",saveRecordAutomatically:"Save Record Automatically",adjustBoardToHumanPlayer:"Adjust Board to Human Player",adjustBoardAutomatically:"Adjust Board Automatically",startGame:"Start Game",startCriteria:"Start Criteria",endCriteria:"End Criteria",endCriteria1Move:"End Criteria for 1 Move",outputSettings:"Output Settings",noOutputs:"No Outputs",insertCommentToTop:"Insert to Top",appendCommentToBottom:"Append to Bottom",overwrite:"Overwrite",fromPrefix:"from",fromSuffix:"",toPrefix:"to",toSuffix:"",plySuffix:"th move",hoursSuffix:"h",minutesSuffix:"min",secondsSuffix:"sec",engineManagement:"Engine Management",engineName:"Engine Name",author:"Author",enginePath:"Engine Path",openDirectory:"Open Directory",displayName:"Display Name",invoke:"Invoke",resetToEngineDefaultValues:"Reset to default values",defaultValue:"Default Value",noEngineRegistered:"No engine",duplicate:"Copy",add:"Add",recommended:"Recommended",import:"Import",saveAndClose:"Save & Close",save:"Save",saveAs:"Save As",cancel:"Cancel",back:"Back",name:"Name",prediction:"Prediction",best:"Best",nodes:"Nodes",hashUsage:"Hash Usage",nonHandicap:"Non-Handicap",lanceHandicap:"Lance Handicap",rightLanceHandicap:"Right Lance Handicap",bishopHandicap:"Bishop Handicap",rookHandicap:"Rook Handicap",rookLanceHandicap:"Rook-Lance Handicap",twoPiecesHandicap:"2 Pieces Handicap",fourPiecesHandicap:"4 Pieces Handicap",sixPiecesHandicap:"6 Pieces Handicap",eightPiecesHandicap:"8 Pieces Handicap",tsumeShogi:"Tsume Shogi",reciprocalKingTsumeShogi:"Reciprocal King Tsume Shogi",inBrowserLogsOutputToConsoleAndIgnoreThisSetting:"*In web browser version, it will output logs to console and ignore this setting.",shouldRestartToApplyLogSettings:"*You should restart this app to apply log settings.",canOpenLogDirectoryFromMenu:'*You can open log directory from "Debug" - "Open Log Directory" menu.',hasNoOldLogCleanUpFeature:"* This app has no old log clean-up feature.",processingPleaseWait:"Processing, please wait.",importingFollowingRecordOrPosition:"Importing the following record(or position).",supportsKIFCSAUSI:"*Supports KIF, CSA, USI.",plesePasteRecordIntoTextArea:"*Please paste record data into the text area.",desktopVersionPastesAutomatically:"*In desktop version, it will paste automatically from clipboard.",someLogsDisabled:"Some log settings are disabled.",logsRecommendedForCSAProtocol:"Log settings are recommended for CSA protocol.",pleaseEnableLogsAndRestart:"Please enable log settings and restart this app.",notSendPVOnStandardCSAProtocol:"Client do not send PV on standard CSA protocol.",sendPVDoNotUseOnWCSC:"Client send PV by floodgate extension. Do not use on WCSC.",csaProtocolSendPlaintextPassword:"On CSA protocol, client send plaintext password.",passwordWillSavedPlaintextBecauseOSSideEncryptionNotAvailable:"Password will saved as plaintext because OS side encryption is not available.",pleaseUncheckSaveHistoryIfNotWantSave:"Please uncheck Save History, if you don't want to save.",csaProtocolSendPlaintextPasswordRegardlessOfHistory:"On CSA protocol, client send plaintext password regardless of history.",areYouSureWantToQuitGames:"Are you sure you want to quit games?",areYouSureWantToRequestQuit:"You have possibility to be loser. Are you sure you want to request quit?",areYouSureWantToClearRecord:"Are you sure you want to clear record?",areYouSureWantToDiscardPosition:"Are you sure you want to discard the position?",errorsOccurred:e=>e>=2?`${e} errors have occurred.`:`${e} error has occurred.`,between:(e,t)=>`between ${e} and ${t}`,addNthEngine:e=>`Add ${Gm(e)} engine`,copyOf:e=>`${e} (copy)`,keepLatest:e=>`keep latest ${e}`,areYouSureWantToDeleteFollowingMove:e=>`Are you sure you want to delete ${e}th move and the following move?`}},ve=Ua.ja;function Km(e){for(const t in Ua[e])ve[t]=Ua[e][t]}var L=(e=>(e.BLACK="black",e.WHITE="white",e))(L||{});function Mt(e){return e==="black"?"white":"black"}function qm(e){return e==="black"?"b":"w"}function Ym(e){return e==="b"||e==="w"}function Xm(e){return e==="b"?"black":"white"}var F=(e=>(e.PAWN="pawn",e.LANCE="lance",e.KNIGHT="knight",e.SILVER="silver",e.GOLD="gold",e.BISHOP="bishop",e.ROOK="rook",e.KING="king",e.PROM_PAWN="promPawn",e.PROM_LANCE="promLance",e.PROM_KNIGHT="promKnight",e.PROM_SILVER="promSilver",e.HORSE="horse",e.DRAGON="dragon",e))(F||{});const Jm=["pawn","lance","knight","silver","gold","bishop","rook"],Qm={pawn:!0,lance:!0,knight:!0,silver:!0,gold:!1,bishop:!0,rook:!0,king:!1,promPawn:!1,promLance:!1,promKnight:!1,promSilver:!1,horse:!1,dragon:!1},Fd={pawn:"promPawn",lance:"promLance",knight:"promKnight",silver:"promSilver",bishop:"horse",rook:"dragon"};function Zm(e){return Fd[e]||e}const e0={promPawn:"pawn",promLance:"lance",promKnight:"knight",promSilver:"silver",horse:"bishop",dragon:"rook"},$d={pawn:"P",lance:"L",knight:"N",silver:"S",gold:"G",bishop:"B",rook:"R",king:"K",promPawn:"+P",promLance:"+L",promKnight:"+N",promSilver:"+S",horse:"+B",dragon:"+R"};function t0(e){return $d[e]}const i0={pawn:"p",lance:"l",knight:"n",silver:"s",gold:"g",bishop:"b",rook:"r",king:"k",promPawn:"+p",promLance:"+l",promKnight:"+n",promSilver:"+s",horse:"+b",dragon:"+r"},Lc={P:"pawn",L:"lance",N:"knight",S:"silver",G:"gold",B:"bishop",R:"rook",K:"king","+P":"promPawn","+L":"promLance","+N":"promKnight","+S":"promSilver","+B":"horse","+R":"dragon",p:"pawn",l:"lance",n:"knight",s:"silver",g:"gold",b:"bishop",r:"rook",k:"king","+p":"promPawn","+l":"promLance","+n":"promKnight","+s":"promSilver","+b":"horse","+r":"dragon"},n0={P:L.BLACK,L:L.BLACK,N:L.BLACK,S:L.BLACK,G:L.BLACK,B:L.BLACK,R:L.BLACK,K:L.BLACK,"+P":L.BLACK,"+L":L.BLACK,"+N":L.BLACK,"+S":L.BLACK,"+B":L.BLACK,"+R":L.BLACK,p:L.WHITE,l:L.WHITE,n:L.WHITE,s:L.WHITE,g:L.WHITE,b:L.WHITE,r:L.WHITE,k:L.WHITE,"+p":L.WHITE,"+l":L.WHITE,"+n":L.WHITE,"+s":L.WHITE,"+b":L.WHITE,"+r":L.WHITE},Wt=new Map;Wt.set("pawn",{type:"promPawn",reverseColor:!1});Wt.set("lance",{type:"promLance",reverseColor:!1});Wt.set("knight",{type:"promKnight",reverseColor:!1});Wt.set("silver",{type:"promSilver",reverseColor:!1});Wt.set("gold",{type:"gold",reverseColor:!0});Wt.set("bishop",{type:"horse",reverseColor:!1});Wt.set("rook",{type:"dragon",reverseColor:!1});Wt.set("king",{type:"king",reverseColor:!0});Wt.set("promPawn",{type:"pawn",reverseColor:!0});Wt.set("promLance",{type:"lance",reverseColor:!0});Wt.set("promKnight",{type:"knight",reverseColor:!0});Wt.set("promSilver",{type:"silver",reverseColor:!0});Wt.set("horse",{type:"bishop",reverseColor:!0});Wt.set("dragon",{type:"rook",reverseColor:!0});class ce{constructor(t,i){this.color=t,this.type=i}black(){return this.withColor(L.BLACK)}white(){return this.withColor(L.WHITE)}withColor(t){return new ce(t,this.type)}equals(t){return this.type===t.type&&this.color===t.color}promoted(){const t=Fd[this.type];return new ce(this.color,t||this.type)}unpromoted(){const t=e0[this.type];return new ce(this.color,t||this.type)}isPromotable(){return!!Qm[this.type]}rotate(){const t=Wt.get(this.type),i=new ce(this.color,t?t.type:this.type);return t&&t.reverseColor&&(i.color=Mt(this.color)),i}get id(){return this.color+"_"+this.type}get sfen(){switch(this.color){default:case L.BLACK:return $d[this.type];case L.WHITE:return i0[this.type]}}static isValidSFEN(t){return!!Lc[t]}static newBySFEN(t){const i=Lc[t];if(!i)return null;const n=n0[t];return n?new ce(n,i):null}}var Ft=(e=>(e.UP="up",e.DOWN="down",e.LEFT="left",e.RIGHT="right",e.LEFT_UP="left_up",e.RIGHT_UP="right_up",e.LEFT_DOWN="left_down",e.RIGHT_DOWN="right_down",e.LEFT_UP_KNIGHT="left_up_knight",e.RIGHT_UP_KNIGHT="right_up_knight",e.LEFT_DOWN_KNIGHT="left_down_knight",e.RIGHT_DOWN_KNIGHT="right_down_knight",e))(Ft||{});const s0={up:"down",down:"up",left:"right",right:"left",left_up:"right_down",right_up:"left_down",left_down:"right_up",right_down:"left_up",left_up_knight:"right_down_knight",right_up_knight:"left_down_knight",left_down_knight:"right_up_knight",right_down_knight:"left_up_knight"};function za(e){return s0[e]}const o0=["up","down","left","right","left_up","right_up","left_down","right_down","left_up_knight","right_up_knight","left_down_knight","right_down_knight"];var Ds=(e=>(e.SHORT="short",e.LONG="long",e))(Ds||{});const Hd={black:{pawn:{up:"short"},lance:{up:"long"},knight:{left_up_knight:"short",right_up_knight:"short"},silver:{left_up:"short",up:"short",right_up:"short",left_down:"short",right_down:"short"},gold:{left_up:"short",up:"short",right_up:"short",left:"short",right:"short",down:"short"},bishop:{left_up:"long",right_up:"long",left_down:"long",right_down:"long"},rook:{up:"long",left:"long",right:"long",down:"long"},king:{left_down:"short",right_down:"short",left_up:"short",right_up:"short",down:"short",left:"short",right:"short",up:"short"},promPawn:{left_up:"short",up:"short",right_up:"short",left:"short",right:"short",down:"short"},promLance:{left_up:"short",up:"short",right_up:"short",left:"short",right:"short",down:"short"},promKnight:{left_up:"short",up:"short",right_up:"short",left:"short",right:"short",down:"short"},promSilver:{left_up:"short",up:"short",right_up:"short",left:"short",right:"short",down:"short"},horse:{left_up:"long",right_up:"long",left_down:"long",right_down:"long",up:"short",left:"short",right:"short",down:"short"},dragon:{up:"long",left:"long",right:"long",down:"long",left_up:"short",right_up:"short",left_down:"short",right_down:"short"}},white:{pawn:{down:"short"},lance:{down:"long"},knight:{left_down_knight:"short",right_down_knight:"short"},silver:{left_down:"short",down:"short",right_down:"short",left_up:"short",right_up:"short"},gold:{left_down:"short",down:"short",right_down:"short",left:"short",right:"short",up:"short"},bishop:{left_down:"long",right_down:"long",left_up:"long",right_up:"long"},rook:{down:"long",left:"long",right:"long",up:"long"},king:{left_down:"short",right_down:"short",left_up:"short",right_up:"short",down:"short",left:"short",right:"short",up:"short"},promPawn:{left_down:"short",down:"short",right_down:"short",left:"short",right:"short",up:"short"},promLance:{left_down:"short",down:"short",right_down:"short",left:"short",right:"short",up:"short"},promKnight:{left_down:"short",down:"short",right_down:"short",left:"short",right:"short",up:"short"},promSilver:{left_down:"short",down:"short",right_down:"short",left:"short",right:"short",up:"short"},horse:{left_down:"long",right_down:"long",left_up:"long",right_up:"long",down:"short",left:"short",right:"short",up:"short"},dragon:{down:"long",left:"long",right:"long",up:"long",left_down:"short",right_down:"short",left_up:"short",right_up:"short"}}};function r0(e){return Object.keys(Hd[e.color][e.type])}function Ud(e,t){return Hd[e.color][e.type][t]}const a0={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},left_up:{x:-1,y:-1},right_up:{x:1,y:-1},left_down:{x:-1,y:1},right_down:{x:1,y:1},left_up_knight:{x:-1,y:-2},right_up_knight:{x:1,y:-2},left_down_knight:{x:-1,y:2},right_down_knight:{x:1,y:2}};function zd(e,t){if(e===1&&t===-2)return{direction:"right_up_knight",distance:1,ok:!0};if(e===-1&&t===-2)return{direction:"left_up_knight",distance:1,ok:!0};if(e===1&&t===2)return{direction:"right_down_knight",distance:1,ok:!0};if(e===-1&&t===2)return{direction:"left_down_knight",distance:1,ok:!0};if(e!==0&&t!==0&&Math.abs(e)!==Math.abs(t))return{direction:"",distance:0,ok:!1};let i=e,n=t,s=0;return i!==0&&(s=Math.abs(i),i/=s),n!==0&&(s=Math.abs(n),n/=s),i===-1&&n===-1?{direction:"left_up",distance:s,ok:!0}:i===0&&n===-1?{direction:"up",distance:s,ok:!0}:i===1&&n===-1?{direction:"right_up",distance:s,ok:!0}:i===-1&&n===0?{direction:"left",distance:s,ok:!0}:i===1&&n===0?{direction:"right",distance:s,ok:!0}:i===-1&&n===1?{direction:"left_down",distance:s,ok:!0}:i===0&&n===1?{direction:"down",distance:s,ok:!0}:i===1&&n===1?{direction:"right_down",distance:s,ok:!0}:{direction:"",distance:0,ok:!1}}var Co=(e=>(e.UP="up",e.NONE="none",e.DOWN="down",e))(Co||{});function jr(e){switch(e){case"up":case"left_up":case"right_up":case"left_up_knight":case"right_up_knight":return"up";case"down":case"left_down":case"right_down":case"left_down_knight":case"right_down_knight":return"down";default:return"none"}}var _i=(e=>(e.LEFT="left",e.NONE="none",e.RIGHT="right",e))(_i||{});function Kr(e){switch(e){case"left":case"left_up":case"left_down":case"left_up_knight":case"left_down_knight":return"left";case"right":case"right_up":case"right_down":case"right_up_knight":case"right_down_knight":return"right";default:return"none"}}function l0(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}function c0(e){switch(e){case"a":return 1;case"b":return 2;case"c":return 3;case"d":return 4;case"e":return 5;case"f":return 6;case"g":return 7;case"h":return 8;case"i":return 9;default:return null}}const u0=["a","b","c","d","e","f","g","h","i"],_t=class{constructor(t,i){this.file=t,this.rank=i}get x(){return 9-this.file}get y(){return this.rank-1}get index(){return this.y*9+this.x}get opposite(){return new _t(10-this.file,10-this.rank)}neighbor(t,i){switch(t){case Ft.UP:return new _t(this.file,this.rank-1);case Ft.DOWN:return new _t(this.file,this.rank+1);case Ft.LEFT:return new _t(this.file+1,this.rank);case Ft.RIGHT:return new _t(this.file-1,this.rank);case Ft.LEFT_UP:return new _t(this.file+1,this.rank-1);case Ft.RIGHT_UP:return new _t(this.file-1,this.rank-1);case Ft.LEFT_DOWN:return new _t(this.file+1,this.rank+1);case Ft.RIGHT_DOWN:return new _t(this.file-1,this.rank+1);case Ft.LEFT_UP_KNIGHT:return new _t(this.file+1,this.rank-2);case Ft.RIGHT_UP_KNIGHT:return new _t(this.file-1,this.rank-2);case Ft.LEFT_DOWN_KNIGHT:return new _t(this.file+1,this.rank+2);case Ft.RIGHT_DOWN_KNIGHT:return new _t(this.file-1,this.rank+2)}const n=t,s=i;return new _t(this.file-n,this.rank+s)}directionTo(t){return zd(t.x-this.x,t.y-this.y).direction}get valid(){return this.file>=1&&this.file<=9&&this.rank>=1&&this.rank<=9}equals(t){return!!t&&this.file===t.file&&this.rank===t.rank}static newByXY(t,i){return new _t(9-t,i+1)}static newByIndex(t){return new _t(9-t%9,Math.trunc(t/9)+1)}get sfen(){return this.file+u0[this.rank-1]}static parseSFENSquare(t){const i=l0(t[0]),n=c0(t[1]);return!i||!n?null:new _t(i,n)}};let $=_t;M($,"all",[]);for(let e=0;e<81;e+=1)$.all.push($.newByIndex(e));class rt{constructor(t,i,n,s,o,r){this.from=t,this.to=i,this.promote=n,this.color=s,this.pieceType=o,this.capturedPieceType=r}equals(t){return t?(this.from instanceof $&&t.from instanceof $&&this.from.equals(t.from)||!(this.from instanceof $)&&!(t.from instanceof $)&&this.from===t.from)&&this.to.equals(t.to)&&this.promote===t.promote&&this.color===t.color&&this.pieceType===t.pieceType&&this.capturedPieceType===t.capturedPieceType:!1}withPromote(){return new rt(this.from,this.to,!0,this.color,this.pieceType,this.capturedPieceType)}get usi(){let t="";return this.from instanceof $?t+=this.from.sfen:t+=t0(this.from)+"*",t+=this.to.sfen,this.promote&&(t+="+"),t}}function Wd(e){let t;if(e[1]==="*"){const s=ce.newBySFEN(e[0]);if(!s)return null;t=s.type}else{const s=$.parseSFENSquare(e);if(!s)return null;t=s}const i=$.parseSFENSquare(e.substring(2));if(!i)return null;const n=e.length>=5&&e[4]==="+";return{from:t,to:i,promote:n}}var be=(e=>(e.STANDARD="standard",e.EMPTY="empty",e.HANDICAP_LANCE="handicapLance",e.HANDICAP_RIGHT_LANCE="handicapRightLance",e.HANDICAP_BISHOP="handicapBishop",e.HANDICAP_ROOK="handicapRook",e.HANDICAP_ROOK_LANCE="handicapRookLance",e.HANDICAP_2PIECES="handicap2Pieces",e.HANDICAP_4PIECES="handicap4Pieces",e.HANDICAP_6PIECES="handicap6Pieces",e.HANDICAP_8PIECES="handicap8Pieces",e.TSUME_SHOGI="tsumeShogi",e.TSUME_SHOGI_2KINGS="tsumeShogi2Kings",e))(be||{});function Bc(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}class Jo{constructor(){M(this,"squares");this.squares=new Array;for(let t=0;t<81;t+=1)this.squares.push(null);this.reset("standard")}at(t){return this.squares[t.index]}set(t,i){this.squares[t.index]=i}swap(t,i){const n=this.squares[t.index];this.squares[t.index]=this.squares[i.index],this.squares[i.index]=n}remove(t){const i=this.squares[t.index];return this.squares[t.index]=null,i}listNonEmptySquares(){return $.all.filter(t=>this.squares[t.index])}listSquaresByColor(t){return $.all.filter(i=>{const n=this.squares[i.index];return n&&n.color===t})}listSquaresByPiece(t){return $.all.filter(i=>{const n=this.squares[i.index];return n&&t.equals(n)})}clear(){$.all.forEach(t=>{this.squares[t.index]=null})}reset(t){if(this.clear(),t!=="empty"&&(this.squares[new $(5,1).index]=new ce(L.WHITE,F.KING),t!=="tsumeShogi"&&(this.squares[new $(5,9).index]=new ce(L.BLACK,F.KING),t!=="tsumeShogi2Kings")))switch(this.squares[new $(2,8).index]=new ce(L.BLACK,F.ROOK),this.squares[new $(8,2).index]=new ce(L.WHITE,F.ROOK),this.squares[new $(8,8).index]=new ce(L.BLACK,F.BISHOP),this.squares[new $(2,2).index]=new ce(L.WHITE,F.BISHOP),this.squares[new $(4,9).index]=new ce(L.BLACK,F.GOLD),this.squares[new $(6,9).index]=new ce(L.BLACK,F.GOLD),this.squares[new $(6,1).index]=new ce(L.WHITE,F.GOLD),this.squares[new $(4,1).index]=new ce(L.WHITE,F.GOLD),this.squares[new $(3,9).index]=new ce(L.BLACK,F.SILVER),this.squares[new $(7,9).index]=new ce(L.BLACK,F.SILVER),this.squares[new $(7,1).index]=new ce(L.WHITE,F.SILVER),this.squares[new $(3,1).index]=new ce(L.WHITE,F.SILVER),this.squares[new $(2,9).index]=new ce(L.BLACK,F.KNIGHT),this.squares[new $(8,9).index]=new ce(L.BLACK,F.KNIGHT),this.squares[new $(8,1).index]=new ce(L.WHITE,F.KNIGHT),this.squares[new $(2,1).index]=new ce(L.WHITE,F.KNIGHT),this.squares[new $(1,9).index]=new ce(L.BLACK,F.LANCE),this.squares[new $(9,9).index]=new ce(L.BLACK,F.LANCE),this.squares[new $(9,1).index]=new ce(L.WHITE,F.LANCE),this.squares[new $(1,1).index]=new ce(L.WHITE,F.LANCE),this.squares[new $(1,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(2,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(3,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(4,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(5,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(6,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(7,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(8,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(9,7).index]=new ce(L.BLACK,F.PAWN),this.squares[new $(1,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(2,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(3,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(4,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(5,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(6,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(7,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(8,3).index]=new ce(L.WHITE,F.PAWN),this.squares[new $(9,3).index]=new ce(L.WHITE,F.PAWN),t){default:case"standard":return;case"handicapLance":this.squares[new $(1,1).index]=null;return;case"handicapRightLance":this.squares[new $(9,1).index]=null;return;case"handicapBishop":this.squares[new $(2,2).index]=null;return;case"handicapRook":this.squares[new $(8,2).index]=null;return;case"handicapRookLance":this.squares[new $(8,2).index]=null,this.squares[new $(1,1).index]=null;return;case"handicap2Pieces":this.squares[new $(8,2).index]=null,this.squares[new $(2,2).index]=null;return;case"handicap4Pieces":this.squares[new $(8,2).index]=null,this.squares[new $(2,2).index]=null,this.squares[new $(1,1).index]=null,this.squares[new $(9,1).index]=null;return;case"handicap6Pieces":this.squares[new $(8,2).index]=null,this.squares[new $(2,2).index]=null,this.squares[new $(1,1).index]=null,this.squares[new $(2,1).index]=null,this.squares[new $(8,1).index]=null,this.squares[new $(9,1).index]=null;return;case"handicap8Pieces":this.squares[new $(8,2).index]=null,this.squares[new $(2,2).index]=null,this.squares[new $(1,1).index]=null,this.squares[new $(2,1).index]=null,this.squares[new $(3,1).index]=null,this.squares[new $(7,1).index]=null,this.squares[new $(8,1).index]=null,this.squares[new $(9,1).index]=null;return}}get sfen(){let t="",i=0;for(let n=0;n<9;n+=1){for(let s=0;s<9;s+=1){const o=this.at($.newByXY(s,n));o?(i&&(t+=i,i=0),t+=o.sfen):i+=1}i&&(t+=i,i=0),n!==8&&(t+="/")}return t}resetBySFEN(t){if(!Jo.isValidSFEN(t))return!1;this.clear();const i=t.split("/");for(let n=0;n<9;n+=1){let s=0;for(let o=0;o<i[n].length;o+=1){let r=i[n][o];r==="+"&&(o+=1,r+=i[n][o]);const a=Bc(r);a?s+=a:(this.set($.newByXY(s,n),ce.newBySFEN(r)),s+=1)}}return!0}findKing(t){const i=new ce(t,F.KING);return $.all.find(n=>{const s=this.at(n);if(s&&i.equals(s))return!0})}hasPower(t,i,n){return!!o0.find(s=>{let o=0;for(let r=t.neighbor(s);r.valid&&(o+=1,!(n&&n.filled&&r.equals(n.filled)));r=r.neighbor(s)){if(n&&n.ignore&&r.equals(n.ignore))continue;const a=this.at(r);if(a){if(a.color!==i)return!1;const l=za(s),c=Ud(a,l);return c===Ds.LONG||c===Ds.SHORT&&o===1}}return!1})}isChecked(t,i){const n=this.findKing(t);return n?this.hasPower(n,Mt(t),{filled:i&&i.filled,ignore:i&&i.ignore}):!1}static isValidSFEN(t){const i=t.split("/");if(i.length!==9)return!1;for(let n=0;n<9;n+=1){let s=0;for(let o=0;o<i[n].length;o+=1){let r=i[n][o];r==="+"&&(o+=1,r+=i[n][o]);const a=Bc(r);if(a)s+=a;else if(ce.isValidSFEN(r))s+=1;else return!1}if(s!==9)return!1}return!0}copyFrom(t){$.all.forEach(i=>{this.squares[i.index]=t.at(i)})}}function un(e,t){return e===0?"":(e!==1?e:"")+t.sfen}class oi{constructor(){M(this,"pieces");this.pieces=new Map,this.pieces.set(F.PAWN,0),this.pieces.set(F.LANCE,0),this.pieces.set(F.KNIGHT,0),this.pieces.set(F.SILVER,0),this.pieces.set(F.GOLD,0),this.pieces.set(F.BISHOP,0),this.pieces.set(F.ROOK,0)}count(t){return this.pieces.get(t)}set(t,i){this.pieces.set(t,i)}add(t,i){let n=this.pieces.get(t);return n+=i,this.pieces.set(t,n),n}reduce(t,i){let n=this.pieces.get(t);return n-=i,this.pieces.set(t,n),n}forEach(t){t(F.PAWN,this.pieces.get(F.PAWN)),t(F.LANCE,this.pieces.get(F.LANCE)),t(F.KNIGHT,this.pieces.get(F.KNIGHT)),t(F.SILVER,this.pieces.get(F.SILVER)),t(F.GOLD,this.pieces.get(F.GOLD)),t(F.BISHOP,this.pieces.get(F.BISHOP)),t(F.ROOK,this.pieces.get(F.ROOK))}get sfenBlack(){return this.formatSFEN(L.BLACK)}get sfenWhite(){return this.formatSFEN(L.WHITE)}formatSFEN(t){let i="";return i+=un(this.count(F.ROOK),new ce(t,F.ROOK)),i+=un(this.count(F.BISHOP),new ce(t,F.BISHOP)),i+=un(this.count(F.GOLD),new ce(t,F.GOLD)),i+=un(this.count(F.SILVER),new ce(t,F.SILVER)),i+=un(this.count(F.KNIGHT),new ce(t,F.KNIGHT)),i+=un(this.count(F.LANCE),new ce(t,F.LANCE)),i+=un(this.count(F.PAWN),new ce(t,F.PAWN)),i===""?"-":i}static formatSFEN(t,i){const n=t.sfenBlack,s=i.sfenWhite;return n==="-"&&s==="-"?"-":s==="-"?n:n==="-"?s:n+s}static isValidSFEN(t){return t==="-"?!0:!!t.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/)}static parseSFEN(t){if(t==="-")return{black:new oi,white:new oi};if(!t.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/))return null;const i=t.match(/([0-9]*[PLNSGBRplnsgbr])/g),n=new oi,s=new oi;for(let o=0;o<i.length;o+=1){const r=i[o];let a=1;r.length>=2&&(a=Number(r.substring(0,r.length-1)));const l=ce.newBySFEN(r[r.length-1]);l.color===L.BLACK?n.add(l.type,a):s.add(l.type,a)}return{black:n,white:s}}copyFrom(t){t.pieces.forEach((i,n)=>{this.pieces.set(n,i)})}}const h0={black:{pawn:{1:!0},lance:{1:!0},knight:{1:!0,2:!0}},white:{pawn:{9:!0},lance:{9:!0},knight:{9:!0,8:!0}}};function Dc(e,t,i){const n=h0[e][t];return n?n[i]:!1}function Qo(e,t){return e===L.BLACK?t<=3:t>=7}function d0(e,t,i){for(let n=1;n<=9;n+=1){const s=t.at(new $(i,n));if(s&&s.type===F.PAWN&&s.color===e)return!0}return!1}class Rt{constructor(){M(this,"_board",new Jo);M(this,"_color",L.BLACK);M(this,"_blackHand",new oi);M(this,"_whiteHand",new oi)}get board(){return this._board}get color(){return this._color}get blackHand(){return this._blackHand}get whiteHand(){return this._whiteHand}reset(t){switch(this._board.reset(t),this._blackHand=new oi,this._whiteHand=new oi,t){case be.STANDARD:case be.EMPTY:case be.TSUME_SHOGI:case be.TSUME_SHOGI_2KINGS:this._color=L.BLACK;break;case be.HANDICAP_LANCE:case be.HANDICAP_RIGHT_LANCE:case be.HANDICAP_BISHOP:case be.HANDICAP_ROOK:case be.HANDICAP_ROOK_LANCE:case be.HANDICAP_2PIECES:case be.HANDICAP_4PIECES:case be.HANDICAP_6PIECES:case be.HANDICAP_8PIECES:this._color=L.WHITE;break}(t===be.TSUME_SHOGI||t===be.TSUME_SHOGI_2KINGS)&&(this._whiteHand.set(F.PAWN,18),this._whiteHand.set(F.LANCE,4),this._whiteHand.set(F.KNIGHT,4),this._whiteHand.set(F.SILVER,4),this._whiteHand.set(F.GOLD,4),this._whiteHand.set(F.BISHOP,2),this._whiteHand.set(F.ROOK,2))}hand(t){return this._hand(t)}_hand(t){return t===L.BLACK?this._blackHand:this._whiteHand}get checked(){return this._board.isChecked(this.color)}createMove(t,i){let n;if(t instanceof $){const o=this._board.at(t);if(!o)return null;n=o.type}else n=t;const s=this._board.at(i);return new rt(t,i,!1,this.color,n,s?s.type:null)}createMoveByUSI(t){const i=Wd(t);if(!i)return null;let n=this.createMove(i.from,i.to);return n?(i.promote&&(n=n.withPromote()),n):null}isPawnDropMate(t){if(t.from instanceof $||t.pieceType!==F.PAWN)return!1;const i=t.to.neighbor(t.color===L.BLACK?Ft.UP:Ft.DOWN),n=this.board.at(i);return!n||n.type!==F.KING||n.color===t.color||r0(n).find(o=>{const r=i.neighbor(o);if(!r.valid)return!1;const a=this.board.at(r);return a&&a.color==n.color?!1:!this.board.hasPower(r,t.color,{filled:t.to})})?!1:!this.board.listSquaresByColor(n.color).find(o=>!o.equals(i)&&this.isMovable(o,t.to)&&!this.board.isChecked(n.color,{filled:t.to,ignore:o}))}listAttackersByPiece(t,i){return this.board.listSquaresByPiece(i).filter(n=>this.isMovable(n,t))}isValidMove(t){if(t.from instanceof $){const i=this._board.at(t.from);if(!i||i.color!==this.color||!this.isMovable(t.from,t.to))return!1;const n=this._board.at(t.to);if(n&&n.color===this.color)return!1;if(t.promote){if(!i.isPromotable()||!Qo(this.color,t.from.rank)&&!Qo(this.color,t.to.rank))return!1}else if(Dc(this.color,i.type,t.to.rank))return!1;if(t.pieceType!==F.KING?this._board.isChecked(this.color,{filled:t.to,ignore:t.from}):this._board.hasPower(t.to,Mt(this.color),{ignore:t.from}))return!1}else if(t.promote||t.color!==this.color||this.hand(this.color).count(t.from)===0||this._board.at(t.to)||Dc(this.color,t.from,t.to.rank)||t.from===F.PAWN&&d0(this.color,this._board,t.to.file)||this._board.isChecked(this.color,{filled:t.to})||this.isPawnDropMate(t))return!1;return!0}doMove(t,i){if(!(i&&i.ignoreValidation)&&!this.isValidMove(t))return!1;if(t.from instanceof $){const n=this._board.at(t.from),s=this._board.at(t.to);this._board.remove(t.from),this._board.set(t.to,t.promote?n.promoted():n),s&&s.type!==F.KING&&this._hand(this.color).add(s.unpromoted().type,1)}else this._hand(this.color).reduce(t.from,1),this._board.set(t.to,new ce(this.color,t.from));return this._color=Mt(this.color),!0}undoMove(t){if(this._color=Mt(this.color),t.from instanceof $)if(this._board.set(t.from,new ce(this.color,t.pieceType)),t.capturedPieceType){const i=new ce(Mt(this.color),t.capturedPieceType);this._board.set(t.to,i),i.type!==F.KING&&this._hand(this.color).reduce(i.unpromoted().type,1)}else this._board.remove(t.to);else this._hand(this.color).add(t.from,1),this._board.remove(t.to)}isValidEditing(t,i){if(t instanceof $){const n=this._board.at(t);if(!n)return!1;if(i instanceof $){if(t.equals(i))return!1}else if(n.type===F.KING)return!1}else{if(!t.color||this.hand(t.color).count(t.type)===0)return!1;if(i instanceof $){if(this._board.at(i))return!1}else if(t.color===i)return!1}return!0}edit(t){if(t.move){if(!this.isValidEditing(t.move.from,t.move.to))return!1;if(!(t.move.from instanceof $))this._hand(t.move.from.color).reduce(t.move.from.type,1),t.move.to instanceof $?this._board.set(t.move.to,t.move.from):this._hand(t.move.to).add(t.move.from.type,1);else if(t.move.to instanceof $)this._board.swap(t.move.from,t.move.to);else{const i=this._board.remove(t.move.from);this._hand(t.move.to).add(i.unpromoted().type,1)}}if(t.rotate){const i=this._board.at(t.rotate);i&&this._board.set(t.rotate,i.rotate())}return!0}get sfen(){return this.getSFEN(1)}getSFEN(t){let i=`${this._board.sfen} ${qm(this.color)} `;return i+=oi.formatSFEN(this._blackHand,this._whiteHand),i+=" "+t,i}resetBySFEN(t){if(!Rt.isValidSFEN(t))return!1;const i=t.split(" ");i[0]==="sfen"&&i.shift(),this._board.resetBySFEN(i[0]),this._color=Xm(i[1]);const n=oi.parseSFEN(i[2]);return this._blackHand=n.black,this._whiteHand=n.white,!0}setColor(t){this._color=t}static isValidSFEN(t){const i=t.split(" ");return i.length===5&&i[0]==="sfen"&&i.shift(),!(i.length!==4||!Jo.isValidSFEN(i[0])||!Ym(i[1])||!oi.isValidSFEN(i[2])||!i[3].match(/[0-9]+/))}static newBySFEN(t){const i=new Rt;return i.resetBySFEN(t)?i:null}isMovable(t,i){const n=i.x-t.x,s=i.y-t.y,{direction:o,distance:r,ok:a}=zd(n,s);if(!a)return!1;const l=this._board.at(t);if(!l)return!1;switch(Ud(l,o)){default:return!1;case Ds.SHORT:return r===1;case Ds.LONG:{const c=a0[o];for(let u=t.neighbor(c.x,c.y);u.valid;u=u.neighbor(c.x,c.y)){if(u.equals(i))return!0;if(this._board.at(u))return!1}return!1}}}copyFrom(t){this._board.copyFrom(t._board),this._color=t.color,this._blackHand.copyFrom(t._blackHand),this._whiteHand.copyFrom(t._whiteHand)}clone(){const t=new Rt;return t.copyFrom(this),t}}function f0(e){const t={pawn:0,lance:0,knight:0,silver:0,gold:0,bishop:0,rook:0,king:0,promPawn:0,promLance:0,promKnight:0,promSilver:0,horse:0,dragon:0};return $.all.forEach(i=>{const n=e.board.at(i);n&&(t[n.type]+=1)}),e.blackHand.forEach((i,n)=>{t[i]+=n}),e.whiteHand.forEach((i,n)=>{t[i]+=n}),t}function p0(e){const t=f0(e);return{pawn:18-t.pawn-t.promPawn,lance:4-t.lance-t.promLance,knight:4-t.knight-t.promKnight,silver:4-t.silver-t.promSilver,gold:4-t.gold,bishop:2-t.bishop-t.horse,rook:2-t.rook-t.dragon,king:2-t.king,promPawn:0,promLance:0,promKnight:0,promSilver:0,horse:0,dragon:0}}const g0={"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9},m0={:1,:2,:3,:4,:5,:6,:7,:8,:9,:10,:11,:12,:13,:14,:15,:16,:17,:18},b0={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9},_0={:F.KING,:F.KING,:F.ROOK,:F.DRAGON,:F.DRAGON,:F.BISHOP,:F.HORSE,:F.GOLD,:F.SILVER,:F.PROM_SILVER,:F.PROM_SILVER,:F.KNIGHT,:F.PROM_KNIGHT,:F.PROM_KNIGHT,:F.LANCE,:F.PROM_LANCE,:F.PROM_LANCE,:F.PAWN,:F.PROM_PAWN};function y0(e){return g0[e]}function Tl(e){return m0[e]}function Fc(e){return b0[e]}function Rl(e){return _0[e]}const Gd=["","","","","","","","","","","","","","","","","",""],v0=["","","","","","","","",""];function S0(e){return Gd[e-1]}function Vd(e){return v0[e-1]}function Ol(e){return Gd[e-1]}const w0={king:"",rook:"",dragon:"",bishop:"",horse:"",gold:"",silver:"",promSilver:"",knight:"",promKnight:"",lance:"",promLance:"",pawn:"",promPawn:""};function jd(e){return w0[e]}const E0={king:"",rook:"",dragon:"",bishop:"",horse:"",gold:"",silver:"",promSilver:"",knight:"",promKnight:"",lance:"",promLance:"",pawn:"",promPawn:""};function Wa(e){return E0[e]}const k0={start:"",resign:"",interrupt:"",impass:"",draw:"",repetitionDraw:"",mate:"",timeout:"",foulWin:"",foulLose:"",enteringOfKing:"",winByDefault:"",loseByDefault:""};function Kd(e){return k0[e]}function Jn(e,t,i){let n="";switch(t.color){case L.BLACK:n+=i!=null&&i.compatible?"":"";break;case L.WHITE:n+=i!=null&&i.compatible?"":"";break}i!=null&&i.prev&&i.prev.to.equals(t.to)?n+="":(n+=Vd(t.to.file),n+=Ol(t.to.rank)),n+=jd(t.pieceType);const s=new ce(t.color,t.pieceType),o=e.listAttackersByPiece(t.to,s).filter(r=>!(t.from instanceof $)||!r.equals(t.from));if(t.from instanceof $){let r=t.from.directionTo(t.to);r=t.color===L.BLACK?r:za(r);const a=jr(r),l=Kr(r),c=o.map(g=>{const _=g.directionTo(t.to);return t.color===L.BLACK?_:za(_)}),u=c.filter(g=>Kr(g)==l).map(g=>jr(g)),h=c.filter(g=>jr(g)==a).map(g=>Kr(g));let f=!1;if(h.length)if(t.pieceType===F.HORSE||t.pieceType===F.DRAGON)l===_i.LEFT||l===_i.NONE&&h[0]===_i.RIGHT?n+="":(l===_i.RIGHT||l===_i.NONE&&h[0]===_i.LEFT)&&(n+="");else switch(l){case _i.LEFT:n+="";break;case _i.NONE:n+="",f=!0;break;case _i.RIGHT:n+="";break}if(!f&&(u.length||!h.length&&o.length))switch(a){case Co.DOWN:n+="";break;case Co.NONE:n+="";break;case Co.UP:n+="";break}t.promote?n+="":t.from instanceof $&&s.isPromotable()&&(Qo(t.color,t.from.rank)||Qo(t.color,t.to.rank))&&(n+="")}else o.length&&(n+="");return n}function qd(e){return Xd(Math.floor(e/1e3))}function Yd(e){return Jd(Math.floor(e/1e3))}function Xd(e){const t=Math.floor(e/3600),i=Math.floor((e-t*3600)/60),n=e%60;return t+":"+String(i).padStart(2,"0")+":"+String(n).padStart(2,"0")}function Jd(e){const t=Math.floor(e/60),i=e%60;return String(t).padStart(2," ")+":"+String(i).padStart(2,"0")}var ue=(e=>(e.TITLE="title",e.BLACK_NAME="blackName",e.WHITE_NAME="whiteName",e.START_DATETIME="startDatetime",e.END_DATETIME="endDatetime",e.DATE="date",e.TOURNAMENT="tournament",e.STRATEGY="strategy",e.TIME_LIMIT="timeLimit",e.TIME_SPENT="timeSpent",e.PLACE="place",e.POSTED_ON="postedOn",e.NOTE="note",e.BLACK_SHORT_NAME="blackShortName",e.WHITE_SHORT_NAME="whiteShortName",e.OPUS_NO="opusNo",e.OPUS_NAME="opusName",e.AUTHOR="author",e.PUBLISHED_ON="publishedOn",e.PUBLISHED_AT="publishedAt",e.SOURCE="source",e.LENGTH="length",e.INTEGRITY="integrity",e.CATEGORY="category",e.AWARD="award",e))(ue||{});function I0(e){switch(e){case"blackName":return"";case"whiteName":return"";case"startDatetime":return"";case"endDatetime":return"";case"date":return"";case"tournament":return"";case"strategy":return"";case"title":return"";case"timeLimit":return"";case"timeSpent":return"";case"place":return"";case"postedOn":return"";case"note":return"";case"blackShortName":return"";case"whiteShortName":return"";case"opusNo":return"";case"opusName":return"";case"author":return"";case"publishedOn":return"";case"publishedAt":return"";case"source":return"";case"length":return"";case"integrity":return"";case"category":return"";case"award":return""}}class Zo{constructor(){M(this,"standard",new Map);M(this,"custom",new Map)}get standardMetadataKeys(){return this.standard.keys()}getStandardMetadata(t){return this.standard.get(t)}setStandardMetadata(t,i){i?this.standard.set(t,i):this.standard.delete(t)}get customMetadataKeys(){return this.custom.keys()}getCustomMetadata(t){return this.custom.get(t)}setCustomMetadata(t,i){i?this.custom.set(t,i):this.custom.delete(t)}}var le=(e=>(e.START="start",e.INTERRUPT="interrupt",e.RESIGN="resign",e.IMPASS="impass",e.DRAW="draw",e.REPETITION_DRAW="repetitionDraw",e.MATE="mate",e.TIMEOUT="timeout",e.FOUL_WIN="foulWin",e.FOUL_LOSE="foulLose",e.ENTERING_OF_KING="enteringOfKing",e.WIN_BY_DEFAULT="winByDefault",e.LOSE_BY_DEFAULT="loseByDefault",e))(le||{});class Dn{constructor(t,i,n,s,o,r,a,l){M(this,"next",null);M(this,"branch",null);M(this,"comment","");M(this,"customData");M(this,"elapsedMs",0);M(this,"totalElapsedMs",0);this.number=t,this.prev=i,this.branchIndex=n,this.activeBranch=s,this.nextColor=o,this.move=r,this.isCheck=a,this.displayText=l}get timeText(){const t=Yd(this.elapsedMs),i=qd(this.totalElapsedMs);return`${t} / ${i}`}get hasBranch(){return!!this.prev&&!!this.prev.next&&!!this.prev.next.branch}get isFirstBranch(){return!this.prev||this.prev.next===this}get isLastMove(){if(!this.next)return!0;for(let t=this.next;t;t=t.branch)if(t.move instanceof rt)return!1;return!0}updateTotalElapsedMs(){this.totalElapsedMs=this.elapsedMs,this.prev&&this.prev.prev&&(this.totalElapsedMs+=this.prev.prev.totalElapsedMs)}setElapsedMs(t){this.elapsedMs=t,this.updateTotalElapsedMs();let i=this.next;const n=[];for(;i;)i.updateTotalElapsedMs(),i.branch&&n.push(i.branch),i.next?i=i.next:i=n.pop()||null}static newRootEntry(t){return new Dn(0,null,0,!0,t,"start",!1,"")}}class At{constructor(t){M(this,"metadata");M(this,"_initialPosition");M(this,"_position");M(this,"_first");M(this,"_current");M(this,"repetitionCounts",{});M(this,"repetitionStart",{});M(this,"onChangePosition",()=>{});this.metadata=new Zo,this._initialPosition=t?t.clone():new Rt,this._position=this.initialPosition.clone(),this._first=Dn.newRootEntry(this._initialPosition.color),this._current=this._first,this.incrementRepetition()}get initialPosition(){return this._initialPosition}get position(){return this._position}get first(){return this._first}get current(){return this._current}get moves(){const t=this.movesBefore;for(let i=this._current.next;i;i=i.next){for(;!i.activeBranch;)i=i.branch;t.push(i)}return t}get movesBefore(){return this._movesBefore}get _movesBefore(){const t=new Array;t.unshift(this._current);for(let i=this._current.prev;i;i=i.prev)t.unshift(i);return t}get length(){let t=this._current.number;for(let i=this._current.next;i;i=i.next){for(;!i.activeBranch;)i=i.branch;t=i.number}return t}get branchBegin(){return this._current.prev?this._current.prev.next:this._current}clear(t){this.metadata=new Zo,t&&(this._initialPosition=t.clone()),this._position=this.initialPosition.clone(),this._first=Dn.newRootEntry(this._initialPosition.color),this._current=this._first,this.repetitionCounts={},this.repetitionStart={},this.incrementRepetition(),this.onChangePosition()}goBack(){return this._goBack()?(this.onChangePosition(),!0):!1}_goBack(){return this._current.prev?(this._current.move instanceof rt&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=this._current.prev,!0):!1}goForward(){return this._goForward()?(this.onChangePosition(),!0):!1}_goForward(){if(this._current.next){for(this._current=this._current.next;!this._current.activeBranch;)this._current=this._current.branch;return this._current.move instanceof rt&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),!0}return!1}goto(t){for(;t<this._current.number&&this._goBack(););for(;t>this._current.number&&this._goForward(););this.onChangePosition()}resetAllBranchSelection(){this._forEach(t=>{t.activeBranch=t.isFirstBranch})}switchBranchByIndex(t){if(this.current.branchIndex===t)return!0;if(!this._current.prev)return!1;let i=!1;for(let n=this._current.prev.next;n;n=n.branch)n.branchIndex===t?(n.activeBranch=!0,this._current.move instanceof rt&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=n,this._current.move instanceof rt&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),i=!0):n.activeBranch=!1;return i&&this.onChangePosition(),i}append(t,i){const n=this.current.move instanceof rt?this.current.move:void 0,s=t instanceof rt?Jn(this.position,t,{prev:n}):Kd(t);let o=!1;if(t instanceof rt){if(!this._position.doMove(t,i))return!1;this.incrementRepetition(),o=this.position.checked}if(this._current!==this.first&&!(this._current.move instanceof rt)&&this.goBack(),!this._current.next)return this._current.next=new Dn(this._current.number+1,this._current,0,!0,this.position.color,t,o,s),this._current=this._current.next,this._current.setElapsedMs(0),this.onChangePosition(),!0;let r;for(r=this._current.next;r;r=r.branch)r.activeBranch=!1;let a=this._current.next;for(r=this._current.next;r;r=r.branch){if(r.move instanceof rt&&t instanceof rt&&t.equals(r.move)||t===r.move)return this._current=r,this._current.activeBranch=!0,this.onChangePosition(),!0;a=r}return this._current=new Dn(this._current.number+1,this._current,a.branchIndex+1,!0,this.position.color,t,o,s),this._current.setElapsedMs(0),a.branch=this._current,this.onChangePosition(),!0}swapWithNextBranch(){return this._current.branch?At.swapWithPreviousBranch(this._current.branch):!1}swapWithPreviousBranch(){return At.swapWithPreviousBranch(this._current)}static swapWithPreviousBranch(t){const i=t.prev;if(!i||!i.next||i.next==t)return!1;if(i.next.branch===t){const n=i.next;return n.branch=t.branch,t.branch=n,i.next=t,[t.branchIndex,n.branchIndex]=[n.branchIndex,t.branchIndex],!0}for(let n=i.next;n.branch;n=n.branch)if(n.branch.branch===t){const s=n.branch;return s.branch=t.branch,t.branch=s,n.branch=t,[t.branchIndex,s.branchIndex]=[s.branchIndex,t.branchIndex],!0}return!1}removeCurrentMove(){const t=this._current;if(!this.goBack()){this._current.next=null;return}if(this._current.next===t)this._current.next=t.branch;else for(let n=this._current.next;n;n=n.branch)if(n.branch===t){n.branch=t.branch;break}let i=0;for(let n=this._current.next;n;n=n.branch)n.branchIndex=i,i+=1;this._current.next&&(this._current.next.activeBranch=!0),this.onChangePosition()}removeNextMove(){this._current.next=null}incrementRepetition(){const t=this.position.sfen;this.repetitionCounts[t]?this.repetitionCounts[t]+=1:(this.repetitionCounts[t]=1,this.repetitionStart[t]=this.current.number)}decrementRepetition(){const t=this.position.sfen;this.repetitionCounts[t]-=1,this.repetitionCounts[t]===0&&(delete this.repetitionCounts[t],delete this.repetitionStart[t])}get repetition(){return this.repetitionCounts[this.position.sfen]>=4}get perpetualCheck(){if(!this.repetition)return null;const t=this.position.sfen,i=this.repetitionStart[t];let n=!0,s=!0,o=this.position.color;for(let r=this.current;r.number>=i;r=r.prev)o=Mt(o),!r.isCheck&&(o===L.BLACK?n=!1:s=!1);return n?L.BLACK:s?L.WHITE:null}get usi(){let t="position sfen "+this.initialPosition.sfen+" moves";return this.movesBefore.forEach(i=>{i.move instanceof rt&&(t+=" "+i.move.usi)}),t}get usiAll(){let t=this.usi;for(let i=this._current.next;i;i=i.next){for(;!i.activeBranch;)i=i.branch;i.move instanceof rt&&(t+=" "+i.move.usi)}return t}get sfen(){return this.position.getSFEN(this._current.number+1)}forEach(t){this._forEach(t)}_forEach(t){let i=this._first;const n=[];for(;i;)t(i),i.branch&&n.push(i.branch),i.next?i=i.next:i=n.pop()||null}on(t,i){switch(t){case"changePosition":this.onChangePosition=i;break}}static newByUSI(t){const i="position startpos ",n="position sfen ",s="startpos ",o="sfen ",r="moves ";return t.startsWith(i)?At.newByUSIFromMoves(new Rt,t.slice(i.length)):t.startsWith(n)?At.newByUSIFromSFEN(t.slice(n.length)):t.startsWith(s)?At.newByUSIFromMoves(new Rt,t.slice(s.length)):t.startsWith(o)?At.newByUSIFromSFEN(t.slice(o.length)):t.startsWith(r)?At.newByUSIFromMoves(new Rt,t):new Error("USI(1): "+t)}static newByUSIFromSFEN(t){const i=t.split(" ");if(i.length<4)return new Error("USI(2): "+t);const n=Rt.newBySFEN(i.slice(0,4).join(" "));return n?At.newByUSIFromMoves(n,i.slice(4).join(" ")):new Error("USI(3): "+t)}static newByUSIFromMoves(t,i){const n=new At(t);if(i.length===0)return n;const s=i.split(" ");if(s[0]!=="moves")return new Error("USI(4): "+i);for(let o=1;o<s.length;o++){const r=Wd(s[o]);if(!r)break;let a=n.position.createMove(r.from,r.to);if(!a)return new Error(": "+s[o]);r.promote&&(a=a.withPromote()),n.append(a,{ignoreValidation:!0})}return n}}const P0={:ue.BLACK_NAME,:ue.WHITE_NAME,:ue.START_DATETIME,:ue.END_DATETIME,:ue.DATE,:ue.TOURNAMENT,:ue.STRATEGY,:ue.TITLE,:ue.TIME_LIMIT,:ue.TIME_SPENT,:ue.PLACE,:ue.POSTED_ON,:ue.NOTE,:ue.BLACK_SHORT_NAME,:ue.WHITE_SHORT_NAME,:ue.OPUS_NO,:ue.OPUS_NAME,:ue.AUTHOR,:ue.PUBLISHED_ON,:ue.PUBLISHED_AT,:ue.SOURCE,:ue.LENGTH,:ue.INTEGRITY,:ue.CATEGORY,:ue.AWARD},A0={blackName:"",whiteName:"",startDatetime:"",endDatetime:"",date:"",tournament:"",strategy:"",title:"",timeLimit:"",timeSpent:"",place:"",postedOn:"",note:"",blackShortName:"",whiteShortName:"",opusNo:"",opusName:"",author:"",publishedOn:"",publishedAt:"",source:"",length:"",integrity:"",category:"",award:""},$c=[{prefix:/^#/,type:0,removePrefix:!1,isPosition:!1},{prefix:/^/,type:2,removePrefix:!0,isPosition:!0},{prefix:/^/,type:3,removePrefix:!0,isPosition:!0},{prefix:/^/,type:4,removePrefix:!0,isPosition:!0},{prefix:/^\|/,type:5,removePrefix:!1,isPosition:!0},{prefix:/^/,type:6,removePrefix:!1,isPosition:!0},{prefix:/^/,type:7,removePrefix:!1,isPosition:!0},{prefix:/^ *[0-9]+ +/,type:8,removePrefix:!1,isPosition:!1},{prefix:/^\*/,type:9,removePrefix:!0,isPosition:!1}];function C0(e){for(let i=0;i<$c.length;i++){const n=$c[i],s=e.match(n.prefix);if(s){const o=n.removePrefix?s[0].length:0;return{type:n.type,data:e.substring(o),isPosition:n.isPosition,metadataKey:""}}}const t=e.match(/^[^ ]+/);if(t){const i=t[0];return{type:1,data:e.substring(i.length),isPosition:!1,metadataKey:i.substring(0,i.length-1)}}return{type:10,data:e,isPosition:!1,metadataKey:""}}function x0(e,t){switch(t.trim()){case"":e.reset(be.STANDARD);return;case"":e.reset(be.HANDICAP_LANCE);return;case"":e.reset(be.HANDICAP_RIGHT_LANCE);return;case"":e.reset(be.HANDICAP_BISHOP);return;case"":e.reset(be.HANDICAP_ROOK);return;case"":e.reset(be.HANDICAP_ROOK_LANCE);return;case"":e.reset(be.HANDICAP_2PIECES);return;case"":e.reset(be.HANDICAP_4PIECES);return;case"":e.reset(be.HANDICAP_6PIECES);return;case"":e.reset(be.HANDICAP_8PIECES);return;case"":e.reset(be.EMPTY);return}return new Error(":"+t)}const M0={:le.INTERRUPT,:le.RESIGN,:le.IMPASS,:le.REPETITION_DRAW,:le.MATE,:le.TIMEOUT,:le.FOUL_WIN,:le.FOUL_LOSE,:le.ENTERING_OF_KING,:le.WIN_BY_DEFAULT,:le.LOSE_BY_DEFAULT},T0=/^ *([0-9]+) +[]?([][]|\u3000*)(||||||||||||||||||)\u3000*(?)(|\([1-9][1-9]\)) *(.*)$/,R0=/\( *([0-9]+):([0-9]+)\/[0-9: ]*\)/,O0=/^ *([0-9]+) +(||||||||||) *(.*)$/;function N0(e,t){if(t.length<21)return new Error(":"+t);const i=t[20],n=Tl(i);if(!n)return new Error(":"+t);for(let s=0;s<9;s+=1){const o=9-s,r=new $(o,n),a=s*2+1,l=t[a+1],c=Rl(l);if(!c){e.remove(r);continue}const u=t[a]!=="v"?L.BLACK:L.WHITE;e.set(r,new ce(u,c))}}function Hc(e,t){const i=t.split(/[ ]/);for(const n of i){if(!n||n==="")continue;const s=n[0],o=n.substring(1),r=Rl(s),a=Tl(o)||1;if(!r)return new Error(": "+n);e.add(r,a)}}function Uc(e,t){const i=R0.exec(t);if(i){const n=i[1],s=i[2],o=Number.parseInt(n)*60+Number.parseInt(s);e.current.setElapsedMs(o*1e3)}}function L0(e,t){let i=O0.exec(t);if(i){const f=Number(i[1]),g=M0[i[2]],_=i[3];e.goto(f-1),e.append(g,{ignoreValidation:!0}),Uc(e,_);return}if(i=T0.exec(t),!i)return new Error(":"+t);const n=Number(i[1]),s=i[2],o=i[3],r=i[4],a=i[5],l=i[6];if(n===0)return new Error(":"+t);e.goto(n-1);let c,u;if(s.startsWith("")){if(!(e.current.move instanceof rt))return new Error(": "+t);c=e.current.move.to}else{const f=y0(s[0]),g=Tl(s[1]);c=new $(f,g)}if(a==="")u=Rl(o);else{const f=Fc(a[1]),g=Fc(a[2]);u=new $(f,g)}let h=e.position.createMove(u,c);if(!h)return new Error(": "+t);r===""&&(h=h.withPromote()),e.append(h,{ignoreValidation:!0}),Uc(e,l)}function zc(e){const t=new Zo,i=new At,n=e.split(/\r?\n/),s=new Rt;let o="",r=!1;for(const a of n){if(a==="")continue;const l=C0(a);if(r&&l.isPosition)return new Error(": "+a);let c;switch(l.type){case 1:{const u=P0[l.metadataKey];u?t.setStandardMetadata(u,l.data):t.setCustomMetadata(l.metadataKey,l.data);break}case 2:c=x0(s,l.data);break;case 3:c=Hc(s.blackHand,l.data);break;case 4:c=Hc(s.whiteHand,l.data);break;case 5:c=N0(s.board,l.data);break;case 6:s.setColor(L.BLACK);break;case 7:s.setColor(L.WHITE);break;case 8:r||(i.clear(s),i.first.comment=o,r=!0),c=L0(i,l.data);break;case 9:r?i.current.comment=qo(i.current.comment,l.data):o=qo(o,l.data);break}if(c)return c}return r||(i.clear(s),i.first.comment=o),i.goto(0),i.resetAllBranchSelection(),i.metadata=t,i}const B0={start:"",resign:"",interrupt:"",impass:"",draw:"",repetitionDraw:"",mate:"",timeout:"",foulWin:"",foulLose:"",enteringOfKing:"",winByDefault:"",loseByDefault:""};function D0(e,t){let i="";const n=t.returnCode?t.returnCode:`
`;for(const s of e.standardMetadataKeys)i+=A0[s]+""+e.getStandardMetadata(s)+n;for(const s of e.customMetadataKeys)i+=s+""+e.getCustomMetadata(s)+n;return i}function F0(e,t){let i="";const n=t.returnCode?t.returnCode:`
`;i+=""+Wc(e.whiteHand)+n,i+="          "+n,i+="+---------------------------+"+n;for(let s=0;s<9;s++){i+="|";for(let o=0;o<9;o++){const r=$.newByXY(o,s),a=e.board.at(r);a?a.color===L.BLACK?i+=" "+Wa(a.type):i+="v"+Wa(a.type):i+=" "}i+="|"+Ol(s+1)+n}return i+="+---------------------------+"+n,i+=""+Wc(e.blackHand)+n,e.color===L.BLACK?i+=""+n:i+=""+n,i}function $0(e){let t="";return t+=Vd(e.to.file),t+=Ol(e.to.rank),t+=jd(e.pieceType),e.promote&&(t+=""),e.from instanceof $?t+="("+e.from.file+e.from.rank+")":t+="",t}function Wc(e){let t="";return e.forEach((i,n)=>{n>=1&&(t+=Wa(i),n>=2&&(t+=S0(n)),t+="")}),t}function Qd(e,t){let i="";const n=t.returnCode?t.returnCode:`
`;return i+="# KIF Generated by Electron Shogi"+n,i+=D0(e.metadata,t),i+=F0(e.initialPosition,t),i+="---------------"+n,e.forEach(s=>{if(s.number!==0){s.isFirstBranch||(i+=n,i+=""+s.number+""+n),i+=s.number+" ",s.move instanceof rt?i+=$0(s.move):i+=B0[s.move];const o=Yd(s.elapsedMs),r=qd(s.totalElapsedMs);i+=` (${o}/${r})`,s.isFirstBranch&&s.hasBranch&&(i+="+"),i+=n}if(s.comment.length!==0){const o=s.comment.endsWith(`
`)?s.comment.slice(0,-1):s.comment;i+="*"+o.replaceAll(`
`,n+"*")+n}}),i}const ao=[{pattern:/^V/,type:0,sectionType:0},{pattern:/^'\*(.+)$/,type:1,sectionType:2},{pattern:/^'(.+)$/,type:2,sectionType:2},{pattern:/^N\+(.+)$/,type:3,sectionType:0},{pattern:/^N-(.+)$/,type:4,sectionType:0},{pattern:/^\$([^:]+):(.+)$/,type:5,sectionType:0},{pattern:/^PI([1-9]{2}[A-Z]{2})*$/,type:6,sectionType:0},{pattern:/^P[1-9]( \* |[-+][A-Z][A-Z]){9}$/,type:7,sectionType:0},{pattern:/^P[-+]([0-9]{2}[A-Z]{2})*/,type:8,sectionType:0},{pattern:/^[-+]$/,type:9,sectionType:0},{pattern:/^[-+][0-9]{4}[A-Z]{2}/,type:10,sectionType:1},{pattern:/^%[-+A-Z_]+/,type:11,sectionType:1},{pattern:/^T([0-9]+)/,type:12,sectionType:1}];function H0(e){const t=[],i=e.match(/^['N$]/)?[e]:e.split(",");for(const n of i)for(let s=0;s<ao.length;s++){const o=ao[s].pattern.exec(n);if(o){t.push({type:ao[s].type,line:n,args:o.slice(1),sectionType:ao[s].sectionType});break}}return t}const U0={EVENT:ue.TITLE,SITE:ue.PLACE,START_TIME:ue.START_DATETIME,END_TIME:ue.END_DATETIME,TIME_LIMIT:ue.TIME_LIMIT,OPENING:ue.STRATEGY},Nl={FU:F.PAWN,KY:F.LANCE,KE:F.KNIGHT,GI:F.SILVER,KI:F.GOLD,KA:F.BISHOP,HI:F.ROOK,OU:F.KING,TO:F.PROM_PAWN,NY:F.PROM_LANCE,NK:F.PROM_KNIGHT,NG:F.PROM_SILVER,UM:F.HORSE,RY:F.DRAGON};function z0(e,t){t.reset(be.STANDARD);for(let i=2;i+4<=e.length;i+=4){const n=Number(e[i]),s=Number(e[i+1]);t.board.remove(new $(n,s))}}function W0(e,t){const i=Number(e[1]);for(let n=0;n<9;n+=1){const s=9-n,o=n*3+2,r=e.slice(o,o+3);if(r[0]===" ")continue;const a=r[0]==="+"?L.BLACK:L.WHITE,l=Nl[r.slice(1)];if(!l)return new Error(": "+r);t.board.set(new $(s,i),new ce(a,l))}}function G0(e,t){const i=e[1]==="+"?L.BLACK:L.WHITE;for(let n=2;n+4<=e.length;n+=4){const s=e.slice(n,n+4);if(s==="00AL"){const l=p0(t);i===L.BLACK?t.blackHand.forEach(c=>{t.blackHand.add(c,l[c])}):t.whiteHand.forEach(c=>{t.whiteHand.add(c,l[c])});return}const o=Number(s[0]),r=Number(s[1]),a=Nl[s.slice(2)];if(!a)return new Error(": "+s);o!==0&&r!==0?t.board.set(new $(o,r),new ce(i,a)):i===L.BLACK?t.blackHand.add(a,1):t.whiteHand.add(a,1)}}function Zd(e,t){if((e[0]==="+"?L.BLACK:L.WHITE)!=t.color)return new Error(": "+e);const n=Number(e[1]),s=Number(e[2]),o=Number(e[3]),r=Number(e[4]),a=Nl[e.slice(5,7)];if(!a)return new Error(": "+e);const l=n===0&&s===0?a:new $(n,s),c=new $(o,r);let u=t.createMove(l,c);if(!u)return new Error(": "+e);if(l instanceof $){const h=t.board.at(l);if(!h)return new Error(": "+e);if(h.type!==a)if(h.promoted().type===a)u=u.withPromote();else return new Error(": "+e)}return u}function V0(e){switch(e){case"%CHUDAN":return le.INTERRUPT;case"%TORYO":return le.RESIGN;case"%JISHOGI":return le.IMPASS;case"%HIKIWAKE":return le.DRAW;case"%SENNICHITE":return le.REPETITION_DRAW;case"%TSUMI":return le.MATE;case"%TIME_UP":return le.TIMEOUT;case"%ILLEGAL_MOVE":return le.FOUL_LOSE;case"%KACHI":return le.ENTERING_OF_KING}}function j0(e,t){return Zd(t,e)}function Gc(e){const t=new Zo,i=new At,n=new Rt;n.reset(be.EMPTY);let s="",o=!1;const r=e.replace(/\r?\n\/(\r?\n[\s\S]*)?$/,"").split(/\r?\n/);for(const a of r)for(const l of H0(a)){if(l.sectionType===0&&o||l.sectionType===1&&!o)return new Error(": "+l.line);switch(l.type){case 0:break;case 1:o?i.current.comment=qo(i.current.comment,l.args[0]):s=qo(s,l.args[0]);break;case 2:break;case 3:t.setStandardMetadata(ue.BLACK_NAME,l.args[0]);break;case 4:t.setStandardMetadata(ue.WHITE_NAME,l.args[0]);break;case 5:{const c=U0[l.args[0]];c?t.setStandardMetadata(c,l.args[1]):t.setCustomMetadata(l.args[0],l.args[1]);break}case 6:z0(l.line,n);break;case 7:{const c=W0(l.line,n);if(c)return c;break}case 8:{const c=G0(l.line,n);if(c)return c;break}case 9:l.line[0]==="+"?n.setColor(L.BLACK):n.setColor(L.WHITE),i.clear(n),i.first.comment=s,o=!0;break;case 10:{const c=Zd(l.line,i.position);if(c instanceof Error)return c;i.append(c,{ignoreValidation:!0});break}case 11:{const c=V0(l.line);c&&i.append(c,{ignoreValidation:!0});break}case 12:i.current.setElapsedMs(Number(l.args[0])*1e3);break}}return o||(i.clear(n),i.first.comment=s),i.goto(0),i.resetAllBranchSelection(),i.metadata=t,i}function K0(e,t){let i="";const n=t.returnCode?t.returnCode:`
`,s=e.getStandardMetadata(ue.BLACK_NAME)||e.getStandardMetadata(ue.BLACK_SHORT_NAME);s&&(i+="N+"+s+n);const o=e.getStandardMetadata(ue.WHITE_NAME)||e.getStandardMetadata(ue.WHITE_SHORT_NAME);o&&(i+="N-"+o+n);const r=e.getStandardMetadata(ue.TOURNAMENT)||e.getStandardMetadata(ue.TITLE)||e.getStandardMetadata(ue.OPUS_NAME)||e.getStandardMetadata(ue.PUBLISHED_ON);r&&(i+="$EVENT:"+r+n);const a=e.getStandardMetadata(ue.PLACE);a&&(i+="$SITE:"+a+n);const l=e.getStandardMetadata(ue.START_DATETIME)||e.getStandardMetadata(ue.DATE);l&&(i+="$START_TIME:"+l.slice(10)+n);const c=e.getStandardMetadata(ue.DATE);c&&(i+="$END_TIME:"+c.slice(10)+n);const u=e.getStandardMetadata(ue.STRATEGY);return u&&(i+="$OPENING:"+u+n),i}const er={king:"OU",rook:"HI",dragon:"RY",bishop:"KA",horse:"UM",gold:"KI",silver:"GI",promSilver:"NG",knight:"KE",promKnight:"NK",lance:"KY",promLance:"NY",pawn:"FU",promPawn:"TO"};function Vc(e){let t="";return e.forEach((i,n)=>{for(let s=0;s<n;s++)t+="00"+er[i]}),t}function q0(e,t){let i="";const n=t.returnCode?t.returnCode:`
`;for(let s=1;s<=9;s+=1){i+="P"+s;for(let o=9;o>=1;o-=1){const r=e.board.at(new $(o,s));r?r.color===L.BLACK?i+="+"+er[r.type]:i+="-"+er[r.type]:i+=" * "}i+=n}return i+="P+"+Vc(e.blackHand)+n,i+="P-"+Vc(e.whiteHand)+n,i+=(e.color===L.BLACK?"+":"-")+n,i}function jc(e){return e instanceof $?`${e.file}${e.rank}`:"00"}function ef(e){return(e.color===L.BLACK?"+":"-")+jc(e.from)+jc(e.to)+er[e.promote?Zm(e.pieceType):e.pieceType]}function Y0(e){switch(e){case le.INTERRUPT:return"%CHUDAN";case le.RESIGN:return"%TORYO";case le.IMPASS:return"%JISHOGI";case le.DRAW:return"%HIKIWAKE";case le.REPETITION_DRAW:return"%SENNICHITE";case le.MATE:return"%TSUMI";case le.TIMEOUT:return"%TIME_UP";case le.FOUL_LOSE:return"%ILLEGAL_MOVE";case le.ENTERING_OF_KING:return"%KACHI"}}function Kc(e){return ef(e)}function tf(e,t){let i="";const n=t.returnCode?t.returnCode:`
`;return i+="' CSA Generated by Electron Shogi"+n,i+="V2.2"+n,i+=K0(e.metadata,t),i+=q0(e.initialPosition,t),e.moves.forEach(s=>{if(s.number===0)return;let o;s.move instanceof rt?o=ef(s.move):o=Y0(s.move),o&&(i+=o+n,i+="T"+Math.floor(s.elapsedMs/1e3)+n),s.comment&&(s.comment.endsWith(`
`)?s.comment.slice(0,-1):s.comment).split(`
`).forEach(a=>{i+="'*"+a+n})}),i}var Fn=(e=>(e[e.USI=0]="USI",e[e.SFEN=1]="SFEN",e[e.KIF=2]="KIF",e[e.CSA=3]="CSA",e))(Fn||{});function X0(e){if(e.startsWith("position sfen ")||e.startsWith("position startpos ")||e.startsWith("sfen ")||e.startsWith("startpos ")||e.startsWith("moves "))return 0;if(Rt.isValidSFEN(e))return 1;const t=/(^|\n)[#0-9]/g,i=/(^|,|\n)[-+$%'VNPT]/g,n=e.match(t),s=e.match(i),o=n?n.length:0,r=s?s.length:0;return o>=r?2:3}class Ct{constructor(t,i){this.width=t,this.height=i}add(t){return new Ct(this.width+t.width,this.height+t.height)}reduce(t){return new Ct(this.width-t.width,this.height-t.height)}}const qc={};function ds(e){if(qc[e])return;const t=document.createElement("img");t.src=e,qc[e]=t}const oe={frame:{width:1471,height:959},board:{x:296.5,y:0,width:878,height:960,squreWidth:94.8,squreHeight:104,leftSquarePadding:12,topSquarePadding:12.2,leftPiecePadding:17.5,topPiecePadding:18.5,highlight:{selected:{"background-color":"#0088ff",opacity:"0.8"},lastMoveTo:{"background-color":"#44cc44",opacity:"0.8"},lastMoveFrom:{"background-color":"#44cc44",opacity:"0.4"}}},label:{fontSize:24},piece:{width:88,height:93},hand:{black:{x:1184,y:600},white:{x:0,y:0},width:288,height:360,highlight:{selected:{"background-color":"#ff4800",opacity:"0.7"}}},turn:{black:{x:1184,y:425},white:{x:0,y:492},width:288,height:45,fontSize:32},playerName:{black:{x:1184,y:480},white:{x:0,y:370},width:288,height:45,fontSize:25},clock:{black:{x:1184,y:535},white:{x:0,y:425},width:288,height:55,fontSize:40},control:{left:{x:0,y:547,width:288,height:412,fontSize:26},right:{x:1184,y:0,width:288,height:412,fontSize:26}}},Yc={[wn.HITOMOJI]:{black:{pawn:"./piece/hitomoji/black_pawn.png",lance:"./piece/hitomoji/black_lance.png",knight:"./piece/hitomoji/black_knight.png",silver:"./piece/hitomoji/black_silver.png",gold:"./piece/hitomoji/black_gold.png",bishop:"./piece/hitomoji/black_bishop.png",rook:"./piece/hitomoji/black_rook.png",king:"./piece/hitomoji/black_king.png",king2:"./piece/hitomoji/black_king2.png",promPawn:"./piece/hitomoji/black_prom_pawn.png",promLance:"./piece/hitomoji/black_prom_lance.png",promKnight:"./piece/hitomoji/black_prom_knight.png",promSilver:"./piece/hitomoji/black_prom_silver.png",horse:"./piece/hitomoji/black_horse.png",dragon:"./piece/hitomoji/black_dragon.png"},white:{pawn:"./piece/hitomoji/white_pawn.png",lance:"./piece/hitomoji/white_lance.png",knight:"./piece/hitomoji/white_knight.png",silver:"./piece/hitomoji/white_silver.png",gold:"./piece/hitomoji/white_gold.png",bishop:"./piece/hitomoji/white_bishop.png",rook:"./piece/hitomoji/white_rook.png",king:"./piece/hitomoji/white_king.png",king2:"./piece/hitomoji/white_king2.png",promPawn:"./piece/hitomoji/white_prom_pawn.png",promLance:"./piece/hitomoji/white_prom_lance.png",promKnight:"./piece/hitomoji/white_prom_knight.png",promSilver:"./piece/hitomoji/white_prom_silver.png",horse:"./piece/hitomoji/white_horse.png",dragon:"./piece/hitomoji/white_dragon.png"}},[wn.HITOMOJI_DARK]:{black:{pawn:"./piece/hitomoji_dark/black_pawn.png",lance:"./piece/hitomoji_dark/black_lance.png",knight:"./piece/hitomoji_dark/black_knight.png",silver:"./piece/hitomoji_dark/black_silver.png",gold:"./piece/hitomoji_dark/black_gold.png",bishop:"./piece/hitomoji_dark/black_bishop.png",rook:"./piece/hitomoji_dark/black_rook.png",king:"./piece/hitomoji_dark/black_king.png",king2:"./piece/hitomoji_dark/black_king2.png",promPawn:"./piece/hitomoji_dark/black_prom_pawn.png",promLance:"./piece/hitomoji_dark/black_prom_lance.png",promKnight:"./piece/hitomoji_dark/black_prom_knight.png",promSilver:"./piece/hitomoji_dark/black_prom_silver.png",horse:"./piece/hitomoji_dark/black_horse.png",dragon:"./piece/hitomoji_dark/black_dragon.png"},white:{pawn:"./piece/hitomoji_dark/white_pawn.png",lance:"./piece/hitomoji_dark/white_lance.png",knight:"./piece/hitomoji_dark/white_knight.png",silver:"./piece/hitomoji_dark/white_silver.png",gold:"./piece/hitomoji_dark/white_gold.png",bishop:"./piece/hitomoji_dark/white_bishop.png",rook:"./piece/hitomoji_dark/white_rook.png",king:"./piece/hitomoji_dark/white_king.png",king2:"./piece/hitomoji_dark/white_king2.png",promPawn:"./piece/hitomoji_dark/white_prom_pawn.png",promLance:"./piece/hitomoji_dark/white_prom_lance.png",promKnight:"./piece/hitomoji_dark/white_prom_knight.png",promSilver:"./piece/hitomoji_dark/white_prom_silver.png",horse:"./piece/hitomoji_dark/white_horse.png",dragon:"./piece/hitomoji_dark/white_dragon.png"}},[wn.HITOMOJI_GOTHIC]:{black:{pawn:"./piece/hitomoji_gothic/black_pawn.png",lance:"./piece/hitomoji_gothic/black_lance.png",knight:"./piece/hitomoji_gothic/black_knight.png",silver:"./piece/hitomoji_gothic/black_silver.png",gold:"./piece/hitomoji_gothic/black_gold.png",bishop:"./piece/hitomoji_gothic/black_bishop.png",rook:"./piece/hitomoji_gothic/black_rook.png",king:"./piece/hitomoji_gothic/black_king.png",king2:"./piece/hitomoji_gothic/black_king2.png",promPawn:"./piece/hitomoji_gothic/black_prom_pawn.png",promLance:"./piece/hitomoji_gothic/black_prom_lance.png",promKnight:"./piece/hitomoji_gothic/black_prom_knight.png",promSilver:"./piece/hitomoji_gothic/black_prom_silver.png",horse:"./piece/hitomoji_gothic/black_horse.png",dragon:"./piece/hitomoji_gothic/black_dragon.png"},white:{pawn:"./piece/hitomoji_gothic/white_pawn.png",lance:"./piece/hitomoji_gothic/white_lance.png",knight:"./piece/hitomoji_gothic/white_knight.png",silver:"./piece/hitomoji_gothic/white_silver.png",gold:"./piece/hitomoji_gothic/white_gold.png",bishop:"./piece/hitomoji_gothic/white_bishop.png",rook:"./piece/hitomoji_gothic/white_rook.png",king:"./piece/hitomoji_gothic/white_king.png",king2:"./piece/hitomoji_gothic/white_king2.png",promPawn:"./piece/hitomoji_gothic/white_prom_pawn.png",promLance:"./piece/hitomoji_gothic/white_prom_lance.png",promKnight:"./piece/hitomoji_gothic/white_prom_knight.png",promSilver:"./piece/hitomoji_gothic/white_prom_silver.png",horse:"./piece/hitomoji_gothic/white_horse.png",dragon:"./piece/hitomoji_gothic/white_dragon.png"}},[wn.HITOMOJI_GOTHIC_DARK]:{black:{pawn:"./piece/hitomoji_gothic_dark/black_pawn.png",lance:"./piece/hitomoji_gothic_dark/black_lance.png",knight:"./piece/hitomoji_gothic_dark/black_knight.png",silver:"./piece/hitomoji_gothic_dark/black_silver.png",gold:"./piece/hitomoji_gothic_dark/black_gold.png",bishop:"./piece/hitomoji_gothic_dark/black_bishop.png",rook:"./piece/hitomoji_gothic_dark/black_rook.png",king:"./piece/hitomoji_gothic_dark/black_king.png",king2:"./piece/hitomoji_gothic_dark/black_king2.png",promPawn:"./piece/hitomoji_gothic_dark/black_prom_pawn.png",promLance:"./piece/hitomoji_gothic_dark/black_prom_lance.png",promKnight:"./piece/hitomoji_gothic_dark/black_prom_knight.png",promSilver:"./piece/hitomoji_gothic_dark/black_prom_silver.png",horse:"./piece/hitomoji_gothic_dark/black_horse.png",dragon:"./piece/hitomoji_gothic_dark/black_dragon.png"},white:{pawn:"./piece/hitomoji_gothic_dark/white_pawn.png",lance:"./piece/hitomoji_gothic_dark/white_lance.png",knight:"./piece/hitomoji_gothic_dark/white_knight.png",silver:"./piece/hitomoji_gothic_dark/white_silver.png",gold:"./piece/hitomoji_gothic_dark/white_gold.png",bishop:"./piece/hitomoji_gothic_dark/white_bishop.png",rook:"./piece/hitomoji_gothic_dark/white_rook.png",king:"./piece/hitomoji_gothic_dark/white_king.png",king2:"./piece/hitomoji_gothic_dark/white_king2.png",promPawn:"./piece/hitomoji_gothic_dark/white_prom_pawn.png",promLance:"./piece/hitomoji_gothic_dark/white_prom_lance.png",promKnight:"./piece/hitomoji_gothic_dark/white_prom_knight.png",promSilver:"./piece/hitomoji_gothic_dark/white_prom_silver.png",horse:"./piece/hitomoji_gothic_dark/white_horse.png",dragon:"./piece/hitomoji_gothic_dark/white_dragon.png"}}},J0={[De.LIGHT]:"./board/grid.svg",[De.WARM]:"./board/grid.svg",[De.RESIN]:"./board/grid.svg",[De.RESIN2]:"./board/grid.svg",[De.RESIN3]:"./board/grid.svg",[De.DARK]:"./board/grid_white.svg",[De.GREEN]:"./board/grid.svg",[De.CHERRY_BLOSSOM]:"./board/grid.svg"},Q0={[De.LIGHT]:"./board/wood_light.png",[De.WARM]:"./board/wood_warm.png",[De.RESIN]:null,[De.RESIN2]:null,[De.RESIN3]:null,[De.DARK]:null,[De.GREEN]:null,[De.CHERRY_BLOSSOM]:null},Z0={[De.LIGHT]:"rgba(0, 0, 0, 0)",[De.WARM]:"rgba(0, 0, 0, 0)",[De.RESIN]:"#d69b00",[De.RESIN2]:"#efbf63",[De.RESIN3]:"#ad7624",[De.DARK]:"#333333",[De.GREEN]:"#598459",[De.CHERRY_BLOSSOM]:"#ecb6b6"},eb={[De.LIGHT]:"#8b4513",[De.WARM]:"#8b4513",[De.RESIN]:"#8b4513",[De.RESIN2]:"#8b4513",[De.RESIN3]:"#8b4513",[De.DARK]:"#333333",[De.GREEN]:"#527a52",[De.CHERRY_BLOSSOM]:"#e8a9a9"},tb={black:{pawn:{row:3,column:0,width:2},lance:{row:2,column:0,width:1},knight:{row:2,column:1,width:1},silver:{row:1,column:0,width:1},gold:{row:1,column:1,width:1},bishop:{row:0,column:0,width:1},rook:{row:0,column:1,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}},white:{pawn:{row:0,column:0,width:2},lance:{row:1,column:1,width:1},knight:{row:1,column:0,width:1},silver:{row:2,column:1,width:1},gold:{row:2,column:0,width:1},bishop:{row:3,column:1,width:1},rook:{row:3,column:0,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}}},ib={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""};class nb{constructor(t,i,n){M(this,"pieceImages");M(this,"boardGridImage");M(this,"boardTextureImage");this.boardImageType=i,this.boardLabelType=n,this.pieceImages=Yc[t]||Yc[wn.HITOMOJI],this.boardGridImage=J0[i],this.boardTextureImage=Q0[i]}preload(){ds(this.boardGridImage),this.boardTextureImage&&ds(this.boardTextureImage),Object.values(this.pieceImages.black).forEach(ds),Object.values(this.pieceImages.white).forEach(ds)}build(t,i,n,s,o,r){let a=t.width/oe.frame.width;oe.frame.height*a>t.height&&(a=t.height/oe.frame.height);const l=()=>{const ee=oe.frame.height*a,ne=oe.frame.width*a;return{style:{height:ee+"px",width:ne+"px"},size:new Ct(ne,ee)}},c=()=>{const ee=oe.board.x*a,ne=oe.board.y*a,ie=oe.board.width*a,Le=oe.board.height*a,ge={"background-color":Z0[this.boardImageType],left:ee+"px",top:ne+"px",height:Le+"px",width:ie+"px"};return{gridImagePath:this.boardGridImage,textureImagePath:this.boardTextureImage,x:ee,y:ne,style:ge}},u=ee=>{const ne=[];if(this.boardLabelType==Es.NONE)return ne;const ie=oe.label.fontSize*a,Le=ie*.1,ke={color:"black","font-size":ie+"px","font-weight":"bold","text-shadow":`${Le}px ${Le}px  ${Le}px white`};for(let ge=1;ge<=9;ge++){const ut=ee.x-ie*.5+(r?0:oe.board.width)*a+oe.board.leftPiecePadding*.5*a*(r?1:-1),ht=ee.y-ie*.5+(oe.board.topSquarePadding+((r?10-ge:ge)-.5)*oe.board.squreHeight)*a;ne.push({id:"rank"+ge,character:ib[ge],style:{left:ut+"px",top:ht+"px",...ke}})}for(let ge=1;ge<=9;ge++){const ut=ee.x-ie*.5+(oe.board.leftPiecePadding+(9.5-(r?10-ge:ge))*oe.board.squreWidth)*a,ht=ee.y-ie*.5+(r?oe.board.height:0)*a+oe.board.topSquarePadding*.5*a*(r?-1:1);ne.push({id:"file"+ge,character:String(ge),style:{left:ut+"px",top:ht+"px",...ke}})}return ne},h=ee=>{const ne=[];return i.board.listNonEmptySquares().forEach(ie=>{const Le=i.board.at(ie),ke=Le.id+ie.index,ge=r?Mt(Le.color):Le.color,ut=Le.type==F.KING&&Le.color==L.BLACK?"king2":Le.type,ht=this.pieceImages[ge][ut],St=ee.x+(oe.board.leftPiecePadding+oe.board.squreWidth*(r?ie.opposite:ie).x)*a,Xe=ee.y+(oe.board.topPiecePadding+oe.board.squreHeight*(r?ie.opposite:ie).y)*a,Pt=oe.piece.width*a,Ke=oe.piece.height*a;ne.push({id:ke,imagePath:ht,style:{left:St+"px",top:Xe+"px",width:Pt+"px",height:Ke+"px"}})}),ne},f=ee=>{const ne=[];return $.all.forEach(ie=>{const Le=ie.index,{file:ke}=ie,{rank:ge}=ie,ut=ee.x+(oe.board.leftSquarePadding+oe.board.squreWidth*(r?ie.opposite:ie).x)*a,ht=ee.y+(oe.board.topSquarePadding+oe.board.squreHeight*(r?ie.opposite:ie).y)*a,St=oe.board.squreWidth*a,Xe=oe.board.squreHeight*a,Pt={left:ut+"px",top:ht+"px",width:St+"px",height:Xe+"px"};let Ke=Pt;n&&ie.equals(n.to)&&(Ke={...Ke,...oe.board.highlight.lastMoveTo}),n&&n.from instanceof $&&ie.equals(n.from)&&(Ke={...Ke,...oe.board.highlight.lastMoveFrom}),s instanceof $&&s.equals(ie)&&(Ke={...Ke,...oe.board.highlight.selected}),ne.push({id:Le,file:ke,rank:ge,style:Pt,backgroundStyle:Ke})}),ne},g=(ee,ne)=>{const ie=r?Mt(ee):ee,Le=eb[this.boardImageType],ke=oe.hand[ie].x*a,ge=oe.hand[ie].y*a,ut=oe.hand.width*a,ht=oe.hand.height*a,St={"background-color":Le,left:ke+"px",top:ge+"px",width:ut+"px",height:ht+"px"},Xe=[],Pt=[];return Jm.forEach(Ke=>{const wt=ne.count(Ke),ii=tb[ie][Ke],mi=oe.hand.width/2*ii.width*a,C=oe.hand.height/4*a,T=mi*ii.column,D=C*ii.row,V=oe.piece.width*a,j=oe.piece.height*a,X=Math.max(mi-V*wt,0)/(wt*2),se=(mi-V-X*2)/Math.max(wt-1,1);for(let he=wt-1;he>=0;he-=1){const de=Ke+he,pe=this.pieceImages[ie][Ke],me=T+X+se*he,xe=D;Xe.push({id:de,imagePath:pe,style:{left:me+"px",top:xe+"px",width:V+"px",height:j+"px"}})}const J=Ke,Z={left:T+"px",top:D+"px",width:mi+"px",height:C+"px"};let q=Z;s&&s instanceof ce&&s.color===ee&&s.type===Ke&&(q={...q,...oe.hand.highlight.selected}),Pt.push({id:J,type:Ke,style:Z,backgroundStyle:q})}),{style:St,pieces:Xe,pointers:Pt}},_=(ee,ne)=>{if(!ne)return null;const ie=r?Mt(ne.color):ne.color,Le=r?ne.to.opposite:ne.to,ke=new ce(ie,ne.pieceType),ge=ke.promoted(),ut=ke.unpromoted(),ht=this.pieceImages[ie][ge.type],St=this.pieceImages[ie][ut.type],Xe=ee.x+(oe.board.leftSquarePadding+oe.board.squreWidth*(Le.x===0?0:Le.x===8?7:Le.x-.5))*a,Pt=ee.y+(oe.board.topSquarePadding+oe.board.squreHeight*Le.y)*a,Ke=oe.board.squreWidth*2*a,wt=oe.board.squreHeight*a,ii={left:Xe+"px",top:Pt+"px",width:Ke+"px",height:wt+"px","font-size":wt/4+"px"};return{promoteImagePath:ht,notPromoteImagePath:St,style:ii}},b=()=>{const ee=i.color,ne=r?Mt(ee):ee,ie=2;return{style:{left:oe.turn[ne].x*a-ie+"px",top:oe.turn[ne].y*a-ie+"px",width:oe.turn.width*a-ie+"px",height:oe.turn.height*a-ie+"px","font-size":oe.turn.fontSize*a+"px","border-radius":oe.turn.height*a*.4+"px","border-width":ie+"px","border-style":"solid"}}},v=ee=>{const ne=r?Mt(ee):ee;return{style:{left:oe.playerName[ne].x*a+"px",top:oe.playerName[ne].y*a+"px",width:oe.playerName.width*a+"px",height:oe.playerName.height*a+"px","font-size":oe.playerName.fontSize*a+"px"}}},y=ee=>{const ne=r?Mt(ee):ee;return{style:{left:oe.clock[ne].x*a+"px",top:oe.clock[ne].y*a+"px",width:oe.clock.width*a+"px",height:oe.clock.height*a+"px","font-size":oe.clock.fontSize*a+"px"}}},E=()=>({left:{style:{left:oe.control.left.x*a+"px",top:oe.control.left.y*a+"px",width:oe.control.left.width*a+"px",height:oe.control.left.height*a+"px","font-size":oe.control.left.fontSize*a+"px"}},right:{style:{left:oe.control.right.x*a+"px",top:oe.control.right.y*a+"px",width:oe.control.right.width*a+"px",height:oe.control.right.height*a+"px","font-size":oe.control.right.fontSize*a+"px"}}}),w=l(),P=c(),A=u(P),O=h(P),U=f(P),z=g(L.BLACK,i.hand(L.BLACK)),te=g(L.WHITE,i.hand(L.WHITE)),G=_(P,o),Q=b(),Se=v(L.BLACK),ae=v(L.WHITE),Re=y(L.BLACK),Ee=y(L.WHITE),we=E();return{frame:w,board:P,labels:A,piece:O,square:U,blackHand:z,whiteHand:te,promotion:G,turn:Q,blackPlayerName:Se,whitePlayerName:ae,blackClock:Re,whiteClock:Ee,control:we}}}const sb=Ge({name:"BoardView",props:{pieceImageType:{type:String,required:!0},boardImageType:{type:String,required:!0},boardLabelType:{type:String,required:!0},maxSize:{type:Ct,required:!0},position:{type:Object,required:!0},lastMove:{type:Object,required:!1,default:null},flip:{type:Boolean,required:!1},allowEdit:{type:Boolean,required:!1},allowMove:{type:Boolean,required:!1},blackPlayerName:{type:String,required:!1,default:""},whitePlayerName:{type:String,required:!1,default:""},blackPlayerTime:{type:Number,required:!1,default:void 0},blackPlayerByoyomi:{type:Number,required:!1,default:void 0},whitePlayerTime:{type:Number,required:!1,default:void 0},whitePlayerByoyomi:{type:Number,required:!1,default:void 0},nextMoveLabel:{type:String,required:!1,default:""}},emits:["resize","move","edit"],setup(e,t){const i=Ci({pointer:null,reservedMove:null}),n=()=>{i.pointer=null,i.reservedMove=null};In([()=>e.position,()=>e.allowEdit,()=>e.allowMove],()=>{n()});const s=()=>{n()},o=(w,P,A)=>{const O=i.pointer;if(n(),!(w instanceof $&&O instanceof $&&w.equals(O))&&!(w instanceof ce&&O instanceof ce&&w.equals(O))){if(O){const U=O,z=w instanceof $?w:w.color;if(e.allowEdit&&e.position.isValidEditing(U,z)){t.emit("edit",{move:{from:O,to:z}});return}if(e.allowMove&&w instanceof $){const te=O instanceof $?O:O.type,G=w,Q=e.position.createMove(te,G);if(!Q)return;const Se=e.position.isValidMove(Q),ae=e.position.isValidMove(Q.withPromote());if(Se&&ae){i.reservedMove=Q;return}if(Se){t.emit("move",Q);return}if(ae){t.emit("move",Q.withPromote());return}}}!e.allowMove&&!e.allowEdit||P||!e.allowEdit&&A!==e.position.color||(i.pointer=w)}},r=(w,P,A)=>{w.stopPropagation(),w.preventDefault();const O=new $(P,A),U=e.position.board.at(O);o(O,!U,U==null?void 0:U.color)},a=(w,P,A)=>{w.stopPropagation(),w.preventDefault();const O=e.position.hand(P).count(A)===0;o(new ce(P,A),O,P)},l=(w,P,A)=>{w.stopPropagation(),w.preventDefault(),n();const O=new $(P,A);e.allowEdit&&e.position.board.at(O)&&t.emit("edit",{rotate:O})},c=w=>{w.stopPropagation(),w.preventDefault();const P=i.reservedMove;n(),P&&e.position.isValidMove(P.withPromote())&&t.emit("move",P.withPromote())},u=w=>{w.stopPropagation(),w.preventDefault();const P=i.reservedMove;n(),P&&e.position.isValidMove(P)&&t.emit("move",P)},h=Me(()=>{const w=new nb(e.pieceImageType,e.boardImageType,e.boardLabelType);return w.preload(),w}),f=Me(()=>{const w=h.value.build(e.maxSize,e.position,e.lastMove,i.pointer,i.reservedMove,e.flip);return t.emit("resize",w.frame.size),w}),g=(w,P)=>w?Xd(w):P!==void 0?""+P:"0:00:00",_=(w,P)=>{if(!w&&!P)return"normal";const A=(w||0)+(P||0);return A<=5?"danger":A<=10?"warning":"normal"},b=Me(()=>g(e.blackPlayerTime,e.blackPlayerByoyomi)),v=Me(()=>_(e.blackPlayerTime,e.blackPlayerByoyomi)),y=Me(()=>g(e.whitePlayerTime,e.whitePlayerByoyomi)),E=Me(()=>_(e.whitePlayerTime,e.whitePlayerByoyomi));return{clickFrame:s,clickSquare:r,clickHand:a,clickSquareR:l,clickPromote:c,clickNotPromote:u,layout:f,blackPlayerTimeText:b,blackPlayerTimeSeverity:v,whitePlayerTimeText:y,whitePlayerTimeSeverity:E,Color:L}}});const Ve=(e,t)=>{const i=e.__vccOpts||e;for(const[n,s]of t)i[n]=s;return i},ob=["src"],rb=["src"],ab={class:"player-name-text"},lb={class:"clock-text"},cb={class:"player-name-text"},ub={class:"clock-text"},hb=["src"],db=["onClick","onContextmenu"],fb=["src"],pb=["onClick"],gb=["src"],mb=["onClick"],bb=["src"],_b=["src"];function yb(e,t,i,n,s,o){return R(),B("div",null,[p("div",{class:"frame",style:Fe(e.layout.frame.style),onClick:t[2]||(t[2]=r=>e.clickFrame())},[e.layout.board.textureImagePath?(R(),B("div",{key:0,class:"board-texture",style:Fe(e.layout.board.style)},[p("img",{class:"board-image",src:e.layout.board.textureImagePath},null,8,ob)],4)):re("",!0),p("div",{class:"board-grid",style:Fe(e.layout.board.style)},[p("img",{class:"board-image",src:e.layout.board.gridImagePath},null,8,rb)],4),p("div",{class:Zt(["player-name",{active:e.position.color=="black"}]),style:Fe(e.layout.blackPlayerName.style)},[p("span",ab,""+k(e.blackPlayerName),1)],6),p("div",{class:Zt(["clock",e.blackPlayerTimeSeverity]),style:Fe(e.layout.blackClock.style)},[p("span",lb,k(e.blackPlayerTimeText),1)],6),p("div",{class:Zt(["player-name",{active:e.position.color=="white"}]),style:Fe(e.layout.whitePlayerName.style)},[p("span",cb,""+k(e.whitePlayerName),1)],6),p("div",{class:Zt(["clock",e.whitePlayerTimeSeverity]),style:Fe(e.layout.whiteClock.style)},[p("span",ub,k(e.whitePlayerTimeText),1)],6),(R(!0),B(Ce,null,Ye(e.layout.square,r=>(R(),B("div",{key:r.id,class:"square",style:Fe(r.backgroundStyle)},null,4))),128)),(R(!0),B(Ce,null,Ye(e.layout.piece,r=>(R(),B("div",{key:r.id,class:"piece",style:Fe(r.style)},[p("img",{class:"piece-image",src:r.imagePath},null,8,hb)],4))),128)),(R(!0),B(Ce,null,Ye(e.layout.labels,r=>(R(),B("div",{key:r.id,class:"label",style:Fe(r.style)},k(r.character),5))),128)),(R(!0),B(Ce,null,Ye(e.layout.square,r=>(R(),B("div",{key:r.id,class:"square",style:Fe(r.style),onClick:a=>e.clickSquare(a,r.file,r.rank),onContextmenu:a=>e.clickSquareR(a,r.file,r.rank)},null,44,db))),128)),p("div",{class:"hand",style:Fe(e.layout.blackHand.style)},[(R(!0),B(Ce,null,Ye(e.layout.blackHand.pointers,r=>(R(),B("div",{key:r.id,class:"hand-pointer",style:Fe(r.backgroundStyle)},null,4))),128)),(R(!0),B(Ce,null,Ye(e.layout.blackHand.pieces,r=>(R(),B("div",{key:r.id,class:"piece",style:Fe(r.style)},[p("img",{class:"piece-image",src:r.imagePath},null,8,fb)],4))),128)),(R(!0),B(Ce,null,Ye(e.layout.blackHand.pointers,r=>(R(),B("div",{key:r.id,class:"hand-pointer",style:Fe(r.style),onClick:a=>e.clickHand(a,e.Color.BLACK,r.type)},null,12,pb))),128))],4),p("div",{class:"hand",style:Fe(e.layout.whiteHand.style)},[(R(!0),B(Ce,null,Ye(e.layout.whiteHand.pointers,r=>(R(),B("div",{key:r.id,class:"hand-pointer",style:Fe(r.backgroundStyle)},null,4))),128)),(R(!0),B(Ce,null,Ye(e.layout.whiteHand.pieces,r=>(R(),B("div",{key:r.id,class:"piece",style:Fe(r.style)},[p("img",{class:"piece-image",src:r.imagePath},null,8,gb)],4))),128)),(R(!0),B(Ce,null,Ye(e.layout.whiteHand.pointers,r=>(R(),B("div",{key:r.id,class:"hand-pointer",style:Fe(r.style),onClick:a=>e.clickHand(a,e.Color.WHITE,r.type)},null,12,mb))),128))],4),e.layout.promotion?(R(),B("div",{key:1,class:"promotion-selector",style:Fe(e.layout.promotion.style)},[p("div",{class:"select-button promote",onClick:t[0]||(t[0]=r=>e.clickPromote(r))},[p("img",{class:"piece-image",src:e.layout.promotion.promoteImagePath},null,8,bb)]),p("div",{class:"select-button not-promote",onClick:t[1]||(t[1]=r=>e.clickNotPromote(r))},[p("img",{class:"piece-image",src:e.layout.promotion.notPromoteImagePath},null,8,_b)])],4)):re("",!0),p("div",{class:"turn",style:Fe(e.layout.turn.style)},k(e.nextMoveLabel),5),p("div",{style:Fe(e.layout.control.left.style)},[Ra(e.$slots,"left-control",{},void 0,!0)],4),p("div",{style:Fe(e.layout.control.right.style)},[Ra(e.$slots,"right-control",{},void 0,!0)],4)],4)])}const nf=Ve(sb,[["render",yb],["__scopeId","data-v-987d098e"]]),Qt="es://human",Ll="es://usi-engine/";function ki(e){return e.startsWith(Ll)}function sf(){const e=Date.now(),t=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16);return Ll+`${e}/${t}`}const vb=Object.freeze(Object.defineProperty({__proto__:null,ES_HUMAN:Qt,ES_USI_ENGINE:Ll,isUSIEngine:ki,issueEngineURI:sf},Symbol.toStringTag,{value:"Module"})),of="USI_Ponder",Sb="USI_MultiPV",wb="Threads",Eb="NumberOfThreads",kb="MultiPV";function Sn(e){if(e){if(e.value!==void 0)return e.value;if(e.default!==void 0)return e.type==="string"&&e.default==="<empty>"?"":e.default}}function Ib(){return{uri:"",name:"",defaultName:"",author:"",path:"",options:{}}}function Pb(e){const t=JSON.parse(JSON.stringify(e));return t.uri=sf(),t.name=ve.copyOf(t.name),t}function Ab(e,t){e.uri=t.uri,e.name=t.name,Object.keys(t.options).forEach(i=>{e.options[i]&&(e.options[i].value=t.options[i].value)})}class Wi{constructor(t){M(this,"engines",{});if(t){const i=JSON.parse(t);for(const n in i.engines)ki(n)&&(this.engines[n]={...Ib(),...i.engines[n],uri:n})}}hasEngine(t){return!!this.engines[t]}addEngine(t){this.engines[t.uri]=t}updateEngine(t){return this.engines[t.uri]?(this.engines[t.uri]=t,!0):!1}removeEngine(t){return this.engines[t]?(delete this.engines[t],!0):!1}getEngine(t){return this.engines[t]}get engineList(){return Object.values(this.engines).sort((t,i)=>t.name!==i.name?t.name>i.name?1:-1:t.defaultName!==i.defaultName?t.defaultName>i.defaultName?1:-1:t.uri>i.uri?1:-1)}get json(){return JSON.stringify(this)}get jsonWithIndent(){return JSON.stringify(this,void 0,2)}getClone(){return new Wi(this.json)}}function Cb(){return{enableNumber:!1,number:20}}function xb(){return{enableNumber:!1,number:100}}function Mb(){return{maxSeconds:5}}var Fi=(e=>(e.NONE="none",e.INSERT="insert",e.APPEND="append",e.OVERWRITE="overwrite",e))(Fi||{});function tr(){return{startCriteria:Cb(),endCriteria:xb(),perMoveCriteria:Mb(),commentBehavior:"insert"}}function Xc(){return{name:"",uri:Qt}}function ir(){return{black:Xc(),white:Xc(),timeLimit:{timeSeconds:0,byoyomi:30,increment:0},enableEngineTimeout:!1,humanIsFront:!0,enableComment:!0,enableAutoSave:!0,repeat:1,swapPlayers:!1,maxMoves:1e3}}function rf(e){if(e.timeLimit.timeSeconds===0&&e.timeLimit.byoyomi===0)return new Error("0");if(e.timeLimit.byoyomi!==0&&e.timeLimit.increment!==0)return new Error("")}function Tb(e){const t=rf(e);if(t)return t;if(e.enableAutoSave)return new Error("Web")}function Ga(){return{}}function Rb(e){if(!e.usi)return new Error("");for(const t of e.secondaries||[])if(!t.usi)return new Error("")}const Ob={async getRecordPathFromProcArg(){return""},updateAppState(){},openExplorer(){},async showOpenRecordDialog(){throw new Error("Web")},async openRecord(){throw new Error("Web")},async showSaveRecordDialog(){throw new Error("Web")},async saveRecord(){throw new Error("Web")},async showSelectFileDialog(){throw new Error("Web")},async showSelectDirectoryDialog(){throw new Error("Web")},async loadAppSetting(){const e=localStorage.getItem("appSetting");return JSON.stringify(e?{...Ha(),...JSON.parse(e)}:Ha())},async saveAppSetting(e){localStorage.setItem("appSetting",e)},async loadResearchSetting(){const e=localStorage.getItem("researchSetting");return JSON.stringify(e?{...Ga(),...JSON.parse(e)}:Ga())},async saveResearchSetting(e){localStorage.setItem("researchSetting",e)},async loadAnalysisSetting(){const e=localStorage.getItem("analysisSetting");return JSON.stringify(e?{...tr(),...JSON.parse(e)}:tr())},async saveAnalysisSetting(e){localStorage.setItem("analysisSetting",e)},async loadGameSetting(){const e=localStorage.getItem("gameSetting");return JSON.stringify(e?{...ir(),...JSON.parse(e)}:ir())},async saveGameSetting(e){localStorage.setItem("gameSetting",e)},async loadCSAGameSettingHistory(){throw new Error("Web")},async saveCSAGameSettingHistory(e){localStorage.setItem("csaGameSettingHistory",e)},async loadUSIEngineSetting(){return new Wi().json},async saveUSIEngineSetting(){},async showSelectUSIEngineDialog(){throw new Error("Web")},async getUSIEngineInfo(){throw new Error("Web")},async sendUSISetOption(){},async usiLaunch(){throw new Error("Web")},async usiGo(){},async usiGoPonder(){},async usiPonderHit(){},async usiGoInfinite(){},async usiStop(){},async usiGameover(){},async usiQuit(){},async csaLogin(){throw new Error("Web")},async csaLogout(){},async csaAgree(){},async csaMove(){},async csaResign(){},async csaWin(){},async csaStop(){},async isEncryptionAvailable(){return!1},log(e,t){switch(e){case mt.DEBUG:console.debug(t);break;case mt.INFO:console.log(t);break;case mt.WARN:console.warn(t);break;case mt.ERROR:console.error(t);break}},onSendError(){},onMenuEvent(){},onUSIBestMove(){},onUSIInfo(){},onUSIPonderInfo(){},onCSAGameSummary(){},onCSAReject(){},onCSAStart(){},onCSAMove(){},onCSAGameResult(){},onCSAClose(){}};function Bl(){return window}const af=Bl().electronShogi||{},ze=Bl().electronShogiAPI||Ob,fe={...ze,async loadAppSetting(){return JSON.parse(await ze.loadAppSetting())},saveAppSetting(e){return ze.saveAppSetting(JSON.stringify(e))},async loadResearchSetting(){return JSON.parse(await ze.loadResearchSetting())},saveResearchSetting(e){return ze.saveResearchSetting(JSON.stringify(e))},async loadAnalysisSetting(){return JSON.parse(await ze.loadAnalysisSetting())},saveAnalysisSetting(e){return ze.saveAnalysisSetting(JSON.stringify(e))},async loadGameSetting(){return JSON.parse(await ze.loadGameSetting())},saveGameSetting(e){return ze.saveGameSetting(JSON.stringify(e))},async loadCSAGameSettingHistory(){return JSON.parse(await ze.loadCSAGameSettingHistory())},saveCSAGameSettingHistory(e){return ze.saveCSAGameSettingHistory(JSON.stringify(e))},async loadUSIEngineSetting(){return new Wi(await ze.loadUSIEngineSetting())},saveUSIEngineSetting(e){return ze.saveUSIEngineSetting(e.json)},async getUSIEngineInfo(e,t){return JSON.parse(await ze.getUSIEngineInfo(e,t))},usiLaunch(e,t){return ze.usiLaunch(JSON.stringify(e),t)},usiGo(e,t,i,n,s){return ze.usiGo(e,t,JSON.stringify(i),n,s)},usiGoPonder(e,t,i,n,s){return ze.usiGoPonder(e,t,JSON.stringify(i),n,s)},csaLogin(e){return ze.csaLogin(JSON.stringify(e))}};function nr(){return!!Bl().electronShogiAPI}let ks;function lf(e){if(ks)return;const t=(e==null?void 0:e.type)||"sine",i=(e==null?void 0:e.frequency)||440,n=(e==null?void 0:e.volume)||2,s=new AudioContext,o=s.createOscillator(),r=s.createGain();o.connect(r),r.connect(s.destination),o.type=t,o.frequency.value=i,r.gain.value=n*.005,o.onended=()=>{r.disconnect(s.destination),o.disconnect(r)},o.start(s.currentTime),e!=null&&e.time&&o.stop(s.currentTime+e.time),e!=null&&e.time||(ks=o)}function Nb(e){lf({type:"sine",frequency:e.frequency,time:.1,volume:e.volume})}function Lb(e){lf({type:"sine",frequency:e.frequency,volume:e.volume})}function Jc(){ks&&(ks.stop(),ks=void 0)}let qr;function Yr(e){const t=Date.now();if(qr&&t<qr+200)return;const i=new Audio("sound/piece.mp3");i.volume=e*.01,i.play(),qr=t}function cf(e){return(e||new Date).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit"})}function Qc(e){return(e||new Date).toLocaleTimeString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function Bb(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var i=function n(){if(this instanceof n){var s=[null];s.push.apply(s,arguments);var o=Function.bind.apply(t,s);return new o}return t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),i}var sr={},Db={get exports(){return sr},set exports(e){sr=e}},Dl={},Tr={};Tr.byteLength=Hb;Tr.toByteArray=zb;Tr.fromByteArray=Vb;var Ii=[],si=[],Fb=typeof Uint8Array<"u"?Uint8Array:Array,Xr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var On=0,$b=Xr.length;On<$b;++On)Ii[On]=Xr[On],si[Xr.charCodeAt(On)]=On;si["-".charCodeAt(0)]=62;si["_".charCodeAt(0)]=63;function uf(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");i===-1&&(i=t);var n=i===t?0:4-i%4;return[i,n]}function Hb(e){var t=uf(e),i=t[0],n=t[1];return(i+n)*3/4-n}function Ub(e,t,i){return(t+i)*3/4-i}function zb(e){var t,i=uf(e),n=i[0],s=i[1],o=new Fb(Ub(e,n,s)),r=0,a=s>0?n-4:n,l;for(l=0;l<a;l+=4)t=si[e.charCodeAt(l)]<<18|si[e.charCodeAt(l+1)]<<12|si[e.charCodeAt(l+2)]<<6|si[e.charCodeAt(l+3)],o[r++]=t>>16&255,o[r++]=t>>8&255,o[r++]=t&255;return s===2&&(t=si[e.charCodeAt(l)]<<2|si[e.charCodeAt(l+1)]>>4,o[r++]=t&255),s===1&&(t=si[e.charCodeAt(l)]<<10|si[e.charCodeAt(l+1)]<<4|si[e.charCodeAt(l+2)]>>2,o[r++]=t>>8&255,o[r++]=t&255),o}function Wb(e){return Ii[e>>18&63]+Ii[e>>12&63]+Ii[e>>6&63]+Ii[e&63]}function Gb(e,t,i){for(var n,s=[],o=t;o<i;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),s.push(Wb(n));return s.join("")}function Vb(e){for(var t,i=e.length,n=i%3,s=[],o=16383,r=0,a=i-n;r<a;r+=o)s.push(Gb(e,r,r+o>a?a:r+o));return n===1?(t=e[i-1],s.push(Ii[t>>2]+Ii[t<<4&63]+"==")):n===2&&(t=(e[i-2]<<8)+e[i-1],s.push(Ii[t>>10]+Ii[t>>4&63]+Ii[t<<2&63]+"=")),s.join("")}var Fl={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Fl.read=function(e,t,i,n,s){var o,r,a=s*8-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=i?s-1:0,f=i?-1:1,g=e[t+h];for(h+=f,o=g&(1<<-u)-1,g>>=-u,u+=a;u>0;o=o*256+e[t+h],h+=f,u-=8);for(r=o&(1<<-u)-1,o>>=-u,u+=n;u>0;r=r*256+e[t+h],h+=f,u-=8);if(o===0)o=1-c;else{if(o===l)return r?NaN:(g?-1:1)*(1/0);r=r+Math.pow(2,n),o=o-c}return(g?-1:1)*r*Math.pow(2,o-n)};Fl.write=function(e,t,i,n,s,o){var r,a,l,c=o*8-s-1,u=(1<<c)-1,h=u>>1,f=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:o-1,_=n?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,r=u):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),r+h>=1?t+=f/l:t+=f*Math.pow(2,1-h),t*l>=2&&(r++,l/=2),r+h>=u?(a=0,r=u):r+h>=1?(a=(t*l-1)*Math.pow(2,s),r=r+h):(a=t*Math.pow(2,h-1)*Math.pow(2,s),r=0));s>=8;e[i+g]=a&255,g+=_,a/=256,s-=8);for(r=r<<s|a,c+=s;c>0;e[i+g]=r&255,g+=_,r/=256,c-=8);e[i+g-_]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=Tr,i=Fl,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=E,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const S=new Uint8Array(1),d={foo:function(){return 42}};return Object.setPrototypeOf(d,Uint8Array.prototype),Object.setPrototypeOf(S,d),S.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function r(S){if(S>s)throw new RangeError('The value "'+S+'" is invalid for option "size"');const d=new Uint8Array(S);return Object.setPrototypeOf(d,a.prototype),d}function a(S,d,m){if(typeof S=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(S)}return l(S,d,m)}a.poolSize=8192;function l(S,d,m){if(typeof S=="string")return f(S,d);if(ArrayBuffer.isView(S))return _(S);if(S==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S);if(he(S,ArrayBuffer)||S&&he(S.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(he(S,SharedArrayBuffer)||S&&he(S.buffer,SharedArrayBuffer)))return b(S,d,m);if(typeof S=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const I=S.valueOf&&S.valueOf();if(I!=null&&I!==S)return a.from(I,d,m);const x=v(S);if(x)return x;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof S[Symbol.toPrimitive]=="function")return a.from(S[Symbol.toPrimitive]("string"),d,m);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S)}a.from=function(S,d,m){return l(S,d,m)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(S){if(typeof S!="number")throw new TypeError('"size" argument must be of type number');if(S<0)throw new RangeError('The value "'+S+'" is invalid for option "size"')}function u(S,d,m){return c(S),S<=0?r(S):d!==void 0?typeof m=="string"?r(S).fill(d,m):r(S).fill(d):r(S)}a.alloc=function(S,d,m){return u(S,d,m)};function h(S){return c(S),r(S<0?0:y(S)|0)}a.allocUnsafe=function(S){return h(S)},a.allocUnsafeSlow=function(S){return h(S)};function f(S,d){if((typeof d!="string"||d==="")&&(d="utf8"),!a.isEncoding(d))throw new TypeError("Unknown encoding: "+d);const m=w(S,d)|0;let I=r(m);const x=I.write(S,d);return x!==m&&(I=I.slice(0,x)),I}function g(S){const d=S.length<0?0:y(S.length)|0,m=r(d);for(let I=0;I<d;I+=1)m[I]=S[I]&255;return m}function _(S){if(he(S,Uint8Array)){const d=new Uint8Array(S);return b(d.buffer,d.byteOffset,d.byteLength)}return g(S)}function b(S,d,m){if(d<0||S.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(S.byteLength<d+(m||0))throw new RangeError('"length" is outside of buffer bounds');let I;return d===void 0&&m===void 0?I=new Uint8Array(S):m===void 0?I=new Uint8Array(S,d):I=new Uint8Array(S,d,m),Object.setPrototypeOf(I,a.prototype),I}function v(S){if(a.isBuffer(S)){const d=y(S.length)|0,m=r(d);return m.length===0||S.copy(m,0,0,d),m}if(S.length!==void 0)return typeof S.length!="number"||de(S.length)?r(0):g(S);if(S.type==="Buffer"&&Array.isArray(S.data))return g(S.data)}function y(S){if(S>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return S|0}function E(S){return+S!=S&&(S=0),a.alloc(+S)}a.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==a.prototype},a.compare=function(d,m){if(he(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),he(m,Uint8Array)&&(m=a.from(m,m.offset,m.byteLength)),!a.isBuffer(d)||!a.isBuffer(m))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===m)return 0;let I=d.length,x=m.length;for(let N=0,H=Math.min(I,x);N<H;++N)if(d[N]!==m[N]){I=d[N],x=m[N];break}return I<x?-1:x<I?1:0},a.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(d,m){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return a.alloc(0);let I;if(m===void 0)for(m=0,I=0;I<d.length;++I)m+=d[I].length;const x=a.allocUnsafe(m);let N=0;for(I=0;I<d.length;++I){let H=d[I];if(he(H,Uint8Array))N+H.length>x.length?(a.isBuffer(H)||(H=a.from(H)),H.copy(x,N)):Uint8Array.prototype.set.call(x,H,N);else if(a.isBuffer(H))H.copy(x,N);else throw new TypeError('"list" argument must be an Array of Buffers');N+=H.length}return x};function w(S,d){if(a.isBuffer(S))return S.length;if(ArrayBuffer.isView(S)||he(S,ArrayBuffer))return S.byteLength;if(typeof S!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof S);const m=S.length,I=arguments.length>2&&arguments[2]===!0;if(!I&&m===0)return 0;let x=!1;for(;;)switch(d){case"ascii":case"latin1":case"binary":return m;case"utf8":case"utf-8":return X(S).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m*2;case"hex":return m>>>1;case"base64":return Z(S).length;default:if(x)return I?-1:X(S).length;d=(""+d).toLowerCase(),x=!0}}a.byteLength=w;function P(S,d,m){let I=!1;if((d===void 0||d<0)&&(d=0),d>this.length||((m===void 0||m>this.length)&&(m=this.length),m<=0)||(m>>>=0,d>>>=0,m<=d))return"";for(S||(S="utf8");;)switch(S){case"hex":return ie(this,d,m);case"utf8":case"utf-8":return Re(this,d,m);case"ascii":return ee(this,d,m);case"latin1":case"binary":return ne(this,d,m);case"base64":return ae(this,d,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Le(this,d,m);default:if(I)throw new TypeError("Unknown encoding: "+S);S=(S+"").toLowerCase(),I=!0}}a.prototype._isBuffer=!0;function A(S,d,m){const I=S[d];S[d]=S[m],S[m]=I}a.prototype.swap16=function(){const d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let m=0;m<d;m+=2)A(this,m,m+1);return this},a.prototype.swap32=function(){const d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let m=0;m<d;m+=4)A(this,m,m+3),A(this,m+1,m+2);return this},a.prototype.swap64=function(){const d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let m=0;m<d;m+=8)A(this,m,m+7),A(this,m+1,m+6),A(this,m+2,m+5),A(this,m+3,m+4);return this},a.prototype.toString=function(){const d=this.length;return d===0?"":arguments.length===0?Re(this,0,d):P.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(d){if(!a.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:a.compare(this,d)===0},a.prototype.inspect=function(){let d="";const m=e.INSPECT_MAX_BYTES;return d=this.toString("hex",0,m).replace(/(.{2})/g,"$1 ").trim(),this.length>m&&(d+=" ... "),"<Buffer "+d+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(d,m,I,x,N){if(he(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),!a.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(m===void 0&&(m=0),I===void 0&&(I=d?d.length:0),x===void 0&&(x=0),N===void 0&&(N=this.length),m<0||I>d.length||x<0||N>this.length)throw new RangeError("out of range index");if(x>=N&&m>=I)return 0;if(x>=N)return-1;if(m>=I)return 1;if(m>>>=0,I>>>=0,x>>>=0,N>>>=0,this===d)return 0;let H=N-x,Ae=I-m;const Oe=Math.min(H,Ae),Be=this.slice(x,N),et=d.slice(m,I);for(let Je=0;Je<Oe;++Je)if(Be[Je]!==et[Je]){H=Be[Je],Ae=et[Je];break}return H<Ae?-1:Ae<H?1:0};function O(S,d,m,I,x){if(S.length===0)return-1;if(typeof m=="string"?(I=m,m=0):m>2147483647?m=2147483647:m<-2147483648&&(m=-2147483648),m=+m,de(m)&&(m=x?0:S.length-1),m<0&&(m=S.length+m),m>=S.length){if(x)return-1;m=S.length-1}else if(m<0)if(x)m=0;else return-1;if(typeof d=="string"&&(d=a.from(d,I)),a.isBuffer(d))return d.length===0?-1:U(S,d,m,I,x);if(typeof d=="number")return d=d&255,typeof Uint8Array.prototype.indexOf=="function"?x?Uint8Array.prototype.indexOf.call(S,d,m):Uint8Array.prototype.lastIndexOf.call(S,d,m):U(S,[d],m,I,x);throw new TypeError("val must be string, number or Buffer")}function U(S,d,m,I,x){let N=1,H=S.length,Ae=d.length;if(I!==void 0&&(I=String(I).toLowerCase(),I==="ucs2"||I==="ucs-2"||I==="utf16le"||I==="utf-16le")){if(S.length<2||d.length<2)return-1;N=2,H/=2,Ae/=2,m/=2}function Oe(et,Je){return N===1?et[Je]:et.readUInt16BE(Je*N)}let Be;if(x){let et=-1;for(Be=m;Be<H;Be++)if(Oe(S,Be)===Oe(d,et===-1?0:Be-et)){if(et===-1&&(et=Be),Be-et+1===Ae)return et*N}else et!==-1&&(Be-=Be-et),et=-1}else for(m+Ae>H&&(m=H-Ae),Be=m;Be>=0;Be--){let et=!0;for(let Je=0;Je<Ae;Je++)if(Oe(S,Be+Je)!==Oe(d,Je)){et=!1;break}if(et)return Be}return-1}a.prototype.includes=function(d,m,I){return this.indexOf(d,m,I)!==-1},a.prototype.indexOf=function(d,m,I){return O(this,d,m,I,!0)},a.prototype.lastIndexOf=function(d,m,I){return O(this,d,m,I,!1)};function z(S,d,m,I){m=Number(m)||0;const x=S.length-m;I?(I=Number(I),I>x&&(I=x)):I=x;const N=d.length;I>N/2&&(I=N/2);let H;for(H=0;H<I;++H){const Ae=parseInt(d.substr(H*2,2),16);if(de(Ae))return H;S[m+H]=Ae}return H}function te(S,d,m,I){return q(X(d,S.length-m),S,m,I)}function G(S,d,m,I){return q(se(d),S,m,I)}function Q(S,d,m,I){return q(Z(d),S,m,I)}function Se(S,d,m,I){return q(J(d,S.length-m),S,m,I)}a.prototype.write=function(d,m,I,x){if(m===void 0)x="utf8",I=this.length,m=0;else if(I===void 0&&typeof m=="string")x=m,I=this.length,m=0;else if(isFinite(m))m=m>>>0,isFinite(I)?(I=I>>>0,x===void 0&&(x="utf8")):(x=I,I=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const N=this.length-m;if((I===void 0||I>N)&&(I=N),d.length>0&&(I<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");x||(x="utf8");let H=!1;for(;;)switch(x){case"hex":return z(this,d,m,I);case"utf8":case"utf-8":return te(this,d,m,I);case"ascii":case"latin1":case"binary":return G(this,d,m,I);case"base64":return Q(this,d,m,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Se(this,d,m,I);default:if(H)throw new TypeError("Unknown encoding: "+x);x=(""+x).toLowerCase(),H=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ae(S,d,m){return d===0&&m===S.length?t.fromByteArray(S):t.fromByteArray(S.slice(d,m))}function Re(S,d,m){m=Math.min(S.length,m);const I=[];let x=d;for(;x<m;){const N=S[x];let H=null,Ae=N>239?4:N>223?3:N>191?2:1;if(x+Ae<=m){let Oe,Be,et,Je;switch(Ae){case 1:N<128&&(H=N);break;case 2:Oe=S[x+1],(Oe&192)===128&&(Je=(N&31)<<6|Oe&63,Je>127&&(H=Je));break;case 3:Oe=S[x+1],Be=S[x+2],(Oe&192)===128&&(Be&192)===128&&(Je=(N&15)<<12|(Oe&63)<<6|Be&63,Je>2047&&(Je<55296||Je>57343)&&(H=Je));break;case 4:Oe=S[x+1],Be=S[x+2],et=S[x+3],(Oe&192)===128&&(Be&192)===128&&(et&192)===128&&(Je=(N&15)<<18|(Oe&63)<<12|(Be&63)<<6|et&63,Je>65535&&Je<1114112&&(H=Je))}}H===null?(H=65533,Ae=1):H>65535&&(H-=65536,I.push(H>>>10&1023|55296),H=56320|H&1023),I.push(H),x+=Ae}return we(I)}const Ee=4096;function we(S){const d=S.length;if(d<=Ee)return String.fromCharCode.apply(String,S);let m="",I=0;for(;I<d;)m+=String.fromCharCode.apply(String,S.slice(I,I+=Ee));return m}function ee(S,d,m){let I="";m=Math.min(S.length,m);for(let x=d;x<m;++x)I+=String.fromCharCode(S[x]&127);return I}function ne(S,d,m){let I="";m=Math.min(S.length,m);for(let x=d;x<m;++x)I+=String.fromCharCode(S[x]);return I}function ie(S,d,m){const I=S.length;(!d||d<0)&&(d=0),(!m||m<0||m>I)&&(m=I);let x="";for(let N=d;N<m;++N)x+=pe[S[N]];return x}function Le(S,d,m){const I=S.slice(d,m);let x="";for(let N=0;N<I.length-1;N+=2)x+=String.fromCharCode(I[N]+I[N+1]*256);return x}a.prototype.slice=function(d,m){const I=this.length;d=~~d,m=m===void 0?I:~~m,d<0?(d+=I,d<0&&(d=0)):d>I&&(d=I),m<0?(m+=I,m<0&&(m=0)):m>I&&(m=I),m<d&&(m=d);const x=this.subarray(d,m);return Object.setPrototypeOf(x,a.prototype),x};function ke(S,d,m){if(S%1!==0||S<0)throw new RangeError("offset is not uint");if(S+d>m)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(d,m,I){d=d>>>0,m=m>>>0,I||ke(d,m,this.length);let x=this[d],N=1,H=0;for(;++H<m&&(N*=256);)x+=this[d+H]*N;return x},a.prototype.readUintBE=a.prototype.readUIntBE=function(d,m,I){d=d>>>0,m=m>>>0,I||ke(d,m,this.length);let x=this[d+--m],N=1;for(;m>0&&(N*=256);)x+=this[d+--m]*N;return x},a.prototype.readUint8=a.prototype.readUInt8=function(d,m){return d=d>>>0,m||ke(d,1,this.length),this[d]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(d,m){return d=d>>>0,m||ke(d,2,this.length),this[d]|this[d+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(d,m){return d=d>>>0,m||ke(d,2,this.length),this[d]<<8|this[d+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(d,m){return d=d>>>0,m||ke(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(d,m){return d=d>>>0,m||ke(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},a.prototype.readBigUInt64LE=me(function(d){d=d>>>0,T(d,"offset");const m=this[d],I=this[d+7];(m===void 0||I===void 0)&&D(d,this.length-8);const x=m+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24,N=this[++d]+this[++d]*2**8+this[++d]*2**16+I*2**24;return BigInt(x)+(BigInt(N)<<BigInt(32))}),a.prototype.readBigUInt64BE=me(function(d){d=d>>>0,T(d,"offset");const m=this[d],I=this[d+7];(m===void 0||I===void 0)&&D(d,this.length-8);const x=m*2**24+this[++d]*2**16+this[++d]*2**8+this[++d],N=this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+I;return(BigInt(x)<<BigInt(32))+BigInt(N)}),a.prototype.readIntLE=function(d,m,I){d=d>>>0,m=m>>>0,I||ke(d,m,this.length);let x=this[d],N=1,H=0;for(;++H<m&&(N*=256);)x+=this[d+H]*N;return N*=128,x>=N&&(x-=Math.pow(2,8*m)),x},a.prototype.readIntBE=function(d,m,I){d=d>>>0,m=m>>>0,I||ke(d,m,this.length);let x=m,N=1,H=this[d+--x];for(;x>0&&(N*=256);)H+=this[d+--x]*N;return N*=128,H>=N&&(H-=Math.pow(2,8*m)),H},a.prototype.readInt8=function(d,m){return d=d>>>0,m||ke(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},a.prototype.readInt16LE=function(d,m){d=d>>>0,m||ke(d,2,this.length);const I=this[d]|this[d+1]<<8;return I&32768?I|4294901760:I},a.prototype.readInt16BE=function(d,m){d=d>>>0,m||ke(d,2,this.length);const I=this[d+1]|this[d]<<8;return I&32768?I|4294901760:I},a.prototype.readInt32LE=function(d,m){return d=d>>>0,m||ke(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},a.prototype.readInt32BE=function(d,m){return d=d>>>0,m||ke(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},a.prototype.readBigInt64LE=me(function(d){d=d>>>0,T(d,"offset");const m=this[d],I=this[d+7];(m===void 0||I===void 0)&&D(d,this.length-8);const x=this[d+4]+this[d+5]*2**8+this[d+6]*2**16+(I<<24);return(BigInt(x)<<BigInt(32))+BigInt(m+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24)}),a.prototype.readBigInt64BE=me(function(d){d=d>>>0,T(d,"offset");const m=this[d],I=this[d+7];(m===void 0||I===void 0)&&D(d,this.length-8);const x=(m<<24)+this[++d]*2**16+this[++d]*2**8+this[++d];return(BigInt(x)<<BigInt(32))+BigInt(this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+I)}),a.prototype.readFloatLE=function(d,m){return d=d>>>0,m||ke(d,4,this.length),i.read(this,d,!0,23,4)},a.prototype.readFloatBE=function(d,m){return d=d>>>0,m||ke(d,4,this.length),i.read(this,d,!1,23,4)},a.prototype.readDoubleLE=function(d,m){return d=d>>>0,m||ke(d,8,this.length),i.read(this,d,!0,52,8)},a.prototype.readDoubleBE=function(d,m){return d=d>>>0,m||ke(d,8,this.length),i.read(this,d,!1,52,8)};function ge(S,d,m,I,x,N){if(!a.isBuffer(S))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>x||d<N)throw new RangeError('"value" argument is out of bounds');if(m+I>S.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(d,m,I,x){if(d=+d,m=m>>>0,I=I>>>0,!x){const Ae=Math.pow(2,8*I)-1;ge(this,d,m,I,Ae,0)}let N=1,H=0;for(this[m]=d&255;++H<I&&(N*=256);)this[m+H]=d/N&255;return m+I},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(d,m,I,x){if(d=+d,m=m>>>0,I=I>>>0,!x){const Ae=Math.pow(2,8*I)-1;ge(this,d,m,I,Ae,0)}let N=I-1,H=1;for(this[m+N]=d&255;--N>=0&&(H*=256);)this[m+N]=d/H&255;return m+I},a.prototype.writeUint8=a.prototype.writeUInt8=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,1,255,0),this[m]=d&255,m+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,2,65535,0),this[m]=d&255,this[m+1]=d>>>8,m+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,2,65535,0),this[m]=d>>>8,this[m+1]=d&255,m+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,4,4294967295,0),this[m+3]=d>>>24,this[m+2]=d>>>16,this[m+1]=d>>>8,this[m]=d&255,m+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,4,4294967295,0),this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=d&255,m+4};function ut(S,d,m,I,x){C(d,I,x,S,m,7);let N=Number(d&BigInt(4294967295));S[m++]=N,N=N>>8,S[m++]=N,N=N>>8,S[m++]=N,N=N>>8,S[m++]=N;let H=Number(d>>BigInt(32)&BigInt(4294967295));return S[m++]=H,H=H>>8,S[m++]=H,H=H>>8,S[m++]=H,H=H>>8,S[m++]=H,m}function ht(S,d,m,I,x){C(d,I,x,S,m,7);let N=Number(d&BigInt(4294967295));S[m+7]=N,N=N>>8,S[m+6]=N,N=N>>8,S[m+5]=N,N=N>>8,S[m+4]=N;let H=Number(d>>BigInt(32)&BigInt(4294967295));return S[m+3]=H,H=H>>8,S[m+2]=H,H=H>>8,S[m+1]=H,H=H>>8,S[m]=H,m+8}a.prototype.writeBigUInt64LE=me(function(d,m=0){return ut(this,d,m,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=me(function(d,m=0){return ht(this,d,m,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(d,m,I,x){if(d=+d,m=m>>>0,!x){const Oe=Math.pow(2,8*I-1);ge(this,d,m,I,Oe-1,-Oe)}let N=0,H=1,Ae=0;for(this[m]=d&255;++N<I&&(H*=256);)d<0&&Ae===0&&this[m+N-1]!==0&&(Ae=1),this[m+N]=(d/H>>0)-Ae&255;return m+I},a.prototype.writeIntBE=function(d,m,I,x){if(d=+d,m=m>>>0,!x){const Oe=Math.pow(2,8*I-1);ge(this,d,m,I,Oe-1,-Oe)}let N=I-1,H=1,Ae=0;for(this[m+N]=d&255;--N>=0&&(H*=256);)d<0&&Ae===0&&this[m+N+1]!==0&&(Ae=1),this[m+N]=(d/H>>0)-Ae&255;return m+I},a.prototype.writeInt8=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,1,127,-128),d<0&&(d=255+d+1),this[m]=d&255,m+1},a.prototype.writeInt16LE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,2,32767,-32768),this[m]=d&255,this[m+1]=d>>>8,m+2},a.prototype.writeInt16BE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,2,32767,-32768),this[m]=d>>>8,this[m+1]=d&255,m+2},a.prototype.writeInt32LE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,4,2147483647,-2147483648),this[m]=d&255,this[m+1]=d>>>8,this[m+2]=d>>>16,this[m+3]=d>>>24,m+4},a.prototype.writeInt32BE=function(d,m,I){return d=+d,m=m>>>0,I||ge(this,d,m,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=d&255,m+4},a.prototype.writeBigInt64LE=me(function(d,m=0){return ut(this,d,m,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=me(function(d,m=0){return ht(this,d,m,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function St(S,d,m,I,x,N){if(m+I>S.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("Index out of range")}function Xe(S,d,m,I,x){return d=+d,m=m>>>0,x||St(S,d,m,4),i.write(S,d,m,I,23,4),m+4}a.prototype.writeFloatLE=function(d,m,I){return Xe(this,d,m,!0,I)},a.prototype.writeFloatBE=function(d,m,I){return Xe(this,d,m,!1,I)};function Pt(S,d,m,I,x){return d=+d,m=m>>>0,x||St(S,d,m,8),i.write(S,d,m,I,52,8),m+8}a.prototype.writeDoubleLE=function(d,m,I){return Pt(this,d,m,!0,I)},a.prototype.writeDoubleBE=function(d,m,I){return Pt(this,d,m,!1,I)},a.prototype.copy=function(d,m,I,x){if(!a.isBuffer(d))throw new TypeError("argument should be a Buffer");if(I||(I=0),!x&&x!==0&&(x=this.length),m>=d.length&&(m=d.length),m||(m=0),x>0&&x<I&&(x=I),x===I||d.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(I<0||I>=this.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("sourceEnd out of bounds");x>this.length&&(x=this.length),d.length-m<x-I&&(x=d.length-m+I);const N=x-I;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(m,I,x):Uint8Array.prototype.set.call(d,this.subarray(I,x),m),N},a.prototype.fill=function(d,m,I,x){if(typeof d=="string"){if(typeof m=="string"?(x=m,m=0,I=this.length):typeof I=="string"&&(x=I,I=this.length),x!==void 0&&typeof x!="string")throw new TypeError("encoding must be a string");if(typeof x=="string"&&!a.isEncoding(x))throw new TypeError("Unknown encoding: "+x);if(d.length===1){const H=d.charCodeAt(0);(x==="utf8"&&H<128||x==="latin1")&&(d=H)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(m<0||this.length<m||this.length<I)throw new RangeError("Out of range index");if(I<=m)return this;m=m>>>0,I=I===void 0?this.length:I>>>0,d||(d=0);let N;if(typeof d=="number")for(N=m;N<I;++N)this[N]=d;else{const H=a.isBuffer(d)?d:a.from(d,x),Ae=H.length;if(Ae===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(N=0;N<I-m;++N)this[N+m]=H[N%Ae]}return this};const Ke={};function wt(S,d,m){Ke[S]=class extends m{constructor(){super(),Object.defineProperty(this,"message",{value:d.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${S}]`,this.stack,delete this.name}get code(){return S}set code(x){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:x,writable:!0})}toString(){return`${this.name} [${S}]: ${this.message}`}}}wt("ERR_BUFFER_OUT_OF_BOUNDS",function(S){return S?`${S} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),wt("ERR_INVALID_ARG_TYPE",function(S,d){return`The "${S}" argument must be of type number. Received type ${typeof d}`},TypeError),wt("ERR_OUT_OF_RANGE",function(S,d,m){let I=`The value of "${S}" is out of range.`,x=m;return Number.isInteger(m)&&Math.abs(m)>2**32?x=ii(String(m)):typeof m=="bigint"&&(x=String(m),(m>BigInt(2)**BigInt(32)||m<-(BigInt(2)**BigInt(32)))&&(x=ii(x)),x+="n"),I+=` It must be ${d}. Received ${x}`,I},RangeError);function ii(S){let d="",m=S.length;const I=S[0]==="-"?1:0;for(;m>=I+4;m-=3)d=`_${S.slice(m-3,m)}${d}`;return`${S.slice(0,m)}${d}`}function mi(S,d,m){T(d,"offset"),(S[d]===void 0||S[d+m]===void 0)&&D(d,S.length-(m+1))}function C(S,d,m,I,x,N){if(S>m||S<d){const H=typeof d=="bigint"?"n":"";let Ae;throw N>3?d===0||d===BigInt(0)?Ae=`>= 0${H} and < 2${H} ** ${(N+1)*8}${H}`:Ae=`>= -(2${H} ** ${(N+1)*8-1}${H}) and < 2 ** ${(N+1)*8-1}${H}`:Ae=`>= ${d}${H} and <= ${m}${H}`,new Ke.ERR_OUT_OF_RANGE("value",Ae,S)}mi(I,x,N)}function T(S,d){if(typeof S!="number")throw new Ke.ERR_INVALID_ARG_TYPE(d,"number",S)}function D(S,d,m){throw Math.floor(S)!==S?(T(S,m),new Ke.ERR_OUT_OF_RANGE(m||"offset","an integer",S)):d<0?new Ke.ERR_BUFFER_OUT_OF_BOUNDS:new Ke.ERR_OUT_OF_RANGE(m||"offset",`>= ${m?1:0} and <= ${d}`,S)}const V=/[^+/0-9A-Za-z-_]/g;function j(S){if(S=S.split("=")[0],S=S.trim().replace(V,""),S.length<2)return"";for(;S.length%4!==0;)S=S+"=";return S}function X(S,d){d=d||1/0;let m;const I=S.length;let x=null;const N=[];for(let H=0;H<I;++H){if(m=S.charCodeAt(H),m>55295&&m<57344){if(!x){if(m>56319){(d-=3)>-1&&N.push(239,191,189);continue}else if(H+1===I){(d-=3)>-1&&N.push(239,191,189);continue}x=m;continue}if(m<56320){(d-=3)>-1&&N.push(239,191,189),x=m;continue}m=(x-55296<<10|m-56320)+65536}else x&&(d-=3)>-1&&N.push(239,191,189);if(x=null,m<128){if((d-=1)<0)break;N.push(m)}else if(m<2048){if((d-=2)<0)break;N.push(m>>6|192,m&63|128)}else if(m<65536){if((d-=3)<0)break;N.push(m>>12|224,m>>6&63|128,m&63|128)}else if(m<1114112){if((d-=4)<0)break;N.push(m>>18|240,m>>12&63|128,m>>6&63|128,m&63|128)}else throw new Error("Invalid code point")}return N}function se(S){const d=[];for(let m=0;m<S.length;++m)d.push(S.charCodeAt(m)&255);return d}function J(S,d){let m,I,x;const N=[];for(let H=0;H<S.length&&!((d-=2)<0);++H)m=S.charCodeAt(H),I=m>>8,x=m%256,N.push(x),N.push(I);return N}function Z(S){return t.toByteArray(j(S))}function q(S,d,m,I){let x;for(x=0;x<I&&!(x+m>=d.length||x>=S.length);++x)d[x+m]=S[x];return x}function he(S,d){return S instanceof d||S!=null&&S.constructor!=null&&S.constructor.name!=null&&S.constructor.name===d.name}function de(S){return S!==S}const pe=function(){const S="0123456789abcdef",d=new Array(256);for(let m=0;m<16;++m){const I=m*16;for(let x=0;x<16;++x)d[I+x]=S[m]+S[x]}return d}();function me(S){return typeof BigInt>"u"?xe:S}function xe(){throw new Error("BigInt not supported")}})(Dl);var xo=Dl,Wn=xo.Buffer,ri={},ai;for(ai in xo)xo.hasOwnProperty(ai)&&(ai==="SlowBuffer"||ai==="Buffer"||(ri[ai]=xo[ai]));var Gn=ri.Buffer={};for(ai in Wn)Wn.hasOwnProperty(ai)&&(ai==="allocUnsafe"||ai==="allocUnsafeSlow"||(Gn[ai]=Wn[ai]));ri.Buffer.prototype=Wn.prototype;(!Gn.from||Gn.from===Uint8Array.from)&&(Gn.from=function(e,t,i){if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&typeof e.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return Wn(e,t,i)});Gn.alloc||(Gn.alloc=function(e,t,i){if(typeof e!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=Wn(e);return!t||t.length===0?n.fill(0):typeof i=="string"?n.fill(t,i):n.fill(t),n});if(!ri.kStringMaxLength)try{ri.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}ri.constants||(ri.constants={MAX_LENGTH:ri.kMaxLength},ri.kStringMaxLength&&(ri.constants.MAX_STRING_LENGTH=ri.kStringMaxLength));var on=ri,$l={},hf="\uFEFF";$l.PrependBOM=Hl;function Hl(e,t){this.encoder=e,this.addBOM=!0}Hl.prototype.write=function(e){return this.addBOM&&(e=hf+e,this.addBOM=!1),this.encoder.write(e)};Hl.prototype.end=function(){return this.encoder.end()};$l.StripBOM=Ul;function Ul(e,t){this.decoder=e,this.pass=!1,this.options=t||{}}Ul.prototype.write=function(e){var t=this.decoder.write(e);return this.pass||!t||(t[0]===hf&&(t=t.slice(1),typeof this.options.stripBOM=="function"&&this.options.stripBOM()),this.pass=!0),t};Ul.prototype.end=function(){return this.decoder.end()};var Jr={},Qr={},Is={},jb={get exports(){return Is},set exports(e){Is=e}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var Zc;function Kb(){return Zc||(Zc=1,function(e,t){var i=Dl,n=i.Buffer;function s(r,a){for(var l in r)a[l]=r[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(s(i,t),t.Buffer=o);function o(r,a,l){return n(r,a,l)}o.prototype=Object.create(n.prototype),s(n,o),o.from=function(r,a,l){if(typeof r=="number")throw new TypeError("Argument must not be a number");return n(r,a,l)},o.alloc=function(r,a,l){if(typeof r!="number")throw new TypeError("Argument must be a number");var c=n(r);return a!==void 0?typeof l=="string"?c.fill(a,l):c.fill(a):c.fill(0),c},o.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return n(r)},o.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(r)}}(jb,Is)),Is}var eu;function qb(){if(eu)return Qr;eu=1;var e=Kb().Buffer,t=e.isEncoding||function(y){switch(y=""+y,y&&y.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(y){if(!y)return"utf8";for(var E;;)switch(y){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return y;default:if(E)return;y=(""+y).toLowerCase(),E=!0}}function n(y){var E=i(y);if(typeof E!="string"&&(e.isEncoding===t||!t(y)))throw new Error("Unknown encoding: "+y);return E||y}Qr.StringDecoder=s;function s(y){this.encoding=n(y);var E;switch(this.encoding){case"utf16le":this.text=h,this.end=f,E=4;break;case"utf8":this.fillLast=l,E=4;break;case"base64":this.text=g,this.end=_,E=3;break;default:this.write=b,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(E)}s.prototype.write=function(y){if(y.length===0)return"";var E,w;if(this.lastNeed){if(E=this.fillLast(y),E===void 0)return"";w=this.lastNeed,this.lastNeed=0}else w=0;return w<y.length?E?E+this.text(y,w):this.text(y,w):E||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(y){if(this.lastNeed<=y.length)return y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,y.length),this.lastNeed-=y.length};function o(y){return y<=127?0:y>>5===6?2:y>>4===14?3:y>>3===30?4:y>>6===2?-1:-2}function r(y,E,w){var P=E.length-1;if(P<w)return 0;var A=o(E[P]);return A>=0?(A>0&&(y.lastNeed=A-1),A):--P<w||A===-2?0:(A=o(E[P]),A>=0?(A>0&&(y.lastNeed=A-2),A):--P<w||A===-2?0:(A=o(E[P]),A>=0?(A>0&&(A===2?A=0:y.lastNeed=A-3),A):0))}function a(y,E,w){if((E[0]&192)!==128)return y.lastNeed=0,"";if(y.lastNeed>1&&E.length>1){if((E[1]&192)!==128)return y.lastNeed=1,"";if(y.lastNeed>2&&E.length>2&&(E[2]&192)!==128)return y.lastNeed=2,""}}function l(y){var E=this.lastTotal-this.lastNeed,w=a(this,y);if(w!==void 0)return w;if(this.lastNeed<=y.length)return y.copy(this.lastChar,E,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,E,0,y.length),this.lastNeed-=y.length}function c(y,E){var w=r(this,y,E);if(!this.lastNeed)return y.toString("utf8",E);this.lastTotal=w;var P=y.length-(w-this.lastNeed);return y.copy(this.lastChar,0,P),y.toString("utf8",E,P)}function u(y){var E=y&&y.length?this.write(y):"";return this.lastNeed?E+"":E}function h(y,E){if((y.length-E)%2===0){var w=y.toString("utf16le",E);if(w){var P=w.charCodeAt(w.length-1);if(P>=55296&&P<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1],w.slice(0,-1)}return w}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=y[y.length-1],y.toString("utf16le",E,y.length-1)}function f(y){var E=y&&y.length?this.write(y):"";if(this.lastNeed){var w=this.lastTotal-this.lastNeed;return E+this.lastChar.toString("utf16le",0,w)}return E}function g(y,E){var w=(y.length-E)%3;return w===0?y.toString("base64",E):(this.lastNeed=3-w,this.lastTotal=3,w===1?this.lastChar[0]=y[y.length-1]:(this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1]),y.toString("base64",E,y.length-w))}function _(y){var E=y&&y.length?this.write(y):"";return this.lastNeed?E+this.lastChar.toString("base64",0,3-this.lastNeed):E}function b(y){return y.toString(this.encoding)}function v(y){return y&&y.length?this.write(y):""}return Qr}var Zr,tu;function Yb(){if(tu)return Zr;tu=1;var e=on.Buffer;Zr={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:t};function t(l,c){this.enc=l.encodingName,this.bomAware=l.bomAware,this.enc==="base64"?this.encoder=o:this.enc==="cesu8"&&(this.enc="utf8",this.encoder=r,e.from("eda0bdedb2a9","hex").toString()!==""&&(this.decoder=a,this.defaultCharUnicode=c.defaultCharUnicode))}t.prototype.encoder=s,t.prototype.decoder=n;var i=qb().StringDecoder;i.prototype.end||(i.prototype.end=function(){});function n(l,c){this.decoder=new i(c.enc)}n.prototype.write=function(l){return e.isBuffer(l)||(l=e.from(l)),this.decoder.write(l)},n.prototype.end=function(){return this.decoder.end()};function s(l,c){this.enc=c.enc}s.prototype.write=function(l){return e.from(l,this.enc)},s.prototype.end=function(){};function o(l,c){this.prevStr=""}o.prototype.write=function(l){l=this.prevStr+l;var c=l.length-l.length%4;return this.prevStr=l.slice(c),l=l.slice(0,c),e.from(l,"base64")},o.prototype.end=function(){return e.from(this.prevStr,"base64")};function r(l,c){}r.prototype.write=function(l){for(var c=e.alloc(l.length*3),u=0,h=0;h<l.length;h++){var f=l.charCodeAt(h);f<128?c[u++]=f:f<2048?(c[u++]=192+(f>>>6),c[u++]=128+(f&63)):(c[u++]=224+(f>>>12),c[u++]=128+(f>>>6&63),c[u++]=128+(f&63))}return c.slice(0,u)},r.prototype.end=function(){};function a(l,c){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=c.defaultCharUnicode}return a.prototype.write=function(l){for(var c=this.acc,u=this.contBytes,h=this.accBytes,f="",g=0;g<l.length;g++){var _=l[g];(_&192)!==128?(u>0&&(f+=this.defaultCharUnicode,u=0),_<128?f+=String.fromCharCode(_):_<224?(c=_&31,u=1,h=1):_<240?(c=_&15,u=2,h=1):f+=this.defaultCharUnicode):u>0?(c=c<<6|_&63,u--,h++,u===0&&(h===2&&c<128&&c>0?f+=this.defaultCharUnicode:h===3&&c<2048?f+=this.defaultCharUnicode:f+=String.fromCharCode(c))):f+=this.defaultCharUnicode}return this.acc=c,this.contBytes=u,this.accBytes=h,f},a.prototype.end=function(){var l=0;return this.contBytes>0&&(l+=this.defaultCharUnicode),l},Zr}var xi={},iu;function Xb(){if(iu)return xi;iu=1;var e=on.Buffer;xi._utf32=t;function t(c,u){this.iconv=u,this.bomAware=!0,this.isLE=c.isLE}xi.utf32le={type:"_utf32",isLE:!0},xi.utf32be={type:"_utf32",isLE:!1},xi.ucs4le="utf32le",xi.ucs4be="utf32be",t.prototype.encoder=i,t.prototype.decoder=n;function i(c,u){this.isLE=u.isLE,this.highSurrogate=0}i.prototype.write=function(c){for(var u=e.from(c,"ucs2"),h=e.alloc(u.length*2),f=this.isLE?h.writeUInt32LE:h.writeUInt32BE,g=0,_=0;_<u.length;_+=2){var b=u.readUInt16LE(_),v=55296<=b&&b<56320,y=56320<=b&&b<57344;if(this.highSurrogate)if(v||!y)f.call(h,this.highSurrogate,g),g+=4;else{var E=(this.highSurrogate-55296<<10|b-56320)+65536;f.call(h,E,g),g+=4,this.highSurrogate=0;continue}v?this.highSurrogate=b:(f.call(h,b,g),g+=4,this.highSurrogate=0)}return g<h.length&&(h=h.slice(0,g)),h},i.prototype.end=function(){if(this.highSurrogate){var c=e.alloc(4);return this.isLE?c.writeUInt32LE(this.highSurrogate,0):c.writeUInt32BE(this.highSurrogate,0),this.highSurrogate=0,c}};function n(c,u){this.isLE=u.isLE,this.badChar=u.iconv.defaultCharUnicode.charCodeAt(0),this.overflow=[]}n.prototype.write=function(c){if(c.length===0)return"";var u=0,h=0,f=e.alloc(c.length+4),g=0,_=this.isLE,b=this.overflow,v=this.badChar;if(b.length>0){for(;u<c.length&&b.length<4;u++)b.push(c[u]);b.length===4&&(_?h=b[u]|b[u+1]<<8|b[u+2]<<16|b[u+3]<<24:h=b[u+3]|b[u+2]<<8|b[u+1]<<16|b[u]<<24,b.length=0,g=s(f,g,h,v))}for(;u<c.length-3;u+=4)_?h=c[u]|c[u+1]<<8|c[u+2]<<16|c[u+3]<<24:h=c[u+3]|c[u+2]<<8|c[u+1]<<16|c[u]<<24,g=s(f,g,h,v);for(;u<c.length;u++)b.push(c[u]);return f.slice(0,g).toString("ucs2")};function s(c,u,h,f){if((h<0||h>1114111)&&(h=f),h>=65536){h-=65536;var g=55296|h>>10;c[u++]=g&255,c[u++]=g>>8;var h=56320|h&1023}return c[u++]=h&255,c[u++]=h>>8,u}n.prototype.end=function(){this.overflow.length=0},xi.utf32=o,xi.ucs4="utf32";function o(c,u){this.iconv=u}o.prototype.encoder=r,o.prototype.decoder=a;function r(c,u){c=c||{},c.addBOM===void 0&&(c.addBOM=!0),this.encoder=u.iconv.getEncoder(c.defaultEncoding||"utf-32le",c)}r.prototype.write=function(c){return this.encoder.write(c)},r.prototype.end=function(){return this.encoder.end()};function a(c,u){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=c||{},this.iconv=u.iconv}a.prototype.write=function(c){if(!this.decoder){if(this.initialBufs.push(c),this.initialBufsLen+=c.length,this.initialBufsLen<32)return"";var u=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(u,this.options);for(var h="",f=0;f<this.initialBufs.length;f++)h+=this.decoder.write(this.initialBufs[f]);return this.initialBufs.length=this.initialBufsLen=0,h}return this.decoder.write(c)},a.prototype.end=function(){if(!this.decoder){var c=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(c,this.options);for(var u="",h=0;h<this.initialBufs.length;h++)u+=this.decoder.write(this.initialBufs[h]);var f=this.decoder.end();return f&&(u+=f),this.initialBufs.length=this.initialBufsLen=0,u}return this.decoder.end()};function l(c,u){var h=[],f=0,g=0,_=0,b=0,v=0;e:for(var y=0;y<c.length;y++)for(var E=c[y],w=0;w<E.length;w++)if(h.push(E[w]),h.length===4){if(f===0){if(h[0]===255&&h[1]===254&&h[2]===0&&h[3]===0)return"utf-32le";if(h[0]===0&&h[1]===0&&h[2]===254&&h[3]===255)return"utf-32be"}if((h[0]!==0||h[1]>16)&&_++,(h[3]!==0||h[2]>16)&&g++,h[0]===0&&h[1]===0&&(h[2]!==0||h[3]!==0)&&v++,(h[0]!==0||h[1]!==0)&&h[2]===0&&h[3]===0&&b++,h.length=0,f++,f>=100)break e}return v-_>b-g?"utf-32be":v-_<b-g?"utf-32le":u||"utf-32le"}return xi}var lo={},nu;function Jb(){if(nu)return lo;nu=1;var e=on.Buffer;lo.utf16be=t;function t(){}t.prototype.encoder=i,t.prototype.decoder=n,t.prototype.bomAware=!0;function i(){}i.prototype.write=function(l){for(var c=e.from(l,"ucs2"),u=0;u<c.length;u+=2){var h=c[u];c[u]=c[u+1],c[u+1]=h}return c},i.prototype.end=function(){};function n(){this.overflowByte=-1}n.prototype.write=function(l){if(l.length==0)return"";var c=e.alloc(l.length+1),u=0,h=0;for(this.overflowByte!==-1&&(c[0]=l[0],c[1]=this.overflowByte,u=1,h=2);u<l.length-1;u+=2,h+=2)c[h]=l[u+1],c[h+1]=l[u];return this.overflowByte=u==l.length-1?l[l.length-1]:-1,c.slice(0,h).toString("ucs2")},n.prototype.end=function(){this.overflowByte=-1},lo.utf16=s;function s(l,c){this.iconv=c}s.prototype.encoder=o,s.prototype.decoder=r;function o(l,c){l=l||{},l.addBOM===void 0&&(l.addBOM=!0),this.encoder=c.iconv.getEncoder("utf-16le",l)}o.prototype.write=function(l){return this.encoder.write(l)},o.prototype.end=function(){return this.encoder.end()};function r(l,c){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=l||{},this.iconv=c.iconv}r.prototype.write=function(l){if(!this.decoder){if(this.initialBufs.push(l),this.initialBufsLen+=l.length,this.initialBufsLen<16)return"";var c=a(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(c,this.options);for(var u="",h=0;h<this.initialBufs.length;h++)u+=this.decoder.write(this.initialBufs[h]);return this.initialBufs.length=this.initialBufsLen=0,u}return this.decoder.write(l)},r.prototype.end=function(){if(!this.decoder){var l=a(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(l,this.options);for(var c="",u=0;u<this.initialBufs.length;u++)c+=this.decoder.write(this.initialBufs[u]);var h=this.decoder.end();return h&&(c+=h),this.initialBufs.length=this.initialBufsLen=0,c}return this.decoder.end()};function a(l,c){var u=[],h=0,f=0,g=0;e:for(var _=0;_<l.length;_++)for(var b=l[_],v=0;v<b.length;v++)if(u.push(b[v]),u.length===2){if(h===0){if(u[0]===255&&u[1]===254)return"utf-16le";if(u[0]===254&&u[1]===255)return"utf-16be"}if(u[0]===0&&u[1]!==0&&g++,u[0]!==0&&u[1]===0&&f++,u.length=0,h++,h>=100)break e}return g>f?"utf-16be":g<f?"utf-16le":c||"utf-16le"}return lo}var os={},su;function Qb(){if(su)return os;su=1;var e=on.Buffer;os.utf7=t,os.unicode11utf7="utf7";function t(b,v){this.iconv=v}t.prototype.encoder=n,t.prototype.decoder=s,t.prototype.bomAware=!0;var i=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function n(b,v){this.iconv=v.iconv}n.prototype.write=function(b){return e.from(b.replace(i,function(v){return"+"+(v==="+"?"":this.iconv.encode(v,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},n.prototype.end=function(){};function s(b,v){this.iconv=v.iconv,this.inBase64=!1,this.base64Accum=""}for(var o=/[A-Za-z0-9\/+]/,r=[],a=0;a<256;a++)r[a]=o.test(String.fromCharCode(a));var l="+".charCodeAt(0),c="-".charCodeAt(0),u="&".charCodeAt(0);s.prototype.write=function(b){for(var v="",y=0,E=this.inBase64,w=this.base64Accum,P=0;P<b.length;P++)if(!E)b[P]==l&&(v+=this.iconv.decode(b.slice(y,P),"ascii"),y=P+1,E=!0);else if(!r[b[P]]){if(P==y&&b[P]==c)v+="+";else{var A=w+this.iconv.decode(b.slice(y,P),"ascii");v+=this.iconv.decode(e.from(A,"base64"),"utf16-be")}b[P]!=c&&P--,y=P+1,E=!1,w=""}if(!E)v+=this.iconv.decode(b.slice(y),"ascii");else{var A=w+this.iconv.decode(b.slice(y),"ascii"),O=A.length-A.length%8;w=A.slice(O),A=A.slice(0,O),v+=this.iconv.decode(e.from(A,"base64"),"utf16-be")}return this.inBase64=E,this.base64Accum=w,v},s.prototype.end=function(){var b="";return this.inBase64&&this.base64Accum.length>0&&(b=this.iconv.decode(e.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",b},os.utf7imap=h;function h(b,v){this.iconv=v}h.prototype.encoder=f,h.prototype.decoder=g,h.prototype.bomAware=!0;function f(b,v){this.iconv=v.iconv,this.inBase64=!1,this.base64Accum=e.alloc(6),this.base64AccumIdx=0}f.prototype.write=function(b){for(var v=this.inBase64,y=this.base64Accum,E=this.base64AccumIdx,w=e.alloc(b.length*5+10),P=0,A=0;A<b.length;A++){var O=b.charCodeAt(A);32<=O&&O<=126?(v&&(E>0&&(P+=w.write(y.slice(0,E).toString("base64").replace(/\//g,",").replace(/=+$/,""),P),E=0),w[P++]=c,v=!1),v||(w[P++]=O,O===u&&(w[P++]=c))):(v||(w[P++]=u,v=!0),v&&(y[E++]=O>>8,y[E++]=O&255,E==y.length&&(P+=w.write(y.toString("base64").replace(/\//g,","),P),E=0)))}return this.inBase64=v,this.base64AccumIdx=E,w.slice(0,P)},f.prototype.end=function(){var b=e.alloc(10),v=0;return this.inBase64&&(this.base64AccumIdx>0&&(v+=b.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),v),this.base64AccumIdx=0),b[v++]=c,this.inBase64=!1),b.slice(0,v)};function g(b,v){this.iconv=v.iconv,this.inBase64=!1,this.base64Accum=""}var _=r.slice();return _[",".charCodeAt(0)]=!0,g.prototype.write=function(b){for(var v="",y=0,E=this.inBase64,w=this.base64Accum,P=0;P<b.length;P++)if(!E)b[P]==u&&(v+=this.iconv.decode(b.slice(y,P),"ascii"),y=P+1,E=!0);else if(!_[b[P]]){if(P==y&&b[P]==c)v+="&";else{var A=w+this.iconv.decode(b.slice(y,P),"ascii").replace(/,/g,"/");v+=this.iconv.decode(e.from(A,"base64"),"utf16-be")}b[P]!=c&&P--,y=P+1,E=!1,w=""}if(!E)v+=this.iconv.decode(b.slice(y),"ascii");else{var A=w+this.iconv.decode(b.slice(y),"ascii").replace(/,/g,"/"),O=A.length-A.length%8;w=A.slice(O),A=A.slice(0,O),v+=this.iconv.decode(e.from(A,"base64"),"utf16-be")}return this.inBase64=E,this.base64Accum=w,v},g.prototype.end=function(){var b="";return this.inBase64&&this.base64Accum.length>0&&(b=this.iconv.decode(e.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",b},os}var ea={},ou;function Zb(){if(ou)return ea;ou=1;var e=on.Buffer;ea._sbcs=t;function t(s,o){if(!s)throw new Error("SBCS codec is called without the data.");if(!s.chars||s.chars.length!==128&&s.chars.length!==256)throw new Error("Encoding '"+s.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(s.chars.length===128){for(var r="",a=0;a<128;a++)r+=String.fromCharCode(a);s.chars=r+s.chars}this.decodeBuf=e.from(s.chars,"ucs2");for(var l=e.alloc(65536,o.defaultCharSingleByte.charCodeAt(0)),a=0;a<s.chars.length;a++)l[s.chars.charCodeAt(a)]=a;this.encodeBuf=l}t.prototype.encoder=i,t.prototype.decoder=n;function i(s,o){this.encodeBuf=o.encodeBuf}i.prototype.write=function(s){for(var o=e.alloc(s.length),r=0;r<s.length;r++)o[r]=this.encodeBuf[s.charCodeAt(r)];return o},i.prototype.end=function(){};function n(s,o){this.decodeBuf=o.decodeBuf}return n.prototype.write=function(s){for(var o=this.decodeBuf,r=e.alloc(s.length*2),a=0,l=0,c=0;c<s.length;c++)a=s[c]*2,l=c*2,r[l]=o[a],r[l+1]=o[a+1];return r.toString("ucs2")},n.prototype.end=function(){},ea}var ta,ru;function e1(){return ru||(ru=1,ta={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},mik:{type:"_sbcs",chars:""},cp720:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",1e4:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}),ta}var ia,au;function t1(){return au||(au=1,ia={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\uFEFF"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},iso646cn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}`},iso646jp:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_\`abcdefghijklmnopqrstuvwxyz{|}`},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}),ia}var na={},lu;function i1(){if(lu)return na;lu=1;var e=on.Buffer;na._dbcs=l;for(var t=-1,i=-2,n=-10,s=-1e3,o=new Array(256),r=-1,a=0;a<256;a++)o[a]=t;function l(f,g){if(this.encodingName=f.encodingName,!f)throw new Error("DBCS codec is called without the data.");if(!f.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var _=f.table();this.decodeTables=[],this.decodeTables[0]=o.slice(0),this.decodeTableSeq=[];for(var b=0;b<_.length;b++)this._addDecodeChunk(_[b]);if(typeof f.gb18030=="function"){this.gb18030=f.gb18030();var v=this.decodeTables.length;this.decodeTables.push(o.slice(0));var y=this.decodeTables.length;this.decodeTables.push(o.slice(0));for(var E=this.decodeTables[0],b=129;b<=254;b++)for(var w=this.decodeTables[s-E[b]],P=48;P<=57;P++){if(w[P]===t)w[P]=s-v;else if(w[P]>s)throw new Error("gb18030 decode tables conflict at byte 2");for(var A=this.decodeTables[s-w[P]],O=129;O<=254;O++){if(A[O]===t)A[O]=s-y;else{if(A[O]===s-y)continue;if(A[O]>s)throw new Error("gb18030 decode tables conflict at byte 3")}for(var U=this.decodeTables[s-A[O]],z=48;z<=57;z++)U[z]===t&&(U[z]=i)}}}this.defaultCharUnicode=g.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var te={};if(f.encodeSkipVals)for(var b=0;b<f.encodeSkipVals.length;b++){var G=f.encodeSkipVals[b];if(typeof G=="number")te[G]=!0;else for(var P=G.from;P<=G.to;P++)te[P]=!0}if(this._fillEncodeTable(0,0,te),f.encodeAdd)for(var Q in f.encodeAdd)Object.prototype.hasOwnProperty.call(f.encodeAdd,Q)&&this._setEncodeChar(Q.charCodeAt(0),f.encodeAdd[Q]);this.defCharSB=this.encodeTable[0][g.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===t&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===t&&(this.defCharSB="?".charCodeAt(0))}l.prototype.encoder=c,l.prototype.decoder=u,l.prototype._getDecodeTrieNode=function(f){for(var g=[];f>0;f>>>=8)g.push(f&255);g.length==0&&g.push(0);for(var _=this.decodeTables[0],b=g.length-1;b>0;b--){var v=_[g[b]];if(v==t)_[g[b]]=s-this.decodeTables.length,this.decodeTables.push(_=o.slice(0));else if(v<=s)_=this.decodeTables[s-v];else throw new Error("Overwrite byte in "+this.encodingName+", addr: "+f.toString(16))}return _},l.prototype._addDecodeChunk=function(f){var g=parseInt(f[0],16),_=this._getDecodeTrieNode(g);g=g&255;for(var b=1;b<f.length;b++){var v=f[b];if(typeof v=="string")for(var y=0;y<v.length;){var E=v.charCodeAt(y++);if(55296<=E&&E<56320){var w=v.charCodeAt(y++);if(56320<=w&&w<57344)_[g++]=65536+(E-55296)*1024+(w-56320);else throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+f[0])}else if(4080<E&&E<=4095){for(var P=4095-E+2,A=[],O=0;O<P;O++)A.push(v.charCodeAt(y++));_[g++]=n-this.decodeTableSeq.length,this.decodeTableSeq.push(A)}else _[g++]=E}else if(typeof v=="number")for(var U=_[g-1]+1,y=0;y<v;y++)_[g++]=U++;else throw new Error("Incorrect type '"+typeof v+"' given in "+this.encodingName+" at chunk "+f[0])}if(g>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+f[0]+": too long"+g)},l.prototype._getEncodeBucket=function(f){var g=f>>8;return this.encodeTable[g]===void 0&&(this.encodeTable[g]=o.slice(0)),this.encodeTable[g]},l.prototype._setEncodeChar=function(f,g){var _=this._getEncodeBucket(f),b=f&255;_[b]<=n?this.encodeTableSeq[n-_[b]][r]=g:_[b]==t&&(_[b]=g)},l.prototype._setEncodeSequence=function(f,g){var _=f[0],b=this._getEncodeBucket(_),v=_&255,y;b[v]<=n?y=this.encodeTableSeq[n-b[v]]:(y={},b[v]!==t&&(y[r]=b[v]),b[v]=n-this.encodeTableSeq.length,this.encodeTableSeq.push(y));for(var E=1;E<f.length-1;E++){var w=y[_];typeof w=="object"?y=w:(y=y[_]={},w!==void 0&&(y[r]=w))}_=f[f.length-1],y[_]=g},l.prototype._fillEncodeTable=function(f,g,_){for(var b=this.decodeTables[f],v=!1,y={},E=0;E<256;E++){var w=b[E],P=g+E;if(!_[P])if(w>=0)this._setEncodeChar(w,P),v=!0;else if(w<=s){var A=s-w;if(!y[A]){var O=P<<8>>>0;this._fillEncodeTable(A,O,_)?v=!0:y[A]=!0}}else w<=n&&(this._setEncodeSequence(this.decodeTableSeq[n-w],P),v=!0)}return v};function c(f,g){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=g.encodeTable,this.encodeTableSeq=g.encodeTableSeq,this.defaultCharSingleByte=g.defCharSB,this.gb18030=g.gb18030}c.prototype.write=function(f){for(var g=e.alloc(f.length*(this.gb18030?4:3)),_=this.leadSurrogate,b=this.seqObj,v=-1,y=0,E=0;;){if(v===-1){if(y==f.length)break;var w=f.charCodeAt(y++)}else{var w=v;v=-1}if(55296<=w&&w<57344)if(w<56320)if(_===-1){_=w;continue}else _=w,w=t;else _!==-1?(w=65536+(_-55296)*1024+(w-56320),_=-1):w=t;else _!==-1&&(v=w,w=t,_=-1);var P=t;if(b!==void 0&&w!=t){var A=b[w];if(typeof A=="object"){b=A;continue}else typeof A=="number"?P=A:A==null&&(A=b[r],A!==void 0&&(P=A,v=w));b=void 0}else if(w>=0){var O=this.encodeTable[w>>8];if(O!==void 0&&(P=O[w&255]),P<=n){b=this.encodeTableSeq[n-P];continue}if(P==t&&this.gb18030){var U=h(this.gb18030.uChars,w);if(U!=-1){var P=this.gb18030.gbChars[U]+(w-this.gb18030.uChars[U]);g[E++]=129+Math.floor(P/12600),P=P%12600,g[E++]=48+Math.floor(P/1260),P=P%1260,g[E++]=129+Math.floor(P/10),P=P%10,g[E++]=48+P;continue}}}P===t&&(P=this.defaultCharSingleByte),P<256?g[E++]=P:P<65536?(g[E++]=P>>8,g[E++]=P&255):P<16777216?(g[E++]=P>>16,g[E++]=P>>8&255,g[E++]=P&255):(g[E++]=P>>>24,g[E++]=P>>>16&255,g[E++]=P>>>8&255,g[E++]=P&255)}return this.seqObj=b,this.leadSurrogate=_,g.slice(0,E)},c.prototype.end=function(){if(!(this.leadSurrogate===-1&&this.seqObj===void 0)){var f=e.alloc(10),g=0;if(this.seqObj){var _=this.seqObj[r];_!==void 0&&(_<256?f[g++]=_:(f[g++]=_>>8,f[g++]=_&255)),this.seqObj=void 0}return this.leadSurrogate!==-1&&(f[g++]=this.defaultCharSingleByte,this.leadSurrogate=-1),f.slice(0,g)}},c.prototype.findIdx=h;function u(f,g){this.nodeIdx=0,this.prevBytes=[],this.decodeTables=g.decodeTables,this.decodeTableSeq=g.decodeTableSeq,this.defaultCharUnicode=g.defaultCharUnicode,this.gb18030=g.gb18030}u.prototype.write=function(f){for(var g=e.alloc(f.length*2),_=this.nodeIdx,b=this.prevBytes,v=this.prevBytes.length,y=-this.prevBytes.length,E,w=0,P=0;w<f.length;w++){var A=w>=0?f[w]:b[w+v],E=this.decodeTables[_][A];if(!(E>=0))if(E===t)E=this.defaultCharUnicode.charCodeAt(0),w=y;else if(E===i){if(w>=3)var O=(f[w-3]-129)*12600+(f[w-2]-48)*1260+(f[w-1]-129)*10+(A-48);else var O=(b[w-3+v]-129)*12600+((w-2>=0?f[w-2]:b[w-2+v])-48)*1260+((w-1>=0?f[w-1]:b[w-1+v])-129)*10+(A-48);var U=h(this.gb18030.gbChars,O);E=this.gb18030.uChars[U]+O-this.gb18030.gbChars[U]}else if(E<=s){_=s-E;continue}else if(E<=n){for(var z=this.decodeTableSeq[n-E],te=0;te<z.length-1;te++)E=z[te],g[P++]=E&255,g[P++]=E>>8;E=z[z.length-1]}else throw new Error("iconv-lite internal error: invalid decoding table value "+E+" at "+_+"/"+A);if(E>=65536){E-=65536;var G=55296|E>>10;g[P++]=G&255,g[P++]=G>>8,E=56320|E&1023}g[P++]=E&255,g[P++]=E>>8,_=0,y=w+1}return this.nodeIdx=_,this.prevBytes=y>=0?Array.prototype.slice.call(f,y):b.slice(y+v).concat(Array.prototype.slice.call(f)),g.slice(0,P).toString("ucs2")},u.prototype.end=function(){for(var f="";this.prevBytes.length>0;){f+=this.defaultCharUnicode;var g=this.prevBytes.slice(1);this.prevBytes=[],this.nodeIdx=0,g.length>0&&(f+=this.write(g))}return this.prevBytes=[],this.nodeIdx=0,f};function h(f,g){if(f[0]>g)return-1;for(var _=0,b=f.length;_<b-1;){var v=_+(b-_+1>>1);f[v]<=g?_=v:b=v}return _}return na}const n1=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]],s1=[["0","\0",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]],sa=[["0","\0",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]],cu=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93],["8135f437",""]],o1=[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],r1=[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3],a1={uChars:o1,gbChars:r1},l1=[["0","\0",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]],uu=[["0","\0",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]],c1=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]];var oa,hu;function u1(){return hu||(hu=1,oa={shiftjis:{type:"_dbcs",table:function(){return n1},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return s1},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return sa}},gbk:{type:"_dbcs",table:function(){return sa.concat(cu)}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return sa.concat(cu)},gb18030:function(){return a1},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return l1}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return uu}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return uu.concat(c1)},encodeSkipVals:[36457,36463,36478,36523,36532,36557,36560,36695,36713,36718,36811,36862,36973,36986,37060,37084,37105,37311,37551,37552,37553,37554,37585,37959,38090,38361,38652,39285,39798,39800,39803,39878,39902,39916,39926,40002,40019,40034,40040,40043,40055,40124,40125,40144,40279,40282,40388,40431,40443,40617,40687,40701,40800,40907,41079,41180,41183,36812,37576,38468,38637,41636,41637,41639,41638,41676,41678]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}),oa}var du;function h1(){return du||(du=1,function(e){for(var t=[Yb(),Xb(),Jb(),Qb(),Zb(),e1(),t1(),i1(),u1()],i=0;i<t.length;i++){var n=t[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}}(Jr)),Jr}var ra,fu;function d1(){if(fu)return ra;fu=1;var e=on.Buffer;return ra=function(t){var i=t.Transform;function n(o,r){this.conv=o,r=r||{},r.decodeStrings=!1,i.call(this,r)}n.prototype=Object.create(i.prototype,{constructor:{value:n}}),n.prototype._transform=function(o,r,a){if(typeof o!="string")return a(new Error("Iconv encoding stream needs strings as its input."));try{var l=this.conv.write(o);l&&l.length&&this.push(l),a()}catch(c){a(c)}},n.prototype._flush=function(o){try{var r=this.conv.end();r&&r.length&&this.push(r),o()}catch(a){o(a)}},n.prototype.collect=function(o){var r=[];return this.on("error",o),this.on("data",function(a){r.push(a)}),this.on("end",function(){o(null,e.concat(r))}),this};function s(o,r){this.conv=o,r=r||{},r.encoding=this.encoding="utf8",i.call(this,r)}return s.prototype=Object.create(i.prototype,{constructor:{value:s}}),s.prototype._transform=function(o,r,a){if(!e.isBuffer(o)&&!(o instanceof Uint8Array))return a(new Error("Iconv decoding stream needs buffers as its input."));try{var l=this.conv.write(o);l&&l.length&&this.push(l,this.encoding),a()}catch(c){a(c)}},s.prototype._flush=function(o){try{var r=this.conv.end();r&&r.length&&this.push(r,this.encoding),o()}catch(a){o(a)}},s.prototype.collect=function(o){var r="";return this.on("error",o),this.on("data",function(a){r+=a}),this.on("end",function(){o(null,r)}),this},{IconvLiteEncoderStream:n,IconvLiteDecoderStream:s}},ra}const f1={},p1=Object.freeze(Object.defineProperty({__proto__:null,default:f1},Symbol.toStringTag,{value:"Module"})),g1=Bb(p1);(function(e){var t=on.Buffer,i=$l,n=e.exports;n.encodings=null,n.defaultCharUnicode="",n.defaultCharSingleByte="?",n.encode=function(r,a,l){r=""+(r||"");var c=n.getEncoder(a,l),u=c.write(r),h=c.end();return h&&h.length>0?t.concat([u,h]):u},n.decode=function(r,a,l){typeof r=="string"&&(n.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),n.skipDecodeWarning=!0),r=t.from(""+(r||""),"binary"));var c=n.getDecoder(a,l),u=c.write(r),h=c.end();return h?u+h:u},n.encodingExists=function(r){try{return n.getCodec(r),!0}catch{return!1}},n.toEncoding=n.encode,n.fromEncoding=n.decode,n._codecDataCache={},n.getCodec=function(r){n.encodings||(n.encodings=h1());for(var a=n._canonicalizeEncoding(r),l={};;){var c=n._codecDataCache[a];if(c)return c;var u=n.encodings[a];switch(typeof u){case"string":a=u;break;case"object":for(var h in u)l[h]=u[h];l.encodingName||(l.encodingName=a),a=u.type;break;case"function":return l.encodingName||(l.encodingName=a),c=new u(l,n),n._codecDataCache[l.encodingName]=c,c;default:throw new Error("Encoding not recognized: '"+r+"' (searched as: '"+a+"')")}}},n._canonicalizeEncoding=function(o){return(""+o).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g,"")},n.getEncoder=function(r,a){var l=n.getCodec(r),c=new l.encoder(a,l);return l.bomAware&&a&&a.addBOM&&(c=new i.PrependBOM(c,a)),c},n.getDecoder=function(r,a){var l=n.getCodec(r),c=new l.decoder(a,l);return l.bomAware&&!(a&&a.stripBOM===!1)&&(c=new i.StripBOM(c,a)),c},n.enableStreamingAPI=function(r){if(!n.supportsStreams){var a=d1()(r);n.IconvLiteEncoderStream=a.IconvLiteEncoderStream,n.IconvLiteDecoderStream=a.IconvLiteDecoderStream,n.encodeStream=function(c,u){return new n.IconvLiteEncoderStream(n.getEncoder(c,u),u)},n.decodeStream=function(c,u){return new n.IconvLiteDecoderStream(n.getDecoder(c,u),u)},n.supportsStreams=!0}};var s;try{s=g1}catch{}s&&s.Transform?n.enableStreamingAPI(s):n.encodeStream=n.decodeStream=function(){throw new Error("iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.")}})(Db);function m1(e){return e>=1500?"":e>=600?"":e>=400?"":e>=200?"":e>=-200?"":e>=-400?"":e>=-600?"":e>=-1500?"":""}function Va(e,t){return 100/(1+Math.exp(-e/t))}var Kt=(e=>(e[e.PLAYER=0]="PLAYER",e[e.OPPONENT=1]="OPPONENT",e[e.RESEARCHER=2]="RESEARCHER",e[e.RESEARCHER_2=3]="RESEARCHER_2",e[e.RESEARCHER_3=4]="RESEARCHER_3",e[e.RESEARCHER_4=5]="RESEARCHER_4",e))(Kt||{});function b1(e){const t=/^\*=([+-]?[.0-9]+)/.exec(e);return t?Number(t[1]):void 0}function _1(e){const t=/^#=([+-]?[.0-9]+)/.exec(e);return t?Number(t[1]):void 0}function y1(e){const t=/^\* *([+-]?[.0-9]+)/.exec(e);return t?Number(t[1]):void 0}function pu(e){e.forEach(t=>{const i=t.customData||{},n=t.comment.split(`
`);for(const s of n){const o=b1(s)||y1(s);o!==void 0&&(i.playerSearchInfo={usi:e.usi,score:o});const r=_1(s);r!==void 0&&(i.researchInfo={usi:e.usi,score:r})}t.customData=i})}function v1(e){switch(e){case 0:return"*";default:return"#"}}function S1(e,t,i){const n=v1(t);let s="";if(i.mate&&(s+=`${Math.abs(i.mate)}
`),i.score!==void 0&&(s+=m1(i.score)+`
`,s+=`${n}=${i.score}
`),i.pv&&i.pv.length!==0){s+=`${n}=`;let o;const r=e.clone();for(const a of i.pv)s+=`${Jn(r,a,{prev:o,compatible:!0})}`,r.doMove(a,{ignoreValidation:!0}),o=a;s+=`
`}return s}function w1(e){return Jd(e.timeSeconds)+"+"+String(e.byoyomi).padStart(2,"0")}class E1{constructor(){M(this,"_record",new At);M(this,"_recordFilePath");M(this,"onChangeFilePath",()=>{});M(this,"onChangePosition",()=>{});this.setupRecordHandler()}get record(){return this._record}get recordFilePath(){return this._recordFilePath}updateRecordFilePath(t){this._recordFilePath=t,this.onChangeFilePath(t)}clearRecordFilePath(){this._recordFilePath=void 0,this.onChangeFilePath()}reset(t){if(t){const i=new Rt;i.reset(t),this._record.clear(i)}else this._record.clear();this.clearRecordFilePath()}resetByCurrentPosition(){this._record.clear(this._record.position),this.clearRecordFilePath()}importRecord(t,i){let n;switch(i||(i=X0(t)),i){case Fn.SFEN:{const s=Rt.newBySFEN(t);n=s?new At(s):new Error("");break}case Fn.USI:n=At.newByUSI(t);break;case Fn.KIF:n=zc(t);break;case Fn.CSA:n=Gc(t);break;default:n=new Error("");break}if(n instanceof Error)return n;this._record=n,this.setupRecordHandler(),this.clearRecordFilePath(),pu(this._record)}importRecordFromBuffer(t,i){let n;if(i.match(/\.kif$/)||i.match(/\.kifu$/)){const s=i.match(/\.kif$/)?sr.decode(t,"Shift_JIS"):new TextDecoder().decode(t);n=zc(s)}else i.match(/\.csa$/)?n=Gc(new TextDecoder().decode(t)):n=new Error(": "+i);if(n instanceof Error)return n;this._record=n,this.setupRecordHandler(),this.updateRecordFilePath(i),pu(this._record)}exportRecordAsBuffer(t,i){let n;if(t.match(/\.kif$/)||t.match(/\.kifu$/)){const s=Qd(this.record,i);n=t.match(/\.kif$/)?sr.encode(s,"Shift_JIS"):new TextEncoder().encode(s)}else if(t.match(/\.csa$/))n=new TextEncoder().encode(tf(this.record,i));else return new Error(": "+t);return this.updateRecordFilePath(t),n}swapNextTurn(){const t=this.record.position.clone();t.setColor(Mt(t.color)),this._record.clear(t),this.clearRecordFilePath()}changePosition(t){const i=this.record.position.clone();i.edit(t),this._record.clear(i),this.clearRecordFilePath()}changePly(t){this._record.goto(t)}changeBranch(t){return this._record.switchBranchByIndex(t)}swapWithNextBranch(){return this._record.swapWithNextBranch()}swapWithPreviousBranch(){return this._record.swapWithPreviousBranch()}removeCurrentMove(){this._record.removeCurrentMove()}removeNextMove(){this._record.removeNextMove()}updateComment(t){this._record.current.comment=t}appendComment(t,i){if(!t)return;const n=this._record.current.comment,s=this.record.current.comment?`
`:"";switch(i){case Fi.NONE:break;case Fi.INSERT:this._record.current.comment=t+s+n;break;case Fi.APPEND:this._record.current.comment=n+s+t;break;case Fi.OVERWRITE:this._record.current.comment=t;break}}appendSearchComment(t,i,n,s){const o=S1(this.record.position,t,i);this.appendComment((s?s+`
`:"")+o,n)}setGameStartMetadata(t){t.gameTitle&&this._record.metadata.setStandardMetadata(ue.TITLE,t.gameTitle),t.blackName&&this._record.metadata.setStandardMetadata(ue.BLACK_NAME,t.blackName),t.whiteName&&this._record.metadata.setStandardMetadata(ue.WHITE_NAME,t.whiteName),this._record.metadata.setStandardMetadata(ue.DATE,cf()),this._record.metadata.setStandardMetadata(ue.START_DATETIME,Qc()),t.timeLimit&&this._record.metadata.setStandardMetadata(ue.TIME_LIMIT,w1(t.timeLimit))}setGameEndMetadata(){this._record.metadata.setStandardMetadata(ue.END_DATETIME,Qc())}updateSearchInfo(t,i){var s,o,r,a;const n=this.record.current.customData||{};switch(t){case 0:n.playerSearchInfo=i;break;case 1:n.opponentSearchInfo=i;break;case 2:(i.depth||0)>=(((s=n.researchInfo)==null?void 0:s.depth)||0)&&(n.researchInfo=i);break;case 3:(i.depth||0)>=(((o=n.researchInfo2)==null?void 0:o.depth)||0)&&(n.researchInfo2=i);break;case 4:(i.depth||0)>=(((r=n.researchInfo3)==null?void 0:r.depth)||0)&&(n.researchInfo3=i);break;case 5:(i.depth||0)>=(((a=n.researchInfo4)==null?void 0:a.depth)||0)&&(n.researchInfo4=i);break}this._record.current.customData=n}appendMove(t){return this._record.append(t.move,t.moveOption)?(t.elapsedMs!==void 0&&this._record.current.setElapsedMs(t.elapsedMs),!0):!1}updateStandardMetadata(t){this._record.metadata.setStandardMetadata(t.key,t.value)}on(t,i){switch(t){case"changeFilePath":this.onChangeFilePath=i;break;case"changePosition":this.onChangePosition=i,this.setupRecordHandler();break}}setupRecordHandler(){this._record.on("changePosition",this.onChangePosition)}}class k1{constructor(){M(this,"searchHandler")}isEngine(){return!1}async startSearch(t,i,n,s,o){this.searchHandler=o}async startPonder(){}async stop(){}async gameover(){}async close(){this.searchHandler=void 0}doMove(t){const i=this.searchHandler;this.searchHandler=void 0,i&&i.onMove(t)}resign(){const t=this.searchHandler;this.searchHandler=void 0,t&&t.onResign()}win(){const t=this.searchHandler;this.searchHandler=void 0,t&&t.onWin()}}const Vn=new k1;function I1(e,t){const i=[],n=e.clone();for(const s of t){const o=n.createMoveByUSI(s);if(!o||!n.doMove(o))break;i.push(o)}return i}class zl{constructor(t,i,n){M(this,"sessionID",0);M(this,"usi");M(this,"position");M(this,"searchHandler");M(this,"ponder");M(this,"inPonder",!1);M(this,"info");M(this,"usiInfoTimeout");this.setting=t,this.timeoutSeconds=i,this.onSearchInfo=n}async launch(){this.sessionID=await fe.usiLaunch(this.setting,this.timeoutSeconds),or[this.sessionID]=this}isEngine(){return!0}async startSearch(t,i,n,s,o){this.searchHandler=o,this.usi=t.usi,this.position=t.position.clone(),this.inPonder&&this.ponder===this.usi?fe.usiPonderHit(this.sessionID):(this.info=void 0,await fe.usiGo(this.sessionID,this.usi,i,n,s)),this.inPonder=!1,this.ponder=void 0}async startPonder(t,i,n,s){const o=t.usi;if(!this.ponder||!this.ponder.startsWith(o)||Sn(this.setting.options[of])!=="true")return;this.searchHandler=void 0,this.usi=this.ponder,this.position=t.position.clone();const a=this.position.createMoveByUSI(this.ponder.slice(o.length+1));a&&(this.position.doMove(a),this.info=void 0,this.inPonder=!0,await fe.usiGoPonder(this.sessionID,this.ponder,i,n,s))}async startResearch(t){this.searchHandler=void 0,this.usi=t.usi,this.info=void 0,this.position=t.position.clone(),await fe.usiGoInfinite(this.sessionID,t.usi)}async stop(){await fe.usiStop(this.sessionID)}async gameover(t){await fe.usiGameover(this.sessionID,t)}async close(){this.searchHandler=void 0,await fe.usiQuit(this.sessionID),delete or[this.sessionID]}onBestMove(t,i,n){const s=this.searchHandler;if(this.searchHandler=void 0,!s||!this.position||t!==this.usi)return;if(i==="resign"){s.onResign();return}if(i==="win"){s.onWin();return}const o=this.position.createMoveByUSI(i);if(!o){s.onError(":"+i),s.onResign();return}if(this.ponder=n&&`${t} ${i} ${n}`,this.flushUSIInfo(),this.info&&this.info.pv&&this.info.pv.length>=1&&this.info.pv[0].equals(o)){const r={...this.info,pv:this.info.pv.slice(1)};s.onMove(o,r)}else s.onMove(o)}onUSIInfo(t,i){if(t!==this.usi||!this.position||i.multipv&&i.multipv!==1)return;const n=this.position.color===L.BLACK?1:-1,s=i.pv&&i.pv.length>=1?i.pv:i.currmove?[i.currmove]:void 0,o={usi:t,depth:i.depth,score:i.scoreCP&&i.scoreCP*n,mate:i.scoreMate&&i.scoreMate*n,pv:s&&I1(this.position,s)};this.updateUSIInfo(o)}updateUSIInfo(t){this.info=t,!this.usiInfoTimeout&&(this.usiInfoTimeout=window.setTimeout(()=>{this.flushUSIInfo()},500))}flushUSIInfo(){this.usiInfoTimeout&&(clearTimeout(this.usiInfoTimeout),this.usiInfoTimeout=void 0),this.onSearchInfo&&this.info&&this.onSearchInfo(this.info)}}const or={};function P1(e,t,i,n){const s=or[e];s&&s.onBestMove(t,i,n)}function gu(e,t,i){const n=or[e];n&&n.onUSIInfo(t,i)}function rr(e){return{async build(t,i){if(t.uri===Qt)return Vn;if(ki(t.uri)&&t.usi){const n=new zl(t.usi,e??10,i);return await n.launch(),n}throw new Error("defaultPlayerBuilder#build: URI: "+t.uri)}}}var Di=(e=>(e.WIN="win",e.LOSE="lose",e.DRAW="draw",e))(Di||{});function mu(e,t){return{player1:{name:e,win:0},player2:{name:t,win:0},draw:0,invalid:0,total:0}}class A1{constructor(t,i,n){M(this,"state");M(this,"_setting");M(this,"startPly",0);M(this,"repeat",0);M(this,"blackPlayer");M(this,"whitePlayer");M(this,"playerBuilder",rr());M(this,"_results",mu("",""));M(this,"lastEventID");M(this,"onSaveRecord",()=>{});M(this,"onGameNext",()=>{});M(this,"onGameEnd",()=>{});M(this,"onPieceBeat",()=>{});M(this,"onBeepShort",()=>{});M(this,"onBeepUnlimited",()=>{});M(this,"onStopBeep",()=>{});M(this,"onError",()=>{});this.recordManager=t,this.blackClock=i,this.whiteClock=n,this.state="idle",this._setting=ir(),this.lastEventID=0}on(t,i){switch(t){case"saveRecord":this.onSaveRecord=i;break;case"gameNext":this.onGameNext=i;break;case"gameEnd":this.onGameEnd=i;break;case"pieceBeat":this.onPieceBeat=i;break;case"beepShort":this.onBeepShort=i;break;case"beepUnlimited":this.onBeepUnlimited=i;break;case"stopBeep":this.onStopBeep=i;break;case"error":this.onError=i;break}return this}get setting(){return this._setting}get results(){return this._results}async startGame(t,i){if(this.state!=="idle")throw Error("GameManager#startGame: ");this._setting=t,this.playerBuilder=i,this.repeat=0,t.startPosition||(this.startPly=this.recordManager.record.current.number),this._results=mu(t.black.name,t.white.name),await this.nextGame()}async nextGame(){this.repeat++,this.setting.startPosition?this.recordManager.reset(this.setting.startPosition):this.recordManager.record.current.number!==this.startPly&&(this.recordManager.changePly(this.startPly),this.recordManager.removeNextMove()),this.recordManager.setGameStartMetadata({gameTitle:this.setting.repeat>=2?` ${this.repeat}/${this.setting.repeat}`:void 0,blackName:this.setting.black.name,whiteName:this.setting.white.name,timeLimit:this.setting.timeLimit});const t={timeMs:this.setting.timeLimit.timeSeconds*1e3,byoyomi:this.setting.timeLimit.byoyomi,increment:this.setting.timeLimit.increment,onBeepShort:()=>this.onBeepShort(),onBeepUnlimited:()=>this.onBeepUnlimited(),onStopBeep:()=>this.onStopBeep()};this.blackClock.setup({...t,onTimeout:()=>{this.timeout(L.BLACK)}}),this.whiteClock.setup({...t,onTimeout:()=>{this.timeout(L.WHITE)}});try{this.blackPlayer=await this.playerBuilder.build(this.setting.black,i=>this.recordManager.updateSearchInfo(Kt.OPPONENT,i)),this.whitePlayer=await this.playerBuilder.build(this.setting.white,i=>this.recordManager.updateSearchInfo(Kt.OPPONENT,i))}catch(i){try{await this.closePlayers()}catch(n){this.onError(n)}throw i}this.state="active",this.onGameNext(),setTimeout(()=>this.nextMove())}nextMove(){if(this.state!=="active")return;if(this._setting.maxMoves&&this.recordManager.record.current.number>=this._setting.maxMoves){this.endGame(le.IMPASS);return}this.getActiveClock().start();const t=this.recordManager.record.position.color,i=this.getPlayer(t),n=this.getPlayer(Mt(t));if(!i||!n){this.onError(new Error("GameManager#nextMove: "));return}const s=this.issueEventID();i.startSearch(this.recordManager.record,this.setting.timeLimit,this.blackClock.timeMs,this.whiteClock.timeMs,{onMove:(o,r)=>this.onMove(s,o,r),onResign:()=>this.onResign(s),onWin:()=>this.onWin(s),onError:o=>this.onError(o)}).catch(o=>{this.onError(new Error("GameManager#nextMove: : "+o))}),n.startPonder(this.recordManager.record,this.setting.timeLimit,this.blackClock.timeMs,this.whiteClock.timeMs).catch(o=>{this.onError(new Error("GameManager#nextMove: Ponder: "+o))})}onMove(t,i,n){if(t!==this.lastEventID){fe.log(mt.ERROR,"GameManager#onMove: event ID already disabled");return}if(this.state!=="active"){fe.log(mt.ERROR,"GameManager#onMove: invalid state: "+this.state);return}if(!this.recordManager.record.position.isValidMove(i)){this.onError(": "+Jn(this.recordManager.record.position,i)),this.endGame(le.FOUL_LOSE);return}this.getActiveClock().stop(),this.recordManager.appendMove({move:i,moveOption:{ignoreValidation:!0},elapsedMs:this.getActiveClock().elapsedMs}),n&&this.recordManager.updateSearchInfo(Kt.PLAYER,n),n&&this.setting.enableComment&&this.recordManager.appendSearchComment(Kt.PLAYER,n,Fi.APPEND),this.onPieceBeat();const s=this.recordManager.record.perpetualCheck;if(s)if(s===this.recordManager.record.position.color){this.endGame(le.FOUL_LOSE);return}else{this.endGame(le.FOUL_WIN);return}else if(this.recordManager.record.repetition){this.endGame(le.REPETITION_DRAW);return}this.nextMove()}onResign(t){if(t!==this.lastEventID){fe.log(mt.ERROR,"GameManager#onResign: event ID already disabled");return}if(this.state!=="active"){fe.log(mt.ERROR,"GameManager#onResign: invalid state: "+this.state);return}this.endGame(le.RESIGN)}onWin(t){if(t!==this.lastEventID){fe.log(mt.ERROR,"GameManager#onWin: event ID already disabled");return}if(this.state!=="active"){fe.log(mt.ERROR,"GameManager#onWin: invalid state: "+this.state);return}this.endGame(le.ENTERING_OF_KING)}timeout(t){this.onStopBeep();const i=this.getPlayer(t);if(i&&i.isEngine()&&!this.setting.enableEngineTimeout){i.stop().catch(n=>{this.onError(new Error("GameManager#timeout: : "+n))});return}this.endGame(le.TIMEOUT)}endGame(t){if(this.state!=="active"&&this.state!=="pending")return;this.state="bussy";const i=this.recordManager.record.position.color;Promise.resolve().then(()=>this.sendGameResults(i,t)).then(()=>this.closePlayers()).then(()=>{if(this.getActiveClock().pause(),this.recordManager.appendMove({move:t,elapsedMs:this.getActiveClock().elapsedMs}),this.recordManager.setGameEndMetadata(),this.addGameResults(i,t),this.state="idle",this._setting.enableAutoSave&&this.onSaveRecord(),t===le.INTERRUPT||this.repeat>=this.setting.repeat){this.onGameEnd(this.results,t);return}this.setting.swapPlayers&&this.swapPlayers(),this.nextGame().catch(s=>{this.onError(s)})}).catch(n=>{this.onError(n),this.state="pending"})}addGameResults(t,i){switch(aa(t,L.BLACK,i)){case Di.WIN:this._results.player1.win++;break;case Di.LOSE:this._results.player2.win++;break;case Di.DRAW:this._results.draw++;break;default:this._results.invalid++;break}this._results.total++}swapPlayers(){this._setting={...this.setting,black:this.setting.white,white:this.setting.black},this._results={...this.results,player1:this.results.player2,player2:this.results.player1}}async sendGameResults(t,i){if(this.blackPlayer){const n=aa(t,L.BLACK,i);n&&await this.blackPlayer.gameover(n)}if(this.whitePlayer){const n=aa(t,L.WHITE,i);n&&await this.whitePlayer.gameover(n)}}async closePlayers(){this.blackPlayer&&(await this.blackPlayer.close(),this.blackPlayer=void 0),this.whitePlayer&&(await this.whitePlayer.close(),this.whitePlayer=void 0)}getPlayer(t){switch(t){case L.BLACK:return this.blackPlayer;case L.WHITE:return this.whitePlayer}}getActiveClock(){switch(this.recordManager.record.position.color){case L.BLACK:return this.blackClock;case L.WHITE:return this.whiteClock}}issueEventID(){return this.lastEventID+=1,this.lastEventID}}function aa(e,t,i){switch(i){case le.FOUL_WIN:case le.ENTERING_OF_KING:return e==t?Di.WIN:Di.LOSE;case le.RESIGN:case le.MATE:case le.TIMEOUT:case le.FOUL_LOSE:return e==t?Di.LOSE:Di.WIN;case le.IMPASS:case le.REPETITION_DRAW:return Di.DRAW}return null}function bu(e){let t=C1(e);const i=e.getStandardMetadata(ue.TITLE)||e.getStandardMetadata(ue.TOURNAMENT)||e.getStandardMetadata(ue.OPUS_NAME)||e.getStandardMetadata(ue.OPUS_NO)||e.getStandardMetadata(ue.PLACE)||e.getStandardMetadata(ue.POSTED_ON)||e.getStandardMetadata(ue.AUTHOR);i&&(t+="_"+i);const n=e.getStandardMetadata(ue.BLACK_NAME)||e.getStandardMetadata(ue.BLACK_SHORT_NAME);n&&(t+="_"+n);const s=e.getStandardMetadata(ue.WHITE_NAME)||e.getStandardMetadata(ue.WHITE_SHORT_NAME);return s&&(t+="_"+s),t.trim().replaceAll("/","_").replaceAll("\\","_")+".kif"}function C1(e){const t=e.getStandardMetadata(ue.START_DATETIME)||e.getStandardMetadata(ue.DATE);return t?t.trim().replaceAll(" ","_").replaceAll("/","").replaceAll(":",""):cf().replaceAll("/","")}class x1{constructor(){M(this,"count",0)}get isBussy(){return this.count!==0}retain(){this.count+=1}release(){this.count-=1}}function M1(e,t){const i=e.clone();let n,s="";for(const o of t){const r=i.createMoveByUSI(o);if(!r)break;s+=Jn(i,r,{prev:n}),i.doMove(r,{ignoreValidation:!0}),n=r}return s}class df{constructor(t,i){M(this,"sfen","");M(this,"nodes");M(this,"nps");M(this,"iterates",[]);M(this,"hashfull");M(this,"currentMove");M(this,"currentMoveText");M(this,"ponderMove");this.sessionID=t,this.name=i}get latestIteration(){const t=[],i=new Set,n=new Set;for(const s of this.iterates){const o=s.pv?s.pv[0]:void 0;!i.has(s.multiPV)&&!n.has(o)&&(t.push(s),i.add(s.multiPV),n.add(o))}return t.sort((s,o)=>(s.multiPV||1)-(o.multiPV||1))}update(t,i,n){this.sfen!==t&&(this.sfen=t,this.nodes=void 0,this.nps=void 0,this.iterates=[],this.hashfull=void 0,this.currentMove=void 0,this.currentMoveText=void 0,this.ponderMove=void 0);const s=Rt.newBySFEN(t);if(!s)return;const o={position:t,color:s.color};if(i.depth!==void 0&&(o.depth=i.depth),i.seldepth!==void 0&&(o.selectiveDepth=i.seldepth),i.timeMs!==void 0&&(o.timeMs=i.timeMs),i.nodes!==void 0&&(this.nodes=i.nodes),i.pv&&(o.pv=i.pv,o.text=M1(s,i.pv)),i.multipv!==void 0&&(o.multiPV=i.multipv),i.scoreCP!==void 0&&(o.score=i.scoreCP),i.scoreMate!==void 0&&(o.scoreMate=i.scoreMate),i.lowerbound!==void 0&&(o.lowerBound=i.lowerbound),i.upperbound!==void 0&&(o.upperBound=i.upperbound),i.currmove!==void 0){this.currentMove=i.currmove;const r=s.createMoveByUSI(i.currmove);r&&(this.currentMoveText=Jn(s,r))}i.hashfullPerMill!==void 0&&(this.hashfull=i.hashfullPerMill/1e3),i.nps!==void 0&&(this.nps=i.nps),i.string&&(o.text=i.string),Object.keys(o).length!==0&&(i.nodes!==void 0&&(o.nodes=i.nodes),this.iterates.unshift(o)),this.ponderMove=n&&Jn(s,n)}}class T1{constructor(){M(this,"_sessions",[]);M(this,"updateQueue",[]);M(this,"timeoutHandle")}get sessions(){return this._sessions}clear(){this._sessions=[],this.updateQueue=[],this.timeoutHandle&&(window.clearTimeout(this.timeoutHandle),this.timeoutHandle=void 0)}update(t,i,n,s,o){this.updateQueue.push({sessionID:t,sfen:i.sfen,name:n,info:s,ponderMove:o}),this.timeoutHandle||(this.timeoutHandle=window.setTimeout(()=>{this.dequeue()},500))}dequeue(){for(const t of this.updateQueue)this._update(t);this.updateQueue=[],this.timeoutHandle=void 0}_update(t){let i=this._sessions.find(n=>n.sessionID===t.sessionID);i||(i=this.addSession(t.sessionID,t.name)),i.update(t.sfen,t.info,t.ponderMove)}addSession(t,i){const n=new df(t,i);return this.sessions.push(n),this.sessions.sort((s,o)=>s.sessionID-o.sessionID),n}}var K=(e=>(e.NORMAL="normal",e.PASTE_DIALOG="pasteDialog",e.POSITION_EDITING="positionEditing",e.GAME_DIALOG="gameDialog",e.GAME="game",e.CSA_GAME_DIALOG="csaGameDialog",e.CSA_GAME="csaGame",e.RESEARCH="research",e.RESEARCH_DIALOG="researchDialog",e.ANALYSIS="analysis",e.ANALYSIS_DIALOG="analysisDialog",e.USI_ENGINE_SETTING_DIALOG="usiEngineSettingDialog",e))(K||{});class R1{constructor(){M(this,"_queue",[])}get message(){return this._queue[0]}get hasMessage(){return this._queue.length!==0}enqueue(t){this._queue.push(t)}dequeue(){this._queue.shift()}}class O1{constructor(){M(this,"errorCounts",{})}get errors(){return Object.entries(this.errorCounts).sort(([t],[i])=>t<i?-1:t>i?1:0).map(([t,i])=>({message:t,count:i}))}get hasError(){return!!Object.keys(this.errorCounts).length}add(t){const i=t instanceof Error?t.message:""+t,n=this.errorCounts[i]||0;this.errorCounts[i]=n+1}clear(){this.errorCounts={}}}class N1{constructor(){M(this,"setting",Ha())}get raw(){return this.setting}get language(){return this.setting.language}get thema(){return this.setting.thema}get pieceImage(){return this.setting.pieceImage}get boardImage(){return this.setting.boardImage}get boardLabelType(){return this.setting.boardLabelType}get pieceVolume(){return this.setting.pieceVolume}get clockVolume(){return this.setting.clockVolume}get clockPitch(){return this.setting.clockPitch}get clockSoundTarget(){return this.setting.clockSoundTarget}get boardFlipping(){return this.setting.boardFlipping}get tabPaneType(){return this.setting.tabPaneType}get tab(){return this.setting.tab}get tab2(){return this.setting.tab2}get topPaneHeightPercentage(){return this.setting.topPaneHeightPercentage}get topPanePreviousHeightPercentage(){return this.setting.topPanePreviousHeightPercentage}get bottomLeftPaneWidthPercentage(){return this.setting.bottomLeftPaneWidthPercentage}get returnCode(){return this.setting.returnCode}get autoSaveDirectory(){return this.setting.autoSaveDirectory}get engineTimeoutSeconds(){return this.setting.engineTimeoutSeconds}get evaluationViewFrom(){return this.setting.evaluationViewFrom}get coefficientInSigmoid(){return this.setting.coefficientInSigmoid}get badMoveLevelThreshold1(){return this.setting.badMoveLevelThreshold1}get badMoveLevelThreshold2(){return this.setting.badMoveLevelThreshold2}get badMoveLevelThreshold3(){return this.setting.badMoveLevelThreshold3}get badMoveLevelThreshold4(){return this.setting.badMoveLevelThreshold4}get showElapsedTimeInRecordView(){return this.setting.showElapsedTimeInRecordView}get showCommentInRecordView(){return this.setting.showCommentInRecordView}get enableAppLog(){return this.setting.enableAppLog}get enableUSILog(){return this.setting.enableUSILog}get enableCSALog(){return this.setting.enableCSALog}get logLevel(){return this.setting.logLevel}async reloadAppSetting(){this.setting=await fe.loadAppSetting()}async updateAppSetting(t){const i=Vm(this.setting,t);if(i instanceof Error)throw i;await fe.saveAppSetting(i),this.setting=i}flipBoard(){this.setting.boardFlipping=!this.setting.boardFlipping,fe.saveAppSetting(this.setting)}}function L1(){return Ci(new N1)}let la;function $e(){return la||(la=L1()),la}class B1{constructor(t){M(this,"researcher");M(this,"setting",tr());M(this,"number");M(this,"actualMove");M(this,"lastSearchInfo");M(this,"searchInfo");M(this,"timerHandle");M(this,"onFinish",()=>{});M(this,"onError",()=>{});this.recordManager=t}on(t,i){switch(t){case"finish":this.onFinish=i;break;case"error":this.onError=i;break}return this}async start(t){if(!t.usi)throw new Error("");await this.setupEngine(t.usi),this.setting=t,this.number=void 0,this.actualMove=void 0,this.lastSearchInfo=void 0,this.searchInfo=void 0,setTimeout(()=>this.next())}close(){this.clearTimer(),this.closeEngine().catch(t=>{this.onError(t)})}async setupEngine(t){if(this.researcher)throw new Error("AnalysisManager#setupEngine: ");const i=$e(),n=new zl(t,i.engineTimeoutSeconds,this.updateSearchInfo.bind(this));await n.launch(),this.researcher=n}async closeEngine(){this.researcher&&(await this.researcher.close(),this.researcher=void 0)}next(){if(this.clearTimer(),!this.researcher){this.onError(new Error("")),this.finish();return}if(this.lastSearchInfo=this.searchInfo,this.searchInfo=void 0,this.number!==void 0?this.number=this.number+1:this.setting.startCriteria.enableNumber?this.number=this.setting.startCriteria.number-1:this.number=0,this.setting.endCriteria.enableNumber&&this.number>=this.setting.endCriteria.number){this.finish();return}this.recordManager.changePly(this.number);const t=this.recordManager.record;if(t.current.number!==this.number){this.finish();return}if(!t.current.next&&!(t.current.move instanceof rt)){this.finish();return}this.actualMove=t.current.move instanceof rt?t.current.move:void 0,this.setTimer(),this.researcher.startResearch(t).catch(i=>{this.onError(i)})}finish(){this.onFinish(),this.close()}setTimer(){this.timerHandle=window.setTimeout(()=>{this.onResult(),this.next()},this.setting.perMoveCriteria.maxSeconds*1e3)}clearTimer(){this.timerHandle&&(clearTimeout(this.timerHandle),this.timerHandle=void 0)}onResult(){if(!this.searchInfo||!this.lastSearchInfo)return;const t=this.recordManager.record,n=Mt(t.position.color)===L.BLACK?1:-1,s=this.searchInfo.score!==void 0?this.searchInfo.score*n:void 0,o=this.searchInfo.score!==void 0&&this.lastSearchInfo.score!==void 0?(this.searchInfo.score-this.lastSearchInfo.score)*n:void 0,r=this.actualMove&&this.lastSearchInfo.pv?this.actualMove.equals(this.lastSearchInfo.pv[0]):void 0,a=$e();let l="";if(o!==void 0&&s!==void 0&&!r){const c=D1(s-o,s,a);c&&(l=`${c}`)}this.recordManager.appendSearchComment(Kt.RESEARCHER,this.searchInfo,this.setting.commentBehavior,l)}updateSearchInfo(t){this.recordManager.updateSearchInfo(Kt.RESEARCHER,t),this.searchInfo=t}}function D1(e,t,i){const n=Va(e,i.coefficientInSigmoid)-Va(t,i.coefficientInSigmoid);return n>=i.badMoveLevelThreshold4?"":n>=i.badMoveLevelThreshold3?"":n>=i.badMoveLevelThreshold2?"":n>=i.badMoveLevelThreshold1?"":null}function F1(){return{id:"",myColor:L.BLACK,toMove:L.BLACK,position:"",timeUnitMs:1e3,totalTime:0,byoyomi:0,delay:0,increment:0}}var Ti=(e=>(e.UNKNOWN="unknown",e.RESIGN="resign",e.SENNICHITE="sennichite",e.OUTE_SENNICHITE="oute_sennichite",e.ILLEGAL_MOVE="illegal_move",e.ILLEGAL_ACTION="illegal_action",e.TIME_UP="time_up",e.JISHOGI="jishogi",e.MAX_MOVES="max_moves",e))(Ti||{}),Mo=(e=>(e.WIN="win",e.LOSE="lose",e.DRAW="draw",e.CENSORED="censored",e.CHUDAN="chudan",e))(Mo||{}),Fs=(e=>(e.V121="v121",e.V121_FLOODGATE="v121_floodgate",e))(Fs||{});function ff(){return{protocolVersion:"v121",host:"localhost",port:4081,id:"",password:""}}function $1(){return{player:{name:"",uri:Qt},server:ff(),autoFlip:!0,enableComment:!0,enableAutoSave:!0,repeat:1,autoRelogin:!0}}function H1(e){if(e.server.protocolVersion!=="v121"&&e.server.protocolVersion!=="v121_floodgate")return new Error("");if(e.server.host==="")return new Error("");if(e.server.port<0||e.server.port>65535)return new Error("");if(e.server.id==="")return new Error("ID")}function U1(){return{player:{name:"",uri:Qt},serverHistory:[],autoFlip:!0,enableComment:!0,enableAutoSave:!0,repeat:1,autoRelogin:!0}}function z1(e,t){var i;return{player:e.player,server:((i=e.serverHistory)==null?void 0:i.length)>t?e.serverHistory[t]:ff(),autoFlip:e.autoFlip,enableComment:e.enableComment,enableAutoSave:e.enableAutoSave,repeat:e.repeat,autoRelogin:e.autoRelogin}}const pf=10;function W1(e,t){const i=[t.server];for(const n of e.serverHistory)if((n.protocolVersion!==t.server.protocolVersion||n.host!==t.server.host||n.port!==t.server.port||n.id!==t.server.id||n.password!==t.server.password)&&i.push(n),i.length===pf)break;return{player:t.player,serverHistory:i,autoFlip:t.autoFlip,enableComment:t.enableComment,enableAutoSave:t.enableAutoSave,repeat:t.repeat,autoRelogin:t.autoRelogin}}const gf=5;var An=(e=>(e[e.OFFLINE=0]="OFFLINE",e[e.WAITING_LOGIN=1]="WAITING_LOGIN",e[e.LOGIN_FAILED=2]="LOGIN_FAILED",e[e.LOGIN_RETRY_INTERVAL=3]="LOGIN_RETRY_INTERVAL",e[e.READY=4]="READY",e[e.GAME=5]="GAME",e))(An||{});class G1{constructor(t,i,n){M(this,"_state",0);M(this,"_setting",$1());M(this,"sessionID",0);M(this,"stopRequested",!1);M(this,"repeat",0);M(this,"player");M(this,"gameSummary",F1());M(this,"searchInfo");M(this,"playerBuilder",rr());M(this,"retryTimer");M(this,"onSaveRecord",()=>{});M(this,"onGameNext",()=>{});M(this,"onGameEnd",()=>{});M(this,"onFlipBoard",()=>{});M(this,"onPieceBeat",()=>{});M(this,"onBeepShort",()=>{});M(this,"onBeepUnlimited",()=>{});M(this,"onStopBeep",()=>{});M(this,"onError",()=>{});this.recordManager=t,this.blackClock=i,this.whiteClock=n}on(t,i){switch(t){case"saveRecord":this.onSaveRecord=i;break;case"gameNext":this.onGameNext=i;break;case"gameEnd":this.onGameEnd=i;break;case"flipBoard":this.onFlipBoard=i;break;case"pieceBeat":this.onPieceBeat=i;break;case"beepShort":this.onBeepShort=i;break;case"beepUnlimited":this.onBeepUnlimited=i;break;case"stopBeep":this.onStopBeep=i;break;case"error":this.onError=i;break}return this}get state(){return this._state}get setting(){return this._setting}get isMyTurn(){return this.recordManager.record.position.color===this.gameSummary.myColor}login(t,i){return this.sessionID?Promise.reject(new Error("CSAGameManager#start: session already exists")):this._state!==0?Promise.reject(new Error("CSAGameManager#start: unexpected state")):(this._setting=t,this.playerBuilder=i,this.repeat=0,this.relogin())}async relogin(){this._state=1;try{this.player=await this.playerBuilder.build(this._setting.player,i=>this.recordManager.updateSearchInfo(Kt.OPPONENT,i));const t=await fe.csaLogin(this._setting.server);this.sessionID=t,this._state=4,V1(this.sessionID,this),this.onGameNext()}catch(t){throw this._state=2,this.close(1),t}}stop(){this.sessionID&&(this.stopRequested=!0,fe.csaStop(this.sessionID))}logout(){this.close(0)}close(t){if(this._state===0||this._state===1)return;if(this.stopRequested&&(t=0,this.stopRequested=!1),this.sessionID&&(j1(this.sessionID),fe.csaLogout(this.sessionID).catch(n=>{this.onError(n)}),this.sessionID=0),this.player&&(this.player.close().catch(n=>{this.onError(n)}),this.player=void 0),this.blackClock.stop(),this.whiteClock.stop(),this._state=0,this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=void 0),t===0||this.repeat>=this.setting.repeat){this.onGameEnd();return}const i=()=>{this.relogin().catch(n=>{this.onError(n)})};t===2?i():(this._state=3,this.retryTimer=setTimeout(i,gf*1e3))}onGameSummary(t){this.gameSummary=t,fe.csaAgree(this.sessionID,this.gameSummary.id)}onReject(){this.close(1)}onStart(t){this.repeat++,this.recordManager.importRecord(this.gameSummary.position,Fn.CSA),this.recordManager.setGameStartMetadata({gameTitle:this.gameSummary.id,blackName:this.gameSummary.blackPlayerName,whiteName:this.gameSummary.whitePlayerName,timeLimit:{timeSeconds:this.gameSummary.totalTime*this.gameSummary.timeUnitMs/1e3,byoyomi:this.gameSummary.byoyomi*this.gameSummary.timeUnitMs/1e3,increment:this.gameSummary.increment*this.gameSummary.timeUnitMs/1e3}}),this.setting.autoFlip&&this.onFlipBoard&&this.onFlipBoard(this.gameSummary.myColor===L.WHITE),this._state=5,this.next(t)}onMove(t,i){const n=this.isMyTurn,s=j0(this.recordManager.record.position,t);if(s instanceof Error){this.onError(`CSAGameManager#onMove:  [${t}]: ${s.message}`);return}const o=/^.*,T([0-9]+)$/.exec(t),r=o?Number(parseInt(o[1]))*this.gameSummary.timeUnitMs:0;this.recordManager.appendMove({move:s,moveOption:{ignoreValidation:!0},elapsedMs:r}),n&&this.searchInfo&&this.recordManager.updateSearchInfo(Kt.PLAYER,this.searchInfo),n&&this.searchInfo&&this.setting.enableComment&&this.recordManager.appendSearchComment(Kt.PLAYER,this.searchInfo,Fi.APPEND),this.onPieceBeat(),this.next(i)}onGameResult(t,i){this.recordManager.appendMove({move:this.gameResultToSpecialMove(t,i)}),this.setting.enableAutoSave&&this.onSaveRecord(),this.close(2)}gameResultToSpecialMove(t,i){const n=this.recordManager.record.position.color;switch(t){case Ti.RESIGN:return le.RESIGN;case Ti.SENNICHITE:return le.REPETITION_DRAW;case Ti.OUTE_SENNICHITE:case Ti.ILLEGAL_MOVE:case Ti.ILLEGAL_ACTION:switch(i){case Mo.WIN:return n===this.gameSummary.myColor?le.FOUL_WIN:le.FOUL_LOSE;case Mo.LOSE:return n===this.gameSummary.myColor?le.FOUL_LOSE:le.FOUL_WIN}break;case Ti.TIME_UP:return le.TIMEOUT;case Ti.JISHOGI:return le.ENTERING_OF_KING;case Ti.MAX_MOVES:return le.IMPASS}return i===Mo.DRAW?le.DRAW:le.INTERRUPT}onClose(){this.close(this.setting.autoRelogin?1:0)}next(t){this.blackClock.stop(),this.whiteClock.stop();const i={byoyomi:this.gameSummary.byoyomi*this.gameSummary.timeUnitMs/1e3,onBeepShort:()=>this.onBeepShort(),onBeepUnlimited:()=>this.onBeepUnlimited(),onStopBeep:()=>this.onStopBeep()};this.blackClock.setup({...i,timeMs:t.black.time*this.gameSummary.timeUnitMs}),this.whiteClock.setup({...i,timeMs:t.white.time*this.gameSummary.timeUnitMs});const n=this.recordManager.record.position.color;if(n===L.BLACK?this.blackClock.start():this.whiteClock.start(),!this.player){this.onError("CSA ");return}const s={timeSeconds:this.gameSummary.totalTime*this.gameSummary.timeUnitMs/1e3,byoyomi:this.gameSummary.byoyomi*this.gameSummary.timeUnitMs/1e3,increment:this.gameSummary.increment*this.gameSummary.timeUnitMs/1e3};n===this.gameSummary.myColor?this.player.startSearch(this.recordManager.record,s,t.black.time*this.gameSummary.timeUnitMs,t.white.time*this.gameSummary.timeUnitMs,{onMove:this.onPlayerMove.bind(this),onResign:this.onPlayerResign.bind(this),onWin:this.onPlayerWin.bind(this),onError:this.onPlayerError.bind(this)}).catch(o=>{this.onError(new Error("CSAGameManager#next: : "+o))}):this.player.startPonder(this.recordManager.record,s,this.blackClock.timeMs,this.whiteClock.timeMs).catch(o=>{this.onError(new Error("CSAGameManager#next: Ponder: "+o))})}onPlayerMove(t,i){this.searchInfo=i;let n,s;switch(this._setting.server.protocolVersion){case Fs.V121:break;case Fs.V121_FLOODGATE:if(n=i==null?void 0:i.score,i!=null&&i.pv)for(const o of i.pv)s=s?s+" ":"",s+=Kc(o);break}fe.csaMove(this.sessionID,Kc(t),n,s)}onPlayerResign(){fe.csaResign(this.sessionID)}onPlayerWin(){fe.csaWin(this.sessionID)}onPlayerError(t){this.onError(t)}}const rn={};function V1(e,t){rn[e]=t}function j1(e){delete rn[e]}function K1(e,t){const i=rn[e];i&&i.onGameSummary(t)}function q1(e){const t=rn[e];t&&t.onReject()}function Y1(e,t){const i=rn[e];i&&i.onStart(t)}function X1(e,t,i){const n=rn[e];n&&n.onMove(t,i)}function J1(e,t,i){const n=rn[e];n&&n.onGameResult(t,i)}function Q1(e){const t=rn[e];t&&t.onClose()}class _u{constructor(){M(this,"setting",{timeMs:0,byoyomi:0,increment:0});M(this,"_timeMs",0);M(this,"_byoyomi",0);M(this,"_elapsedMs",0);M(this,"timerHandle",0);M(this,"timerStart",0);M(this,"lastTimeMs",0)}setup(t){this.setting=t,this._timeMs=t.timeMs||0,this._byoyomi=t.byoyomi||0,this._elapsedMs=0}get time(){return Math.ceil(this._timeMs/1e3)}get timeMs(){return this._timeMs}get byoyomi(){return this._byoyomi}get elapsedMs(){return this._elapsedMs}start(){this.clearTimer(),this.timerStart=Date.now(),this.lastTimeMs=this._timeMs,this._byoyomi=this.setting.byoyomi||0,this._elapsedMs=0,this.timerHandle=window.setInterval(()=>{const t=this.timeMs,i=this.byoyomi;this._elapsedMs=Date.now()-this.timerStart;const n=this.lastTimeMs-this._elapsedMs;if(n>=0?this._timeMs=n:(this._timeMs=0,this._byoyomi=Math.max(Math.ceil((this.setting.byoyomi||0)+n/1e3),0)),this.timeMs===0&&this.byoyomi===0){this.timeout();return}this.fireBeep(t,i)},100)}fireBeep(t,i){let n=Math.ceil(this.timeMs/1e3),s=Math.ceil(t/1e3);if(!(n!==0&&this.byoyomi!==0)){if(n===0&&s!==0){this.setting.onBeepShort&&this.setting.onBeepShort();return}this.byoyomi!==0&&(n=this.byoyomi,s=i),n!==s&&(n<=5?this.setting.onBeepUnlimited&&this.setting.onBeepUnlimited():(n<=10||n===20||n===30||n===60)&&this.setting.onBeepShort&&this.setting.onBeepShort())}}pause(){this.clearTimer()}stop(){this.clearTimer(),this.incrementTime()}timeout(){this.clearTimer(),this.setting.onTimeout&&this.setting.onTimeout()}clearTimer(){this.timerHandle&&(window.clearInterval(this.timerHandle),this.timerHandle=0),this.setting.onStopBeep&&this.setting.onStopBeep()}incrementTime(){this._timeMs+=(this.setting.increment||0)*1e3}}function Z1(e){switch(e){case 0:return Kt.RESEARCHER;case 1:return Kt.RESEARCHER_2;case 2:return Kt.RESEARCHER_3;case 3:return Kt.RESEARCHER_4;default:return}}class e_{constructor(){M(this,"engines",[]);M(this,"onUpdateSearchInfo")}on(t,i){switch(t){case"updateSearchInfo":this.onUpdateSearchInfo=i}}async launch(t){var s;if(t.usi===void 0)throw new Error("ResearchManager#launch: USI");for(const o of t.secondaries||[])if(o.usi===void 0)throw new Error("ResearchManager#launch: USI");if(this.engines.length>0)throw new Error("ResearchManager#launch: ");const i=$e(),n=[t.usi,...((s=t.secondaries)==null?void 0:s.map(o=>o.usi))||[]].filter(o=>!!o);this.engines=n.map((o,r)=>{const a=Z1(r);return new zl(o,i.engineTimeoutSeconds,l=>{this.onUpdateSearchInfo&&a!==void 0&&this.onUpdateSearchInfo(a,l)})});try{await Promise.all(this.engines.map(o=>o.launch()))}catch(o){throw this.close(),o}}updatePosition(t){this.engines.forEach(i=>i.startResearch(t))}async close(){await Promise.allSettled(this.engines.map(t=>t.close())),this.engines=[]}}function yu(e){const t=e.total-e.invalid;return[{type:"list",items:[{text:e.player1.name,children:[`: ${e.player1.win}`,`: ${Nc(e.player1.win,t,1)}`]},{text:e.player2.name,children:[`: ${e.player2.win}`,`: ${Nc(e.player2.win,t,1)}`]},{text:`: ${e.draw}`},{text:`: ${t}`},{text:`: ${e.invalid}`}]}]}class t_{constructor(){M(this,"_bussy",new x1);M(this,"_message",new R1);M(this,"_error",new O1);M(this,"recordManager",new E1);M(this,"_appState",K.NORMAL);M(this,"_isAppSettingDialogVisible",!1);M(this,"_confirmation");M(this,"usiMonitor",new T1);M(this,"blackClock",new _u);M(this,"whiteClock",new _u);M(this,"gameManager",new A1(this.recordManager,this.blackClock,this.whiteClock));M(this,"csaGameManager",new G1(this.recordManager,this.blackClock,this.whiteClock));M(this,"researchManager",new e_);M(this,"analysisManager",new B1(this.recordManager));M(this,"_reactive");this.updateAppTitle(),this.recordManager.on("changeFilePath",n=>{this.updateAppTitle(n)}),this.recordManager.on("changePosition",()=>{this.onUpdatePosition()});const t=Ci(this),i=$e();this.gameManager.on("saveRecord",t.onSaveRecord.bind(t)).on("gameNext",t.onGameNext.bind(t)).on("gameEnd",t.onGameEnd.bind(t)).on("pieceBeat",()=>Yr(i.pieceVolume)).on("beepShort",this.onBeepShort.bind(this)).on("beepUnlimited",this.onBeepUnlimited.bind(this)).on("stopBeep",Jc).on("error",t.pushError.bind(t)),this.csaGameManager.on("saveRecord",t.onSaveRecord.bind(t)).on("gameNext",t.onGameNext.bind(t)).on("gameEnd",t.onCSAGameEnd.bind(t)).on("flipBoard",t.onFlipBoard.bind(t)).on("pieceBeat",()=>Yr(i.pieceVolume)).on("beepShort",this.onBeepShort.bind(this)).on("beepUnlimited",this.onBeepUnlimited.bind(this)).on("stopBeep",Jc).on("error",t.pushError.bind(t)),this.researchManager.on("updateSearchInfo",this.onUpdateSearchInfo.bind(t)),this.analysisManager.on("finish",this.onFinish.bind(t)).on("error",this.pushError.bind(t)),this._reactive=t}get reactive(){return this._reactive}updateAppTitle(t){if(!document)return;const i=ve.electronShogi,n=af.appVersion;t?document.title=`${i} Version ${n} - ${t}`:document.title=`${i} Version ${n}`}get isBussy(){return this._bussy.isBussy}retainBussyState(){return this._bussy.retain()}releaseBussyState(){return this._bussy.release()}get message(){return this._message.message}get hasMessage(){return this._message.hasMessage}enqueueMessage(t){this._message.enqueue(t)}dequeueMessage(){this._message.dequeue()}get errors(){return this._error.errors}get hasError(){return this._error.hasError}pushError(t){fe.log(mt.ERROR,Dd(t)),this._error.add(t)}clearErrors(){this._error.clear()}get record(){return this.recordManager.record}get recordFilePath(){return this.recordManager.recordFilePath}updateStandardRecordMetadata(t){this.recordManager.updateStandardMetadata(t)}get appState(){return this._appState}get confirmation(){var t;return(t=this._confirmation)==null?void 0:t.message}showConfirmation(t){this._confirmation&&fe.log(mt.WARN,`Store#showConfirmation:  appState=${this.appState} currentMessage=${this._confirmation.message} newMessage=${t.message}`),this._confirmation={...t,appState:this.appState}}confirmationOk(){if(!this._confirmation)return;const t=this._confirmation;if(this._confirmation=void 0,this.appState!==t.appState){this.pushError("");return}t.onOk&&t.onOk()}confirmationCancel(){this._confirmation=void 0}showPasteDialog(){this.appState===K.NORMAL&&(this._appState=K.PASTE_DIALOG)}showGameDialog(){this.appState===K.NORMAL&&(this._appState=K.GAME_DIALOG)}showCSAGameDialog(){this.appState===K.NORMAL&&(this._appState=K.CSA_GAME_DIALOG)}showResearchDialog(){this.appState===K.NORMAL&&(this._appState=K.RESEARCH_DIALOG)}showAnalysisDialog(){this.appState===K.NORMAL&&(this._appState=K.ANALYSIS_DIALOG)}showUsiEngineManagementDialog(){this.appState===K.NORMAL&&(this._appState=K.USI_ENGINE_SETTING_DIALOG)}destroyModalDialog(){(this.appState===K.PASTE_DIALOG||this.appState===K.GAME_DIALOG||this.appState===K.CSA_GAME_DIALOG||this.appState===K.RESEARCH_DIALOG||this.appState===K.ANALYSIS_DIALOG||this.appState===K.USI_ENGINE_SETTING_DIALOG)&&(this._appState=K.NORMAL)}closeModalDialog(){this.isBussy||this.destroyModalDialog()}get isAppSettingDialogVisible(){return this._isAppSettingDialogVisible}showAppSettingDialog(){this._isAppSettingDialogVisible=!0}closeAppSettingDialog(){this._isAppSettingDialogVisible=!1}get usiMonitors(){return this.usiMonitor.sessions}updateUSIInfo(t,i,n,s){this.recordManager.record.usi===i&&this.usiMonitor.update(t,this.recordManager.record.position,n,s)}updateUSIPonderInfo(t,i,n,s){const o=At.newByUSI(i);if(o instanceof Error){fe.log(mt.ERROR,`invalid USI: ${i} (updateUSIPonderInfo)`);return}const r=o.current.move;r instanceof rt&&this.usiMonitor.update(t,o.position,n,s,r)}get blackTime(){return this.blackClock.time}get blackByoyomi(){return this.blackClock.byoyomi}get whiteTime(){return this.whiteClock.time}get whiteByoyomi(){return this.whiteClock.byoyomi}startGame(t){this.appState!==K.GAME_DIALOG||this.isBussy||(this.retainBussyState(),fe.saveGameSetting(t).then(()=>{this.initializeDisplaySettingForGame(t);const i=$e(),n=rr(i.engineTimeoutSeconds);return this.gameManager.startGame(t,n)}).then(()=>this._appState=K.GAME).catch(i=>{this.pushError(": "+i)}).finally(()=>{this.releaseBussyState()}))}get gameSetting(){return this.gameManager.setting}get gameResults(){return this.gameManager.results}get csaGameState(){return this.csaGameManager.state}loginCSAGame(t,i){this.appState!==K.CSA_GAME_DIALOG||this.isBussy||(this.retainBussyState(),Promise.resolve().then(async()=>{if(i.saveHistory){const n=await fe.loadCSAGameSettingHistory(),s=W1(n,t);await fe.saveCSAGameSettingHistory(s)}}).then(()=>{const n=$e(),s=rr(n.engineTimeoutSeconds);return this.csaGameManager.login(t,s)}).then(()=>this._appState=K.CSA_GAME).catch(n=>{this.pushError(": "+n)}).finally(()=>{this.releaseBussyState()}))}cancelCSAGame(){if(this.appState===K.CSA_GAME){if(this.csaGameManager.state===An.GAME){this.pushError("");return}this.csaGameManager.logout(),this._appState=K.NORMAL}}initializeDisplaySettingForGame(t){if(t.humanIsFront){const i=$e();let n=i.boardFlipping;t.black.uri===Qt&&t.white.uri!==Qt?n=!1:t.black.uri!==Qt&&t.white.uri===Qt&&(n=!0),n!==i.boardFlipping&&i.flipBoard()}}stopGame(){switch(this.appState){case K.GAME:this.gameManager.setting.repeat>=2?this.showConfirmation({message:ve.areYouSureWantToQuitGames,onOk:()=>this.gameManager.endGame(le.INTERRUPT)}):this.gameManager.endGame(le.INTERRUPT);break;case K.CSA_GAME:this.showConfirmation({message:ve.areYouSureWantToRequestQuit,onOk:()=>this.csaGameManager.stop()});break}}showGameResults(){if(this.appState!==K.GAME)return;const t=this.gameManager.results;this.enqueueMessage({text:ve.gameProgress,attachments:yu(t)})}onGameNext(){this.usiMonitor.clear()}onGameEnd(t,i){this.appState===K.GAME&&(t&&t.total>=2?this.enqueueMessage({text:ve.allGamesCompleted,attachments:yu(t)}):i&&this.enqueueMessage({text:`${ve.gameEnded}${Kd(i)})`}),this._appState=K.NORMAL)}onCSAGameEnd(){this.appState===K.CSA_GAME&&(this._appState=K.NORMAL)}onFlipBoard(t){$e().boardFlipping!==t&&$e().flipBoard()}onSaveRecord(){const t=bu(this.recordManager.record.metadata),n=`${$e().autoSaveDirectory}/${t}`;this.saveRecordByPath(n).catch(s=>{this.pushError(`: ${s}`)})}onBeepShort(){const t=$e();t.clockSoundTarget===$a.ONLY_USER&&!this.isMovableByUser||Nb({frequency:t.clockPitch,volume:t.clockVolume})}onBeepUnlimited(){const t=$e();t.clockSoundTarget===$a.ONLY_USER&&!this.isMovableByUser||Lb({frequency:t.clockPitch,volume:t.clockVolume})}doMove(t){if(this.appState!==K.NORMAL&&this.appState!==K.RESEARCH||!this.recordManager.appendMove({move:t}))return;const i=$e();Yr(i.pieceVolume)}onFinish(){this.appState===K.ANALYSIS&&(this._message.enqueue({text:""}),this._appState=K.NORMAL)}startResearch(t){if(!(this.appState!==K.RESEARCH_DIALOG||this.isBussy)){if(this.retainBussyState(),!t.usi){this.pushError(new Error(""));return}fe.saveResearchSetting(t).then(()=>this.researchManager.launch(t)).then(()=>{this._appState=K.RESEARCH,this.usiMonitor.clear(),this.onUpdatePosition();const i=$e();i.tab!==$t.SEARCH&&i.tab!==$t.PV&&i.tab!==$t.CHART&&i.tab!==$t.PERCENTAGE_CHART&&$e().updateAppSetting({tab:$t.PV})}).catch(i=>{this.pushError(": "+i)}).finally(()=>{this.releaseBussyState()})}}stopResearch(){this.appState===K.RESEARCH&&(this.researchManager.close(),this._appState=K.NORMAL)}onUpdateSearchInfo(t,i){this.recordManager.updateSearchInfo(t,i)}startAnalysis(t){this.appState!==K.ANALYSIS_DIALOG||this.isBussy||(this.retainBussyState(),fe.saveAnalysisSetting(t).then(()=>this.analysisManager.start(t)).then(()=>{this._appState=K.ANALYSIS,this.usiMonitor.clear()}).catch(i=>{this.pushError(": "+i)}).finally(()=>{this.releaseBussyState()}))}stopAnalysis(){this.appState===K.ANALYSIS&&(this.analysisManager.close(),this._appState=K.NORMAL)}onUpdatePosition(){this.researchManager&&this.researchManager.updatePosition(this.recordManager.record)}resetRecord(){this.appState==K.NORMAL&&this.showConfirmation({message:ve.areYouSureWantToClearRecord,onOk:()=>{this.recordManager.reset()}})}updateRecordComment(t){this.recordManager.updateComment(t)}insertSpecialMove(t){this.appState!==K.NORMAL&&this.appState!==K.RESEARCH||this.recordManager.appendMove({move:t})}startPositionEditing(){this.appState===K.NORMAL&&this.showConfirmation({message:ve.areYouSureWantToClearRecord,onOk:()=>{this._appState=K.POSITION_EDITING,this.recordManager.resetByCurrentPosition()}})}endPositionEditing(){this.appState===K.POSITION_EDITING&&(this._appState=K.NORMAL)}initializePosition(t){this.appState==K.POSITION_EDITING&&this.showConfirmation({message:ve.areYouSureWantToDiscardPosition,onOk:()=>{this.recordManager.reset(t)}})}changeTurn(){this.appState==K.POSITION_EDITING&&this.recordManager.swapNextTurn()}editPosition(t){this.appState===K.POSITION_EDITING&&this.recordManager.changePosition(t)}changePly(t){(this.appState===K.NORMAL||this.appState===K.RESEARCH)&&this.recordManager.changePly(t)}changeBranch(t){(this.appState===K.NORMAL||this.appState===K.RESEARCH)&&this.recordManager.changeBranch(t)}swapWithNextBranch(){return this.recordManager.swapWithNextBranch()}swapWithPreviousBranch(){return this.recordManager.swapWithPreviousBranch()}removeCurrentMove(){if(!(this.appState!==K.NORMAL&&this.appState!==K.RESEARCH)){if(this.recordManager.record.current.isLastMove){this.recordManager.removeCurrentMove();return}this.showConfirmation({message:ve.areYouSureWantToDeleteFollowingMove(this.recordManager.record.current.number),onOk:()=>{this.recordManager.removeCurrentMove()}})}}copyRecordKIF(){const t=$e(),i=Qd(this.recordManager.record,{returnCode:t.returnCode});navigator.clipboard.writeText(i)}copyRecordCSA(){const t=$e(),i=tf(this.recordManager.record,{returnCode:t.returnCode});navigator.clipboard.writeText(i)}copyRecordUSIBefore(){const t=this.recordManager.record.usi;navigator.clipboard.writeText(t)}copyRecordUSIAll(){const t=this.recordManager.record.usiAll;navigator.clipboard.writeText(t)}copyBoardSFEN(){const t=this.recordManager.record.sfen;navigator.clipboard.writeText(t)}pasteRecord(t){if(this.appState!==K.NORMAL)return;const i=this.recordManager.importRecord(t);if(i){this.pushError(i);return}}openRecord(t){this.appState!==K.NORMAL||this.isBussy||(this.retainBussyState(),Promise.resolve().then(()=>t||fe.showOpenRecordDialog()).then(i=>{if(i)return fe.openRecord(i).then(n=>{const s=this.recordManager.importRecordFromBuffer(n,i);return s&&Promise.reject(s)})}).catch(i=>{this.pushError(": "+i)}).finally(()=>{this.releaseBussyState()}))}saveRecord(t){this.appState!==K.NORMAL||this.isBussy||(this.retainBussyState(),Promise.resolve().then(()=>{const i=this.recordManager.recordFilePath;if(t!=null&&t.overwrite&&i)return i;const n=bu(this.recordManager.record.metadata);return fe.showSaveRecordDialog(n)}).then(i=>{if(i)return this.saveRecordByPath(i)}).catch(i=>{this.pushError(i)}).finally(()=>{this.releaseBussyState()}))}async saveRecordByPath(t){const i=$e(),n=this.recordManager.exportRecordAsBuffer(t,{returnCode:i.returnCode});if(n instanceof Error)throw n;this.retainBussyState();try{await fe.saveRecord(t,n)}catch(s){throw new Error(`: ${s}`)}finally{this.releaseBussyState()}}get isMovableByUser(){switch(this.appState){case K.NORMAL:case K.RESEARCH:return!0;case K.GAME:return(this.recordManager.record.position.color===L.BLACK?this.gameManager.setting.black.uri:this.gameManager.setting.white.uri)===Qt;case K.CSA_GAME:return this.csaGameManager.isMyTurn&&this.csaGameManager.setting.player.uri===Qt}return!1}}function i_(){return new t_().reactive}let ca;function ot(){return ca||(ca=i_()),ca}var tt=(e=>(e.BUSSY="bussy",e.ERROR="error",e.INFO="info",e.GAME="game",e.INTERNET="internet",e.STOP="stop",e.RESIGN="resign",e.RESEARCH="research",e.END="end",e.QUIZ="quiz",e.EDIT="edit",e.CHECK="check",e.SWAP="swap",e.SWAP_H="swap_h",e.SETTINGS="settings",e.ENGINE_SETTINGS="engineSettings",e.FLIP="flip",e.FILE="file",e.OPEN="open",e.SAVE="save",e.SAVE_AS="saveAs",e.PASTE="paste",e.COPY="copy",e.DELETE="delete",e.COMMENT="comment",e.BRAIN="brain",e.PV="pv",e.CHART="chart",e.PERCENT="percent",e.ARROW_DROP="arrowDrop",e.ARROW_UP="arrowUp",e.FIRST="first",e.BACK="back",e.NEXT="next",e.LAST="last",e.QUESTION="question",e.ANALYSIS="analysis",e.DESCRIPTION="description",e.PLAY="play",e.CLOSE="close",e.CALL="call",e.SCORE="score",e))(tt||{});const mf={bussy:"icon/hourglass_empty_white_24dp.svg",error:"icon/error_outline_white_24dp.svg",info:"icon/info_white_24dp.svg",game:"icon/sports_esports_white_24dp.svg",internet:"icon/language_FILL0_wght400_GRAD0_opsz48.svg",stop:"icon/block_white_24dp.svg",resign:"icon/flag_white_24dp.svg",research:"icon/science_white_24dp.svg",end:"icon/do_disturb_on_white_24dp.svg",quiz:"icon/quiz_FILL0_wght400_GRAD0_opsz48.svg",edit:"icon/app_registration_white_24dp.svg",check:"icon/check_circle_white_24dp.svg",swap:"icon/swap_vert_white_24dp.svg",swap_h:"icon/swap_horiz_white_24dp.svg",settings:"icon/settings_white_24dp.svg",engineSettings:"icon/settings_input_component_white_24dp.svg",flip:"icon/flip_camera_android_white_24dp.svg",file:"icon/draft_FILL0_wght400_GRAD0_opsz48.svg",open:"icon/file_open_FILL0_wght400_GRAD0_opsz48.svg",save:"icon/save_FILL0_wght400_GRAD0_opsz48.svg",saveAs:"icon/save_as_FILL0_wght400_GRAD0_opsz48.svg",paste:"icon/content_paste_white_24dp.svg",copy:"icon/content_copy_white_24dp.svg",delete:"icon/backspace_white_24dp.svg",comment:"icon/edit_note_white_24dp.svg",brain:"icon/psychology_white_24dp.svg",pv:"icon/manage_search_FILL0_wght400_GRAD0_opsz48.svg",chart:"icon/show_chart_white_24dp.svg",percent:"icon/percent_white_24dp.svg",arrowDrop:"icon/arrow_drop_down_white_24dp.svg",arrowUp:"icon/arrow_drop_up_FILL0_wght400_GRAD0_opsz48.svg",first:"icon/first_page_white_24dp.svg",back:"icon/chevron_left_white_24dp.svg",next:"icon/chevron_right_white_24dp.svg",last:"icon/last_page_white_24dp.svg",question:"icon/help_white_24dp.svg",analysis:"icon/query_stats_white_24dp.svg",description:"icon/description_white_24dp.svg",play:"icon/play_arrow_FILL1_wght400_GRAD0_opsz48.svg",close:"icon/close_FILL0_wght400_GRAD0_opsz48.svg",call:"icon/record_voice_over_FILL0_wght400_GRAD0_opsz48.svg",score:"icon/scoreboard_FILL0_wght400_GRAD0_opsz48.svg"};Object.values(mf).forEach(e=>{ds(e)});const n_=Ge({name:"ButtonIcon",props:{icon:{type:String,required:!0}},setup(e){return{source:mf[e.icon]}}}),s_=["src"];function o_(e,t,i,n,s,o){return R(),B("img",{class:"icon",src:e.source,draggable:"false"},null,8,s_)}const Bt=Ve(n_,[["render",o_]]);function kt(e,t){e.addEventListener("cancel",i=>{i.preventDefault(),i.stopPropagation(),t&&t()}),e.addEventListener("copy",i=>{i.stopPropagation()}),e.addEventListener("paste",i=>{i.stopPropagation()}),e.showModal()}function co(e){return document.getElementById(e)}const r_=Ge({name:"GameMenu",components:{ButtonIcon:Bt},emits:["close"],setup(e,t){const i=ot(),n=W(null),s=()=>{t.emit("close")};return st(()=>{kt(n.value,s)}),{t:ve,dialog:n,Icon:tt,onClose:s,onLocalGame:()=>{i.showGameDialog(),t.emit("close")},onCSAGame:()=>{i.showCSAGameDialog(),t.emit("close")}}}}),a_={ref:"dialog",class:"menu"},l_={class:"groups"},c_={class:"group"},u_={class:"label"},h_={class:"group"},d_={class:"label"},f_={class:"label"};function p_(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",a_,[p("div",l_,[p("div",c_,[p("button",{class:"close",onClick:t[0]||(t[0]=(...a)=>e.onClose&&e.onClose(...a))},[Y(r,{class:"icon",icon:e.Icon.CLOSE},null,8,["icon"]),p("div",u_,k(e.t.back),1)])]),p("div",h_,[p("button",{onClick:t[1]||(t[1]=(...a)=>e.onLocalGame&&e.onLocalGame(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),p("div",d_,k(e.t.offlineGame),1)]),p("button",{onClick:t[2]||(t[2]=(...a)=>e.onCSAGame&&e.onCSAGame(...a))},[Y(r,{class:"icon",icon:e.Icon.INTERNET},null,8,["icon"]),p("div",f_,k(e.t.csaOnlineGame),1)])])])],512)])}const g_=Ve(r_,[["render",p_]]),m_=Ge({name:"FileMenu",components:{ButtonIcon:Bt},emits:["close"],setup(e,t){const i=ot(),n=W(null),s=()=>{t.emit("close")};st(()=>{kt(n.value,s)});const o=()=>{i.resetRecord(),t.emit("close")},r=()=>{i.openRecord(),t.emit("close")},a=()=>{i.saveRecord({overwrite:!0}),t.emit("close")},l=()=>{i.saveRecord(),t.emit("close")},c=()=>{i.copyRecordKIF(),t.emit("close")},u=()=>{i.copyRecordCSA(),t.emit("close")},h=()=>{i.copyRecordUSIAll(),t.emit("close")},f=()=>{i.copyBoardSFEN(),t.emit("close")},g=()=>{i.showPasteDialog(),t.emit("close")},_=Me(()=>({newFile:i.appState===K.NORMAL,open:i.appState===K.NORMAL,save:i.appState===K.NORMAL,saveAs:i.appState===K.NORMAL,paste:i.appState===K.NORMAL}));return{t:ve,dialog:n,Icon:tt,onClose:s,onNewFile:o,onOpen:r,onSave:a,onSaveAs:l,onCopyKIF:c,onCopyCSA:u,onCopyUSI:h,onCopySFEN:f,onPaste:g,states:_}}}),b_={ref:"dialog",class:"menu"},__={class:"groups"},y_={class:"group"},v_={class:"label"},S_={class:"group"},w_=["disabled"],E_={class:"label"},k_=["disabled"],I_={class:"label"},P_=["disabled"],A_={class:"label"},C_=["disabled"],x_={class:"label"},M_={class:"group"},T_={class:"label"},R_={class:"label"},O_={class:"label"},N_={class:"label"},L_=["disabled"],B_={class:"label"};function D_(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",b_,[p("div",__,[p("div",y_,[p("button",{class:"close",onClick:t[0]||(t[0]=(...a)=>e.onClose&&e.onClose(...a))},[Y(r,{class:"icon",icon:e.Icon.CLOSE},null,8,["icon"]),p("div",v_,k(e.t.back),1)])]),p("div",S_,[p("button",{disabled:!e.states.newFile,onClick:t[1]||(t[1]=(...a)=>e.onNewFile&&e.onNewFile(...a))},[Y(r,{class:"icon",icon:e.Icon.FILE},null,8,["icon"]),p("div",E_,k(e.t.clear),1)],8,w_),p("button",{disabled:!e.states.open,onClick:t[2]||(t[2]=(...a)=>e.onOpen&&e.onOpen(...a))},[Y(r,{class:"icon",icon:e.Icon.OPEN},null,8,["icon"]),p("div",I_,k(e.t.open),1)],8,k_),p("button",{disabled:!e.states.save,onClick:t[3]||(t[3]=(...a)=>e.onSave&&e.onSave(...a))},[Y(r,{class:"icon",icon:e.Icon.SAVE},null,8,["icon"]),p("div",A_,k(e.t.saveOverwrite),1)],8,P_),p("button",{disabled:!e.states.saveAs,onClick:t[4]||(t[4]=(...a)=>e.onSaveAs&&e.onSaveAs(...a))},[Y(r,{class:"icon",icon:e.Icon.SAVE_AS},null,8,["icon"]),p("div",x_,k(e.t.saveAs),1)],8,C_)]),p("div",M_,[p("button",{onClick:t[5]||(t[5]=(...a)=>e.onCopyKIF&&e.onCopyKIF(...a))},[Y(r,{class:"icon",icon:e.Icon.COPY},null,8,["icon"]),p("div",T_,k(e.t.copyAsKIF),1)]),p("button",{onClick:t[6]||(t[6]=(...a)=>e.onCopyCSA&&e.onCopyCSA(...a))},[Y(r,{class:"icon",icon:e.Icon.COPY},null,8,["icon"]),p("div",R_,k(e.t.copyAsCSA),1)]),p("button",{onClick:t[7]||(t[7]=(...a)=>e.onCopyUSI&&e.onCopyUSI(...a))},[Y(r,{class:"icon",icon:e.Icon.COPY},null,8,["icon"]),p("div",O_,k(e.t.copyAsUSI),1)]),p("button",{onClick:t[8]||(t[8]=(...a)=>e.onCopySFEN&&e.onCopySFEN(...a))},[Y(r,{class:"icon",icon:e.Icon.COPY},null,8,["icon"]),p("div",N_,k(e.t.copyAsSFEN),1)]),p("button",{disabled:!e.states.paste,onClick:t[9]||(t[9]=(...a)=>e.onPaste&&e.onPaste(...a))},[Y(r,{class:"icon",icon:e.Icon.PASTE},null,8,["icon"]),p("div",B_,k(e.t.paste),1)],8,L_)])])],512)])}const F_=Ve(m_,[["render",D_]]),$_=Ge({name:"InitialPositionMenu",components:{ButtonIcon:Bt},emits:["close"],setup(e,t){const i=ot(),n=W(null),s=()=>{t.emit("close")};return st(()=>{kt(n.value,s)}),{t:ve,dialog:n,Icon:tt,onClose:s,onStandard:()=>{i.initializePosition(be.STANDARD),t.emit("close")},onHandicapLance:()=>{i.initializePosition(be.HANDICAP_LANCE),t.emit("close")},onHandicapRightLance:()=>{i.initializePosition(be.HANDICAP_RIGHT_LANCE),t.emit("close")},onHandicapBishop:()=>{i.initializePosition(be.HANDICAP_BISHOP),t.emit("close")},onHandicapRook:()=>{i.initializePosition(be.HANDICAP_ROOK),t.emit("close")},onHandicapRookLance:()=>{i.initializePosition(be.HANDICAP_ROOK_LANCE),t.emit("close")},onHandicap2Pieces:()=>{i.initializePosition(be.HANDICAP_2PIECES),t.emit("close")},onHandicap4Pieces:()=>{i.initializePosition(be.HANDICAP_4PIECES),t.emit("close")},onHandicap6Pieces:()=>{i.initializePosition(be.HANDICAP_6PIECES),t.emit("close")},onHandicap8Pieces:()=>{i.initializePosition(be.HANDICAP_8PIECES),t.emit("close")},onTsumeShogi:()=>{i.initializePosition(be.TSUME_SHOGI),t.emit("close")},onTsumeShogi2Kings:()=>{i.initializePosition(be.TSUME_SHOGI_2KINGS),t.emit("close")}}}}),H_={ref:"dialog",class:"menu"},U_={class:"groups"},z_={class:"group"},W_={class:"label"},G_={class:"group"},V_=p("div",{class:"label"},"",-1),j_=p("div",{class:"label"},"",-1),K_=p("div",{class:"label"},"",-1),q_=p("div",{class:"label"},"",-1),Y_=p("div",{class:"label"},"",-1),X_=p("div",{class:"label"},"",-1),J_=p("div",{class:"label"},"2",-1),Q_=p("div",{class:"label"},"4",-1),Z_=p("div",{class:"label"},"6",-1),ey=p("div",{class:"label"},"8",-1),ty=p("div",{class:"label"},"",-1),iy=p("div",{class:"label"},"",-1);function ny(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",H_,[p("div",U_,[p("div",z_,[p("button",{class:"close",onClick:t[0]||(t[0]=(...a)=>e.onClose&&e.onClose(...a))},[Y(r,{class:"icon",icon:e.Icon.CLOSE},null,8,["icon"]),p("div",W_,k(e.t.back),1)])]),p("div",G_,[p("button",{onClick:t[1]||(t[1]=(...a)=>e.onStandard&&e.onStandard(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),V_]),p("button",{onClick:t[2]||(t[2]=(...a)=>e.onHandicapLance&&e.onHandicapLance(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),j_]),p("button",{onClick:t[3]||(t[3]=(...a)=>e.onHandicapRightLance&&e.onHandicapRightLance(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),K_]),p("button",{onClick:t[4]||(t[4]=(...a)=>e.onHandicapBishop&&e.onHandicapBishop(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),q_]),p("button",{onClick:t[5]||(t[5]=(...a)=>e.onHandicapRook&&e.onHandicapRook(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),Y_]),p("button",{onClick:t[6]||(t[6]=(...a)=>e.onHandicapRookLance&&e.onHandicapRookLance(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),X_]),p("button",{onClick:t[7]||(t[7]=(...a)=>e.onHandicap2Pieces&&e.onHandicap2Pieces(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),J_]),p("button",{onClick:t[8]||(t[8]=(...a)=>e.onHandicap4Pieces&&e.onHandicap4Pieces(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),Q_]),p("button",{onClick:t[9]||(t[9]=(...a)=>e.onHandicap6Pieces&&e.onHandicap6Pieces(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),Z_]),p("button",{onClick:t[10]||(t[10]=(...a)=>e.onHandicap8Pieces&&e.onHandicap8Pieces(...a))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),ey]),p("button",{onClick:t[11]||(t[11]=(...a)=>e.onTsumeShogi&&e.onTsumeShogi(...a))},[Y(r,{class:"icon",icon:e.Icon.QUIZ},null,8,["icon"]),ty]),p("button",{onClick:t[12]||(t[12]=(...a)=>e.onTsumeShogi2Kings&&e.onTsumeShogi2Kings(...a))},[Y(r,{class:"icon",icon:e.Icon.QUIZ},null,8,["icon"]),iy])])])],512)])}const sy=Ve($_,[["render",ny]]);class ja{constructor(t){this.children=[],this.parent=t}delete(t){const i=this.children.indexOf(t);return i===-1?!1:(this.children=this.children.slice(0,i).concat(this.children.slice(i+1)),this.children.length===0&&this.parent.delete(this),!0)}add(t){return this.children.push(t),this}}class ar{constructor(t){this.parent=null,this.children={},this.parent=t||null}get(t){return this.children[t]}insert(t){let i=this;for(let n=0;n<t.length;n+=1){const s=t[n];let o=i.get(s);if(n===t.length-1)return o instanceof ar&&(i.delete(o),o=null),o||(o=new ja(i),i.children[s]=o),o;o instanceof ja&&(o=null),o||(o=new ar(i),i.children[s]=o),i=o}return i}delete(t){for(const i in this.children)if(this.children[i]===t){const s=delete this.children[i];return Object.keys(this.children).length===0&&this.parent&&this.parent.delete(this),s}return!1}}function Ka(e){if(!(e instanceof HTMLElement))return!1;const t=e.nodeName.toLowerCase(),i=(e.getAttribute("type")||"").toLowerCase();return t==="select"||t==="textarea"||t==="input"&&i!=="submit"&&i!=="reset"&&i!=="checkbox"&&i!=="radio"&&i!=="file"||e.isContentEditable}function oy(e,t){const i=new CustomEvent("hotkey-fire",{cancelable:!0,detail:{path:t}});e.dispatchEvent(i)&&(Ka(e)?e.focus():e.click())}function ry(e){const t=[];let i=[""],n=!1;for(let s=0;s<e.length;s++){if(n&&e[s]===","){t.push(i),i=[""],n=!1;continue}if(e[s]===" "){i.push(""),n=!1;continue}else e[s]==="+"?n=!1:n=!0;i[i.length-1]+=e[s]}return t.push(i),t.map(s=>s.filter(o=>o!=="")).filter(s=>s.length>0)}function vu(e){const{ctrlKey:t,altKey:i,metaKey:n,key:s}=e,o=[],r=[t,i,n,ay(e)];for(const[a,l]of r.entries())l&&o.push(Su[a]);return Su.includes(s)||o.push(s),o.join("+")}const Su=["Control","Alt","Meta","Shift"];function ay(e){const{shiftKey:t,code:i,key:n}=e;return t&&!(i.startsWith("Key")&&n.toUpperCase()===n)}const $s=new ar,bf=new WeakMap;let qa=$s,To=null,Ya=[];function ua(){Ya=[],To=null,qa=$s}function _f(e){if(e.defaultPrevented||!(e.target instanceof Node))return;if(Ka(e.target)){const i=e.target;if(!i.id||!i.ownerDocument.querySelector(`[data-hotkey-scope="${i.id}"]`))return}To!=null&&window.clearTimeout(To),To=window.setTimeout(ua,1500);const t=qa.get(vu(e));if(!t){ua();return}if(Ya.push(vu(e)),qa=t,t instanceof ja){const i=e.target;let n=!1,s;const o=Ka(i);for(let r=t.children.length-1;r>=0;r-=1){s=t.children[r];const a=s.getAttribute("data-hotkey-scope");if(!o&&!a||o&&i.id===a){n=!0;break}}s&&n&&(oy(s,Ya),e.preventDefault()),ua()}}function ly(e,t){Object.keys($s.children).length===0&&document.addEventListener("keydown",_f);const n=ry(t||e.getAttribute("data-hotkey")||"").map(s=>$s.insert(s).add(e));bf.set(e,n)}function cy(e){const t=bf.get(e);if(t&&t.length)for(const i of t)i&&i.delete(e);Object.keys($s.children).length===0&&document.removeEventListener("keydown",_f)}function lr(e){for(const t of e.querySelectorAll("[data-hotkey]"))ly(t)}function cr(e){for(const t of e.querySelectorAll("[data-hotkey]"))cy(t)}const jn=[],Xt=[];function fs(e){Xt.length===0&&lr(e),jn.push(e)}function ps(e){Xt.length===0&&cr(e);for(let t=0;t<jn.length;t++)if(jn[t]===e){jn.splice(t,1);break}}function ei(e){if(Xt.length===0)for(const t of jn)cr(t);else cr(Xt[Xt.length-1]);lr(e),Xt.push(e)}function ti(e){for(let t=0;t<Xt.length;t++)if(Xt[t]===e){Xt.splice(t,1),t===Xt.length&&cr(e);break}if(Xt.length===0)for(const t of jn)lr(t);else lr(Xt[Xt.length-1])}const uy=Ge({name:"BoardPane",components:{BoardView:nf,ButtonIcon:Bt,GameMenu:g_,FileMenu:F_,InitialPositionMenu:sy},props:{maxSize:{type:Ct,required:!0}},emits:["resize"],setup(e,t){const i=ot(),n=$e(),s=W(),o=W(),r=W(!1),a=W(!1),l=W(!1);st(()=>{fs(s.value),fs(o.value)}),Xs(()=>{fs(s.value),fs(o.value)}),wd(()=>{ps(s.value),ps(o.value)}),zt(()=>{ps(s.value),ps(o.value)});const c=ie=>{t.emit("resize",ie)},u=ie=>{i.appState===K.GAME||i.appState===K.CSA_GAME?Vn.doMove(ie):i.doMove(ie)},h=ie=>{i.editPosition(ie)},f=()=>{r.value=!0},g=()=>{i.showGameResults()},_=()=>{i.stopGame()},b=()=>{Vn.win()},v=()=>{Vn.resign()},y=()=>{i.showResearchDialog()},E=()=>{i.stopResearch()},w=()=>{i.showAnalysisDialog()},P=()=>{i.stopAnalysis()},A=()=>{i.startPositionEditing()},O=()=>{i.endPositionEditing()},U=()=>{l.value=!0},z=()=>{i.changeTurn()},te=()=>{i.showAppSettingDialog()},G=()=>{i.showUsiEngineManagementDialog()},Q=()=>{n.flipBoard()},Se=()=>{a.value=!0},ae=()=>{i.removeCurrentMove()},Re=Me(()=>{const ie=i.record.current.move;return ie instanceof rt?ie:void 0}),Ee=Me(()=>i.record.metadata.getStandardMetadata(ue.BLACK_NAME)||ve.sente),we=Me(()=>i.record.metadata.getStandardMetadata(ue.WHITE_NAME)||ve.gote),ee=Me(()=>{if(i.appState===K.GAME||i.csaGameState===An.GAME)return{black:{time:i.blackTime,byoyomi:i.blackByoyomi},white:{time:i.whiteTime,byoyomi:i.whiteByoyomi}}}),ne=Me(()=>({game:i.appState===K.NORMAL,showGameResults:i.appState===K.GAME&&i.gameSetting.repeat>=2,stop:i.appState===K.GAME||i.appState===K.CSA_GAME,win:i.appState===K.CSA_GAME&&i.isMovableByUser,resign:(i.appState===K.GAME||i.appState===K.CSA_GAME)&&i.isMovableByUser,research:i.appState===K.NORMAL,endResearch:i.appState===K.RESEARCH,analysis:i.appState===K.NORMAL,endAnalysis:i.appState===K.ANALYSIS,startEditPosition:i.appState===K.NORMAL,endEditPosition:i.appState===K.POSITION_EDITING,initPosition:i.appState===K.POSITION_EDITING,removeCurrentMove:i.appState===K.NORMAL||i.appState===K.RESEARCH,engineSettings:i.appState===K.NORMAL}));return{t:ve,store:i,rightControl:s,leftControl:o,isGameMenuVisible:r,isFileMenuVisible:a,isInitialPositionMenuVisible:l,appSetting:n,lastMove:Re,blackPlayerName:Ee,whitePlayerName:we,clock:ee,controlStates:ne,onResize:c,onMove:u,onEdit:h,onGame:f,onShowGameResults:g,onStop:_,onWin:b,onResign:v,onResearch:y,onEndResearch:E,onAnalysis:w,onEndAnalysis:P,onStartEditPosition:A,onEndEditPosition:O,onInitPosition:U,onChangeTurn:z,onOpenAppSettings:te,onOpenEngineSettings:G,onFlip:Q,onFileAction:Se,onRemoveCurrentMove:ae,Icon:tt,AppState:K}}});const hy={ref:"rightControl",class:"control top"},dy={ref:"leftControl",class:"control bottom"},fy=["disabled"],py=["disabled"];function gy(e,t,i,n,s,o){var h,f,g,_;const r=ye("ButtonIcon"),a=ye("BoardView"),l=ye("GameMenu"),c=ye("FileMenu"),u=ye("InitialPositionMenu");return R(),B("div",null,[Y(a,{"piece-image-type":e.appSetting.pieceImage,"board-image-type":e.appSetting.boardImage,"board-label-type":e.appSetting.boardLabelType,"max-size":e.maxSize,position:e.store.record.position,"last-move":e.lastMove,flip:e.appSetting.boardFlipping,"allow-move":e.store.isMovableByUser,"allow-edit":e.store.appState===e.AppState.POSITION_EDITING,"black-player-name":e.blackPlayerName,"white-player-name":e.whitePlayerName,"black-player-time":(h=e.clock)==null?void 0:h.black.time,"black-player-byoyomi":(f=e.clock)==null?void 0:f.black.byoyomi,"white-player-time":(g=e.clock)==null?void 0:g.white.time,"white-player-byoyomi":(_=e.clock)==null?void 0:_.white.byoyomi,"next-move-label":e.t.nextTurn,onResize:e.onResize,onMove:e.onMove,onEdit:e.onEdit},{"right-control":Si(()=>[p("div",hy,[e.controlStates.game?(R(),B("button",{key:0,class:"control-item",onClick:t[0]||(t[0]=(...b)=>e.onGame&&e.onGame(...b))},[Y(r,{class:"icon",icon:e.Icon.GAME},null,8,["icon"]),Qe(" "+k(e.t.game),1)])):re("",!0),e.controlStates.showGameResults?(R(),B("button",{key:1,class:"control-item",onClick:t[1]||(t[1]=(...b)=>e.onShowGameResults&&e.onShowGameResults(...b))},[Y(r,{class:"icon",icon:e.Icon.SCORE},null,8,["icon"]),Qe(" "+k(e.t.displayGameResults),1)])):re("",!0),e.controlStates.stop?(R(),B("button",{key:2,class:"control-item",onClick:t[2]||(t[2]=(...b)=>e.onStop&&e.onStop(...b))},[Y(r,{class:"icon",icon:e.Icon.STOP,"data-hotkey":"Escape"},null,8,["icon"]),Qe(" "+k(e.t.stopGame),1)])):re("",!0),e.controlStates.win?(R(),B("button",{key:3,class:"control-item",onClick:t[3]||(t[3]=(...b)=>e.onWin&&e.onWin(...b))},[Y(r,{class:"icon",icon:e.Icon.CALL},null,8,["icon"]),Qe(" "+k(e.t.declareWinning),1)])):re("",!0),e.controlStates.resign?(R(),B("button",{key:4,class:"control-item",onClick:t[4]||(t[4]=(...b)=>e.onResign&&e.onResign(...b))},[Y(r,{class:"icon",icon:e.Icon.RESIGN},null,8,["icon"]),Qe(" "+k(e.t.resign),1)])):re("",!0),e.controlStates.research?(R(),B("button",{key:5,class:"control-item",onClick:t[5]||(t[5]=(...b)=>e.onResearch&&e.onResearch(...b))},[Y(r,{class:"icon",icon:e.Icon.RESEARCH,"data-hotkey":"Control+r"},null,8,["icon"]),Qe(" "+k(e.t.research),1)])):re("",!0),e.controlStates.endResearch?(R(),B("button",{key:6,class:"control-item","data-hotkey":"Escape",onClick:t[6]||(t[6]=(...b)=>e.onEndResearch&&e.onEndResearch(...b))},[Y(r,{class:"icon",icon:e.Icon.END},null,8,["icon"]),Qe(" "+k(e.t.endResearch),1)])):re("",!0),e.controlStates.analysis?(R(),B("button",{key:7,class:"control-item",onClick:t[7]||(t[7]=(...b)=>e.onAnalysis&&e.onAnalysis(...b))},[Y(r,{class:"icon",icon:e.Icon.ANALYSIS,"data-hotkey":"Control+a"},null,8,["icon"]),Qe(" "+k(e.t.analysis),1)])):re("",!0),e.controlStates.endAnalysis?(R(),B("button",{key:8,class:"control-item","data-hotkey":"Escape",onClick:t[8]||(t[8]=(...b)=>e.onEndAnalysis&&e.onEndAnalysis(...b))},[Y(r,{class:"icon",icon:e.Icon.STOP},null,8,["icon"]),Qe(" "+k(e.t.stopAnalysis),1)])):re("",!0),e.controlStates.startEditPosition?(R(),B("button",{key:9,class:"control-item",onClick:t[9]||(t[9]=(...b)=>e.onStartEditPosition&&e.onStartEditPosition(...b))},[Y(r,{class:"icon",icon:e.Icon.EDIT},null,8,["icon"]),Qe(" "+k(e.t.setupPosition),1)])):re("",!0),e.controlStates.endEditPosition?(R(),B("button",{key:10,class:"control-item",onClick:t[10]||(t[10]=(...b)=>e.onEndEditPosition&&e.onEndEditPosition(...b))},[Y(r,{class:"icon",icon:e.Icon.CHECK},null,8,["icon"]),Qe(" "+k(e.t.completePositionSetup),1)])):re("",!0),e.controlStates.initPosition?(R(),B("button",{key:11,class:"control-item",onClick:t[11]||(t[11]=(...b)=>e.onChangeTurn&&e.onChangeTurn(...b))},[Y(r,{class:"icon",icon:e.Icon.SWAP},null,8,["icon"]),Qe(" "+k(e.t.changeTurn),1)])):re("",!0),e.controlStates.initPosition?(R(),B("button",{key:12,class:"control-item",onClick:t[12]||(t[12]=(...b)=>e.onInitPosition&&e.onInitPosition(...b))},k(e.t.initializePosition),1)):re("",!0)],512)]),"left-control":Si(()=>[p("div",dy,[p("button",{class:"control-item",onClick:t[13]||(t[13]=(...b)=>e.onOpenAppSettings&&e.onOpenAppSettings(...b))},[Y(r,{class:"icon",icon:e.Icon.SETTINGS,"data-hotkey":"Control+,"},null,8,["icon"]),Qe(" "+k(e.t.appSettings),1)]),p("button",{class:"control-item",disabled:!e.controlStates.engineSettings,onClick:t[14]||(t[14]=(...b)=>e.onOpenEngineSettings&&e.onOpenEngineSettings(...b))},[Y(r,{class:"icon",icon:e.Icon.ENGINE_SETTINGS,"data-hotkey":"Control+."},null,8,["icon"]),Qe(" "+k(e.t.engineSettings),1)],8,fy),p("button",{class:"control-item",onClick:t[15]||(t[15]=(...b)=>e.onFlip&&e.onFlip(...b))},[Y(r,{class:"icon",icon:e.Icon.FLIP,"data-hotkey":"Control+t"},null,8,["icon"]),Qe(" "+k(e.t.flipBoard),1)]),p("button",{class:"control-item",onClick:t[16]||(t[16]=(...b)=>e.onFileAction&&e.onFileAction(...b))},[Y(r,{class:"icon",icon:e.Icon.FILE},null,8,["icon"]),Qe(" "+k(e.t.file),1)]),p("button",{class:"control-item",disabled:!e.controlStates.removeCurrentMove,onClick:t[17]||(t[17]=(...b)=>e.onRemoveCurrentMove&&e.onRemoveCurrentMove(...b))},[Y(r,{class:"icon",icon:e.Icon.DELETE,"data-hotkey":"Control+d"},null,8,["icon"]),Qe(" "+k(e.t.deleteMove),1)],8,py)],512)]),_:1},8,["piece-image-type","board-image-type","board-label-type","max-size","position","last-move","flip","allow-move","allow-edit","black-player-name","white-player-name","black-player-time","black-player-byoyomi","white-player-time","white-player-byoyomi","next-move-label","onResize","onMove","onEdit"]),e.isGameMenuVisible?(R(),je(l,{key:0,onClose:t[18]||(t[18]=b=>e.isGameMenuVisible=!1)})):re("",!0),e.isFileMenuVisible?(R(),je(c,{key:1,onClose:t[19]||(t[19]=b=>e.isFileMenuVisible=!1)})):re("",!0),e.isInitialPositionMenuVisible?(R(),je(u,{key:2,onClose:t[20]||(t[20]=b=>e.isInitialPositionMenuVisible=!1)})):re("",!0)])}const my=Ve(uy,[["render",gy],["__scopeId","data-v-d61558cd"]]),by=Ge({name:"RecordView",components:{ButtonIcon:Bt},props:{record:{type:Object,required:!0},operational:{type:Boolean,required:!1},showElapsedTime:{type:Boolean,required:!1},showComment:{type:Boolean,required:!1}},emits:["goBegin","goBack","goForward","goEnd","selectMove","selectBranch","swapWithPreviousBranch","swapWithNextBranch"],setup(e,t){const i=W(null),n=W(null),s=()=>{e.operational&&t.emit("goBegin")},o=()=>{e.operational&&t.emit("goBack")},r=()=>{e.operational&&t.emit("goForward")},a=()=>{e.operational&&t.emit("goEnd")},l=_=>{e.operational&&t.emit("selectMove",Number(_))},c=_=>{e.operational&&t.emit("selectBranch",Number(_))},u=()=>{e.operational&&t.emit("swapWithPreviousBranch")},h=()=>{e.operational&&t.emit("swapWithNextBranch")},f=Me(()=>{const _=[];return e.record.moves.forEach(b=>{_.push({number:b.number,text:b.displayText,time:b.number!=0?b.timeText:"",hasBranch:b.hasBranch,comment:b.comment,selected:b===e.record.current})}),_}),g=Me(()=>{if(!e.record.branchBegin.branch)return null;const _=[];let b;for(b=e.record.branchBegin;b&&b.move;b=b.branch)_.push({index:_.length,text:b.displayText,comment:b.comment,selected:b.activeBranch});return _});return Xs(()=>{i.value.childNodes.forEach(v=>{v instanceof HTMLElement&&v.classList.contains("selected")&&v.scrollIntoView({behavior:"auto",block:"nearest"})}),n.value.childNodes.forEach(v=>{v instanceof HTMLElement&&v.classList.contains("selected")&&v.scrollIntoView({behavior:"auto",block:"nearest"})})}),{moves:f,branches:g,moveList:i,branchList:n,goBegin:s,goBack:o,goForward:r,goEnd:a,changeNumber:l,changeBranch:c,swapWithPreviousBranch:u,swapWithNextBranch:h,Icon:tt}}});const _y={class:"record-view"},yy={class:"controller"},vy=["disabled"],Sy=["disabled"],wy=["disabled"],Ey=["disabled"],ky={ref:"moveList",class:"move-list"},Iy=["value","onClick"],Py={class:"move-number"},Ay={class:"move-text"},Cy={key:0,class:"move-time"},xy={key:1,class:"move-comment"},My={class:"branch-list-area"},Ty={ref:"branchList",class:"branch-list"},Ry=["value","onClick"],Oy={class:"move-text"},Ny={key:0,class:"move-comment"},Ly={class:"branch-list-control"},By=["disabled"],Dy=["disabled"];function Fy(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",_y,[p("div",yy,[p("button",{class:"control-button",disabled:!e.operational,"data-hotkey":"ArrowLeft",onClick:t[0]||(t[0]=a=>e.goBegin())},[Y(r,{class:"icon",icon:e.Icon.FIRST},null,8,["icon"])],8,vy),p("button",{class:"control-button",disabled:!e.operational,"data-hotkey":"ArrowUp",onClick:t[1]||(t[1]=a=>e.goBack())},[Y(r,{class:"icon",icon:e.Icon.BACK},null,8,["icon"])],8,Sy),p("button",{class:"control-button",disabled:!e.operational,"data-hotkey":"ArrowDown",onClick:t[2]||(t[2]=a=>e.goForward())},[Y(r,{class:"icon",icon:e.Icon.NEXT},null,8,["icon"])],8,wy),p("button",{class:"control-button",disabled:!e.operational,"data-hotkey":"ArrowRight",onClick:t[3]||(t[3]=a=>e.goEnd())},[Y(r,{class:"icon",icon:e.Icon.LAST},null,8,["icon"])],8,Ey)]),p("div",ky,[(R(!0),B(Ce,null,Ye(e.moves,a=>(R(),B("div",{key:a.number,class:Zt(["move-element",{"has-branch":a.hasBranch,selected:a.selected}]),value:a.number,onClick:l=>e.changeNumber(a.number)},[p("div",Py,k(a.number!==0?a.number:""),1),p("div",Ay,k(a.text),1),e.showElapsedTime?(R(),B("div",Cy,k(a.time),1)):re("",!0),e.showComment?(R(),B("div",xy,k(a.comment),1)):re("",!0)],10,Iy))),128))],512),p("div",My,[p("div",Ty,[(R(!0),B(Ce,null,Ye(e.branches,a=>(R(),B("div",{key:a.index,class:Zt(["move-element",{selected:a.selected}]),value:a.index,onClick:l=>e.changeBranch(a.index)},[p("div",Oy,k(a.text),1),e.showComment?(R(),B("div",Ny,k(a.comment),1)):re("",!0)],10,Ry))),128))],512),p("div",Ly,[p("button",{class:"branch-list-control-button",disabled:!e.operational,onClick:t[4]||(t[4]=a=>e.swapWithPreviousBranch())},[Y(r,{class:"icon",icon:e.Icon.ARROW_UP},null,8,["icon"])],8,By),p("button",{class:"branch-list-control-button",disabled:!e.operational,onClick:t[5]||(t[5]=a=>e.swapWithNextBranch())},[Y(r,{class:"icon",icon:e.Icon.ARROW_DROP},null,8,["icon"])],8,Dy)])])])}const $y=Ve(by,[["render",Fy],["__scopeId","data-v-816a92a9"]]),Hy=200,Uy=Ge({name:"RecordPane",components:{RecordView:$y},setup(){const e=ot(),t=$e(),i=W();st(()=>{fs(i.value)}),Js(()=>{ps(i.value)});const n=b=>{e.changePly(b)},s=()=>{n(0)},o=()=>{n(e.record.current.number-1)},r=()=>{n(e.record.current.number+1)},a=()=>{n(Number.MAX_SAFE_INTEGER)},l=b=>{n(b)},c=b=>{e.changeBranch(b)},u=()=>{e.swapWithPreviousBranch()},h=()=>{e.swapWithNextBranch()},f=b=>{const v=b.target;t.updateAppSetting({showElapsedTimeInRecordView:v.checked})},g=b=>{const v=b.target;t.updateAppSetting({showCommentInRecordView:v.checked})},_=Me(()=>e.appState===K.NORMAL||e.appState===K.RESEARCH);return{t:ve,store:e,appSetting:t,root:i,isRecordOperational:_,goBegin:s,goBack:o,goForward:r,goEnd:a,selectMove:l,selectBranch:c,swapWithPreviousBranch:u,swapWithNextBranch:h,onToggleElapsedTime:f,onToggleComment:g}}});const zy={ref:"root",class:"record-pane"},Wy={class:"record"},Gy={class:"options"},Vy={class:"option"},jy=["checked"],Ky={for:"show-elapsed-time"},qy={class:"option"},Yy=["checked"],Xy={for:"show-comment"};function Jy(e,t,i,n,s,o){const r=ye("RecordView");return R(),B("div",zy,[p("div",Wy,[Y(r,{record:e.store.record,operational:e.isRecordOperational,"show-comment":e.appSetting.showCommentInRecordView,"show-elapsed-time":e.appSetting.showElapsedTimeInRecordView,onGoBegin:e.goBegin,onGoBack:e.goBack,onGoForward:e.goForward,onGoEnd:e.goEnd,onSelectMove:e.selectMove,onSelectBranch:e.selectBranch,onSwapWithPreviousBranch:e.swapWithPreviousBranch,onSwapWithNextBranch:e.swapWithNextBranch},null,8,["record","operational","show-comment","show-elapsed-time","onGoBegin","onGoBack","onGoForward","onGoEnd","onSelectMove","onSelectBranch","onSwapWithPreviousBranch","onSwapWithNextBranch"])]),p("div",Gy,[p("div",Vy,[p("input",{id:"show-elapsed-time",type:"checkbox",checked:e.appSetting.showElapsedTimeInRecordView,onChange:t[0]||(t[0]=(...a)=>e.onToggleElapsedTime&&e.onToggleElapsedTime(...a))},null,40,jy),p("label",Ky,k(e.t.elapsedTime),1)]),p("div",qy,[p("input",{id:"show-comment",type:"checkbox",checked:e.appSetting.showCommentInRecordView,onChange:t[1]||(t[1]=(...a)=>e.onToggleComment&&e.onToggleComment(...a))},null,40,Yy),p("label",Xy,k(e.t.comments),1)])])],512)}const Qy=Ve(Uy,[["render",Jy],["__scopeId","data-v-f21fd26b"]]),Zy=Ge({name:"RecordComment",setup(){const e=ot(),t=Me(()=>e.appState!=K.NORMAL&&e.appState!=K.RESEARCH),i=W(null),n=s=>{const o=s.target.value;e.updateRecordComment(o)};return st(()=>{i.value.addEventListener("copy",s=>{s.stopPropagation()}),i.value.addEventListener("paste",s=>{s.stopPropagation()})}),{store:e,textarea:i,readonly:t,change:n}}});const ev={class:"root"},tv=["value","readonly"];function iv(e,t,i,n,s,o){return R(),B("div",null,[p("div",ev,[p("textarea",{ref:"textarea",class:"text",value:e.store.record.current.comment,readonly:e.readonly,onInput:t[0]||(t[0]=(...r)=>e.change&&e.change(...r))},null,40,tv)])])}const nv=Ve(Zy,[["render",iv],["__scopeId","data-v-e4c39294"]]),sv=Ge({name:"PVPreviewDialog",components:{BoardView:nf,ButtonIcon:Bt},props:{position:{type:String,required:!0},pv:{type:Array,required:!0},infos:{type:Array,default:[],required:!1}},emits:["close"],setup(e,t){const i=$e(),n=W(null),s=Ci(new Ct(0,0)),o=Ci(new At),r=W(i.boardFlipping),a=()=>{s.width=window.innerWidth*.8,s.height=window.innerHeight*.8-80},l=()=>{const y=Rt.newBySFEN(e.position);if(y){o.clear(y);for(const E of e.pv){const w=o.position.createMoveByUSI(E);if(!w)break;o.append(w,{ignoreValidation:!0})}o.goto(1)}};st(async()=>{a(),l(),window.addEventListener("resize",a),kt(n.value),ei(n.value)}),zt(()=>{window.removeEventListener("resize",a),ti(n.value)}),In([()=>e.position,()=>e.pv],()=>{l(),kt(n.value)});const c=()=>{t.emit("close")},u=()=>{o.goto(0)},h=()=>{o.goto(Number.MAX_SAFE_INTEGER)},f=()=>{o.goBack()},g=()=>{o.goForward()},_=()=>{r.value=!r.value},b=Me(()=>o.current.move instanceof rt?o.current.move:null),v=Me(()=>o.moves.slice(1).map(y=>({text:y.displayText,selected:y.number===o.current.number})));return{dialog:n,appSetting:i,record:o,lastMove:b,maxSize:s,flip:r,displayPV:v,close:c,goBegin:u,goEnd:h,goBack:f,goForward:g,doFlip:_,Icon:tt}}});const ov={ref:"dialog"},rv={class:"control top"},av={class:"control-row"},lv={class:"control-row"},cv={class:"control-row"},uv={class:"informations"},hv={class:"information"};function dv(e,t,i,n,s,o){const r=ye("ButtonIcon"),a=ye("BoardView");return R(),B("div",null,[p("dialog",ov,[Y(a,{class:"board","piece-image-type":e.appSetting.pieceImage,"board-image-type":e.appSetting.boardImage,"board-label-type":e.appSetting.boardLabelType,"max-size":e.maxSize,position:e.record.position,"last-move":e.lastMove,flip:e.flip},{"right-control":Si(()=>[p("div",rv,[p("div",av,[p("button",{class:"control-item","data-hotkey":"Control+t",onClick:t[0]||(t[0]=(...l)=>e.doFlip&&e.doFlip(...l))},[Y(r,{class:"icon",icon:e.Icon.FLIP},null,8,["icon"])]),p("button",{class:"control-item",autofocus:"","data-hotkey":"Escape",onClick:t[1]||(t[1]=(...l)=>e.close&&e.close(...l))},[Y(r,{class:"icon",icon:e.Icon.CLOSE},null,8,["icon"])])]),p("div",lv,[p("button",{class:"control-item","data-hotkey":"ArrowLeft",onClick:t[2]||(t[2]=(...l)=>e.goBegin&&e.goBegin(...l))},[Y(r,{class:"icon",icon:e.Icon.FIRST},null,8,["icon"])]),p("button",{class:"control-item","data-hotkey":"ArrowRight",onClick:t[3]||(t[3]=(...l)=>e.goEnd&&e.goEnd(...l))},[Y(r,{class:"icon",icon:e.Icon.LAST},null,8,["icon"])])]),p("div",cv,[p("button",{class:"control-item","data-hotkey":"ArrowUp",onClick:t[4]||(t[4]=(...l)=>e.goBack&&e.goBack(...l))},[Y(r,{class:"icon",icon:e.Icon.BACK},null,8,["icon"])]),p("button",{class:"control-item","data-hotkey":"ArrowDown",onClick:t[5]||(t[5]=(...l)=>e.goForward&&e.goForward(...l))},[Y(r,{class:"icon",icon:e.Icon.NEXT},null,8,["icon"])])])])]),_:1},8,["piece-image-type","board-image-type","board-label-type","max-size","position","last-move","flip"]),p("div",uv,[(R(!0),B(Ce,null,Ye(e.infos,(l,c)=>(R(),B("div",{key:c,class:"information"},k(l),1))),128)),p("div",hv,[(R(!0),B(Ce,null,Ye(e.displayPV,(l,c)=>(R(),B("span",{key:c},[p("span",{class:Zt(["move-element",{selected:l.selected}])},""+k(l.text)+"",3)]))),128))])])],512)])}const fv=Ve(sv,[["render",dv],["__scopeId","data-v-b4ce705c"]]),pv=Ge({name:"EngineAnalyticsElement",components:{ButtonIcon:Bt,PVPreviewDialog:fv},props:{historyMode:{type:Boolean,required:!0},name:{type:String,required:!0},info:{type:df,required:!0},height:{type:Number,required:!0}},setup:e=>{const t=Me(()=>{if(!e.historyMode)return!1;for(const a of e.info.iterates)if(a.multiPV&&a.multiPV!==1)return!0;return!1}),i=W(null),n=Me(()=>$e().evaluationViewFrom),s=(a,l,c)=>c===Ml.EACH||l==L.BLACK?a:-a;return{t:ve,Icon:tt,enableHighlight:t,preview:i,evaluationViewFrom:n,getDisplayScore:s,showPreview:a=>{const l=[];a.depth!==void 0&&l.push(`=${a.depth}`),a.selectiveDepth!==void 0&&l.push(`=${a.selectiveDepth}`),a.score&&(l.push(`=${s(a.score,a.color,n.value)}`),a.lowerBound&&l.push(""),a.upperBound&&l.push("")),a.scoreMate&&l.push(`=${s(a.scoreMate,a.color,n.value)}`),a.multiPV&&l.push(`=${a.multiPV}`),i.value={position:a.position,pv:a.pv||[],infos:[l.join(" / ")]}},closePreview:()=>{i.value=null}}}});const gv=e=>(qs("data-v-5fa41fbd"),e=e(),Ys(),e),mv={class:"root"},bv={class:"headers"},_v={class:"header"},yv={class:"label"},vv={class:"value"},Sv={class:"header"},wv={class:"label"},Ev={class:"value"},kv={class:"header"},Iv={class:"label"},Pv={class:"value"},Av={class:"header"},Cv=gv(()=>p("span",{class:"label"},"NPS: ",-1)),xv={class:"value"},Mv={class:"header"},Tv={class:"label"},Rv={class:"value"},Ov={class:"header"},Nv={class:"label"},Lv={class:"value"},Bv={class:"list-header"},Dv={class:"list-column time"},Fv={class:"list-column multipv-index"},$v={class:"list-column depth"},Hv={class:"list-column nodes"},Uv={class:"list-column score"},zv={class:"list-column time"},Wv={class:"list-column multipv-index"},Gv={class:"list-column depth"},Vv={class:"list-column nodes"},jv={class:"list-column score"},Kv={class:"list-column score-flag"},qv={class:"list-column text"},Yv=["onClick"];function Xv(e,t,i,n,s,o){const r=ye("ButtonIcon"),a=ye("PVPreviewDialog");return R(),B("div",null,[p("div",mv,[p("div",bv,[p("div",_v,[p("span",yv,k(e.t.name)+": ",1),p("span",vv,k(e.name),1)]),p("div",Sv,[p("span",wv,k(e.t.prediction)+": ",1),p("span",Ev,k(e.info.ponderMove?e.info.ponderMove:"---"),1)]),p("div",kv,[p("span",Iv,k(e.t.best)+": ",1),p("span",Pv,k(e.info.currentMoveText||"---"),1)]),p("div",Av,[Cv,p("span",xv,k(e.info.nps||"---"),1)]),p("div",Mv,[p("span",Tv,k(e.t.nodes)+": ",1),p("span",Rv,k(e.info.nodes||"---"),1)]),p("div",Ov,[p("span",Nv,k(e.t.hashUsage)+": ",1),p("span",Lv,k(e.info.hashfull?(e.info.hashfull*100).toFixed(1):"---")+" % ",1)])]),p("div",Bv,[p("div",Dv,k(e.t.elapsed),1),p("div",Fv,k(e.t.rank),1),p("div",$v,k(e.t.depth),1),p("div",Hv,k(e.t.nodes),1),p("div",Uv,k(e.t.eval),1)]),p("div",{class:"list",style:Fe({height:`${e.height-37}px`})},[(R(!0),B(Ce,null,Ye(e.historyMode?e.info.iterates:e.info.latestIteration,(l,c)=>(R(),B("div",{key:c,class:Zt(["list-item",{highlight:e.enableHighlight&&l.multiPV===1}])},[p("div",zv,k(l.timeMs?(l.timeMs/1e3).toFixed(1)+"s":""),1),p("div",Wv,k(l.multiPV||""),1),p("div",Gv,k(l.depth)+k(l.selectiveDepth&&l.depth?"/":"")+k(l.selectiveDepth),1),p("div",Vv,k(l.nodes),1),p("div",jv,k(l.scoreMate?e.getDisplayScore(l.scoreMate,l.color,e.evaluationViewFrom):l.score?e.getDisplayScore(l.score,l.color,e.evaluationViewFrom):""),1),p("div",Kv,k(l.lowerBound?"++":"")+" "+k(l.upperBound?"--":"")+" "+k(l.scoreMate?e.t.mateShort:""),1),p("div",qv,[l.pv&&l.pv.length!==0&&l.text?(R(),B("button",{key:0,onClick:u=>e.showPreview(l)},[Y(r,{class:"icon",icon:e.Icon.PLAY},null,8,["icon"]),Qe(" "+k(e.t.displayPVShort),1)],8,Yv)):re("",!0),Qe(" "+k(l.text),1)])],2))),128))],4),e.preview?(R(),je(a,{key:0,position:e.preview.position,pv:e.preview.pv,infos:e.preview.infos,onClose:e.closePreview},null,8,["position","pv","infos","onClose"])):re("",!0)])])}const Jv=Ve(pv,[["render",Xv],["__scopeId","data-v-5fa41fbd"]]),Qv=Ge({name:"EngineAnalytics",components:{EngineAnalyticsElement:Jv},props:{size:{type:Ct,required:!0},historyMode:{type:Boolean,required:!0}},setup(e){const t=ot(),i=Me(()=>{const n=t.usiMonitors.length;return n!==0?e.size.height/n:0});return{store:t,elementHeight:i}}});const Zv={class:"root"};function eS(e,t,i,n,s,o){const r=ye("EngineAnalyticsElement");return R(),B("div",null,[p("div",Zv,[(R(!0),B(Ce,null,Ye(e.store.usiMonitors,a=>(R(),je(r,{key:a.sessionID,"history-mode":e.historyMode,name:a.name,info:a,height:e.elementHeight},null,8,["history-mode","name","info","height"]))),128))])])}const tS=Ve(Qv,[["render",eS],["__scopeId","data-v-f4347fe3"]]);/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function Qs(e){return e+.5|0}const Ki=(e,t,i)=>Math.max(Math.min(e,i),t);function gs(e){return Ki(Qs(e*2.55),0,255)}function Zi(e){return Ki(Qs(e*255),0,255)}function Li(e){return Ki(Qs(e/2.55)/100,0,1)}function wu(e){return Ki(Qs(e*100),0,100)}const ni={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Xa=[..."0123456789ABCDEF"],iS=e=>Xa[e&15],nS=e=>Xa[(e&240)>>4]+Xa[e&15],uo=e=>(e&240)>>4===(e&15),sS=e=>uo(e.r)&&uo(e.g)&&uo(e.b)&&uo(e.a);function oS(e){var t=e.length,i;return e[0]==="#"&&(t===4||t===5?i={r:255&ni[e[1]]*17,g:255&ni[e[2]]*17,b:255&ni[e[3]]*17,a:t===5?ni[e[4]]*17:255}:(t===7||t===9)&&(i={r:ni[e[1]]<<4|ni[e[2]],g:ni[e[3]]<<4|ni[e[4]],b:ni[e[5]]<<4|ni[e[6]],a:t===9?ni[e[7]]<<4|ni[e[8]]:255})),i}const rS=(e,t)=>e<255?t(e):"";function aS(e){var t=sS(e)?iS:nS;return e?"#"+t(e.r)+t(e.g)+t(e.b)+rS(e.a,t):void 0}const lS=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function yf(e,t,i){const n=t*Math.min(i,1-i),s=(o,r=(o+e/30)%12)=>i-n*Math.max(Math.min(r-3,9-r,1),-1);return[s(0),s(8),s(4)]}function cS(e,t,i){const n=(s,o=(s+e/60)%6)=>i-i*t*Math.max(Math.min(o,4-o,1),0);return[n(5),n(3),n(1)]}function uS(e,t,i){const n=yf(e,1,.5);let s;for(t+i>1&&(s=1/(t+i),t*=s,i*=s),s=0;s<3;s++)n[s]*=1-t-i,n[s]+=t;return n}function hS(e,t,i,n,s){return e===s?(t-i)/n+(t<i?6:0):t===s?(i-e)/n+2:(e-t)/n+4}function Wl(e){const i=e.r/255,n=e.g/255,s=e.b/255,o=Math.max(i,n,s),r=Math.min(i,n,s),a=(o+r)/2;let l,c,u;return o!==r&&(u=o-r,c=a>.5?u/(2-o-r):u/(o+r),l=hS(i,n,s,u,o),l=l*60+.5),[l|0,c||0,a]}function Gl(e,t,i,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,i,n)).map(Zi)}function Vl(e,t,i){return Gl(yf,e,t,i)}function dS(e,t,i){return Gl(uS,e,t,i)}function fS(e,t,i){return Gl(cS,e,t,i)}function vf(e){return(e%360+360)%360}function pS(e){const t=lS.exec(e);let i=255,n;if(!t)return;t[5]!==n&&(i=t[6]?gs(+t[5]):Zi(+t[5]));const s=vf(+t[2]),o=+t[3]/100,r=+t[4]/100;return t[1]==="hwb"?n=dS(s,o,r):t[1]==="hsv"?n=fS(s,o,r):n=Vl(s,o,r),{r:n[0],g:n[1],b:n[2],a:i}}function gS(e,t){var i=Wl(e);i[0]=vf(i[0]+t),i=Vl(i),e.r=i[0],e.g=i[1],e.b=i[2]}function mS(e){if(!e)return;const t=Wl(e),i=t[0],n=wu(t[1]),s=wu(t[2]);return e.a<255?`hsla(${i}, ${n}%, ${s}%, ${Li(e.a)})`:`hsl(${i}, ${n}%, ${s}%)`}const Eu={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ku={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function bS(){const e={},t=Object.keys(ku),i=Object.keys(Eu);let n,s,o,r,a;for(n=0;n<t.length;n++){for(r=a=t[n],s=0;s<i.length;s++)o=i[s],a=a.replace(o,Eu[o]);o=parseInt(ku[r],16),e[a]=[o>>16&255,o>>8&255,o&255]}return e}let ho;function _S(e){ho||(ho=bS(),ho.transparent=[0,0,0,0]);const t=ho[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const yS=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function vS(e){const t=yS.exec(e);let i=255,n,s,o;if(t){if(t[7]!==n){const r=+t[7];i=t[8]?gs(r):Ki(r*255,0,255)}return n=+t[1],s=+t[3],o=+t[5],n=255&(t[2]?gs(n):Ki(n,0,255)),s=255&(t[4]?gs(s):Ki(s,0,255)),o=255&(t[6]?gs(o):Ki(o,0,255)),{r:n,g:s,b:o,a:i}}}function SS(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Li(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const ha=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Nn=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function wS(e,t,i){const n=Nn(Li(e.r)),s=Nn(Li(e.g)),o=Nn(Li(e.b));return{r:Zi(ha(n+i*(Nn(Li(t.r))-n))),g:Zi(ha(s+i*(Nn(Li(t.g))-s))),b:Zi(ha(o+i*(Nn(Li(t.b))-o))),a:e.a+i*(t.a-e.a)}}function fo(e,t,i){if(e){let n=Wl(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*i,t===0?360:1)),n=Vl(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function Sf(e,t){return e&&Object.assign(t||{},e)}function Iu(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Zi(e[3]))):(t=Sf(e,{r:0,g:0,b:0,a:1}),t.a=Zi(t.a)),t}function ES(e){return e.charAt(0)==="r"?vS(e):pS(e)}class Hs{constructor(t){if(t instanceof Hs)return t;const i=typeof t;let n;i==="object"?n=Iu(t):i==="string"&&(n=oS(t)||_S(t)||ES(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=Sf(this._rgb);return t&&(t.a=Li(t.a)),t}set rgb(t){this._rgb=Iu(t)}rgbString(){return this._valid?SS(this._rgb):void 0}hexString(){return this._valid?aS(this._rgb):void 0}hslString(){return this._valid?mS(this._rgb):void 0}mix(t,i){if(t){const n=this.rgb,s=t.rgb;let o;const r=i===o?.5:i,a=2*r-1,l=n.a-s.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;o=1-c,n.r=255&c*n.r+o*s.r+.5,n.g=255&c*n.g+o*s.g+.5,n.b=255&c*n.b+o*s.b+.5,n.a=r*n.a+(1-r)*s.a,this.rgb=n}return this}interpolate(t,i){return t&&(this._rgb=wS(this._rgb,t._rgb,i)),this}clone(){return new Hs(this.rgb)}alpha(t){return this._rgb.a=Zi(t),this}clearer(t){const i=this._rgb;return i.a*=1-t,this}greyscale(){const t=this._rgb,i=Qs(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=i,this}opaquer(t){const i=this._rgb;return i.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return fo(this._rgb,2,t),this}darken(t){return fo(this._rgb,2,-t),this}saturate(t){return fo(this._rgb,1,t),this}desaturate(t){return fo(this._rgb,1,-t),this}rotate(t){return gS(this._rgb,t),this}}/*!
 * Chart.js v4.2.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function Mi(){}const kS=(()=>{let e=0;return()=>e++})();function Ue(e){return e===null||typeof e>"u"}function it(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ne(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function dt(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function Yt(e,t){return dt(e)?e:t}function Ie(e,t){return typeof e>"u"?t:e}const IS=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,wf=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Ze(e,t,i){if(e&&typeof e.call=="function")return e.apply(i,t)}function qe(e,t,i,n){let s,o,r;if(it(e))if(o=e.length,n)for(s=o-1;s>=0;s--)t.call(i,e[s],s);else for(s=0;s<o;s++)t.call(i,e[s],s);else if(Ne(e))for(r=Object.keys(e),o=r.length,s=0;s<o;s++)t.call(i,e[r[s]],r[s])}function ur(e,t){let i,n,s,o;if(!e||!t||e.length!==t.length)return!1;for(i=0,n=e.length;i<n;++i)if(s=e[i],o=t[i],s.datasetIndex!==o.datasetIndex||s.index!==o.index)return!1;return!0}function hr(e){if(it(e))return e.map(hr);if(Ne(e)){const t=Object.create(null),i=Object.keys(e),n=i.length;let s=0;for(;s<n;++s)t[i[s]]=hr(e[i[s]]);return t}return e}function Ef(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function PS(e,t,i,n){if(!Ef(e))return;const s=t[e],o=i[e];Ne(s)&&Ne(o)?Us(s,o,n):t[e]=hr(o)}function Us(e,t,i){const n=it(t)?t:[t],s=n.length;if(!Ne(e))return e;i=i||{};const o=i.merger||PS;let r;for(let a=0;a<s;++a){if(r=n[a],!Ne(r))continue;const l=Object.keys(r);for(let c=0,u=l.length;c<u;++c)o(l[c],e,r,i)}return e}function Ps(e,t){return Us(e,t,{merger:AS})}function AS(e,t,i){if(!Ef(e))return;const n=t[e],s=i[e];Ne(n)&&Ne(s)?Ps(n,s):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=hr(s))}const Pu={"":e=>e,x:e=>e.x,y:e=>e.y};function CS(e){const t=e.split("."),i=[];let n="";for(const s of t)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(i.push(n),n="");return i}function xS(e){const t=CS(e);return i=>{for(const n of t){if(n==="")break;i=i&&i[n]}return i}}function nn(e,t){return(Pu[t]||(Pu[t]=xS(t)))(e)}function jl(e){return e.charAt(0).toUpperCase()+e.slice(1)}const li=e=>typeof e<"u",sn=e=>typeof e=="function",Au=(e,t)=>{if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0};function MS(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const ct=Math.PI,nt=2*ct,TS=nt+ct,dr=Number.POSITIVE_INFINITY,RS=ct/180,ft=ct/2,hn=ct/4,Cu=ct*2/3,qi=Math.log10,Pi=Math.sign;function As(e,t,i){return Math.abs(e-t)<i}function xu(e){const t=Math.round(e);e=As(e,t,e/1e3)?t:e;const i=Math.pow(10,Math.floor(qi(e))),n=e/i;return(n<=1?1:n<=2?2:n<=5?5:10)*i}function OS(e){const t=[],i=Math.sqrt(e);let n;for(n=1;n<i;n++)e%n===0&&(t.push(n),t.push(e/n));return i===(i|0)&&t.push(i),t.sort((s,o)=>s-o).pop(),t}function Qn(e){return!isNaN(parseFloat(e))&&isFinite(e)}function NS(e,t){const i=Math.round(e);return i-t<=e&&i+t>=e}function kf(e,t,i){let n,s,o;for(n=0,s=e.length;n<s;n++)o=e[n][i],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function di(e){return e*(ct/180)}function Kl(e){return e*(180/ct)}function Mu(e){if(!dt(e))return;let t=1,i=0;for(;Math.round(e*t)/t!==e;)t*=10,i++;return i}function If(e,t){const i=t.x-e.x,n=t.y-e.y,s=Math.sqrt(i*i+n*n);let o=Math.atan2(n,i);return o<-.5*ct&&(o+=nt),{angle:o,distance:s}}function Ja(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function LS(e,t){return(e-t+TS)%nt-ct}function Jt(e){return(e%nt+nt)%nt}function zs(e,t,i,n){const s=Jt(e),o=Jt(t),r=Jt(i),a=Jt(o-s),l=Jt(r-s),c=Jt(s-o),u=Jt(s-r);return s===o||s===r||n&&o===r||a>l&&c<u}function Et(e,t,i){return Math.max(t,Math.min(i,e))}function BS(e){return Et(e,-32768,32767)}function $i(e,t,i,n=1e-6){return e>=Math.min(t,i)-n&&e<=Math.max(t,i)+n}function ql(e,t,i){i=i||(r=>e[r]<t);let n=e.length-1,s=0,o;for(;n-s>1;)o=s+n>>1,i(o)?s=o:n=o;return{lo:s,hi:n}}const Hi=(e,t,i,n)=>ql(e,i,n?s=>{const o=e[s][t];return o<i||o===i&&e[s+1][t]===i}:s=>e[s][t]<i),DS=(e,t,i)=>ql(e,i,n=>e[n][t]>=i);function FS(e,t,i){let n=0,s=e.length;for(;n<s&&e[n]<t;)n++;for(;s>n&&e[s-1]>i;)s--;return n>0||s<e.length?e.slice(n,s):e}const Pf=["push","pop","shift","splice","unshift"];function $S(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Pf.forEach(i=>{const n="_onData"+jl(i),s=e[i];Object.defineProperty(e,i,{configurable:!0,enumerable:!1,value(...o){const r=s.apply(this,o);return e._chartjs.listeners.forEach(a=>{typeof a[n]=="function"&&a[n](...o)}),r}})})}function Tu(e,t){const i=e._chartjs;if(!i)return;const n=i.listeners,s=n.indexOf(t);s!==-1&&n.splice(s,1),!(n.length>0)&&(Pf.forEach(o=>{delete e[o]}),delete e._chartjs)}function Af(e){const t=new Set;let i,n;for(i=0,n=e.length;i<n;++i)t.add(e[i]);return t.size===n?e:Array.from(t)}const Cf=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function xf(e,t){let i=[],n=!1;return function(...s){i=s,n||(n=!0,Cf.call(window,()=>{n=!1,e.apply(t,i)}))}}function HS(e,t){let i;return function(...n){return t?(clearTimeout(i),i=setTimeout(e,t,n)):e.apply(this,n),t}}const Yl=e=>e==="start"?"left":e==="end"?"right":"center",xt=(e,t,i)=>e==="start"?t:e==="end"?i:(t+i)/2,US=(e,t,i,n)=>e===(n?"left":"right")?i:e==="center"?(t+i)/2:t;function Mf(e,t,i){const n=t.length;let s=0,o=n;if(e._sorted){const{iScale:r,_parsed:a}=e,l=r.axis,{min:c,max:u,minDefined:h,maxDefined:f}=r.getUserBounds();h&&(s=Et(Math.min(Hi(a,r.axis,c).lo,i?n:Hi(t,l,r.getPixelForValue(c)).lo),0,n-1)),f?o=Et(Math.max(Hi(a,r.axis,u,!0).hi+1,i?0:Hi(t,l,r.getPixelForValue(u),!0).hi+1),s,n)-s:o=n-s}return{start:s,count:o}}function Tf(e){const{xScale:t,yScale:i,_scaleRanges:n}=e,s={xmin:t.min,xmax:t.max,ymin:i.min,ymax:i.max};if(!n)return e._scaleRanges=s,!0;const o=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==i.min||n.ymax!==i.max;return Object.assign(n,s),o}const po=e=>e===0||e===1,Ru=(e,t,i)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*nt/i)),Ou=(e,t,i)=>Math.pow(2,-10*e)*Math.sin((e-t)*nt/i)+1,Cs={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*ft)+1,easeOutSine:e=>Math.sin(e*ft),easeInOutSine:e=>-.5*(Math.cos(ct*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>po(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>po(e)?e:Ru(e,.075,.3),easeOutElastic:e=>po(e)?e:Ou(e,.075,.3),easeInOutElastic(e){return po(e)?e:e<.5?.5*Ru(e*2,.1125,.45):.5+.5*Ou(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Cs.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Cs.easeInBounce(e*2)*.5:Cs.easeOutBounce(e*2-1)*.5+.5};function Rf(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Nu(e){return Rf(e)?e:new Hs(e)}function da(e){return Rf(e)?e:new Hs(e).saturate(.5).darken(.1).hexString()}const zS=["x","y","borderWidth","radius","tension"],WS=["color","borderColor","backgroundColor"];function GS(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:WS},numbers:{type:"number",properties:zS}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function VS(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Lu=new Map;function jS(e,t){t=t||{};const i=e+JSON.stringify(t);let n=Lu.get(i);return n||(n=new Intl.NumberFormat(e,t),Lu.set(i,n)),n}function Zs(e,t,i){return jS(t,i).format(e)}const Of={values(e){return it(e)?e:""+e},numeric(e,t,i){if(e===0)return"0";const n=this.chart.options.locale;let s,o=e;if(i.length>1){const c=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),o=KS(e,i)}const r=qi(Math.abs(o)),a=Math.max(Math.min(-1*Math.floor(r),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Zs(e,n,l)},logarithmic(e,t,i){if(e===0)return"0";const n=i[t].significand||e/Math.pow(10,Math.floor(qi(e)));return[1,2,3,5,10,15].includes(n)||t>.8*i.length?Of.numeric.call(this,e,t,i):""}};function KS(e,t){let i=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(i)>=1&&e!==Math.floor(e)&&(i=e-Math.floor(e)),i}var Rr={formatters:Of};function qS(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,i)=>i.lineWidth,tickColor:(t,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Rr.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Mn=Object.create(null),Qa=Object.create(null);function xs(e,t){if(!t)return e;const i=t.split(".");for(let n=0,s=i.length;n<s;++n){const o=i[n];e=e[o]||(e[o]=Object.create(null))}return e}function fa(e,t,i){return typeof t=="string"?Us(xs(e,t),i):Us(xs(e,""),t)}class YS{constructor(t,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>da(s.backgroundColor),this.hoverBorderColor=(n,s)=>da(s.borderColor),this.hoverColor=(n,s)=>da(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(i)}set(t,i){return fa(this,t,i)}get(t){return xs(this,t)}describe(t,i){return fa(Qa,t,i)}override(t,i){return fa(Mn,t,i)}route(t,i,n,s){const o=xs(this,t),r=xs(this,n),a="_"+i;Object.defineProperties(o,{[a]:{value:o[i],writable:!0},[i]:{enumerable:!0,get(){const l=this[a],c=r[s];return Ne(l)?Object.assign({},c,l):Ie(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(i=>i(this))}}var pt=new YS({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[GS,VS,qS]);function XS(e){return!e||Ue(e.size)||Ue(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function fr(e,t,i,n,s){let o=t[s];return o||(o=t[s]=e.measureText(s).width,i.push(s)),o>n&&(n=o),n}function JS(e,t,i,n){n=n||{};let s=n.data=n.data||{},o=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(s=n.data={},o=n.garbageCollect=[],n.font=t),e.save(),e.font=t;let r=0;const a=i.length;let l,c,u,h,f;for(l=0;l<a;l++)if(h=i[l],h!=null&&it(h)!==!0)r=fr(e,s,o,r,h);else if(it(h))for(c=0,u=h.length;c<u;c++)f=h[c],f!=null&&!it(f)&&(r=fr(e,s,o,r,f));e.restore();const g=o.length/2;if(g>i.length){for(l=0;l<g;l++)delete s[o[l]];o.splice(0,g)}return r}function dn(e,t,i){const n=e.currentDevicePixelRatio,s=i!==0?Math.max(i/2,.5):0;return Math.round((t-s)*n)/n+s}function Bu(e,t){t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Za(e,t,i,n){Nf(e,t,i,n,null)}function Nf(e,t,i,n,s){let o,r,a,l,c,u,h,f;const g=t.pointStyle,_=t.rotation,b=t.radius;let v=(_||0)*RS;if(g&&typeof g=="object"&&(o=g.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){e.save(),e.translate(i,n),e.rotate(v),e.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),e.restore();return}if(!(isNaN(b)||b<=0)){switch(e.beginPath(),g){default:s?e.ellipse(i,n,s/2,b,0,0,nt):e.arc(i,n,b,0,nt),e.closePath();break;case"triangle":u=s?s/2:b,e.moveTo(i+Math.sin(v)*u,n-Math.cos(v)*b),v+=Cu,e.lineTo(i+Math.sin(v)*u,n-Math.cos(v)*b),v+=Cu,e.lineTo(i+Math.sin(v)*u,n-Math.cos(v)*b),e.closePath();break;case"rectRounded":c=b*.516,l=b-c,r=Math.cos(v+hn)*l,h=Math.cos(v+hn)*(s?s/2-c:l),a=Math.sin(v+hn)*l,f=Math.sin(v+hn)*(s?s/2-c:l),e.arc(i-h,n-a,c,v-ct,v-ft),e.arc(i+f,n-r,c,v-ft,v),e.arc(i+h,n+a,c,v,v+ft),e.arc(i-f,n+r,c,v+ft,v+ct),e.closePath();break;case"rect":if(!_){l=Math.SQRT1_2*b,u=s?s/2:l,e.rect(i-u,n-l,2*u,2*l);break}v+=hn;case"rectRot":h=Math.cos(v)*(s?s/2:b),r=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(s?s/2:b),e.moveTo(i-h,n-a),e.lineTo(i+f,n-r),e.lineTo(i+h,n+a),e.lineTo(i-f,n+r),e.closePath();break;case"crossRot":v+=hn;case"cross":h=Math.cos(v)*(s?s/2:b),r=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(s?s/2:b),e.moveTo(i-h,n-a),e.lineTo(i+h,n+a),e.moveTo(i+f,n-r),e.lineTo(i-f,n+r);break;case"star":h=Math.cos(v)*(s?s/2:b),r=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(s?s/2:b),e.moveTo(i-h,n-a),e.lineTo(i+h,n+a),e.moveTo(i+f,n-r),e.lineTo(i-f,n+r),v+=hn,h=Math.cos(v)*(s?s/2:b),r=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(s?s/2:b),e.moveTo(i-h,n-a),e.lineTo(i+h,n+a),e.moveTo(i+f,n-r),e.lineTo(i-f,n+r);break;case"line":r=s?s/2:Math.cos(v)*b,a=Math.sin(v)*b,e.moveTo(i-r,n-a),e.lineTo(i+r,n+a);break;case"dash":e.moveTo(i,n),e.lineTo(i+Math.cos(v)*(s?s/2:b),n+Math.sin(v)*b);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Ws(e,t,i){return i=i||.5,!t||e&&e.x>t.left-i&&e.x<t.right+i&&e.y>t.top-i&&e.y<t.bottom+i}function Or(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Nr(e){e.restore()}function QS(e,t,i,n,s){if(!t)return e.lineTo(i.x,i.y);if(s==="middle"){const o=(t.x+i.x)/2;e.lineTo(o,t.y),e.lineTo(o,i.y)}else s==="after"!=!!n?e.lineTo(t.x,i.y):e.lineTo(i.x,t.y);e.lineTo(i.x,i.y)}function ZS(e,t,i,n){if(!t)return e.lineTo(i.x,i.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?i.cp2x:i.cp1x,n?i.cp2y:i.cp1y,i.x,i.y)}function Tn(e,t,i,n,s,o={}){const r=it(t)?t:[t],a=o.strokeWidth>0&&o.strokeColor!=="";let l,c;for(e.save(),e.font=s.string,ew(e,o),l=0;l<r.length;++l)c=r[l],o.backdrop&&iw(e,o.backdrop),a&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),Ue(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(c,i,n,o.maxWidth)),e.fillText(c,i,n,o.maxWidth),tw(e,i,n,c,o),n+=s.lineHeight;e.restore()}function ew(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Ue(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function tw(e,t,i,n,s){if(s.strikethrough||s.underline){const o=e.measureText(n),r=t-o.actualBoundingBoxLeft,a=t+o.actualBoundingBoxRight,l=i-o.actualBoundingBoxAscent,c=i+o.actualBoundingBoxDescent,u=s.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=s.decorationWidth||2,e.moveTo(r,u),e.lineTo(a,u),e.stroke()}}function iw(e,t){const i=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=i}function Gs(e,t){const{x:i,y:n,w:s,h:o,radius:r}=t;e.arc(i+r.topLeft,n+r.topLeft,r.topLeft,-ft,ct,!0),e.lineTo(i,n+o-r.bottomLeft),e.arc(i+r.bottomLeft,n+o-r.bottomLeft,r.bottomLeft,ct,ft,!0),e.lineTo(i+s-r.bottomRight,n+o),e.arc(i+s-r.bottomRight,n+o-r.bottomRight,r.bottomRight,ft,0,!0),e.lineTo(i+s,n+r.topRight),e.arc(i+s-r.topRight,n+r.topRight,r.topRight,0,-ft,!0),e.lineTo(i+r.topLeft,n)}const nw=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,sw=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function ow(e,t){const i=(""+e).match(nw);if(!i||i[1]==="normal")return t*1.2;switch(e=+i[2],i[3]){case"px":return e;case"%":e/=100;break}return t*e}const rw=e=>+e||0;function Xl(e,t){const i={},n=Ne(t),s=n?Object.keys(t):t,o=Ne(e)?n?r=>Ie(e[r],e[t[r]]):r=>e[r]:()=>e;for(const r of s)i[r]=rw(o(r));return i}function Lf(e){return Xl(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Cn(e){return Xl(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Lt(e){const t=Lf(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function yt(e,t){e=e||{},t=t||pt.font;let i=Ie(e.size,t.size);typeof i=="string"&&(i=parseInt(i,10));let n=Ie(e.style,t.style);n&&!(""+n).match(sw)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:Ie(e.family,t.family),lineHeight:ow(Ie(e.lineHeight,t.lineHeight),i),size:i,style:n,weight:Ie(e.weight,t.weight),string:""};return s.string=XS(s),s}function ms(e,t,i,n){let s=!0,o,r,a;for(o=0,r=e.length;o<r;++o)if(a=e[o],a!==void 0&&(t!==void 0&&typeof a=="function"&&(a=a(t),s=!1),i!==void 0&&it(a)&&(a=a[i%a.length],s=!1),a!==void 0))return n&&!s&&(n.cacheable=!1),a}function aw(e,t,i){const{min:n,max:s}=e,o=wf(t,(s-n)/2),r=(a,l)=>i&&a===0?0:a+l;return{min:r(n,-Math.abs(o)),max:r(s,o)}}function an(e,t){return Object.assign(Object.create(e),t)}function Jl(e,t=[""],i=e,n,s=()=>e[0]){li(n)||(n=$f("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:n,_getTarget:s,override:r=>Jl([r,...e],t,i,n)};return new Proxy(o,{deleteProperty(r,a){return delete r[a],delete r._keys,delete e[0][a],!0},get(r,a){return Df(r,a,()=>gw(a,t,e,r))},getOwnPropertyDescriptor(r,a){return Reflect.getOwnPropertyDescriptor(r._scopes[0],a)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(r,a){return Fu(r).includes(a)},ownKeys(r){return Fu(r)},set(r,a,l){const c=r._storage||(r._storage=s());return r[a]=c[a]=l,delete r._keys,!0}})}function Zn(e,t,i,n){const s={_cacheable:!1,_proxy:e,_context:t,_subProxy:i,_stack:new Set,_descriptors:Bf(e,n),setContext:o=>Zn(e,o,i,n),override:o=>Zn(e.override(o),t,i,n)};return new Proxy(s,{deleteProperty(o,r){return delete o[r],delete e[r],!0},get(o,r,a){return Df(o,r,()=>cw(o,r,a))},getOwnPropertyDescriptor(o,r){return o._descriptors.allKeys?Reflect.has(e,r)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,r)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(o,r){return Reflect.has(e,r)},ownKeys(){return Reflect.ownKeys(e)},set(o,r,a){return e[r]=a,delete o[r],!0}})}function Bf(e,t={scriptable:!0,indexable:!0}){const{_scriptable:i=t.scriptable,_indexable:n=t.indexable,_allKeys:s=t.allKeys}=e;return{allKeys:s,scriptable:i,indexable:n,isScriptable:sn(i)?i:()=>i,isIndexable:sn(n)?n:()=>n}}const lw=(e,t)=>e?e+jl(t):t,Ql=(e,t)=>Ne(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Df(e,t,i){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];const n=i();return e[t]=n,n}function cw(e,t,i){const{_proxy:n,_context:s,_subProxy:o,_descriptors:r}=e;let a=n[t];return sn(a)&&r.isScriptable(t)&&(a=uw(t,a,e,i)),it(a)&&a.length&&(a=hw(t,a,e,r.isIndexable)),Ql(t,a)&&(a=Zn(a,s,o&&o[t],r)),a}function uw(e,t,i,n){const{_proxy:s,_context:o,_subProxy:r,_stack:a}=i;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);return a.add(e),t=t(o,r||n),a.delete(e),Ql(e,t)&&(t=Zl(s._scopes,s,e,t)),t}function hw(e,t,i,n){const{_proxy:s,_context:o,_subProxy:r,_descriptors:a}=i;if(li(o.index)&&n(e))t=t[o.index%t.length];else if(Ne(t[0])){const l=t,c=s._scopes.filter(u=>u!==l);t=[];for(const u of l){const h=Zl(c,s,e,u);t.push(Zn(h,o,r&&r[e],a))}}return t}function Ff(e,t,i){return sn(e)?e(t,i):e}const dw=(e,t)=>e===!0?t:typeof e=="string"?nn(t,e):void 0;function fw(e,t,i,n,s){for(const o of t){const r=dw(i,o);if(r){e.add(r);const a=Ff(r._fallback,i,s);if(li(a)&&a!==i&&a!==n)return a}else if(r===!1&&li(n)&&i!==n)return null}return!1}function Zl(e,t,i,n){const s=t._rootScopes,o=Ff(t._fallback,i,n),r=[...e,...s],a=new Set;a.add(n);let l=Du(a,r,i,o||i,n);return l===null||li(o)&&o!==i&&(l=Du(a,r,o,l,n),l===null)?!1:Jl(Array.from(a),[""],s,o,()=>pw(t,i,n))}function Du(e,t,i,n,s){for(;i;)i=fw(e,t,i,n,s);return i}function pw(e,t,i){const n=e._getTarget();t in n||(n[t]={});const s=n[t];return it(s)&&Ne(i)?i:s||{}}function gw(e,t,i,n){let s;for(const o of t)if(s=$f(lw(o,e),i),li(s))return Ql(e,s)?Zl(i,n,e,s):s}function $f(e,t){for(const i of t){if(!i)continue;const n=i[e];if(li(n))return n}}function Fu(e){let t=e._keys;return t||(t=e._keys=mw(e._scopes)),t}function mw(e){const t=new Set;for(const i of e)for(const n of Object.keys(i).filter(s=>!s.startsWith("_")))t.add(n);return Array.from(t)}function Hf(e,t,i,n){const{iScale:s}=e,{key:o="r"}=this._parsing,r=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=t[c],r[a]={r:s.parse(nn(u,o),c)};return r}const bw=Number.EPSILON||1e-14,es=(e,t)=>t<e.length&&!e[t].skip&&e[t],Uf=e=>e==="x"?"y":"x";function _w(e,t,i,n){const s=e.skip?t:e,o=t,r=i.skip?t:i,a=Ja(o,s),l=Ja(r,o);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=n*c,f=n*u;return{previous:{x:o.x-h*(r.x-s.x),y:o.y-h*(r.y-s.y)},next:{x:o.x+f*(r.x-s.x),y:o.y+f*(r.y-s.y)}}}function yw(e,t,i){const n=e.length;let s,o,r,a,l,c=es(e,0);for(let u=0;u<n-1;++u)if(l=c,c=es(e,u+1),!(!l||!c)){if(As(t[u],0,bw)){i[u]=i[u+1]=0;continue}s=i[u]/t[u],o=i[u+1]/t[u],a=Math.pow(s,2)+Math.pow(o,2),!(a<=9)&&(r=3/Math.sqrt(a),i[u]=s*r*t[u],i[u+1]=o*r*t[u])}}function vw(e,t,i="x"){const n=Uf(i),s=e.length;let o,r,a,l=es(e,0);for(let c=0;c<s;++c){if(r=a,a=l,l=es(e,c+1),!a)continue;const u=a[i],h=a[n];r&&(o=(u-r[i])/3,a[`cp1${i}`]=u-o,a[`cp1${n}`]=h-o*t[c]),l&&(o=(l[i]-u)/3,a[`cp2${i}`]=u+o,a[`cp2${n}`]=h+o*t[c])}}function Sw(e,t="x"){const i=Uf(t),n=e.length,s=Array(n).fill(0),o=Array(n);let r,a,l,c=es(e,0);for(r=0;r<n;++r)if(a=l,l=c,c=es(e,r+1),!!l){if(c){const u=c[t]-l[t];s[r]=u!==0?(c[i]-l[i])/u:0}o[r]=a?c?Pi(s[r-1])!==Pi(s[r])?0:(s[r-1]+s[r])/2:s[r-1]:s[r]}yw(e,s,o),vw(e,o,t)}function go(e,t,i){return Math.max(Math.min(e,i),t)}function ww(e,t){let i,n,s,o,r,a=Ws(e[0],t);for(i=0,n=e.length;i<n;++i)r=o,o=a,a=i<n-1&&Ws(e[i+1],t),o&&(s=e[i],r&&(s.cp1x=go(s.cp1x,t.left,t.right),s.cp1y=go(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=go(s.cp2x,t.left,t.right),s.cp2y=go(s.cp2y,t.top,t.bottom)))}function Ew(e,t,i,n,s){let o,r,a,l;if(t.spanGaps&&(e=e.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")Sw(e,s);else{let c=n?e[e.length-1]:e[0];for(o=0,r=e.length;o<r;++o)a=e[o],l=_w(c,a,e[Math.min(o+1,r-(n?0:1))%r],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&ww(e,i)}function zf(){return typeof window<"u"&&typeof document<"u"}function ec(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function pr(e,t,i){let n;return typeof e=="string"?(n=parseInt(e,10),e.indexOf("%")!==-1&&(n=n/100*t.parentNode[i])):n=e,n}const Lr=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function kw(e,t){return Lr(e).getPropertyValue(t)}const Iw=["top","right","bottom","left"];function xn(e,t,i){const n={};i=i?"-"+i:"";for(let s=0;s<4;s++){const o=Iw[s];n[o]=parseFloat(e[t+"-"+o+i])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const Pw=(e,t,i)=>(e>0||t>0)&&(!i||!i.shadowRoot);function Aw(e,t){const i=e.touches,n=i&&i.length?i[0]:e,{offsetX:s,offsetY:o}=n;let r=!1,a,l;if(Pw(s,o,e.target))a=s,l=o;else{const c=t.getBoundingClientRect();a=n.clientX-c.left,l=n.clientY-c.top,r=!0}return{x:a,y:l,box:r}}function bn(e,t){if("native"in e)return e;const{canvas:i,currentDevicePixelRatio:n}=t,s=Lr(i),o=s.boxSizing==="border-box",r=xn(s,"padding"),a=xn(s,"border","width"),{x:l,y:c,box:u}=Aw(e,i),h=r.left+(u&&a.left),f=r.top+(u&&a.top);let{width:g,height:_}=t;return o&&(g-=r.width+a.width,_-=r.height+a.height),{x:Math.round((l-h)/g*i.width/n),y:Math.round((c-f)/_*i.height/n)}}function Cw(e,t,i){let n,s;if(t===void 0||i===void 0){const o=ec(e);if(!o)t=e.clientWidth,i=e.clientHeight;else{const r=o.getBoundingClientRect(),a=Lr(o),l=xn(a,"border","width"),c=xn(a,"padding");t=r.width-c.width-l.width,i=r.height-c.height-l.height,n=pr(a.maxWidth,o,"clientWidth"),s=pr(a.maxHeight,o,"clientHeight")}}return{width:t,height:i,maxWidth:n||dr,maxHeight:s||dr}}const mo=e=>Math.round(e*10)/10;function xw(e,t,i,n){const s=Lr(e),o=xn(s,"margin"),r=pr(s.maxWidth,e,"clientWidth")||dr,a=pr(s.maxHeight,e,"clientHeight")||dr,l=Cw(e,t,i);let{width:c,height:u}=l;if(s.boxSizing==="content-box"){const f=xn(s,"border","width"),g=xn(s,"padding");c-=g.width+f.width,u-=g.height+f.height}return c=Math.max(0,c-o.width),u=Math.max(0,n?c/n:u-o.height),c=mo(Math.min(c,r,l.maxWidth)),u=mo(Math.min(u,a,l.maxHeight)),c&&!u&&(u=mo(c/2)),(t!==void 0||i!==void 0)&&n&&l.height&&u>l.height&&(u=l.height,c=mo(Math.floor(u*n))),{width:c,height:u}}function $u(e,t,i){const n=t||1,s=Math.floor(e.height*n),o=Math.floor(e.width*n);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const r=e.canvas;return r.style&&(i||!r.style.height&&!r.style.width)&&(r.style.height=`${e.height}px`,r.style.width=`${e.width}px`),e.currentDevicePixelRatio!==n||r.height!==s||r.width!==o?(e.currentDevicePixelRatio=n,r.height=s,r.width=o,e.ctx.setTransform(n,0,0,n,0,0),!0):!1}const Mw=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return e}();function Hu(e,t){const i=kw(e,t),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function _n(e,t,i,n){return{x:e.x+i*(t.x-e.x),y:e.y+i*(t.y-e.y)}}function Tw(e,t,i,n){return{x:e.x+i*(t.x-e.x),y:n==="middle"?i<.5?e.y:t.y:n==="after"?i<1?e.y:t.y:i>0?t.y:e.y}}function Rw(e,t,i,n){const s={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},r=_n(e,s,i),a=_n(s,o,i),l=_n(o,t,i),c=_n(r,a,i),u=_n(a,l,i);return _n(c,u,i)}const Ow=function(e,t){return{x(i){return e+e+t-i},setWidth(i){t=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,n){return i-n},leftForLtr(i,n){return i-n}}},Nw=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function Kn(e,t,i){return e?Ow(t,i):Nw()}function Wf(e,t){let i,n;(t==="ltr"||t==="rtl")&&(i=e.canvas.style,n=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",t,"important"),e.prevTextDirection=n)}function Gf(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Vf(e){return e==="angle"?{between:zs,compare:LS,normalize:Jt}:{between:$i,compare:(t,i)=>t-i,normalize:t=>t}}function Uu({start:e,end:t,count:i,loop:n,style:s}){return{start:e%i,end:t%i,loop:n&&(t-e+1)%i===0,style:s}}function Lw(e,t,i){const{property:n,start:s,end:o}=i,{between:r,normalize:a}=Vf(n),l=t.length;let{start:c,end:u,loop:h}=e,f,g;if(h){for(c+=l,u+=l,f=0,g=l;f<g&&r(a(t[c%l][n]),s,o);++f)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:e.style}}function jf(e,t,i){if(!i)return[e];const{property:n,start:s,end:o}=i,r=t.length,{compare:a,between:l,normalize:c}=Vf(n),{start:u,end:h,loop:f,style:g}=Lw(e,t,i),_=[];let b=!1,v=null,y,E,w;const P=()=>l(s,w,y)&&a(s,w)!==0,A=()=>a(o,y)===0||l(o,w,y),O=()=>b||P(),U=()=>!b||A();for(let z=u,te=u;z<=h;++z)E=t[z%r],!E.skip&&(y=c(E[n]),y!==w&&(b=l(y,s,o),v===null&&O()&&(v=a(y,s)===0?z:te),v!==null&&U()&&(_.push(Uu({start:v,end:z,loop:f,count:r,style:g})),v=null),te=z,w=y));return v!==null&&_.push(Uu({start:v,end:h,loop:f,count:r,style:g})),_}function Kf(e,t){const i=[],n=e.segments;for(let s=0;s<n.length;s++){const o=jf(n[s],e.points,t);o.length&&i.push(...o)}return i}function Bw(e,t,i,n){let s=0,o=t-1;if(i&&!n)for(;s<t&&!e[s].skip;)s++;for(;s<t&&e[s].skip;)s++;for(s%=t,i&&(o+=s);o>s&&e[o%t].skip;)o--;return o%=t,{start:s,end:o}}function Dw(e,t,i,n){const s=e.length,o=[];let r=t,a=e[t],l;for(l=t+1;l<=i;++l){const c=e[l%s];c.skip||c.stop?a.skip||(n=!1,o.push({start:t%s,end:(l-1)%s,loop:n}),t=r=c.stop?l:null):(r=l,a.skip&&(t=l)),a=c}return r!==null&&o.push({start:t%s,end:r%s,loop:n}),o}function Fw(e,t){const i=e.points,n=e.options.spanGaps,s=i.length;if(!s)return[];const o=!!e._loop,{start:r,end:a}=Bw(i,s,o,n);if(n===!0)return zu(e,[{start:r,end:a,loop:o}],i,t);const l=a<r?a+s:a,c=!!e._fullLoop&&r===0&&a===s-1;return zu(e,Dw(i,r,l,c),i,t)}function zu(e,t,i,n){return!n||!n.setContext||!i?t:$w(e,t,i,n)}function $w(e,t,i,n){const s=e._chart.getContext(),o=Wu(e.options),{_datasetIndex:r,options:{spanGaps:a}}=e,l=i.length,c=[];let u=o,h=t[0].start,f=h;function g(_,b,v,y){const E=a?-1:1;if(_!==b){for(_+=l;i[_%l].skip;)_-=E;for(;i[b%l].skip;)b+=E;_%l!==b%l&&(c.push({start:_%l,end:b%l,loop:v,style:y}),u=y,h=b%l)}}for(const _ of t){h=a?h:_.start;let b=i[h%l],v;for(f=h+1;f<=_.end;f++){const y=i[f%l];v=Wu(n.setContext(an(s,{type:"segment",p0:b,p1:y,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:r}))),Hw(v,u)&&g(h,f-1,_.loop,u),b=y,u=v}h<f-1&&g(h,f-1,_.loop,u)}return c}function Wu(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Hw(e,t){return t&&JSON.stringify(e)!==JSON.stringify(t)}/*!
 * Chart.js v4.2.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class Uw{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,i,n,s){const o=i.listeners[s],r=i.duration;o.forEach(a=>a({chart:t,initial:i.initial,numSteps:r,currentStep:Math.min(n-i.start,r)}))}_refresh(){this._request||(this._running=!0,this._request=Cf.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let i=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const o=n.items;let r=o.length-1,a=!1,l;for(;r>=0;--r)l=o[r],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(t),a=!0):(o[r]=o[o.length-1],o.pop());a&&(s.draw(),this._notify(s,n,t,"progress")),o.length||(n.running=!1,this._notify(s,n,t,"complete"),n.initial=!1),i+=o.length}),this._lastDate=t,i===0&&(this._running=!1)}_getAnims(t){const i=this._charts;let n=i.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(t,n)),n}listen(t,i,n){this._getAnims(t).listeners[i].push(n)}add(t,i){!i||!i.length||this._getAnims(t).items.push(...i)}has(t){return this._getAnims(t).items.length>0}start(t){const i=this._charts.get(t);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const i=this._charts.get(t);return!(!i||!i.running||!i.items.length)}stop(t){const i=this._charts.get(t);if(!i||!i.items.length)return;const n=i.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();i.items=[],this._notify(t,i,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Ri=new Uw;const Gu="transparent",zw={boolean(e,t,i){return i>.5?t:e},color(e,t,i){const n=Nu(e||Gu),s=n.valid&&Nu(t||Gu);return s&&s.valid?s.mix(n,i).hexString():t},number(e,t,i){return e+(t-e)*i}};class Ww{constructor(t,i,n,s){const o=i[n];s=ms([t.to,s,o,t.from]);const r=ms([t.from,o,s]);this._active=!0,this._fn=t.fn||zw[t.type||typeof r],this._easing=Cs[t.easing]||Cs.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=i,this._prop=n,this._from=r,this._to=s,this._promises=void 0}active(){return this._active}update(t,i,n){if(this._active){this._notify(!1);const s=this._target[this._prop],o=n-this._start,r=this._duration-o;this._start=n,this._duration=Math.floor(Math.max(r,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=ms([t.to,i,s,t.from]),this._from=ms([t.from,s,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const i=t-this._start,n=this._duration,s=this._prop,o=this._from,r=this._loop,a=this._to;let l;if(this._active=o!==a&&(r||i<n),!this._active){this._target[s]=a,this._notify(!0);return}if(i<0){this._target[s]=o;return}l=i/n%2,l=r&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(o,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((i,n)=>{t.push({res:i,rej:n})})}_notify(t){const i=t?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][i]()}}class qf{constructor(t,i){this._chart=t,this._properties=new Map,this.configure(i)}configure(t){if(!Ne(t))return;const i=Object.keys(pt.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const o=t[s];if(!Ne(o))return;const r={};for(const a of i)r[a]=o[a];(it(o.properties)&&o.properties||[s]).forEach(a=>{(a===s||!n.has(a))&&n.set(a,r)})})}_animateOptions(t,i){const n=i.options,s=Vw(t,n);if(!s)return[];const o=this._createAnimations(s,n);return n.$shared&&Gw(t.options.$animations,n).then(()=>{t.options=n},()=>{}),o}_createAnimations(t,i){const n=this._properties,s=[],o=t.$animations||(t.$animations={}),r=Object.keys(i),a=Date.now();let l;for(l=r.length-1;l>=0;--l){const c=r[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(t,i));continue}const u=i[c];let h=o[c];const f=n.get(c);if(h)if(f&&h.active()){h.update(f,u,a);continue}else h.cancel();if(!f||!f.duration){t[c]=u;continue}o[c]=h=new Ww(f,t,c,u),s.push(h)}return s}update(t,i){if(this._properties.size===0){Object.assign(t,i);return}const n=this._createAnimations(t,i);if(n.length)return Ri.add(this._chart,n),!0}}function Gw(e,t){const i=[],n=Object.keys(t);for(let s=0;s<n.length;s++){const o=e[n[s]];o&&o.active()&&i.push(o.wait())}return Promise.all(i)}function Vw(e,t){if(!t)return;let i=e.options;if(!i){e.options=t;return}return i.$shared&&(e.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function Vu(e,t){const i=e&&e.options||{},n=i.reverse,s=i.min===void 0?t:0,o=i.max===void 0?t:0;return{start:n?o:s,end:n?s:o}}function jw(e,t,i){if(i===!1)return!1;const n=Vu(e,i),s=Vu(t,i);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function Kw(e){let t,i,n,s;return Ne(e)?(t=e.top,i=e.right,n=e.bottom,s=e.left):t=i=n=s=e,{top:t,right:i,bottom:n,left:s,disabled:e===!1}}function Yf(e,t){const i=[],n=e._getSortedDatasetMetas(t);let s,o;for(s=0,o=n.length;s<o;++s)i.push(n[s].index);return i}function ju(e,t,i,n={}){const s=e.keys,o=n.mode==="single";let r,a,l,c;if(t!==null){for(r=0,a=s.length;r<a;++r){if(l=+s[r],l===i){if(n.all)continue;break}c=e.values[l],dt(c)&&(o||t===0||Pi(t)===Pi(c))&&(t+=c)}return t}}function qw(e){const t=Object.keys(e),i=new Array(t.length);let n,s,o;for(n=0,s=t.length;n<s;++n)o=t[n],i[n]={x:o,y:e[o]};return i}function Ku(e,t){const i=e&&e.options.stacked;return i||i===void 0&&t.stack!==void 0}function Yw(e,t,i){return`${e.id}.${t.id}.${i.stack||i.type}`}function Xw(e){const{min:t,max:i,minDefined:n,maxDefined:s}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:s?i:Number.POSITIVE_INFINITY}}function Jw(e,t,i){const n=e[t]||(e[t]={});return n[i]||(n[i]={})}function qu(e,t,i,n){for(const s of t.getMatchingVisibleMetas(n).reverse()){const o=e[s.index];if(i&&o>0||!i&&o<0)return s.index}return null}function Yu(e,t){const{chart:i,_cachedMeta:n}=e,s=i._stacks||(i._stacks={}),{iScale:o,vScale:r,index:a}=n,l=o.axis,c=r.axis,u=Yw(o,r,n),h=t.length;let f;for(let g=0;g<h;++g){const _=t[g],{[l]:b,[c]:v}=_,y=_._stacks||(_._stacks={});f=y[c]=Jw(s,u,b),f[a]=v,f._top=qu(f,r,!0,n.type),f._bottom=qu(f,r,!1,n.type);const E=f._visualValues||(f._visualValues={});E[a]=v}}function pa(e,t){const i=e.scales;return Object.keys(i).filter(n=>i[n].axis===t).shift()}function Qw(e,t){return an(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Zw(e,t,i){return an(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:i,index:t,mode:"default",type:"data"})}function rs(e,t){const i=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const s of t){const o=s._stacks;if(!o||o[n]===void 0||o[n][i]===void 0)return;delete o[n][i],o[n]._visualValues!==void 0&&o[n]._visualValues[i]!==void 0&&delete o[n]._visualValues[i]}}}const ga=e=>e==="reset"||e==="none",Xu=(e,t)=>t?e:Object.assign({},e),eE=(e,t,i)=>e&&!t.hidden&&t._stacked&&{keys:Yf(i,!0),values:null};class gi{constructor(t,i){this.chart=t,this._ctx=t.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ku(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&rs(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,i=this._cachedMeta,n=this.getDataset(),s=(h,f,g,_)=>h==="x"?f:h==="r"?_:g,o=i.xAxisID=Ie(n.xAxisID,pa(t,"x")),r=i.yAxisID=Ie(n.yAxisID,pa(t,"y")),a=i.rAxisID=Ie(n.rAxisID,pa(t,"r")),l=i.indexAxis,c=i.iAxisID=s(l,o,r,a),u=i.vAxisID=s(l,r,o,a);i.xScale=this.getScaleForId(o),i.yScale=this.getScaleForId(r),i.rScale=this.getScaleForId(a),i.iScale=this.getScaleForId(c),i.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const i=this._cachedMeta;return t===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Tu(this._data,this),t._stacked&&rs(t)}_dataCheck(){const t=this.getDataset(),i=t.data||(t.data=[]),n=this._data;if(Ne(i))this._data=qw(i);else if(n!==i){if(n){Tu(n,this);const s=this._cachedMeta;rs(s),s._parsed=[]}i&&Object.isExtensible(i)&&$S(i,this),this._syncList=[],this._data=i}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const i=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const o=i._stacked;i._stacked=Ku(i.vScale,i),i.stack!==n.stack&&(s=!0,rs(i),i.stack=n.stack),this._resyncElements(t),(s||o!==i._stacked)&&Yu(this,i._parsed)}configure(){const t=this.chart.config,i=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),i,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,i){const{_cachedMeta:n,_data:s}=this,{iScale:o,_stacked:r}=n,a=o.axis;let l=t===0&&i===s.length?!0:n._sorted,c=t>0&&n._parsed[t-1],u,h,f;if(this._parsing===!1)n._parsed=s,n._sorted=!0,f=s;else{it(s[t])?f=this.parseArrayData(n,s,t,i):Ne(s[t])?f=this.parseObjectData(n,s,t,i):f=this.parsePrimitiveData(n,s,t,i);const g=()=>h[a]===null||c&&h[a]<c[a];for(u=0;u<i;++u)n._parsed[u+t]=h=f[u],l&&(g()&&(l=!1),c=h);n._sorted=l}r&&Yu(this,f)}parsePrimitiveData(t,i,n,s){const{iScale:o,vScale:r}=t,a=o.axis,l=r.axis,c=o.getLabels(),u=o===r,h=new Array(s);let f,g,_;for(f=0,g=s;f<g;++f)_=f+n,h[f]={[a]:u||o.parse(c[_],_),[l]:r.parse(i[_],_)};return h}parseArrayData(t,i,n,s){const{xScale:o,yScale:r}=t,a=new Array(s);let l,c,u,h;for(l=0,c=s;l<c;++l)u=l+n,h=i[u],a[l]={x:o.parse(h[0],u),y:r.parse(h[1],u)};return a}parseObjectData(t,i,n,s){const{xScale:o,yScale:r}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let u,h,f,g;for(u=0,h=s;u<h;++u)f=u+n,g=i[f],c[u]={x:o.parse(nn(g,a),f),y:r.parse(nn(g,l),f)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,i,n){const s=this.chart,o=this._cachedMeta,r=i[t.axis],a={keys:Yf(s,!0),values:i._stacks[t.axis]._visualValues};return ju(a,r,o.index,{mode:n})}updateRangeFromParsed(t,i,n,s){const o=n[i.axis];let r=o===null?NaN:o;const a=s&&n._stacks[i.axis];s&&a&&(s.values=a,r=ju(s,o,this._cachedMeta.index)),t.min=Math.min(t.min,r),t.max=Math.max(t.max,r)}getMinMax(t,i){const n=this._cachedMeta,s=n._parsed,o=n._sorted&&t===n.iScale,r=s.length,a=this._getOtherScale(t),l=eE(i,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=Xw(a);let f,g;function _(){g=s[f];const b=g[a.axis];return!dt(g[t.axis])||u>b||h<b}for(f=0;f<r&&!(!_()&&(this.updateRangeFromParsed(c,t,g,l),o));++f);if(o){for(f=r-1;f>=0;--f)if(!_()){this.updateRangeFromParsed(c,t,g,l);break}}return c}getAllParsedValues(t){const i=this._cachedMeta._parsed,n=[];let s,o,r;for(s=0,o=i.length;s<o;++s)r=i[s][t.axis],dt(r)&&n.push(r);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const i=this._cachedMeta,n=i.iScale,s=i.vScale,o=this.getParsed(t);return{label:n?""+n.getLabelForValue(o[n.axis]):"",value:s?""+s.getLabelForValue(o[s.axis]):""}}_update(t){const i=this._cachedMeta;this.update(t||"default"),i._clip=Kw(Ie(this.options.clip,jw(i.xScale,i.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,i=this.chart,n=this._cachedMeta,s=n.data||[],o=i.chartArea,r=[],a=this._drawStart||0,l=this._drawCount||s.length-a,c=this.options.drawActiveElementsOnTop;let u;for(n.dataset&&n.dataset.draw(t,o,a,l),u=a;u<a+l;++u){const h=s[u];h.hidden||(h.active&&c?r.push(h):h.draw(t,o))}for(u=0;u<r.length;++u)r[u].draw(t,o)}getStyle(t,i){const n=i?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,i,n){const s=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const r=this._cachedMeta.data[t];o=r.$context||(r.$context=Zw(this.getContext(),t,r)),o.parsed=this.getParsed(t),o.raw=s.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=Qw(this.chart.getContext(),this.index)),o.dataset=s,o.index=o.datasetIndex=this.index;return o.active=!!i,o.mode=n,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,i){return this._resolveElementOptions(this.dataElementType.id,i,t)}_resolveElementOptions(t,i="default",n){const s=i==="active",o=this._cachedDataOpts,r=t+"-"+i,a=o[r],l=this.enableOptionSharing&&li(n);if(a)return Xu(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),h=s?[`${t}Hover`,"hover",t,""]:[t,""],f=c.getOptionScopes(this.getDataset(),u),g=Object.keys(pt.elements[t]),_=()=>this.getContext(n,s,i),b=c.resolveNamedOptions(f,g,_,h);return b.$shared&&(b.$shared=l,o[r]=Object.freeze(Xu(b,l))),b}_resolveAnimations(t,i,n){const s=this.chart,o=this._cachedDataOpts,r=`animation-${i}`,a=o[r];if(a)return a;let l;if(s.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,i),f=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(f,this.getContext(t,n,i))}const c=new qf(s,l&&l.animations);return l&&l._cacheable&&(o[r]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,i){return!i||ga(t)||this.chart._animationsDisabled}_getSharedOptions(t,i){const n=this.resolveDataElementOptions(t,i),s=this._sharedOptions,o=this.getSharedOptions(n),r=this.includeOptions(i,o)||o!==s;return this.updateSharedOptions(o,i,n),{sharedOptions:o,includeOptions:r}}updateElement(t,i,n,s){ga(s)?Object.assign(t,n):this._resolveAnimations(i,s).update(t,n)}updateSharedOptions(t,i,n){t&&!ga(i)&&this._resolveAnimations(void 0,i).update(t,n)}_setStyle(t,i,n,s){t.active=s;const o=this.getStyle(i,s);this._resolveAnimations(i,n,s).update(t,{options:!s&&this.getSharedOptions(o)||o})}removeHoverStyle(t,i,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,i,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const i=this._data,n=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const s=n.length,o=i.length,r=Math.min(o,s);r&&this.parse(0,r),o>s?this._insertElements(s,o-s,t):o<s&&this._removeElements(o,s-o)}_insertElements(t,i,n=!0){const s=this._cachedMeta,o=s.data,r=t+i;let a;const l=c=>{for(c.length+=i,a=c.length-1;a>=r;a--)c[a]=c[a-i]};for(l(o),a=t;a<r;++a)o[a]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(t,i),n&&this.updateElements(o,t,i,"reset")}updateElements(t,i,n,s){}_removeElements(t,i){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(t,i);n._stacked&&rs(n,s)}n.data.splice(t,i)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[i,n,s]=t;this[i](n,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,i){i&&this._sync(["_removeElements",t,i]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}M(gi,"defaults",{}),M(gi,"datasetElementType",null),M(gi,"dataElementType",null);function tE(e,t){if(!e._cache.$bar){const i=e.getMatchingVisibleMetas(t);let n=[];for(let s=0,o=i.length;s<o;s++)n=n.concat(i[s].controller.getAllParsedValues(e));e._cache.$bar=Af(n.sort((s,o)=>s-o))}return e._cache.$bar}function iE(e){const t=e.iScale,i=tE(t,e.type);let n=t._length,s,o,r,a;const l=()=>{r===32767||r===-32768||(li(a)&&(n=Math.min(n,Math.abs(r-a)||n)),a=r)};for(s=0,o=i.length;s<o;++s)r=t.getPixelForValue(i[s]),l();for(a=void 0,s=0,o=t.ticks.length;s<o;++s)r=t.getPixelForTick(s),l();return n}function nE(e,t,i,n){const s=i.barThickness;let o,r;return Ue(s)?(o=t.min*i.categoryPercentage,r=i.barPercentage):(o=s*n,r=1),{chunk:o/n,ratio:r,start:t.pixels[e]-o/2}}function sE(e,t,i,n){const s=t.pixels,o=s[e];let r=e>0?s[e-1]:null,a=e<s.length-1?s[e+1]:null;const l=i.categoryPercentage;r===null&&(r=o-(a===null?t.end-t.start:a-o)),a===null&&(a=o+o-r);const c=o-(o-Math.min(r,a))/2*l;return{chunk:Math.abs(a-r)/2*l/n,ratio:i.barPercentage,start:c}}function oE(e,t,i,n){const s=i.parse(e[0],n),o=i.parse(e[1],n),r=Math.min(s,o),a=Math.max(s,o);let l=r,c=a;Math.abs(r)>Math.abs(a)&&(l=a,c=r),t[i.axis]=c,t._custom={barStart:l,barEnd:c,start:s,end:o,min:r,max:a}}function Xf(e,t,i,n){return it(e)?oE(e,t,i,n):t[i.axis]=i.parse(e,n),t}function Ju(e,t,i,n){const s=e.iScale,o=e.vScale,r=s.getLabels(),a=s===o,l=[];let c,u,h,f;for(c=i,u=i+n;c<u;++c)f=t[c],h={},h[s.axis]=a||s.parse(r[c],c),l.push(Xf(f,h,o,c));return l}function ma(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function rE(e,t,i){return e!==0?Pi(e):(t.isHorizontal()?1:-1)*(t.min>=i?1:-1)}function aE(e){let t,i,n,s,o;return e.horizontal?(t=e.base>e.x,i="left",n="right"):(t=e.base<e.y,i="bottom",n="top"),t?(s="end",o="start"):(s="start",o="end"),{start:i,end:n,reverse:t,top:s,bottom:o}}function lE(e,t,i,n){let s=t.borderSkipped;const o={};if(!s){e.borderSkipped=o;return}if(s===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:r,end:a,reverse:l,top:c,bottom:u}=aE(e);s==="middle"&&i&&(e.enableBorderRadius=!0,(i._top||0)===n?s=c:(i._bottom||0)===n?s=u:(o[Qu(u,r,a,l)]=!0,s=c)),o[Qu(s,r,a,l)]=!0,e.borderSkipped=o}function Qu(e,t,i,n){return n?(e=cE(e,t,i),e=Zu(e,i,t)):e=Zu(e,t,i),e}function cE(e,t,i){return e===t?i:e===i?t:e}function Zu(e,t,i){return e==="start"?t:e==="end"?i:e}function uE(e,{inflateAmount:t},i){e.inflateAmount=t==="auto"?i===1?.33:0:t}class Ro extends gi{parsePrimitiveData(t,i,n,s){return Ju(t,i,n,s)}parseArrayData(t,i,n,s){return Ju(t,i,n,s)}parseObjectData(t,i,n,s){const{iScale:o,vScale:r}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=o.axis==="x"?a:l,u=r.axis==="x"?a:l,h=[];let f,g,_,b;for(f=n,g=n+s;f<g;++f)b=i[f],_={},_[o.axis]=o.parse(nn(b,c),f),h.push(Xf(nn(b,u),_,r,f));return h}updateRangeFromParsed(t,i,n,s){super.updateRangeFromParsed(t,i,n,s);const o=n._custom;o&&i===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const i=this._cachedMeta,{iScale:n,vScale:s}=i,o=this.getParsed(t),r=o._custom,a=ma(r)?"["+r.start+", "+r.end+"]":""+s.getLabelForValue(o[s.axis]);return{label:""+n.getLabelForValue(o[n.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,t)}updateElements(t,i,n,s){const o=s==="reset",{index:r,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(i,s);for(let g=i;g<i+n;g++){const _=this.getParsed(g),b=o||Ue(_[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(g),v=this._calculateBarIndexPixels(g,u),y=(_._stacks||{})[a.axis],E={horizontal:c,base:b.base,enableBorderRadius:!y||ma(_._custom)||r===y._top||r===y._bottom,x:c?b.head:v.center,y:c?v.center:b.head,height:c?v.size:Math.abs(b.size),width:c?Math.abs(b.size):v.size};f&&(E.options=h||this.resolveDataElementOptions(g,t[g].active?"active":s));const w=E.options||t[g].options;lE(E,w,y,r),uE(E,w,u.ratio),this.updateElement(t[g],g,E,s)}}_getStacks(t,i){const{iScale:n}=this._cachedMeta,s=n.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),o=n.options.stacked,r=[],a=l=>{const c=l.controller.getParsed(i),u=c&&c[l.vScale.axis];if(Ue(u)||isNaN(u))return!0};for(const l of s)if(!(i!==void 0&&a(l))&&((o===!1||r.indexOf(l.stack)===-1||o===void 0&&l.stack===void 0)&&r.push(l.stack),l.index===t))break;return r.length||r.push(void 0),r}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,i,n){const s=this._getStacks(t,n),o=i!==void 0?s.indexOf(i):-1;return o===-1?s.length-1:o}_getRuler(){const t=this.options,i=this._cachedMeta,n=i.iScale,s=[];let o,r;for(o=0,r=i.data.length;o<r;++o)s.push(n.getPixelForValue(this.getParsed(o)[n.axis],o));const a=t.barThickness;return{min:a||iE(i),pixels:s,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:i,_stacked:n,index:s},options:{base:o,minBarLength:r}}=this,a=o||0,l=this.getParsed(t),c=l._custom,u=ma(c);let h=l[i.axis],f=0,g=n?this.applyStack(i,l,n):h,_,b;g!==h&&(f=g-h,g=h),u&&(h=c.barStart,g=c.barEnd-c.barStart,h!==0&&Pi(h)!==Pi(c.barEnd)&&(f=0),f+=h);const v=!Ue(o)&&!u?o:f;let y=i.getPixelForValue(v);if(this.chart.getDataVisibility(t)?_=i.getPixelForValue(f+g):_=y,b=_-y,Math.abs(b)<r){b=rE(b,i,a)*r,h===a&&(y-=b/2);const E=i.getPixelForDecimal(0),w=i.getPixelForDecimal(1),P=Math.min(E,w),A=Math.max(E,w);y=Math.max(Math.min(y,A),P),_=y+b,n&&!u&&(l._stacks[i.axis]._visualValues[s]=i.getValueForPixel(_)-i.getValueForPixel(y))}if(y===i.getPixelForValue(a)){const E=Pi(b)*i.getLineWidthForValue(a)/2;y+=E,b-=E}return{size:b,base:y,head:_,center:_+b/2}}_calculateBarIndexPixels(t,i){const n=i.scale,s=this.options,o=s.skipNull,r=Ie(s.maxBarThickness,1/0);let a,l;if(i.grouped){const c=o?this._getStackCount(t):i.stackCount,u=s.barThickness==="flex"?sE(t,i,s,c):nE(t,i,s,c),h=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0);a=u.start+u.chunk*h+u.chunk/2,l=Math.min(r,u.chunk*u.ratio)}else a=n.getPixelForValue(this.getParsed(t)[n.axis],t),l=Math.min(r,i.min*i.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,i=t.vScale,n=t.data,s=n.length;let o=0;for(;o<s;++o)this.getParsed(o)[i.axis]!==null&&n[o].draw(this._ctx)}}M(Ro,"id","bar"),M(Ro,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),M(Ro,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Oo extends gi{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,i,n,s){const o=super.parsePrimitiveData(t,i,n,s);for(let r=0;r<o.length;r++)o[r]._custom=this.resolveDataElementOptions(r+n).radius;return o}parseArrayData(t,i,n,s){const o=super.parseArrayData(t,i,n,s);for(let r=0;r<o.length;r++){const a=i[n+r];o[r]._custom=Ie(a[2],this.resolveDataElementOptions(r+n).radius)}return o}parseObjectData(t,i,n,s){const o=super.parseObjectData(t,i,n,s);for(let r=0;r<o.length;r++){const a=i[n+r];o[r]._custom=Ie(a&&a.r&&+a.r,this.resolveDataElementOptions(r+n).radius)}return o}getMaxOverflow(){const t=this._cachedMeta.data;let i=0;for(let n=t.length-1;n>=0;--n)i=Math.max(i,t[n].size(this.resolveDataElementOptions(n))/2);return i>0&&i}getLabelAndValue(t){const i=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:o}=i,r=this.getParsed(t),a=s.getLabelForValue(r.x),l=o.getLabelForValue(r.y),c=r._custom;return{label:n[t]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(t){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,t)}updateElements(t,i,n,s){const o=s==="reset",{iScale:r,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(i,s),u=r.axis,h=a.axis;for(let f=i;f<i+n;f++){const g=t[f],_=!o&&this.getParsed(f),b={},v=b[u]=o?r.getPixelForDecimal(.5):r.getPixelForValue(_[u]),y=b[h]=o?a.getBasePixel():a.getPixelForValue(_[h]);b.skip=isNaN(v)||isNaN(y),c&&(b.options=l||this.resolveDataElementOptions(f,g.active?"active":s),o&&(b.options.radius=0)),this.updateElement(g,f,b,s)}}resolveDataElementOptions(t,i){const n=this.getParsed(t);let s=super.resolveDataElementOptions(t,i);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const o=s.radius;return i!=="active"&&(s.radius=0),s.radius+=Ie(n&&n._custom,o),s}}M(Oo,"id","bubble"),M(Oo,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),M(Oo,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function hE(e,t,i){let n=1,s=1,o=0,r=0;if(t<nt){const a=e,l=a+t,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),f=Math.sin(l),g=(w,P,A)=>zs(w,a,l,!0)?1:Math.max(P,P*i,A,A*i),_=(w,P,A)=>zs(w,a,l,!0)?-1:Math.min(P,P*i,A,A*i),b=g(0,c,h),v=g(ft,u,f),y=_(ct,c,h),E=_(ct+ft,u,f);n=(b-y)/2,s=(v-E)/2,o=-(b+y)/2,r=-(v+E)/2}return{ratioX:n,ratioY:s,offsetX:o,offsetY:r}}class En extends gi{constructor(t,i){super(t,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,i){const n=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=n;else{let o=l=>+n[l];if(Ne(n[t])){const{key:l="value"}=this._parsing;o=c=>+nn(n[c],l)}let r,a;for(r=t,a=t+i;r<a;++r)s._parsed[r]=o(r)}}_getRotation(){return di(this.options.rotation-90)}_getCircumference(){return di(this.options.circumference)}_getRotationExtents(){let t=nt,i=-nt;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const s=this.chart.getDatasetMeta(n).controller,o=s._getRotation(),r=s._getCircumference();t=Math.min(t,o),i=Math.max(i,o+r)}return{rotation:t,circumference:i-t}}update(t){const i=this.chart,{chartArea:n}=i,s=this._cachedMeta,o=s.data,r=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,a=Math.max((Math.min(n.width,n.height)-r)/2,0),l=Math.min(IS(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:g,offsetX:_,offsetY:b}=hE(h,u,l),v=(n.width-r)/f,y=(n.height-r)/g,E=Math.max(Math.min(v,y)/2,0),w=wf(this.options.radius,E),P=Math.max(w*l,0),A=(w-P)/this._getVisibleDatasetWeightTotal();this.offsetX=_*w,this.offsetY=b*w,s.total=this.calculateTotal(),this.outerRadius=w-A*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-A*c,0),this.updateElements(o,0,o.length,t)}_circumference(t,i){const n=this.options,s=this._cachedMeta,o=this._getCircumference();return i&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*o/nt)}updateElements(t,i,n,s){const o=s==="reset",r=this.chart,a=r.chartArea,c=r.options.animation,u=(a.left+a.right)/2,h=(a.top+a.bottom)/2,f=o&&c.animateScale,g=f?0:this.innerRadius,_=f?0:this.outerRadius,{sharedOptions:b,includeOptions:v}=this._getSharedOptions(i,s);let y=this._getRotation(),E;for(E=0;E<i;++E)y+=this._circumference(E,o);for(E=i;E<i+n;++E){const w=this._circumference(E,o),P=t[E],A={x:u+this.offsetX,y:h+this.offsetY,startAngle:y,endAngle:y+w,circumference:w,outerRadius:_,innerRadius:g};v&&(A.options=b||this.resolveDataElementOptions(E,P.active?"active":s)),y+=w,this.updateElement(P,E,A,s)}}calculateTotal(){const t=this._cachedMeta,i=t.data;let n=0,s;for(s=0;s<i.length;s++){const o=t._parsed[s];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(s)&&!i[s].hidden&&(n+=Math.abs(o))}return n}calculateCircumference(t){const i=this._cachedMeta.total;return i>0&&!isNaN(t)?nt*(Math.abs(t)/i):0}getLabelAndValue(t){const i=this._cachedMeta,n=this.chart,s=n.data.labels||[],o=Zs(i._parsed[t],n.options.locale);return{label:s[t]||"",value:o}}getMaxBorderWidth(t){let i=0;const n=this.chart;let s,o,r,a,l;if(!t){for(s=0,o=n.data.datasets.length;s<o;++s)if(n.isDatasetVisible(s)){r=n.getDatasetMeta(s),t=r.data,a=r.controller;break}}if(!t)return 0;for(s=0,o=t.length;s<o;++s)l=a.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(i=Math.max(i,l.borderWidth||0,l.hoverBorderWidth||0));return i}getMaxOffset(t){let i=0;for(let n=0,s=t.length;n<s;++n){const o=this.resolveDataElementOptions(n);i=Math.max(i,o.offset||0,o.hoverOffset||0)}return i}_getRingWeightOffset(t){let i=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(i+=this._getRingWeight(n));return i}_getRingWeight(t){return Math.max(Ie(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}M(En,"id","doughnut"),M(En,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),M(En,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"}),M(En,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const i=t.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:n,color:s}}=t.legend.options;return i.labels.map((o,r)=>{const l=t.getDatasetMeta(0).controller.getStyle(r);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(r),index:r}})}return[]}},onClick(t,i,n){n.chart.toggleDataVisibility(i.index),n.chart.update()}}}});class No extends gi{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const i=this._cachedMeta,{dataset:n,data:s=[],_dataset:o}=i,r=this.chart._animationsDisabled;let{start:a,count:l}=Mf(i,s,r);this._drawStart=a,this._drawCount=l,Tf(i)&&(a=0,l=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!o._decimated,n.points=s;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(n,void 0,{animated:!r,options:c},t),this.updateElements(s,a,l,t)}updateElements(t,i,n,s){const o=s==="reset",{iScale:r,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(i,s),f=r.axis,g=a.axis,{spanGaps:_,segment:b}=this.options,v=Qn(_)?_:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||o||s==="none",E=i+n,w=t.length;let P=i>0&&this.getParsed(i-1);for(let A=0;A<w;++A){const O=t[A],U=y?O:{};if(A<i||A>=E){U.skip=!0;continue}const z=this.getParsed(A),te=Ue(z[g]),G=U[f]=r.getPixelForValue(z[f],A),Q=U[g]=o||te?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,z,l):z[g],A);U.skip=isNaN(G)||isNaN(Q)||te,U.stop=A>0&&Math.abs(z[f]-P[f])>v,b&&(U.parsed=z,U.raw=c.data[A]),h&&(U.options=u||this.resolveDataElementOptions(A,O.active?"active":s)),y||this.updateElement(O,A,U,s),P=z}}getMaxOverflow(){const t=this._cachedMeta,i=t.dataset,n=i.options&&i.options.borderWidth||0,s=t.data||[];if(!s.length)return n;const o=s[0].size(this.resolveDataElementOptions(0)),r=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(n,o,r)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}M(No,"id","line"),M(No,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),M(No,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Ms extends gi{constructor(t,i){super(t,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const i=this._cachedMeta,n=this.chart,s=n.data.labels||[],o=Zs(i._parsed[t].r,n.options.locale);return{label:s[t]||"",value:o}}parseObjectData(t,i,n,s){return Hf.bind(this)(t,i,n,s)}update(t){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,t)}getMinMax(){const t=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((n,s)=>{const o=this.getParsed(s).r;!isNaN(o)&&this.chart.getDataVisibility(s)&&(o<i.min&&(i.min=o),o>i.max&&(i.max=o))}),i}_updateRadius(){const t=this.chart,i=t.chartArea,n=t.options,s=Math.min(i.right-i.left,i.bottom-i.top),o=Math.max(s/2,0),r=Math.max(n.cutoutPercentage?o/100*n.cutoutPercentage:1,0),a=(o-r)/t.getVisibleDatasetCount();this.outerRadius=o-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,i,n,s){const o=s==="reset",r=this.chart,l=r.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,f=c.getIndexAngle(0)-.5*ct;let g=f,_;const b=360/this.countVisibleElements();for(_=0;_<i;++_)g+=this._computeAngle(_,s,b);for(_=i;_<i+n;_++){const v=t[_];let y=g,E=g+this._computeAngle(_,s,b),w=r.getDataVisibility(_)?c.getDistanceFromCenterForValue(this.getParsed(_).r):0;g=E,o&&(l.animateScale&&(w=0),l.animateRotate&&(y=E=f));const P={x:u,y:h,innerRadius:0,outerRadius:w,startAngle:y,endAngle:E,options:this.resolveDataElementOptions(_,v.active?"active":s)};this.updateElement(v,_,P,s)}}countVisibleElements(){const t=this._cachedMeta;let i=0;return t.data.forEach((n,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&i++}),i}_computeAngle(t,i,n){return this.chart.getDataVisibility(t)?di(this.resolveDataElementOptions(t,i).angle||n):0}}M(Ms,"id","polarArea"),M(Ms,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),M(Ms,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const i=t.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:n,color:s}}=t.legend.options;return i.labels.map((o,r)=>{const l=t.getDatasetMeta(0).controller.getStyle(r);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(r),index:r}})}return[]}},onClick(t,i,n){n.chart.toggleDataVisibility(i.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class el extends En{}M(el,"id","pie"),M(el,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Lo extends gi{getLabelAndValue(t){const i=this._cachedMeta.vScale,n=this.getParsed(t);return{label:i.getLabels()[t],value:""+i.getLabelForValue(n[i.axis])}}parseObjectData(t,i,n,s){return Hf.bind(this)(t,i,n,s)}update(t){const i=this._cachedMeta,n=i.dataset,s=i.data||[],o=i.iScale.getLabels();if(n.points=s,t!=="resize"){const r=this.resolveDatasetElementOptions(t);this.options.showLine||(r.borderWidth=0);const a={_loop:!0,_fullLoop:o.length===s.length,options:r};this.updateElement(n,void 0,a,t)}this.updateElements(s,0,s.length,t)}updateElements(t,i,n,s){const o=this._cachedMeta.rScale,r=s==="reset";for(let a=i;a<i+n;a++){const l=t[a],c=this.resolveDataElementOptions(a,l.active?"active":s),u=o.getPointPositionForValue(a,this.getParsed(a).r),h=r?o.xCenter:u.x,f=r?o.yCenter:u.y,g={x:h,y:f,angle:u.angle,skip:isNaN(h)||isNaN(f),options:c};this.updateElement(l,a,g,s)}}}M(Lo,"id","radar"),M(Lo,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),M(Lo,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Bo extends gi{getLabelAndValue(t){const i=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:o}=i,r=this.getParsed(t),a=s.getLabelForValue(r.x),l=o.getLabelForValue(r.y);return{label:n[t]||"",value:"("+a+", "+l+")"}}update(t){const i=this._cachedMeta,{data:n=[]}=i,s=this.chart._animationsDisabled;let{start:o,count:r}=Mf(i,n,s);if(this._drawStart=o,this._drawCount=r,Tf(i)&&(o=0,r=n.length),this.options.showLine){const{dataset:a,_dataset:l}=i;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=n;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:c},t)}this.updateElements(n,o,r,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,i,n,s){const o=s==="reset",{iScale:r,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(i,s),h=this.getSharedOptions(u),f=this.includeOptions(s,h),g=r.axis,_=a.axis,{spanGaps:b,segment:v}=this.options,y=Qn(b)?b:Number.POSITIVE_INFINITY,E=this.chart._animationsDisabled||o||s==="none";let w=i>0&&this.getParsed(i-1);for(let P=i;P<i+n;++P){const A=t[P],O=this.getParsed(P),U=E?A:{},z=Ue(O[_]),te=U[g]=r.getPixelForValue(O[g],P),G=U[_]=o||z?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,O,l):O[_],P);U.skip=isNaN(te)||isNaN(G)||z,U.stop=P>0&&Math.abs(O[g]-w[g])>y,v&&(U.parsed=O,U.raw=c.data[P]),f&&(U.options=h||this.resolveDataElementOptions(P,A.active?"active":s)),E||this.updateElement(A,P,U,s),w=O}this.updateSharedOptions(h,s,u)}getMaxOverflow(){const t=this._cachedMeta,i=t.data||[];if(!this.options.showLine){let a=0;for(let l=i.length-1;l>=0;--l)a=Math.max(a,i[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const n=t.dataset,s=n.options&&n.options.borderWidth||0;if(!i.length)return s;const o=i[0].size(this.resolveDataElementOptions(0)),r=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,o,r)/2}}M(Bo,"id","scatter"),M(Bo,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),M(Bo,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var dE=Object.freeze({__proto__:null,BarController:Ro,BubbleController:Oo,DoughnutController:En,LineController:No,PolarAreaController:Ms,PieController:el,RadarController:Lo,ScatterController:Bo});function fn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class tc{static override(t){Object.assign(tc.prototype,t)}constructor(t){this.options=t||{}}init(){}formats(){return fn()}parse(){return fn()}format(){return fn()}add(){return fn()}diff(){return fn()}startOf(){return fn()}endOf(){return fn()}}var fE={_date:tc};function pE(e,t,i,n){const{controller:s,data:o,_sorted:r}=e,a=s._cachedMeta.iScale;if(a&&t===a.axis&&t!=="r"&&r&&o.length){const l=a._reversePixels?DS:Hi;if(n){if(s._sharedOptions){const c=o[0],u=typeof c.getRange=="function"&&c.getRange(t);if(u){const h=l(o,t,i-u),f=l(o,t,i+u);return{lo:h.lo,hi:f.hi}}}}else return l(o,t,i)}return{lo:0,hi:o.length-1}}function eo(e,t,i,n,s){const o=e.getSortedVisibleDatasetMetas(),r=i[t];for(let a=0,l=o.length;a<l;++a){const{index:c,data:u}=o[a],{lo:h,hi:f}=pE(o[a],t,r,s);for(let g=h;g<=f;++g){const _=u[g];_.skip||n(_,c,g)}}}function gE(e){const t=e.indexOf("x")!==-1,i=e.indexOf("y")!==-1;return function(n,s){const o=t?Math.abs(n.x-s.x):0,r=i?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(r,2))}}function ba(e,t,i,n,s){const o=[];return!s&&!e.isPointInArea(t)||eo(e,i,t,function(a,l,c){!s&&!Ws(a,e.chartArea,0)||a.inRange(t.x,t.y,n)&&o.push({element:a,datasetIndex:l,index:c})},!0),o}function mE(e,t,i,n){let s=[];function o(r,a,l){const{startAngle:c,endAngle:u}=r.getProps(["startAngle","endAngle"],n),{angle:h}=If(r,{x:t.x,y:t.y});zs(h,c,u)&&s.push({element:r,datasetIndex:a,index:l})}return eo(e,i,t,o),s}function bE(e,t,i,n,s,o){let r=[];const a=gE(i);let l=Number.POSITIVE_INFINITY;function c(u,h,f){const g=u.inRange(t.x,t.y,s);if(n&&!g)return;const _=u.getCenterPoint(s);if(!(!!o||e.isPointInArea(_))&&!g)return;const v=a(t,_);v<l?(r=[{element:u,datasetIndex:h,index:f}],l=v):v===l&&r.push({element:u,datasetIndex:h,index:f})}return eo(e,i,t,c),r}function _a(e,t,i,n,s,o){return!o&&!e.isPointInArea(t)?[]:i==="r"&&!n?mE(e,t,i,s):bE(e,t,i,n,s,o)}function eh(e,t,i,n,s){const o=[],r=i==="x"?"inXRange":"inYRange";let a=!1;return eo(e,i,t,(l,c,u)=>{l[r](t[i],s)&&(o.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(t.x,t.y,s))}),n&&!a?[]:o}var _E={evaluateInteractionItems:eo,modes:{index(e,t,i,n){const s=bn(t,e),o=i.axis||"x",r=i.includeInvisible||!1,a=i.intersect?ba(e,s,o,n,r):_a(e,s,o,!1,n,r),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(e,t,i,n){const s=bn(t,e),o=i.axis||"xy",r=i.includeInvisible||!1;let a=i.intersect?ba(e,s,o,n,r):_a(e,s,o,!1,n,r);if(a.length>0){const l=a[0].datasetIndex,c=e.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(e,t,i,n){const s=bn(t,e),o=i.axis||"xy",r=i.includeInvisible||!1;return ba(e,s,o,n,r)},nearest(e,t,i,n){const s=bn(t,e),o=i.axis||"xy",r=i.includeInvisible||!1;return _a(e,s,o,i.intersect,n,r)},x(e,t,i,n){const s=bn(t,e);return eh(e,s,"x",i.intersect,n)},y(e,t,i,n){const s=bn(t,e);return eh(e,s,"y",i.intersect,n)}}};const Jf=["left","top","right","bottom"];function as(e,t){return e.filter(i=>i.pos===t)}function th(e,t){return e.filter(i=>Jf.indexOf(i.pos)===-1&&i.box.axis===t)}function ls(e,t){return e.sort((i,n)=>{const s=t?n:i,o=t?i:n;return s.weight===o.weight?s.index-o.index:s.weight-o.weight})}function yE(e){const t=[];let i,n,s,o,r,a;for(i=0,n=(e||[]).length;i<n;++i)s=e[i],{position:o,options:{stack:r,stackWeight:a=1}}=s,t.push({index:i,box:s,pos:o,horizontal:s.isHorizontal(),weight:s.weight,stack:r&&o+r,stackWeight:a});return t}function vE(e){const t={};for(const i of e){const{stack:n,pos:s,stackWeight:o}=i;if(!n||!Jf.includes(s))continue;const r=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});r.count++,r.weight+=o}return t}function SE(e,t){const i=vE(e),{vBoxMaxWidth:n,hBoxMaxHeight:s}=t;let o,r,a;for(o=0,r=e.length;o<r;++o){a=e[o];const{fullSize:l}=a.box,c=i[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*n:l&&t.availableWidth,a.height=s):(a.width=n,a.height=u?u*s:l&&t.availableHeight)}return i}function wE(e){const t=yE(e),i=ls(t.filter(c=>c.box.fullSize),!0),n=ls(as(t,"left"),!0),s=ls(as(t,"right")),o=ls(as(t,"top"),!0),r=ls(as(t,"bottom")),a=th(t,"x"),l=th(t,"y");return{fullSize:i,leftAndTop:n.concat(o),rightAndBottom:s.concat(l).concat(r).concat(a),chartArea:as(t,"chartArea"),vertical:n.concat(s).concat(l),horizontal:o.concat(r).concat(a)}}function ih(e,t,i,n){return Math.max(e[i],t[i])+Math.max(e[n],t[n])}function Qf(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function EE(e,t,i,n){const{pos:s,box:o}=i,r=e.maxPadding;if(!Ne(s)){i.size&&(e[s]-=i.size);const h=n[i.stack]||{size:0,count:1};h.size=Math.max(h.size,i.horizontal?o.height:o.width),i.size=h.size/h.count,e[s]+=i.size}o.getPadding&&Qf(r,o.getPadding());const a=Math.max(0,t.outerWidth-ih(r,e,"left","right")),l=Math.max(0,t.outerHeight-ih(r,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,i.horizontal?{same:c,other:u}:{same:u,other:c}}function kE(e){const t=e.maxPadding;function i(n){const s=Math.max(t[n]-e[n],0);return e[n]+=s,s}e.y+=i("top"),e.x+=i("left"),i("right"),i("bottom")}function IE(e,t){const i=t.maxPadding;function n(s){const o={left:0,top:0,right:0,bottom:0};return s.forEach(r=>{o[r]=Math.max(t[r],i[r])}),o}return n(e?["left","right"]:["top","bottom"])}function bs(e,t,i,n){const s=[];let o,r,a,l,c,u;for(o=0,r=e.length,c=0;o<r;++o){a=e[o],l=a.box,l.update(a.width||t.w,a.height||t.h,IE(a.horizontal,t));const{same:h,other:f}=EE(t,i,a,n);c|=h&&s.length,u=u||f,l.fullSize||s.push(a)}return c&&bs(s,t,i,n)||u}function bo(e,t,i,n,s){e.top=i,e.left=t,e.right=t+n,e.bottom=i+s,e.width=n,e.height=s}function nh(e,t,i,n){const s=i.padding;let{x:o,y:r}=t;for(const a of e){const l=a.box,c=n[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const h=t.w*u,f=c.size||l.height;li(c.start)&&(r=c.start),l.fullSize?bo(l,s.left,r,i.outerWidth-s.right-s.left,f):bo(l,t.left+c.placed,r,h,f),c.start=r,c.placed+=h,r=l.bottom}else{const h=t.h*u,f=c.size||l.width;li(c.start)&&(o=c.start),l.fullSize?bo(l,o,s.top,f,i.outerHeight-s.bottom-s.top):bo(l,o,t.top+c.placed,f,h),c.start=o,c.placed+=h,o=l.right}}t.x=o,t.y=r}var Nt={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(i){t.draw(i)}}]},e.boxes.push(t)},removeBox(e,t){const i=e.boxes?e.boxes.indexOf(t):-1;i!==-1&&e.boxes.splice(i,1)},configure(e,t,i){t.fullSize=i.fullSize,t.position=i.position,t.weight=i.weight},update(e,t,i,n){if(!e)return;const s=Lt(e.options.layout.padding),o=Math.max(t-s.width,0),r=Math.max(i-s.height,0),a=wE(e.boxes),l=a.vertical,c=a.horizontal;qe(e.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const u=l.reduce((b,v)=>v.box.options&&v.box.options.display===!1?b:b+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:i,padding:s,availableWidth:o,availableHeight:r,vBoxMaxWidth:o/2/u,hBoxMaxHeight:r/2}),f=Object.assign({},s);Qf(f,Lt(n));const g=Object.assign({maxPadding:f,w:o,h:r,x:s.left,y:s.top},s),_=SE(l.concat(c),h);bs(a.fullSize,g,h,_),bs(l,g,h,_),bs(c,g,h,_)&&bs(l,g,h,_),kE(g),nh(a.leftAndTop,g,h,_),g.x+=g.w,g.y+=g.h,nh(a.rightAndBottom,g,h,_),e.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},qe(a.chartArea,b=>{const v=b.box;Object.assign(v,e.chartArea),v.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class Zf{acquireContext(t,i){}releaseContext(t){return!1}addEventListener(t,i,n){}removeEventListener(t,i,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,i,n,s){return i=Math.max(0,i||t.width),n=n||t.height,{width:i,height:Math.max(0,s?Math.floor(i/s):n)}}isAttached(t){return!0}updateConfig(t){}}class PE extends Zf{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Do="$chartjs",AE={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},sh=e=>e===null||e==="";function CE(e,t){const i=e.style,n=e.getAttribute("height"),s=e.getAttribute("width");if(e[Do]={initial:{height:n,width:s,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",sh(s)){const o=Hu(e,"width");o!==void 0&&(e.width=o)}if(sh(n))if(e.style.height==="")e.height=e.width/(t||2);else{const o=Hu(e,"height");o!==void 0&&(e.height=o)}return e}const ep=Mw?{passive:!0}:!1;function xE(e,t,i){e.addEventListener(t,i,ep)}function ME(e,t,i){e.canvas.removeEventListener(t,i,ep)}function TE(e,t){const i=AE[e.type]||e.type,{x:n,y:s}=bn(e,t);return{type:i,chart:t,native:e,x:n!==void 0?n:null,y:s!==void 0?s:null}}function gr(e,t){for(const i of e)if(i===t||i.contains(t))return!0}function RE(e,t,i){const n=e.canvas,s=new MutationObserver(o=>{let r=!1;for(const a of o)r=r||gr(a.addedNodes,n),r=r&&!gr(a.removedNodes,n);r&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}function OE(e,t,i){const n=e.canvas,s=new MutationObserver(o=>{let r=!1;for(const a of o)r=r||gr(a.removedNodes,n),r=r&&!gr(a.addedNodes,n);r&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}const Vs=new Map;let oh=0;function tp(){const e=window.devicePixelRatio;e!==oh&&(oh=e,Vs.forEach((t,i)=>{i.currentDevicePixelRatio!==e&&t()}))}function NE(e,t){Vs.size||window.addEventListener("resize",tp),Vs.set(e,t)}function LE(e){Vs.delete(e),Vs.size||window.removeEventListener("resize",tp)}function BE(e,t,i){const n=e.canvas,s=n&&ec(n);if(!s)return;const o=xf((a,l)=>{const c=s.clientWidth;i(a,l),c<s.clientWidth&&i()},window),r=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||o(c,u)});return r.observe(s),NE(e,o),r}function ya(e,t,i){i&&i.disconnect(),t==="resize"&&LE(e)}function DE(e,t,i){const n=e.canvas,s=xf(o=>{e.ctx!==null&&i(TE(o,e))},e);return xE(n,t,s),s}class FE extends Zf{acquireContext(t,i){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(CE(t,i),n):null}releaseContext(t){const i=t.canvas;if(!i[Do])return!1;const n=i[Do].initial;["height","width"].forEach(o=>{const r=n[o];Ue(r)?i.removeAttribute(o):i.setAttribute(o,r)});const s=n.style||{};return Object.keys(s).forEach(o=>{i.style[o]=s[o]}),i.width=i.width,delete i[Do],!0}addEventListener(t,i,n){this.removeEventListener(t,i);const s=t.$proxies||(t.$proxies={}),r={attach:RE,detach:OE,resize:BE}[i]||DE;s[i]=r(t,i,n)}removeEventListener(t,i){const n=t.$proxies||(t.$proxies={}),s=n[i];if(!s)return;({attach:ya,detach:ya,resize:ya}[i]||ME)(t,i,s),n[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,i,n,s){return xw(t,i,n,s)}isAttached(t){const i=ec(t);return!!(i&&i.isConnected)}}function $E(e){return!zf()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?PE:FE}var ko;let Gi=(ko=class{constructor(){M(this,"active",!1)}tooltipPosition(t){const{x:i,y:n}=this.getProps(["x","y"],t);return{x:i,y:n}}hasValue(){return Qn(this.x)&&Qn(this.y)}getProps(t,i){const n=this.$animations;if(!i||!n)return this;const s={};return t.forEach(o=>{s[o]=n[o]&&n[o].active()?n[o]._to:this[o]}),s}},M(ko,"defaults",{}),M(ko,"defaultRoutes"),ko);function HE(e,t){const i=e.options.ticks,n=UE(e),s=Math.min(i.maxTicksLimit||n,n),o=i.major.enabled?WE(t):[],r=o.length,a=o[0],l=o[r-1],c=[];if(r>s)return GE(t,c,o,r/s),c;const u=zE(o,t,s);if(r>0){let h,f;const g=r>1?Math.round((l-a)/(r-1)):null;for(_o(t,c,u,Ue(g)?0:a-g,a),h=0,f=r-1;h<f;h++)_o(t,c,u,o[h],o[h+1]);return _o(t,c,u,l,Ue(g)?t.length:l+g),c}return _o(t,c,u),c}function UE(e){const t=e.options.offset,i=e._tickSize(),n=e._length/i+(t?0:1),s=e._maxLength/i;return Math.floor(Math.min(n,s))}function zE(e,t,i){const n=VE(e),s=t.length/i;if(!n)return Math.max(s,1);const o=OS(n);for(let r=0,a=o.length-1;r<a;r++){const l=o[r];if(l>s)return l}return Math.max(s,1)}function WE(e){const t=[];let i,n;for(i=0,n=e.length;i<n;i++)e[i].major&&t.push(i);return t}function GE(e,t,i,n){let s=0,o=i[0],r;for(n=Math.ceil(n),r=0;r<e.length;r++)r===o&&(t.push(e[r]),s++,o=i[s*n])}function _o(e,t,i,n,s){const o=Ie(n,0),r=Math.min(Ie(s,e.length),e.length);let a=0,l,c,u;for(i=Math.ceil(i),s&&(l=s-n,i=l/Math.floor(l/i)),u=o;u<0;)a++,u=Math.round(o+a*i);for(c=Math.max(o,0);c<r;c++)c===u&&(t.push(e[c]),a++,u=Math.round(o+a*i))}function VE(e){const t=e.length;let i,n;if(t<2)return!1;for(n=e[0],i=1;i<t;++i)if(e[i]-e[i-1]!==n)return!1;return n}const jE=e=>e==="left"?"right":e==="right"?"left":e,rh=(e,t,i)=>t==="top"||t==="left"?e[t]+i:e[t]-i,ah=(e,t)=>Math.min(t||e,e);function lh(e,t){const i=[],n=e.length/t,s=e.length;let o=0;for(;o<s;o+=n)i.push(e[Math.floor(o)]);return i}function KE(e,t,i){const n=e.ticks.length,s=Math.min(t,n-1),o=e._startPixel,r=e._endPixel,a=1e-6;let l=e.getPixelForTick(s),c;if(!(i&&(n===1?c=Math.max(l-o,r-l):t===0?c=(e.getPixelForTick(1)-l)/2:c=(l-e.getPixelForTick(s-1))/2,l+=s<t?c:-c,l<o-a||l>r+a)))return l}function qE(e,t){qe(e,i=>{const n=i.gc,s=n.length/2;let o;if(s>t){for(o=0;o<s;++o)delete i.data[n[o]];n.splice(0,s)}})}function cs(e){return e.drawTicks?e.tickLength:0}function ch(e,t){if(!e.display)return 0;const i=yt(e.font,t),n=Lt(e.padding);return(it(e.text)?e.text.length:1)*i.lineHeight+n.height}function YE(e,t){return an(e,{scale:t,type:"scale"})}function XE(e,t,i){return an(e,{tick:i,index:t,type:"tick"})}function JE(e,t,i){let n=Yl(e);return(i&&t!=="right"||!i&&t==="right")&&(n=jE(n)),n}function QE(e,t,i,n){const{top:s,left:o,bottom:r,right:a,chart:l}=e,{chartArea:c,scales:u}=l;let h=0,f,g,_;const b=r-s,v=a-o;if(e.isHorizontal()){if(g=xt(n,o,a),Ne(i)){const y=Object.keys(i)[0],E=i[y];_=u[y].getPixelForValue(E)+b-t}else i==="center"?_=(c.bottom+c.top)/2+b-t:_=rh(e,i,t);f=a-o}else{if(Ne(i)){const y=Object.keys(i)[0],E=i[y];g=u[y].getPixelForValue(E)-v+t}else i==="center"?g=(c.left+c.right)/2-v+t:g=rh(e,i,t);_=xt(n,r,s),h=i==="left"?-ft:ft}return{titleX:g,titleY:_,maxWidth:f,rotation:h}}class Rn extends Gi{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,i){return t}getUserBounds(){let{_userMin:t,_userMax:i,_suggestedMin:n,_suggestedMax:s}=this;return t=Yt(t,Number.POSITIVE_INFINITY),i=Yt(i,Number.NEGATIVE_INFINITY),n=Yt(n,Number.POSITIVE_INFINITY),s=Yt(s,Number.NEGATIVE_INFINITY),{min:Yt(t,n),max:Yt(i,s),minDefined:dt(t),maxDefined:dt(i)}}getMinMax(t){let{min:i,max:n,minDefined:s,maxDefined:o}=this.getUserBounds(),r;if(s&&o)return{min:i,max:n};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)r=a[l].controller.getMinMax(this,t),s||(i=Math.min(i,r.min)),o||(n=Math.max(n,r.max));return i=o&&i>n?n:i,n=s&&i>n?i:n,{min:Yt(i,Yt(n,i)),max:Yt(n,Yt(i,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ze(this.options.beforeUpdate,[this])}update(t,i,n){const{beginAtZero:s,grace:o,ticks:r}=this.options,a=r.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=i,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=aw(this,o,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?lh(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),r.display&&(r.autoSkip||r.source==="auto")&&(this.ticks=HE(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,i,n;this.isHorizontal()?(i=this.left,n=this.right):(i=this.top,n=this.bottom,t=!t),this._startPixel=i,this._endPixel=n,this._reversePixels=t,this._length=n-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ze(this.options.afterUpdate,[this])}beforeSetDimensions(){Ze(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ze(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Ze(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ze(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const i=this.options.ticks;let n,s,o;for(n=0,s=t.length;n<s;n++)o=t[n],o.label=Ze(i.callback,[o.value,n,t],this)}afterTickToLabelConversion(){Ze(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ze(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,i=t.ticks,n=ah(this.ticks.length,t.ticks.maxTicksLimit),s=i.minRotation||0,o=i.maxRotation;let r=s,a,l,c;if(!this._isVisible()||!i.display||s>=o||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const u=this._getLabelSizes(),h=u.widest.width,f=u.highest.height,g=Et(this.chart.width-h,0,this.maxWidth);a=t.offset?this.maxWidth/n:g/(n-1),h+6>a&&(a=g/(n-(t.offset?.5:1)),l=this.maxHeight-cs(t.grid)-i.padding-ch(t.title,this.chart.options.font),c=Math.sqrt(h*h+f*f),r=Kl(Math.min(Math.asin(Et((u.highest.height+6)/a,-1,1)),Math.asin(Et(l/c,-1,1))-Math.asin(Et(f/c,-1,1)))),r=Math.max(s,Math.min(o,r))),this.labelRotation=r}afterCalculateLabelRotation(){Ze(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ze(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:i,options:{ticks:n,title:s,grid:o}}=this,r=this._isVisible(),a=this.isHorizontal();if(r){const l=ch(s,i.options.font);if(a?(t.width=this.maxWidth,t.height=cs(o)+l):(t.height=this.maxHeight,t.width=cs(o)+l),n.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:f}=this._getLabelSizes(),g=n.padding*2,_=di(this.labelRotation),b=Math.cos(_),v=Math.sin(_);if(a){const y=n.mirror?0:v*h.width+b*f.height;t.height=Math.min(this.maxHeight,t.height+y+g)}else{const y=n.mirror?0:b*h.width+v*f.height;t.width=Math.min(this.maxWidth,t.width+y+g)}this._calculatePadding(c,u,v,b)}}this._handleMargins(),a?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,i,n,s){const{ticks:{align:o,padding:r},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,g=0;l?c?(f=s*t.width,g=n*i.height):(f=n*t.height,g=s*i.width):o==="start"?g=i.width:o==="end"?f=t.width:o!=="inner"&&(f=t.width/2,g=i.width/2),this.paddingLeft=Math.max((f-u+r)*this.width/(this.width-u),0),this.paddingRight=Math.max((g-h+r)*this.width/(this.width-h),0)}else{let u=i.height/2,h=t.height/2;o==="start"?(u=0,h=t.height):o==="end"&&(u=i.height,h=0),this.paddingTop=u+r,this.paddingBottom=h+r}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ze(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:i}=this.options;return i==="top"||i==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let i,n;for(i=0,n=t.length;i<n;i++)Ue(t[i].label)&&(t.splice(i,1),n--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const i=this.options.ticks.sampleSize;let n=this.ticks;i<n.length&&(n=lh(n,i)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,i,n){const{ctx:s,_longestTextCache:o}=this,r=[],a=[],l=Math.floor(i/ah(i,n));let c=0,u=0,h,f,g,_,b,v,y,E,w,P,A;for(h=0;h<i;h+=l){if(_=t[h].label,b=this._resolveTickFontOptions(h),s.font=v=b.string,y=o[v]=o[v]||{data:{},gc:[]},E=b.lineHeight,w=P=0,!Ue(_)&&!it(_))w=fr(s,y.data,y.gc,w,_),P=E;else if(it(_))for(f=0,g=_.length;f<g;++f)A=_[f],!Ue(A)&&!it(A)&&(w=fr(s,y.data,y.gc,w,A),P+=E);r.push(w),a.push(P),c=Math.max(w,c),u=Math.max(P,u)}qE(o,i);const O=r.indexOf(c),U=a.indexOf(u),z=te=>({width:r[te]||0,height:a[te]||0});return{first:z(0),last:z(i-1),widest:z(O),highest:z(U),widths:r,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,i){return NaN}getValueForPixel(t){}getPixelForTick(t){const i=this.ticks;return t<0||t>i.length-1?null:this.getPixelForValue(i[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const i=this._startPixel+t*this._length;return BS(this._alignToPixels?dn(this.chart,i,0):i)}getDecimalForPixel(t){const i=(t-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:i}=this;return t<0&&i<0?i:t>0&&i>0?t:0}getContext(t){const i=this.ticks||[];if(t>=0&&t<i.length){const n=i[t];return n.$context||(n.$context=XE(this.getContext(),t,n))}return this.$context||(this.$context=YE(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,i=di(this.labelRotation),n=Math.abs(Math.cos(i)),s=Math.abs(Math.sin(i)),o=this._getLabelSizes(),r=t.autoSkipPadding||0,a=o?o.widest.width+r:0,l=o?o.highest.height+r:0;return this.isHorizontal()?l*n>a*s?a/n:l/s:l*s<a*n?l/n:a/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const i=this.axis,n=this.chart,s=this.options,{grid:o,position:r,border:a}=s,l=o.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=cs(o),g=[],_=a.setContext(this.getContext()),b=_.display?_.width:0,v=b/2,y=function(we){return dn(n,we,b)};let E,w,P,A,O,U,z,te,G,Q,Se,ae;if(r==="top")E=y(this.bottom),U=this.bottom-f,te=E-v,Q=y(t.top)+v,ae=t.bottom;else if(r==="bottom")E=y(this.top),Q=t.top,ae=y(t.bottom)-v,U=E+v,te=this.top+f;else if(r==="left")E=y(this.right),O=this.right-f,z=E-v,G=y(t.left)+v,Se=t.right;else if(r==="right")E=y(this.left),G=t.left,Se=y(t.right)-v,O=E+v,z=this.left+f;else if(i==="x"){if(r==="center")E=y((t.top+t.bottom)/2+.5);else if(Ne(r)){const we=Object.keys(r)[0],ee=r[we];E=y(this.chart.scales[we].getPixelForValue(ee))}Q=t.top,ae=t.bottom,U=E+v,te=U+f}else if(i==="y"){if(r==="center")E=y((t.left+t.right)/2);else if(Ne(r)){const we=Object.keys(r)[0],ee=r[we];E=y(this.chart.scales[we].getPixelForValue(ee))}O=E-v,z=O-f,G=t.left,Se=t.right}const Re=Ie(s.ticks.maxTicksLimit,h),Ee=Math.max(1,Math.ceil(h/Re));for(w=0;w<h;w+=Ee){const we=this.getContext(w),ee=o.setContext(we),ne=a.setContext(we),ie=ee.lineWidth,Le=ee.color,ke=ne.dash||[],ge=ne.dashOffset,ut=ee.tickWidth,ht=ee.tickColor,St=ee.tickBorderDash||[],Xe=ee.tickBorderDashOffset;P=KE(this,w,l),P!==void 0&&(A=dn(n,P,ie),c?O=z=G=Se=A:U=te=Q=ae=A,g.push({tx1:O,ty1:U,tx2:z,ty2:te,x1:G,y1:Q,x2:Se,y2:ae,width:ie,color:Le,borderDash:ke,borderDashOffset:ge,tickWidth:ut,tickColor:ht,tickBorderDash:St,tickBorderDashOffset:Xe}))}return this._ticksLength=h,this._borderValue=E,g}_computeLabelItems(t){const i=this.axis,n=this.options,{position:s,ticks:o}=n,r=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=o,f=cs(n.grid),g=f+u,_=h?-u:g,b=-di(this.labelRotation),v=[];let y,E,w,P,A,O,U,z,te,G,Q,Se,ae="middle";if(s==="top")O=this.bottom-_,U=this._getXAxisLabelAlignment();else if(s==="bottom")O=this.top+_,U=this._getXAxisLabelAlignment();else if(s==="left"){const Ee=this._getYAxisLabelAlignment(f);U=Ee.textAlign,A=Ee.x}else if(s==="right"){const Ee=this._getYAxisLabelAlignment(f);U=Ee.textAlign,A=Ee.x}else if(i==="x"){if(s==="center")O=(t.top+t.bottom)/2+g;else if(Ne(s)){const Ee=Object.keys(s)[0],we=s[Ee];O=this.chart.scales[Ee].getPixelForValue(we)+g}U=this._getXAxisLabelAlignment()}else if(i==="y"){if(s==="center")A=(t.left+t.right)/2-g;else if(Ne(s)){const Ee=Object.keys(s)[0],we=s[Ee];A=this.chart.scales[Ee].getPixelForValue(we)}U=this._getYAxisLabelAlignment(f).textAlign}i==="y"&&(l==="start"?ae="top":l==="end"&&(ae="bottom"));const Re=this._getLabelSizes();for(y=0,E=a.length;y<E;++y){w=a[y],P=w.label;const Ee=o.setContext(this.getContext(y));z=this.getPixelForTick(y)+o.labelOffset,te=this._resolveTickFontOptions(y),G=te.lineHeight,Q=it(P)?P.length:1;const we=Q/2,ee=Ee.color,ne=Ee.textStrokeColor,ie=Ee.textStrokeWidth;let Le=U;r?(A=z,U==="inner"&&(y===E-1?Le=this.options.reverse?"left":"right":y===0?Le=this.options.reverse?"right":"left":Le="center"),s==="top"?c==="near"||b!==0?Se=-Q*G+G/2:c==="center"?Se=-Re.highest.height/2-we*G+G:Se=-Re.highest.height+G/2:c==="near"||b!==0?Se=G/2:c==="center"?Se=Re.highest.height/2-we*G:Se=Re.highest.height-Q*G,h&&(Se*=-1),b!==0&&!Ee.showLabelBackdrop&&(A+=G/2*Math.sin(b))):(O=z,Se=(1-Q)*G/2);let ke;if(Ee.showLabelBackdrop){const ge=Lt(Ee.backdropPadding),ut=Re.heights[y],ht=Re.widths[y];let St=Se-ge.top,Xe=0-ge.left;switch(ae){case"middle":St-=ut/2;break;case"bottom":St-=ut;break}switch(U){case"center":Xe-=ht/2;break;case"right":Xe-=ht;break}ke={left:Xe,top:St,width:ht+ge.width,height:ut+ge.height,color:Ee.backdropColor}}v.push({label:P,font:te,textOffset:Se,options:{rotation:b,color:ee,strokeColor:ne,strokeWidth:ie,textAlign:Le,textBaseline:ae,translation:[A,O],backdrop:ke}})}return v}_getXAxisLabelAlignment(){const{position:t,ticks:i}=this.options;if(-di(this.labelRotation))return t==="top"?"left":"right";let s="center";return i.align==="start"?s="left":i.align==="end"?s="right":i.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:i,ticks:{crossAlign:n,mirror:s,padding:o}}=this.options,r=this._getLabelSizes(),a=t+o,l=r.widest.width;let c,u;return i==="left"?s?(u=this.right+o,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u=this.left)):i==="right"?s?(u=this.left+o,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:i},left:n,top:s,width:o,height:r}=this;i&&(t.save(),t.fillStyle=i,t.fillRect(n,s,o,r),t.restore())}getLineWidthForValue(t){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const s=this.ticks.findIndex(o=>o.value===t);return s>=0?i.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const i=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let o,r;const a=(l,c,u)=>{!u.width||!u.color||(n.save(),n.lineWidth=u.width,n.strokeStyle=u.color,n.setLineDash(u.borderDash||[]),n.lineDashOffset=u.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(i.display)for(o=0,r=s.length;o<r;++o){const l=s[o];i.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),i.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:i,options:{border:n,grid:s}}=this,o=n.setContext(this.getContext()),r=n.display?o.width:0;if(!r)return;const a=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,h,f;this.isHorizontal()?(c=dn(t,this.left,r)-r/2,u=dn(t,this.right,a)+a/2,h=f=l):(h=dn(t,this.top,r)-r/2,f=dn(t,this.bottom,a)+a/2,c=u=l),i.save(),i.lineWidth=o.width,i.strokeStyle=o.color,i.beginPath(),i.moveTo(c,h),i.lineTo(u,f),i.stroke(),i.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&Or(n,s);const o=this.getLabelItems(t);for(const r of o){const a=r.options,l=r.font,c=r.label,u=r.textOffset;Tn(n,c,0,u,l,a)}s&&Nr(n)}drawTitle(){const{ctx:t,options:{position:i,title:n,reverse:s}}=this;if(!n.display)return;const o=yt(n.font),r=Lt(n.padding),a=n.align;let l=o.lineHeight/2;i==="bottom"||i==="center"||Ne(i)?(l+=r.bottom,it(n.text)&&(l+=o.lineHeight*(n.text.length-1))):l+=r.top;const{titleX:c,titleY:u,maxWidth:h,rotation:f}=QE(this,l,i,a);Tn(t,n.text,0,0,o,{color:n.color,maxWidth:h,rotation:f,textAlign:JE(a,i,s),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,i=t.ticks&&t.ticks.z||0,n=Ie(t.grid&&t.grid.z,-1),s=Ie(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Rn.prototype.draw?[{z:i,draw:o=>{this.draw(o)}}]:[{z:n,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:i,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(t){const i=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let o,r;for(o=0,r=i.length;o<r;++o){const a=i[o];a[n]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){const i=this.options.ticks.setContext(this.getContext(t));return yt(i.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class yo{constructor(t,i,n){this.type=t,this.scope=i,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const i=Object.getPrototypeOf(t);let n;t8(i)&&(n=this.register(i));const s=this.items,o=t.id,r=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in s||(s[o]=t,ZE(t,r,n),this.override&&pt.override(t.id,t.overrides)),r}get(t){return this.items[t]}unregister(t){const i=this.items,n=t.id,s=this.scope;n in i&&delete i[n],s&&n in pt[s]&&(delete pt[s][n],this.override&&delete Mn[n])}}function ZE(e,t,i){const n=Us(Object.create(null),[i?pt.get(i):{},pt.get(t),e.defaults]);pt.set(t,n),e.defaultRoutes&&e8(t,e.defaultRoutes),e.descriptors&&pt.describe(t,e.descriptors)}function e8(e,t){Object.keys(t).forEach(i=>{const n=i.split("."),s=n.pop(),o=[e].concat(n).join("."),r=t[i].split("."),a=r.pop(),l=r.join(".");pt.route(o,s,l,a)})}function t8(e){return"id"in e&&"defaults"in e}class i8{constructor(){this.controllers=new yo(gi,"datasets",!0),this.elements=new yo(Gi,"elements"),this.plugins=new yo(Object,"plugins"),this.scales=new yo(Rn,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,i,n){[...i].forEach(s=>{const o=n||this._getRegistryForType(s);n||o.isForType(s)||o===this.plugins&&s.id?this._exec(t,o,s):qe(s,r=>{const a=n||this._getRegistryForType(r);this._exec(t,a,r)})})}_exec(t,i,n){const s=jl(t);Ze(n["before"+s],[],n),i[t](n),Ze(n["after"+s],[],n)}_getRegistryForType(t){for(let i=0;i<this._typedRegistries.length;i++){const n=this._typedRegistries[i];if(n.isForType(t))return n}return this.plugins}_get(t,i,n){const s=i.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return s}}var vi=new i8;class n8{constructor(){this._init=[]}notify(t,i,n,s){i==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const o=s?this._descriptors(t).filter(s):this._descriptors(t),r=this._notify(o,t,i,n);return i==="afterDestroy"&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall")),r}_notify(t,i,n,s){s=s||{};for(const o of t){const r=o.plugin,a=r[n],l=[i,s,o.options];if(Ze(a,l,r)===!1&&s.cancelable)return!1}return!0}invalidate(){Ue(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const i=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),i}_createDescriptors(t,i){const n=t&&t.config,s=Ie(n.options&&n.options.plugins,{}),o=s8(n);return s===!1&&!i?[]:r8(t,o,s,i)}_notifyStateChanges(t){const i=this._oldCache||[],n=this._cache,s=(o,r)=>o.filter(a=>!r.some(l=>a.plugin.id===l.plugin.id));this._notify(s(i,n),t,"stop"),this._notify(s(n,i),t,"start")}}function s8(e){const t={},i=[],n=Object.keys(vi.plugins.items);for(let o=0;o<n.length;o++)i.push(vi.getPlugin(n[o]));const s=e.plugins||[];for(let o=0;o<s.length;o++){const r=s[o];i.indexOf(r)===-1&&(i.push(r),t[r.id]=!0)}return{plugins:i,localIds:t}}function o8(e,t){return!t&&e===!1?null:e===!0?{}:e}function r8(e,{plugins:t,localIds:i},n,s){const o=[],r=e.getContext();for(const a of t){const l=a.id,c=o8(n[l],s);c!==null&&o.push({plugin:a,options:a8(e.config,{plugin:a,local:i[l]},c,r)})}return o}function a8(e,{plugin:t,local:i},n,s){const o=e.pluginScopeKeys(t),r=e.getOptionScopes(n,o);return i&&t.defaults&&r.push(t.defaults),e.createResolver(r,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function tl(e,t){const i=pt.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||i.indexAxis||"x"}function l8(e,t){let i=e;return e==="_index_"?i=t:e==="_value_"&&(i=t==="x"?"y":"x"),i}function c8(e,t){return e===t?"_index_":"_value_"}function u8(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function mr(e,t){if(e==="x"||e==="y"||e==="r"||(e=t.axis||u8(t.position)||e.length>1&&mr(e[0].toLowerCase(),t),e))return e;throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`)}function h8(e,t){const i=Mn[e.type]||{scales:{}},n=t.scales||{},s=tl(e.type,t),o=Object.create(null);return Object.keys(n).forEach(r=>{const a=n[r];if(!Ne(a))return console.error(`Invalid scale configuration for scale: ${r}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${r}`);const l=mr(r,a),c=c8(l,s),u=i.scales||{};o[r]=Ps(Object.create(null),[{axis:l},a,u[l],u[c]])}),e.data.datasets.forEach(r=>{const a=r.type||e.type,l=r.indexAxis||tl(a,t),u=(Mn[a]||{}).scales||{};Object.keys(u).forEach(h=>{const f=l8(h,l),g=r[f+"AxisID"]||f;o[g]=o[g]||Object.create(null),Ps(o[g],[{axis:f},n[g],u[h]])})}),Object.keys(o).forEach(r=>{const a=o[r];Ps(a,[pt.scales[a.type],pt.scale])}),o}function ip(e){const t=e.options||(e.options={});t.plugins=Ie(t.plugins,{}),t.scales=h8(e,t)}function np(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function d8(e){return e=e||{},e.data=np(e.data),ip(e),e}const uh=new Map,sp=new Set;function vo(e,t){let i=uh.get(e);return i||(i=t(),uh.set(e,i),sp.add(i)),i}const us=(e,t,i)=>{const n=nn(t,i);n!==void 0&&e.add(n)};class f8{constructor(t){this._config=d8(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=np(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),ip(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return vo(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,i){return vo(`${t}.transition.${i}`,()=>[[`datasets.${t}.transitions.${i}`,`transitions.${i}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,i){return vo(`${t}-${i}`,()=>[[`datasets.${t}.elements.${i}`,`datasets.${t}`,`elements.${i}`,""]])}pluginScopeKeys(t){const i=t.id,n=this.type;return vo(`${n}-plugin-${i}`,()=>[[`plugins.${i}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,i){const n=this._scopeCache;let s=n.get(t);return(!s||i)&&(s=new Map,n.set(t,s)),s}getOptionScopes(t,i,n){const{options:s,type:o}=this,r=this._cachedScopes(t,n),a=r.get(i);if(a)return a;const l=new Set;i.forEach(u=>{t&&(l.add(t),u.forEach(h=>us(l,t,h))),u.forEach(h=>us(l,s,h)),u.forEach(h=>us(l,Mn[o]||{},h)),u.forEach(h=>us(l,pt,h)),u.forEach(h=>us(l,Qa,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),sp.has(i)&&r.set(i,c),c}chartOptionScopes(){const{options:t,type:i}=this;return[t,Mn[i]||{},pt.datasets[i]||{},{type:i},pt,Qa]}resolveNamedOptions(t,i,n,s=[""]){const o={$shared:!0},{resolver:r,subPrefixes:a}=hh(this._resolverCache,t,s);let l=r;if(g8(r,i)){o.$shared=!1,n=sn(n)?n():n;const c=this.createResolver(t,n,a);l=Zn(r,n,c)}for(const c of i)o[c]=l[c];return o}createResolver(t,i,n=[""],s){const{resolver:o}=hh(this._resolverCache,t,n);return Ne(i)?Zn(o,i,void 0,s):o}}function hh(e,t,i){let n=e.get(t);n||(n=new Map,e.set(t,n));const s=i.join();let o=n.get(s);return o||(o={resolver:Jl(t,i),subPrefixes:i.filter(a=>!a.toLowerCase().includes("hover"))},n.set(s,o)),o}const p8=e=>Ne(e)&&Object.getOwnPropertyNames(e).reduce((t,i)=>t||sn(e[i]),!1);function g8(e,t){const{isScriptable:i,isIndexable:n}=Bf(e);for(const s of t){const o=i(s),r=n(s),a=(r||o)&&e[s];if(o&&(sn(a)||p8(a))||r&&it(a))return!0}return!1}var m8="4.2.1";const b8=["top","bottom","left","right","chartArea"];function dh(e,t){return e==="top"||e==="bottom"||b8.indexOf(e)===-1&&t==="x"}function fh(e,t){return function(i,n){return i[e]===n[e]?i[t]-n[t]:i[e]-n[e]}}function ph(e){const t=e.chart,i=t.options.animation;t.notifyPlugins("afterRender"),Ze(i&&i.onComplete,[e],t)}function _8(e){const t=e.chart,i=t.options.animation;Ze(i&&i.onProgress,[e],t)}function op(e){return zf()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Fo={},gh=e=>{const t=op(e);return Object.values(Fo).filter(i=>i.canvas===t).pop()};function y8(e,t,i){const n=Object.keys(e);for(const s of n){const o=+s;if(o>=t){const r=e[s];delete e[s],(i>0||o>t)&&(e[o+i]=r)}}}function v8(e,t,i,n){return!i||e.type==="mouseout"?null:n?t:e}function S8(e){const{xScale:t,yScale:i}=e;if(t&&i)return{left:t.left,right:t.right,top:i.top,bottom:i.bottom}}class Bi{static register(...t){vi.add(...t),mh()}static unregister(...t){vi.remove(...t),mh()}constructor(t,i){const n=this.config=new f8(i),s=op(t),o=gh(s);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const r=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||$E(s)),this.platform.updateConfig(n);const a=this.platform.acquireContext(s,r.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=kS(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=r,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new n8,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=HS(h=>this.update(h),r.resizeDelay||0),this._dataChanges=[],Fo[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Ri.listen(this,"complete",ph),Ri.listen(this,"progress",_8),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:i},width:n,height:s,_aspectRatio:o}=this;return Ue(t)?i&&o?o:s?n/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return vi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():$u(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Bu(this.canvas,this.ctx),this}stop(){return Ri.stop(this),this}resize(t,i){Ri.running(this)?this._resizeBeforeDraw={width:t,height:i}:this._resize(t,i)}_resize(t,i){const n=this.options,s=this.canvas,o=n.maintainAspectRatio&&this.aspectRatio,r=this.platform.getMaximumSize(s,t,i,o),a=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=r.width,this.height=r.height,this._aspectRatio=this.aspectRatio,$u(this,a,!0)&&(this.notifyPlugins("resize",{size:r}),Ze(n.onResize,[this,r],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const i=this.options.scales||{};qe(i,(n,s)=>{n.id=s})}buildOrUpdateScales(){const t=this.options,i=t.scales,n=this.scales,s=Object.keys(n).reduce((r,a)=>(r[a]=!1,r),{});let o=[];i&&(o=o.concat(Object.keys(i).map(r=>{const a=i[r],l=mr(r,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),qe(o,r=>{const a=r.options,l=a.id,c=mr(l,a),u=Ie(a.type,r.dtype);(a.position===void 0||dh(a.position,c)!==dh(r.dposition))&&(a.position=r.dposition),s[l]=!0;let h=null;if(l in n&&n[l].type===u)h=n[l];else{const f=vi.getScale(u);h=new f({id:l,type:u,ctx:this.ctx,chart:this}),n[h.id]=h}h.init(a,t)}),qe(s,(r,a)=>{r||delete n[a]}),qe(n,r=>{Nt.configure(this,r,r.options),Nt.addBox(this,r)})}_updateMetasets(){const t=this._metasets,i=this.data.datasets.length,n=t.length;if(t.sort((s,o)=>s.index-o.index),n>i){for(let s=i;s<n;++s)this._destroyDatasetMeta(s);t.splice(i,n-i)}this._sortedMetasets=t.slice(0).sort(fh("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:i}}=this;t.length>i.length&&delete this._stacks,t.forEach((n,s)=>{i.filter(o=>o===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],i=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=i.length;n<s;n++){const o=i[n];let r=this.getDatasetMeta(n);const a=o.type||this.config.type;if(r.type&&r.type!==a&&(this._destroyDatasetMeta(n),r=this.getDatasetMeta(n)),r.type=a,r.indexAxis=o.indexAxis||tl(a,this.options),r.order=o.order||0,r.index=n,r.label=""+o.label,r.visible=this.isDatasetVisible(n),r.controller)r.controller.updateIndex(n),r.controller.linkScales();else{const l=vi.getController(a),{datasetElementType:c,dataElementType:u}=pt.datasets[a];Object.assign(l,{dataElementType:vi.getElement(u),datasetElementType:c&&vi.getElement(c)}),r.controller=new l(this,n),t.push(r.controller)}}return this._updateMetasets(),t}_resetElements(){qe(this.data.datasets,(t,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const i=this.config;i.update();const n=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let r=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),f=!s&&o.indexOf(h)===-1;h.buildOrUpdateElements(f),r=Math.max(+h.getMaxOverflow(),r)}r=this._minPadding=n.layout.autoPadding?r:0,this._updateLayout(r),s||qe(o,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(fh("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){qe(this.scales,t=>{Nt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,i=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!Au(i,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,i=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:o}of i){const r=n==="_removeElements"?-o:o;y8(t,s,r)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const i=this.data.datasets.length,n=o=>new Set(t.filter(r=>r[0]===o).map((r,a)=>a+","+r.splice(1).join(","))),s=n(0);for(let o=1;o<i;o++)if(!Au(s,n(o)))return;return Array.from(s).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Nt.update(this,this.width,this.height,t);const i=this.chartArea,n=i.width<=0||i.height<=0;this._layers=[],qe(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,o)=>{s._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let i=0,n=this.data.datasets.length;i<n;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,n=this.data.datasets.length;i<n;++i)this._updateDataset(i,sn(t)?t({datasetIndex:i}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,i){const n=this.getDatasetMeta(t),s={meta:n,index:t,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(i),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ri.has(this)?this.attached&&!Ri.running(this)&&Ri.start(this):(this.draw(),ph({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resize(n,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const i=this._layers;for(t=0;t<i.length&&i[t].z<=0;++t)i[t].draw(this.chartArea);for(this._drawDatasets();t<i.length;++t)i[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const i=this._sortedMetasets,n=[];let s,o;for(s=0,o=i.length;s<o;++s){const r=i[s];(!t||r.visible)&&n.push(r)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let i=t.length-1;i>=0;--i)this._drawDataset(t[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const i=this.ctx,n=t._clip,s=!n.disabled,o=S8(t)||this.chartArea,r={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&Or(i,{left:n.left===!1?0:o.left-n.left,right:n.right===!1?this.width:o.right+n.right,top:n.top===!1?0:o.top-n.top,bottom:n.bottom===!1?this.height:o.bottom+n.bottom}),t.controller.draw(),s&&Nr(i),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return Ws(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,i,n,s){const o=_E.modes[i];return typeof o=="function"?o(this,t,n,s):[]}getDatasetMeta(t){const i=this.data.datasets[t],n=this._metasets;let s=n.filter(o=>o&&o._dataset===i).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:t,_dataset:i,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=an(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const i=this.data.datasets[t];if(!i)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!i.hidden}setDatasetVisibility(t,i){const n=this.getDatasetMeta(t);n.hidden=!i}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,i,n){const s=n?"show":"hide",o=this.getDatasetMeta(t),r=o.controller._resolveAnimations(void 0,s);li(i)?(o.data[i].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),r.update(o,{visible:n}),this.update(a=>a.datasetIndex===t?s:void 0))}hide(t,i){this._updateVisibility(t,i,!1)}show(t,i){this._updateVisibility(t,i,!0)}_destroyDatasetMeta(t){const i=this._metasets[t];i&&i.controller&&i.controller._destroy(),delete this._metasets[t]}_stop(){let t,i;for(this.stop(),Ri.remove(this),t=0,i=this.data.datasets.length;t<i;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:i}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Bu(t,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete Fo[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,i=this.platform,n=(o,r)=>{i.addEventListener(this,o,r),t[o]=r},s=(o,r,a)=>{o.offsetX=r,o.offsetY=a,this._eventHandler(o)};qe(this.options.events,o=>n(o,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,i=this.platform,n=(l,c)=>{i.addEventListener(this,l,c),t[l]=c},s=(l,c)=>{t[l]&&(i.removeEventListener(this,l,c),delete t[l])},o=(l,c)=>{this.canvas&&this.resize(l,c)};let r;const a=()=>{s("attach",a),this.attached=!0,this.resize(),n("resize",o),n("detach",r)};r=()=>{this.attached=!1,s("resize",o),this._stop(),this._resize(0,0),n("attach",a)},i.isAttached(this.canvas)?a():r()}unbindEvents(){qe(this._listeners,(t,i)=>{this.platform.removeEventListener(this,i,t)}),this._listeners={},qe(this._responsiveListeners,(t,i)=>{this.platform.removeEventListener(this,i,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,i,n){const s=n?"set":"remove";let o,r,a,l;for(i==="dataset"&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+s+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){r=t[a];const c=r&&this.getDatasetMeta(r.datasetIndex).controller;c&&c[s+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const i=this._active||[],n=t.map(({datasetIndex:o,index:r})=>{const a=this.getDatasetMeta(o);if(!a)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:a.data[r],index:r}});!ur(n,i)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,i))}notifyPlugins(t,i,n){return this._plugins.notify(this,t,i,n)}isPluginEnabled(t){return this._plugins._cache.filter(i=>i.plugin.id===t).length===1}_updateHoverStyles(t,i,n){const s=this.options.hover,o=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),r=o(i,t),a=n?t:o(t,i);r.length&&this.updateHoverStyle(r,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,i){const n={event:t,replay:i,cancelable:!0,inChartArea:this.isPointInArea(t)},s=r=>(r.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const o=this._handleEvent(t,i,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(o||n.changed)&&this.render(),this}_handleEvent(t,i,n){const{_active:s=[],options:o}=this,r=i,a=this._getActiveElements(t,s,n,r),l=MS(t),c=v8(t,this._lastEvent,n,l);n&&(this._lastEvent=null,Ze(o.onHover,[t,a,this],this),l&&Ze(o.onClick,[t,a,this],this));const u=!ur(a,s);return(u||i)&&(this._active=a,this._updateHoverStyles(a,s,i)),this._lastEvent=c,u}_getActiveElements(t,i,n,s){if(t.type==="mouseout")return[];if(!n)return i;const o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,s)}}M(Bi,"defaults",pt),M(Bi,"instances",Fo),M(Bi,"overrides",Mn),M(Bi,"registry",vi),M(Bi,"version",m8),M(Bi,"getChart",gh);function mh(){return qe(Bi.instances,e=>e._plugins.invalidate())}function w8(e,t,i){const{startAngle:n,pixelMargin:s,x:o,y:r,outerRadius:a,innerRadius:l}=t;let c=s/a;e.beginPath(),e.arc(o,r,a,n-c,i+c),l>s?(c=s/l,e.arc(o,r,l,i+c,n-c,!0)):e.arc(o,r,s,i+ft,n-ft),e.closePath(),e.clip()}function E8(e){return Xl(e,["outerStart","outerEnd","innerStart","innerEnd"])}function k8(e,t,i,n){const s=E8(e.options.borderRadius),o=(i-t)/2,r=Math.min(o,n*t/2),a=l=>{const c=(i-Math.min(o,l))*n/2;return Et(l,0,Math.min(o,c))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:Et(s.innerStart,0,r),innerEnd:Et(s.innerEnd,0,r)}}function Ln(e,t,i,n){return{x:i+e*Math.cos(t),y:n+e*Math.sin(t)}}function br(e,t,i,n,s,o){const{x:r,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+n+i-c,0),f=u>0?u+n+i+c:0;let g=0;const _=s-l;if(n){const Ee=u>0?u-n:0,we=h>0?h-n:0,ee=(Ee+we)/2,ne=ee!==0?_*ee/(ee+n):_;g=(_-ne)/2}const b=Math.max(.001,_*h-i/ct)/h,v=(_-b)/2,y=l+v+g,E=s-v-g,{outerStart:w,outerEnd:P,innerStart:A,innerEnd:O}=k8(t,f,h,E-y),U=h-w,z=h-P,te=y+w/U,G=E-P/z,Q=f+A,Se=f+O,ae=y+A/Q,Re=E-O/Se;if(e.beginPath(),o){const Ee=(te+G)/2;if(e.arc(r,a,h,te,Ee),e.arc(r,a,h,Ee,G),P>0){const ie=Ln(z,G,r,a);e.arc(ie.x,ie.y,P,G,E+ft)}const we=Ln(Se,E,r,a);if(e.lineTo(we.x,we.y),O>0){const ie=Ln(Se,Re,r,a);e.arc(ie.x,ie.y,O,E+ft,Re+Math.PI)}const ee=(E-O/f+(y+A/f))/2;if(e.arc(r,a,f,E-O/f,ee,!0),e.arc(r,a,f,ee,y+A/f,!0),A>0){const ie=Ln(Q,ae,r,a);e.arc(ie.x,ie.y,A,ae+Math.PI,y-ft)}const ne=Ln(U,y,r,a);if(e.lineTo(ne.x,ne.y),w>0){const ie=Ln(U,te,r,a);e.arc(ie.x,ie.y,w,y-ft,te)}}else{e.moveTo(r,a);const Ee=Math.cos(te)*h+r,we=Math.sin(te)*h+a;e.lineTo(Ee,we);const ee=Math.cos(G)*h+r,ne=Math.sin(G)*h+a;e.lineTo(ee,ne)}e.closePath()}function I8(e,t,i,n,s){const{fullCircles:o,startAngle:r,circumference:a}=t;let l=t.endAngle;if(o){br(e,t,i,n,l,s);for(let c=0;c<o;++c)e.fill();isNaN(a)||(l=r+(a%nt||nt))}return br(e,t,i,n,l,s),e.fill(),l}function P8(e,t,i,n,s){const{fullCircles:o,startAngle:r,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,h=l.borderAlign==="inner";if(!c)return;h?(e.lineWidth=c*2,e.lineJoin=u||"round"):(e.lineWidth=c,e.lineJoin=u||"bevel");let f=t.endAngle;if(o){br(e,t,i,n,f,s);for(let g=0;g<o;++g)e.stroke();isNaN(a)||(f=r+(a%nt||nt))}h&&w8(e,t,f),o||(br(e,t,i,n,f,s),e.stroke())}class $o extends Gi{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,i,n){const s=this.getProps(["x","y"],n),{angle:o,distance:r}=If(s,{x:t,y:i}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),f=this.options.spacing/2,_=Ie(h,l-a)>=nt||zs(o,a,l),b=$i(r,c+f,u+f);return _&&b}getCenterPoint(t){const{x:i,y:n,startAngle:s,endAngle:o,innerRadius:r,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:l,spacing:c}=this.options,u=(s+o)/2,h=(r+a+c+l)/2;return{x:i+Math.cos(u)*h,y:n+Math.sin(u)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:i,circumference:n}=this,s=(i.offset||0)/4,o=(i.spacing||0)/2,r=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=n>nt?Math.floor(n/nt):0,n===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*s,Math.sin(a)*s);const l=1-Math.sin(Math.min(ct,n||0)),c=s*l;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,I8(t,this,c,o,r),P8(t,this,c,o,r),t.restore()}}M($o,"id","arc"),M($o,"defaults",{borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),M($o,"defaultRoutes",{backgroundColor:"backgroundColor"});function rp(e,t,i=t){e.lineCap=Ie(i.borderCapStyle,t.borderCapStyle),e.setLineDash(Ie(i.borderDash,t.borderDash)),e.lineDashOffset=Ie(i.borderDashOffset,t.borderDashOffset),e.lineJoin=Ie(i.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Ie(i.borderWidth,t.borderWidth),e.strokeStyle=Ie(i.borderColor,t.borderColor)}function A8(e,t,i){e.lineTo(i.x,i.y)}function C8(e){return e.stepped?QS:e.tension||e.cubicInterpolationMode==="monotone"?ZS:A8}function ap(e,t,i={}){const n=e.length,{start:s=0,end:o=n-1}=i,{start:r,end:a}=t,l=Math.max(s,r),c=Math.min(o,a),u=s<r&&o<r||s>a&&o>a;return{count:n,start:l,loop:t.loop,ilen:c<l&&!u?n+c-l:c-l}}function x8(e,t,i,n){const{points:s,options:o}=t,{count:r,start:a,loop:l,ilen:c}=ap(s,i,n),u=C8(o);let{move:h=!0,reverse:f}=n||{},g,_,b;for(g=0;g<=c;++g)_=s[(a+(f?c-g:g))%r],!_.skip&&(h?(e.moveTo(_.x,_.y),h=!1):u(e,b,_,f,o.stepped),b=_);return l&&(_=s[(a+(f?c:0))%r],u(e,b,_,f,o.stepped)),!!l}function M8(e,t,i,n){const s=t.points,{count:o,start:r,ilen:a}=ap(s,i,n),{move:l=!0,reverse:c}=n||{};let u=0,h=0,f,g,_,b,v,y;const E=P=>(r+(c?a-P:P))%o,w=()=>{b!==v&&(e.lineTo(u,v),e.lineTo(u,b),e.lineTo(u,y))};for(l&&(g=s[E(0)],e.moveTo(g.x,g.y)),f=0;f<=a;++f){if(g=s[E(f)],g.skip)continue;const P=g.x,A=g.y,O=P|0;O===_?(A<b?b=A:A>v&&(v=A),u=(h*u+P)/++h):(w(),e.lineTo(P,A),_=O,h=0,b=v=A),y=A}w()}function il(e){const t=e.options,i=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!i?M8:x8}function T8(e){return e.stepped?Tw:e.tension||e.cubicInterpolationMode==="monotone"?Rw:_n}function R8(e,t,i,n){let s=t._path;s||(s=t._path=new Path2D,t.path(s,i,n)&&s.closePath()),rp(e,t.options),e.stroke(s)}function O8(e,t,i,n){const{segments:s,options:o}=t,r=il(t);for(const a of s)rp(e,o,a.style),e.beginPath(),r(e,t,a,{start:i,end:i+n-1})&&e.closePath(),e.stroke()}const N8=typeof Path2D=="function";function L8(e,t,i,n){N8&&!t.options.segment?R8(e,t,i,n):O8(e,t,i,n)}class Yi extends Gi{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,i){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const s=n.spanGaps?this._loop:this._fullLoop;Ew(this._points,n,t,s,i),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Fw(this,this.options.segment))}first(){const t=this.segments,i=this.points;return t.length&&i[t[0].start]}last(){const t=this.segments,i=this.points,n=t.length;return n&&i[t[n-1].end]}interpolate(t,i){const n=this.options,s=t[i],o=this.points,r=Kf(this,{property:i,start:s,end:s});if(!r.length)return;const a=[],l=T8(n);let c,u;for(c=0,u=r.length;c<u;++c){const{start:h,end:f}=r[c],g=o[h],_=o[f];if(g===_){a.push(g);continue}const b=Math.abs((s-g[i])/(_[i]-g[i])),v=l(g,_,b,n.stepped);v[i]=t[i],a.push(v)}return a.length===1?a[0]:a}pathSegment(t,i,n){return il(this)(t,this,i,n)}path(t,i,n){const s=this.segments,o=il(this);let r=this._loop;i=i||0,n=n||this.points.length-i;for(const a of s)r&=o(t,this,a,{start:i,end:i+n-1});return!!r}draw(t,i,n,s){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),L8(t,this,n,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}M(Yi,"id","line"),M(Yi,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),M(Yi,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),M(Yi,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function bh(e,t,i,n){const s=e.options,{[i]:o}=e.getProps([i],n);return Math.abs(t-o)<s.radius+s.hitRadius}class Ho extends Gi{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,i,n){const s=this.options,{x:o,y:r}=this.getProps(["x","y"],n);return Math.pow(t-o,2)+Math.pow(i-r,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,i){return bh(this,t,"x",i)}inYRange(t,i){return bh(this,t,"y",i)}getCenterPoint(t){const{x:i,y:n}=this.getProps(["x","y"],t);return{x:i,y:n}}size(t){t=t||this.options||{};let i=t.radius||0;i=Math.max(i,i&&t.hoverRadius||0);const n=i&&t.borderWidth||0;return(i+n)*2}draw(t,i){const n=this.options;this.skip||n.radius<.1||!Ws(this,i,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,Za(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}M(Ho,"id","point"),M(Ho,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),M(Ho,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function lp(e,t){const{x:i,y:n,base:s,width:o,height:r}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,h;return e.horizontal?(h=r/2,a=Math.min(i,s),l=Math.max(i,s),c=n-h,u=n+h):(h=o/2,a=i-h,l=i+h,c=Math.min(n,s),u=Math.max(n,s)),{left:a,top:c,right:l,bottom:u}}function Xi(e,t,i,n){return e?0:Et(t,i,n)}function B8(e,t,i){const n=e.options.borderWidth,s=e.borderSkipped,o=Lf(n);return{t:Xi(s.top,o.top,0,i),r:Xi(s.right,o.right,0,t),b:Xi(s.bottom,o.bottom,0,i),l:Xi(s.left,o.left,0,t)}}function D8(e,t,i){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),s=e.options.borderRadius,o=Cn(s),r=Math.min(t,i),a=e.borderSkipped,l=n||Ne(s);return{topLeft:Xi(!l||a.top||a.left,o.topLeft,0,r),topRight:Xi(!l||a.top||a.right,o.topRight,0,r),bottomLeft:Xi(!l||a.bottom||a.left,o.bottomLeft,0,r),bottomRight:Xi(!l||a.bottom||a.right,o.bottomRight,0,r)}}function F8(e){const t=lp(e),i=t.right-t.left,n=t.bottom-t.top,s=B8(e,i/2,n/2),o=D8(e,i/2,n/2);return{outer:{x:t.left,y:t.top,w:i,h:n,radius:o},inner:{x:t.left+s.l,y:t.top+s.t,w:i-s.l-s.r,h:n-s.t-s.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,o.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(s.b,s.r))}}}}function va(e,t,i,n){const s=t===null,o=i===null,a=e&&!(s&&o)&&lp(e,n);return a&&(s||$i(t,a.left,a.right))&&(o||$i(i,a.top,a.bottom))}function $8(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function H8(e,t){e.rect(t.x,t.y,t.w,t.h)}function Sa(e,t,i={}){const n=e.x!==i.x?-t:0,s=e.y!==i.y?-t:0,o=(e.x+e.w!==i.x+i.w?t:0)-n,r=(e.y+e.h!==i.y+i.h?t:0)-s;return{x:e.x+n,y:e.y+s,w:e.w+o,h:e.h+r,radius:e.radius}}class Uo extends Gi{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:i,options:{borderColor:n,backgroundColor:s}}=this,{inner:o,outer:r}=F8(this),a=$8(r.radius)?Gs:H8;t.save(),(r.w!==o.w||r.h!==o.h)&&(t.beginPath(),a(t,Sa(r,i,o)),t.clip(),a(t,Sa(o,-i,r)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),a(t,Sa(o,i)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,i,n){return va(this,t,i,n)}inXRange(t,i){return va(this,t,null,i)}inYRange(t,i){return va(this,null,t,i)}getCenterPoint(t){const{x:i,y:n,base:s,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(i+s)/2:i,y:o?n:(n+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}M(Uo,"id","bar"),M(Uo,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),M(Uo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var U8=Object.freeze({__proto__:null,ArcElement:$o,LineElement:Yi,PointElement:Ho,BarElement:Uo});const nl=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],_h=nl.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function cp(e){return nl[e%nl.length]}function up(e){return _h[e%_h.length]}function z8(e,t){return e.borderColor=cp(t),e.backgroundColor=up(t),++t}function W8(e,t){return e.backgroundColor=e.data.map(()=>cp(t++)),t}function G8(e,t){return e.backgroundColor=e.data.map(()=>up(t++)),t}function V8(e){let t=0;return(i,n)=>{const s=e.getDatasetMeta(n).controller;s instanceof En?t=W8(i,t):s instanceof Ms?t=G8(i,t):s&&(t=z8(i,t))}}function yh(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function j8(e){return e&&(e.borderColor||e.backgroundColor)}var K8={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,i){if(!i.enabled)return;const{data:{datasets:n},options:s}=e.config,{elements:o}=s;if(!i.forceOverride&&(yh(n)||j8(s)||o&&yh(o)))return;const r=V8(e);n.forEach(r)}};function q8(e,t,i,n,s){const o=s.samples||n;if(o>=i)return e.slice(t,t+i);const r=[],a=(i-2)/(o-2);let l=0;const c=t+i-1;let u=t,h,f,g,_,b;for(r[l++]=e[u],h=0;h<o-2;h++){let v=0,y=0,E;const w=Math.floor((h+1)*a)+1+t,P=Math.min(Math.floor((h+2)*a)+1,i)+t,A=P-w;for(E=w;E<P;E++)v+=e[E].x,y+=e[E].y;v/=A,y/=A;const O=Math.floor(h*a)+1+t,U=Math.min(Math.floor((h+1)*a)+1,i)+t,{x:z,y:te}=e[u];for(g=_=-1,E=O;E<U;E++)_=.5*Math.abs((z-v)*(e[E].y-te)-(z-e[E].x)*(y-te)),_>g&&(g=_,f=e[E],b=E);r[l++]=f,u=b}return r[l++]=e[c],r}function Y8(e,t,i,n){let s=0,o=0,r,a,l,c,u,h,f,g,_,b;const v=[],y=t+i-1,E=e[t].x,P=e[y].x-E;for(r=t;r<t+i;++r){a=e[r],l=(a.x-E)/P*n,c=a.y;const A=l|0;if(A===u)c<_?(_=c,h=r):c>b&&(b=c,f=r),s=(o*s+a.x)/++o;else{const O=r-1;if(!Ue(h)&&!Ue(f)){const U=Math.min(h,f),z=Math.max(h,f);U!==g&&U!==O&&v.push({...e[U],x:s}),z!==g&&z!==O&&v.push({...e[z],x:s})}r>0&&O!==g&&v.push(e[O]),v.push(a),u=A,o=0,_=b=c,h=f=g=r}}return v}function hp(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function vh(e){e.data.datasets.forEach(t=>{hp(t)})}function X8(e,t){const i=t.length;let n=0,s;const{iScale:o}=e,{min:r,max:a,minDefined:l,maxDefined:c}=o.getUserBounds();return l&&(n=Et(Hi(t,o.axis,r).lo,0,i-1)),c?s=Et(Hi(t,o.axis,a).hi+1,n,i)-n:s=i-n,{start:n,count:s}}var J8={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,i)=>{if(!i.enabled){vh(e);return}const n=e.width;e.data.datasets.forEach((s,o)=>{const{_data:r,indexAxis:a}=s,l=e.getDatasetMeta(o),c=r||s.data;if(ms([a,e.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=e.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||e.options.parsing)return;let{start:h,count:f}=X8(l,c);const g=i.threshold||4*n;if(f<=g){hp(s);return}Ue(r)&&(s._data=c,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(b){this._data=b}}));let _;switch(i.algorithm){case"lttb":_=q8(c,h,f,n,i);break;case"min-max":_=Y8(c,h,f,n);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}s._decimated=_})},destroy(e){vh(e)}};function Q8(e,t,i){const n=e.segments,s=e.points,o=t.points,r=[];for(const a of n){let{start:l,end:c}=a;c=ic(l,c,s);const u=sl(i,s[l],s[c],a.loop);if(!t.segments){r.push({source:a,target:u,start:s[l],end:s[c]});continue}const h=Kf(t,u);for(const f of h){const g=sl(i,o[f.start],o[f.end],f.loop),_=jf(a,s,g);for(const b of _)r.push({source:b,target:f,start:{[i]:Sh(u,g,"start",Math.max)},end:{[i]:Sh(u,g,"end",Math.min)}})}}return r}function sl(e,t,i,n){if(n)return;let s=t[e],o=i[e];return e==="angle"&&(s=Jt(s),o=Jt(o)),{property:e,start:s,end:o}}function Z8(e,t){const{x:i=null,y:n=null}=e||{},s=t.points,o=[];return t.segments.forEach(({start:r,end:a})=>{a=ic(r,a,s);const l=s[r],c=s[a];n!==null?(o.push({x:l.x,y:n}),o.push({x:c.x,y:n})):i!==null&&(o.push({x:i,y:l.y}),o.push({x:i,y:c.y}))}),o}function ic(e,t,i){for(;t>e;t--){const n=i[t];if(!isNaN(n.x)&&!isNaN(n.y))break}return t}function Sh(e,t,i,n){return e&&t?n(e[i],t[i]):e?e[i]:t?t[i]:0}function dp(e,t){let i=[],n=!1;return it(e)?(n=!0,i=e):i=Z8(e,t),i.length?new Yi({points:i,options:{tension:0},_loop:n,_fullLoop:n}):null}function wh(e){return e&&e.fill!==!1}function ek(e,t,i){let s=e[t].fill;const o=[t];let r;if(!i)return s;for(;s!==!1&&o.indexOf(s)===-1;){if(!dt(s))return s;if(r=e[s],!r)return!1;if(r.visible)return s;o.push(s),s=r.fill}return!1}function tk(e,t,i){const n=ok(e);if(Ne(n))return isNaN(n.value)?!1:n;let s=parseFloat(n);return dt(s)&&Math.floor(s)===s?ik(n[0],t,s,i):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function ik(e,t,i,n){return(e==="-"||e==="+")&&(i=t+i),i===t||i<0||i>=n?!1:i}function nk(e,t){let i=null;return e==="start"?i=t.bottom:e==="end"?i=t.top:Ne(e)?i=t.getPixelForValue(e.value):t.getBasePixel&&(i=t.getBasePixel()),i}function sk(e,t,i){let n;return e==="start"?n=i:e==="end"?n=t.options.reverse?t.min:t.max:Ne(e)?n=e.value:n=t.getBaseValue(),n}function ok(e){const t=e.options,i=t.fill;let n=Ie(i&&i.target,i);return n===void 0&&(n=!!t.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function rk(e){const{scale:t,index:i,line:n}=e,s=[],o=n.segments,r=n.points,a=ak(t,i);a.push(dp({x:null,y:t.bottom},n));for(let l=0;l<o.length;l++){const c=o[l];for(let u=c.start;u<=c.end;u++)lk(s,r[u],a)}return new Yi({points:s,options:{}})}function ak(e,t){const i=[],n=e.getMatchingVisibleMetas("line");for(let s=0;s<n.length;s++){const o=n[s];if(o.index===t)break;o.hidden||i.unshift(o.dataset)}return i}function lk(e,t,i){const n=[];for(let s=0;s<i.length;s++){const o=i[s],{first:r,last:a,point:l}=ck(o,t,"x");if(!(!l||r&&a)){if(r)n.unshift(l);else if(e.push(l),!a)break}}e.push(...n)}function ck(e,t,i){const n=e.interpolate(t,i);if(!n)return{};const s=n[i],o=e.segments,r=e.points;let a=!1,l=!1;for(let c=0;c<o.length;c++){const u=o[c],h=r[u.start][i],f=r[u.end][i];if($i(s,h,f)){a=s===h,l=s===f;break}}return{first:a,last:l,point:n}}class fp{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,i,n){const{x:s,y:o,radius:r}=this;return i=i||{start:0,end:nt},t.arc(s,o,r,i.end,i.start,!0),!n.bounds}interpolate(t){const{x:i,y:n,radius:s}=this,o=t.angle;return{x:i+Math.cos(o)*s,y:n+Math.sin(o)*s,angle:o}}}function uk(e){const{chart:t,fill:i,line:n}=e;if(dt(i))return hk(t,i);if(i==="stack")return rk(e);if(i==="shape")return!0;const s=dk(e);return s instanceof fp?s:dp(s,n)}function hk(e,t){const i=e.getDatasetMeta(t);return i&&e.isDatasetVisible(t)?i.dataset:null}function dk(e){return(e.scale||{}).getPointPositionForValue?pk(e):fk(e)}function fk(e){const{scale:t={},fill:i}=e,n=nk(i,t);if(dt(n)){const s=t.isHorizontal();return{x:s?n:null,y:s?null:n}}return null}function pk(e){const{scale:t,fill:i}=e,n=t.options,s=t.getLabels().length,o=n.reverse?t.max:t.min,r=sk(i,t,o),a=[];if(n.grid.circular){const l=t.getPointPositionForValue(0,o);return new fp({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(r)})}for(let l=0;l<s;++l)a.push(t.getPointPositionForValue(l,r));return a}function wa(e,t,i){const n=uk(t),{line:s,scale:o,axis:r}=t,a=s.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:h=c}=l||{};n&&s.points.length&&(Or(e,i),gk(e,{line:s,target:n,above:u,below:h,area:i,scale:o,axis:r}),Nr(e))}function gk(e,t){const{line:i,target:n,above:s,below:o,area:r,scale:a}=t,l=i._loop?"angle":t.axis;e.save(),l==="x"&&o!==s&&(Eh(e,n,r.top),kh(e,{line:i,target:n,color:s,scale:a,property:l}),e.restore(),e.save(),Eh(e,n,r.bottom)),kh(e,{line:i,target:n,color:o,scale:a,property:l}),e.restore()}function Eh(e,t,i){const{segments:n,points:s}=t;let o=!0,r=!1;e.beginPath();for(const a of n){const{start:l,end:c}=a,u=s[l],h=s[ic(l,c,s)];o?(e.moveTo(u.x,u.y),o=!1):(e.lineTo(u.x,i),e.lineTo(u.x,u.y)),r=!!t.pathSegment(e,a,{move:r}),r?e.closePath():e.lineTo(h.x,i)}e.lineTo(t.first().x,i),e.closePath(),e.clip()}function kh(e,t){const{line:i,target:n,property:s,color:o,scale:r}=t,a=Q8(i,n,s);for(const{source:l,target:c,start:u,end:h}of a){const{style:{backgroundColor:f=o}={}}=l,g=n!==!0;e.save(),e.fillStyle=f,mk(e,r,g&&sl(s,u,h)),e.beginPath();const _=!!i.pathSegment(e,l);let b;if(g){_?e.closePath():Ih(e,n,h,s);const v=!!n.pathSegment(e,c,{move:_,reverse:!0});b=_&&v,b||Ih(e,n,u,s)}e.closePath(),e.fill(b?"evenodd":"nonzero"),e.restore()}}function mk(e,t,i){const{top:n,bottom:s}=t.chart.chartArea,{property:o,start:r,end:a}=i||{};o==="x"&&(e.beginPath(),e.rect(r,n,a-r,s-n),e.clip())}function Ih(e,t,i,n){const s=t.interpolate(i,n);s&&e.lineTo(s.x,s.y)}var bk={id:"filler",afterDatasetsUpdate(e,t,i){const n=(e.data.datasets||[]).length,s=[];let o,r,a,l;for(r=0;r<n;++r)o=e.getDatasetMeta(r),a=o.dataset,l=null,a&&a.options&&a instanceof Yi&&(l={visible:e.isDatasetVisible(r),index:r,fill:tk(a,r,n),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=l,s.push(l);for(r=0;r<n;++r)l=s[r],!(!l||l.fill===!1)&&(l.fill=ek(s,r,i.propagate))},beforeDraw(e,t,i){const n=i.drawTime==="beforeDraw",s=e.getSortedVisibleDatasetMetas(),o=e.chartArea;for(let r=s.length-1;r>=0;--r){const a=s[r].$filler;a&&(a.line.updateControlPoints(o,a.axis),n&&a.fill&&wa(e.ctx,a,o))}},beforeDatasetsDraw(e,t,i){if(i.drawTime!=="beforeDatasetsDraw")return;const n=e.getSortedVisibleDatasetMetas();for(let s=n.length-1;s>=0;--s){const o=n[s].$filler;wh(o)&&wa(e.ctx,o,e.chartArea)}},beforeDatasetDraw(e,t,i){const n=t.meta.$filler;!wh(n)||i.drawTime!=="beforeDatasetDraw"||wa(e.ctx,n,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Ph=(e,t)=>{let{boxHeight:i=t,boxWidth:n=t}=e;return e.usePointStyle&&(i=Math.min(i,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:i,itemHeight:Math.max(t,i)}},_k=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class Ah extends Gi{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,i,n){this.maxWidth=t,this.maxHeight=i,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let i=Ze(t.generateLabels,[this.chart],this)||[];t.filter&&(i=i.filter(n=>t.filter(n,this.chart.data))),t.sort&&(i=i.sort((n,s)=>t.sort(n,s,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){const{options:t,ctx:i}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,s=yt(n.font),o=s.size,r=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=Ph(n,o);let c,u;i.font=s.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(r,o,a,l)+10):(u=this.maxHeight,c=this._fitCols(r,s,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,i,n,s){const{ctx:o,maxWidth:r,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=s+a;let h=t;o.textAlign="left",o.textBaseline="middle";let f=-1,g=-u;return this.legendItems.forEach((_,b)=>{const v=n+i/2+o.measureText(_.text).width;(b===0||c[c.length-1]+v+2*a>r)&&(h+=u,c[c.length-(b>0?0:1)]=0,g+=u,f++),l[b]={left:0,top:g,row:f,width:v,height:s},c[c.length-1]+=v+a}),h}_fitCols(t,i,n,s){const{ctx:o,maxHeight:r,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=r-t;let h=a,f=0,g=0,_=0,b=0;return this.legendItems.forEach((v,y)=>{const{itemWidth:E,itemHeight:w}=yk(n,i,o,v,s);y>0&&g+w+2*a>u&&(h+=f+a,c.push({width:f,height:g}),_+=f+a,b++,f=g=0),l[y]={left:_,top:g,col:b,width:E,height:w},f=Math.max(f,E),g+=w+a}),h+=f,c.push({width:f,height:g}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:n,labels:{padding:s},rtl:o}}=this,r=Kn(o,this.left,this.width);if(this.isHorizontal()){let a=0,l=xt(n,this.left+s,this.right-this.lineWidths[a]);for(const c of i)a!==c.row&&(a=c.row,l=xt(n,this.left+s,this.right-this.lineWidths[a])),c.top+=this.top+t+s,c.left=r.leftForLtr(r.x(l),c.width),l+=c.width+s}else{let a=0,l=xt(n,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const c of i)c.col!==a&&(a=c.col,l=xt(n,this.top+t+s,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+s,c.left=r.leftForLtr(r.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Or(t,this),this._draw(),Nr(t)}}_draw(){const{options:t,columnSizes:i,lineWidths:n,ctx:s}=this,{align:o,labels:r}=t,a=pt.color,l=Kn(t.rtl,this.left,this.width),c=yt(r.font),{padding:u}=r,h=c.size,f=h/2;let g;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:_,boxHeight:b,itemHeight:v}=Ph(r,h),y=function(O,U,z){if(isNaN(_)||_<=0||isNaN(b)||b<0)return;s.save();const te=Ie(z.lineWidth,1);if(s.fillStyle=Ie(z.fillStyle,a),s.lineCap=Ie(z.lineCap,"butt"),s.lineDashOffset=Ie(z.lineDashOffset,0),s.lineJoin=Ie(z.lineJoin,"miter"),s.lineWidth=te,s.strokeStyle=Ie(z.strokeStyle,a),s.setLineDash(Ie(z.lineDash,[])),r.usePointStyle){const G={radius:b*Math.SQRT2/2,pointStyle:z.pointStyle,rotation:z.rotation,borderWidth:te},Q=l.xPlus(O,_/2),Se=U+f;Nf(s,G,Q,Se,r.pointStyleWidth&&_)}else{const G=U+Math.max((h-b)/2,0),Q=l.leftForLtr(O,_),Se=Cn(z.borderRadius);s.beginPath(),Object.values(Se).some(ae=>ae!==0)?Gs(s,{x:Q,y:G,w:_,h:b,radius:Se}):s.rect(Q,G,_,b),s.fill(),te!==0&&s.stroke()}s.restore()},E=function(O,U,z){Tn(s,z.text,O,U+v/2,c,{strikethrough:z.hidden,textAlign:l.textAlign(z.textAlign)})},w=this.isHorizontal(),P=this._computeTitleHeight();w?g={x:xt(o,this.left+u,this.right-n[0]),y:this.top+u+P,line:0}:g={x:this.left+u,y:xt(o,this.top+P+u,this.bottom-i[0].height),line:0},Wf(this.ctx,t.textDirection);const A=v+u;this.legendItems.forEach((O,U)=>{s.strokeStyle=O.fontColor,s.fillStyle=O.fontColor;const z=s.measureText(O.text).width,te=l.textAlign(O.textAlign||(O.textAlign=r.textAlign)),G=_+f+z;let Q=g.x,Se=g.y;l.setWidth(this.width),w?U>0&&Q+G+u>this.right&&(Se=g.y+=A,g.line++,Q=g.x=xt(o,this.left+u,this.right-n[g.line])):U>0&&Se+A>this.bottom&&(Q=g.x=Q+i[g.line].width+u,g.line++,Se=g.y=xt(o,this.top+P+u,this.bottom-i[g.line].height));const ae=l.x(Q);if(y(ae,Se,O),Q=US(te,Q+_+f,w?Q+G:this.right,t.rtl),E(l.x(Q),Se,O),w)g.x+=G+u;else if(typeof O.text!="string"){const Re=c.lineHeight;g.y+=pp(O,Re)}else g.y+=A}),Gf(this.ctx,t.textDirection)}drawTitle(){const t=this.options,i=t.title,n=yt(i.font),s=Lt(i.padding);if(!i.display)return;const o=Kn(t.rtl,this.left,this.width),r=this.ctx,a=i.position,l=n.size/2,c=s.top+l;let u,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+c,h=xt(t.align,h,this.right-f);else{const _=this.columnSizes.reduce((b,v)=>Math.max(b,v.height),0);u=c+xt(t.align,this.top,this.bottom-_-t.labels.padding-this._computeTitleHeight())}const g=xt(a,h,h+f);r.textAlign=o.textAlign(Yl(a)),r.textBaseline="middle",r.strokeStyle=i.color,r.fillStyle=i.color,r.font=n.string,Tn(r,i.text,g,u,n)}_computeTitleHeight(){const t=this.options.title,i=yt(t.font),n=Lt(t.padding);return t.display?i.lineHeight+n.height:0}_getLegendItemAt(t,i){let n,s,o;if($i(t,this.left,this.right)&&$i(i,this.top,this.bottom)){for(o=this.legendHitBoxes,n=0;n<o.length;++n)if(s=o[n],$i(t,s.left,s.left+s.width)&&$i(i,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(t){const i=this.options;if(!wk(t.type,i))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,o=_k(s,n);s&&!o&&Ze(i.onLeave,[t,s,this],this),this._hoveredItem=n,n&&!o&&Ze(i.onHover,[t,n,this],this)}else n&&Ze(i.onClick,[t,n,this],this)}}function yk(e,t,i,n,s){const o=vk(n,e,t,i),r=Sk(s,n,t.lineHeight);return{itemWidth:o,itemHeight:r}}function vk(e,t,i,n){let s=e.text;return s&&typeof s!="string"&&(s=s.reduce((o,r)=>o.length>r.length?o:r)),t+i.size/2+n.measureText(s).width}function Sk(e,t,i){let n=e;return typeof t.text!="string"&&(n=pp(t,i)),n}function pp(e,t){const i=e.text?e.text.length+.5:0;return t*i}function wk(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var Ek={id:"legend",_element:Ah,start(e,t,i){const n=e.legend=new Ah({ctx:e.ctx,options:i,chart:e});Nt.configure(e,n,i),Nt.addBox(e,n)},stop(e){Nt.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,i){const n=e.legend;Nt.configure(e,n,i),n.options=i},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,i){const n=t.datasetIndex,s=i.chart;s.isDatasetVisible(n)?(s.hide(n),t.hidden=!0):(s.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:i,pointStyle:n,textAlign:s,color:o,useBorderRadius:r,borderRadius:a}}=e.legend.options;return e._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(i?0:void 0),u=Lt(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:o,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:r&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class nc extends Gi{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,i){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=i;const s=it(n.text)?n.text.length:1;this._padding=Lt(n.padding);const o=s*yt(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:i,left:n,bottom:s,right:o,options:r}=this,a=r.align;let l=0,c,u,h;return this.isHorizontal()?(u=xt(a,n,o),h=i+t,c=o-n):(r.position==="left"?(u=n+t,h=xt(a,s,i),l=ct*-.5):(u=o-t,h=xt(a,i,s),l=ct*.5),c=s-i),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){const t=this.ctx,i=this.options;if(!i.display)return;const n=yt(i.font),o=n.lineHeight/2+this._padding.top,{titleX:r,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(o);Tn(t,i.text,0,0,n,{color:i.color,maxWidth:l,rotation:c,textAlign:Yl(i.align),textBaseline:"middle",translation:[r,a]})}}function kk(e,t){const i=new nc({ctx:e.ctx,options:t,chart:e});Nt.configure(e,i,t),Nt.addBox(e,i),e.titleBlock=i}var Ik={id:"title",_element:nc,start(e,t,i){kk(e,i)},stop(e){const t=e.titleBlock;Nt.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,i){const n=e.titleBlock;Nt.configure(e,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const So=new WeakMap;var Pk={id:"subtitle",start(e,t,i){const n=new nc({ctx:e.ctx,options:i,chart:e});Nt.configure(e,n,i),Nt.addBox(e,n),So.set(e,n)},stop(e){Nt.removeBox(e,So.get(e)),So.delete(e)},beforeUpdate(e,t,i){const n=So.get(e);Nt.configure(e,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const _s={average(e){if(!e.length)return!1;let t,i,n=0,s=0,o=0;for(t=0,i=e.length;t<i;++t){const r=e[t].element;if(r&&r.hasValue()){const a=r.tooltipPosition();n+=a.x,s+=a.y,++o}}return{x:n/o,y:s/o}},nearest(e,t){if(!e.length)return!1;let i=t.x,n=t.y,s=Number.POSITIVE_INFINITY,o,r,a;for(o=0,r=e.length;o<r;++o){const l=e[o].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Ja(t,c);u<s&&(s=u,a=l)}}if(a){const l=a.tooltipPosition();i=l.x,n=l.y}return{x:i,y:n}}};function yi(e,t){return t&&(it(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Oi(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function Ak(e,t){const{element:i,datasetIndex:n,index:s}=t,o=e.getDatasetMeta(n).controller,{label:r,value:a}=o.getLabelAndValue(s);return{chart:e,label:r,parsed:o.getParsed(s),raw:e.data.datasets[n].data[s],formattedValue:a,dataset:o.getDataset(),dataIndex:s,datasetIndex:n,element:i}}function Ch(e,t){const i=e.chart.ctx,{body:n,footer:s,title:o}=e,{boxWidth:r,boxHeight:a}=t,l=yt(t.bodyFont),c=yt(t.titleFont),u=yt(t.footerFont),h=o.length,f=s.length,g=n.length,_=Lt(t.padding);let b=_.height,v=0,y=n.reduce((P,A)=>P+A.before.length+A.lines.length+A.after.length,0);if(y+=e.beforeBody.length+e.afterBody.length,h&&(b+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),y){const P=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;b+=g*P+(y-g)*l.lineHeight+(y-1)*t.bodySpacing}f&&(b+=t.footerMarginTop+f*u.lineHeight+(f-1)*t.footerSpacing);let E=0;const w=function(P){v=Math.max(v,i.measureText(P).width+E)};return i.save(),i.font=c.string,qe(e.title,w),i.font=l.string,qe(e.beforeBody.concat(e.afterBody),w),E=t.displayColors?r+2+t.boxPadding:0,qe(n,P=>{qe(P.before,w),qe(P.lines,w),qe(P.after,w)}),E=0,i.font=u.string,qe(e.footer,w),i.restore(),v+=_.width,{width:v,height:b}}function Ck(e,t){const{y:i,height:n}=t;return i<n/2?"top":i>e.height-n/2?"bottom":"center"}function xk(e,t,i,n){const{x:s,width:o}=n,r=i.caretSize+i.caretPadding;if(e==="left"&&s+o+r>t.width||e==="right"&&s-o-r<0)return!0}function Mk(e,t,i,n){const{x:s,width:o}=i,{width:r,chartArea:{left:a,right:l}}=e;let c="center";return n==="center"?c=s<=(a+l)/2?"left":"right":s<=o/2?c="left":s>=r-o/2&&(c="right"),xk(c,e,t,i)&&(c="center"),c}function xh(e,t,i){const n=i.yAlign||t.yAlign||Ck(e,i);return{xAlign:i.xAlign||t.xAlign||Mk(e,t,i,n),yAlign:n}}function Tk(e,t){let{x:i,width:n}=e;return t==="right"?i-=n:t==="center"&&(i-=n/2),i}function Rk(e,t,i){let{y:n,height:s}=e;return t==="top"?n+=i:t==="bottom"?n-=s+i:n-=s/2,n}function Mh(e,t,i,n){const{caretSize:s,caretPadding:o,cornerRadius:r}=e,{xAlign:a,yAlign:l}=i,c=s+o,{topLeft:u,topRight:h,bottomLeft:f,bottomRight:g}=Cn(r);let _=Tk(t,a);const b=Rk(t,l,c);return l==="center"?a==="left"?_+=c:a==="right"&&(_-=c):a==="left"?_-=Math.max(u,f)+s:a==="right"&&(_+=Math.max(h,g)+s),{x:Et(_,0,n.width-t.width),y:Et(b,0,n.height-t.height)}}function wo(e,t,i){const n=Lt(i.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-n.right:e.x+n.left}function Th(e){return yi([],Oi(e))}function Ok(e,t,i){return an(e,{tooltip:t,tooltipItems:i,type:"tooltip"})}function Rh(e,t){const i=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return i?e.override(i):e}const gp={beforeTitle:Mi,title(e){if(e.length>0){const t=e[0],i=t.chart.data.labels,n=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return i[t.dataIndex]}return""},afterTitle:Mi,beforeBody:Mi,beforeLabel:Mi,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const i=e.formattedValue;return Ue(i)||(t+=i),t},labelColor(e){const i=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const i=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:Mi,afterBody:Mi,beforeFooter:Mi,footer:Mi,afterFooter:Mi};function Gt(e,t,i,n){const s=e[t].call(i,n);return typeof s>"u"?gp[t].call(i,n):s}class ol extends Gi{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const i=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&i.options.animation&&n.animations,o=new qf(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=Ok(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,i){const{callbacks:n}=i,s=Gt(n,"beforeTitle",this,t),o=Gt(n,"title",this,t),r=Gt(n,"afterTitle",this,t);let a=[];return a=yi(a,Oi(s)),a=yi(a,Oi(o)),a=yi(a,Oi(r)),a}getBeforeBody(t,i){return Th(Gt(i.callbacks,"beforeBody",this,t))}getBody(t,i){const{callbacks:n}=i,s=[];return qe(t,o=>{const r={before:[],lines:[],after:[]},a=Rh(n,o);yi(r.before,Oi(Gt(a,"beforeLabel",this,o))),yi(r.lines,Gt(a,"label",this,o)),yi(r.after,Oi(Gt(a,"afterLabel",this,o))),s.push(r)}),s}getAfterBody(t,i){return Th(Gt(i.callbacks,"afterBody",this,t))}getFooter(t,i){const{callbacks:n}=i,s=Gt(n,"beforeFooter",this,t),o=Gt(n,"footer",this,t),r=Gt(n,"afterFooter",this,t);let a=[];return a=yi(a,Oi(s)),a=yi(a,Oi(o)),a=yi(a,Oi(r)),a}_createItems(t){const i=this._active,n=this.chart.data,s=[],o=[],r=[];let a=[],l,c;for(l=0,c=i.length;l<c;++l)a.push(Ak(this.chart,i[l]));return t.filter&&(a=a.filter((u,h,f)=>t.filter(u,h,f,n))),t.itemSort&&(a=a.sort((u,h)=>t.itemSort(u,h,n))),qe(a,u=>{const h=Rh(t.callbacks,u);s.push(Gt(h,"labelColor",this,u)),o.push(Gt(h,"labelPointStyle",this,u)),r.push(Gt(h,"labelTextColor",this,u))}),this.labelColors=s,this.labelPointStyles=o,this.labelTextColors=r,this.dataPoints=a,a}update(t,i){const n=this.options.setContext(this.getContext()),s=this._active;let o,r=[];if(!s.length)this.opacity!==0&&(o={opacity:0});else{const a=_s[n.position].call(this,s,this._eventPosition);r=this._createItems(n),this.title=this.getTitle(r,n),this.beforeBody=this.getBeforeBody(r,n),this.body=this.getBody(r,n),this.afterBody=this.getAfterBody(r,n),this.footer=this.getFooter(r,n);const l=this._size=Ch(this,n),c=Object.assign({},a,l),u=xh(this.chart,n,c),h=Mh(n,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,o={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=r,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(t,i,n,s){const o=this.getCaretPosition(t,n,s);i.lineTo(o.x1,o.y1),i.lineTo(o.x2,o.y2),i.lineTo(o.x3,o.y3)}getCaretPosition(t,i,n){const{xAlign:s,yAlign:o}=this,{caretSize:r,cornerRadius:a}=n,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=Cn(a),{x:f,y:g}=t,{width:_,height:b}=i;let v,y,E,w,P,A;return o==="center"?(P=g+b/2,s==="left"?(v=f,y=v-r,w=P+r,A=P-r):(v=f+_,y=v+r,w=P-r,A=P+r),E=v):(s==="left"?y=f+Math.max(l,u)+r:s==="right"?y=f+_-Math.max(c,h)-r:y=this.caretX,o==="top"?(w=g,P=w-r,v=y-r,E=y+r):(w=g+b,P=w+r,v=y+r,E=y-r),A=w),{x1:v,x2:y,x3:E,y1:w,y2:P,y3:A}}drawTitle(t,i,n){const s=this.title,o=s.length;let r,a,l;if(o){const c=Kn(n.rtl,this.x,this.width);for(t.x=wo(this,n.titleAlign,n),i.textAlign=c.textAlign(n.titleAlign),i.textBaseline="middle",r=yt(n.titleFont),a=n.titleSpacing,i.fillStyle=n.titleColor,i.font=r.string,l=0;l<o;++l)i.fillText(s[l],c.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+a,l+1===o&&(t.y+=n.titleMarginBottom-a)}}_drawColorBox(t,i,n,s,o){const r=this.labelColors[n],a=this.labelPointStyles[n],{boxHeight:l,boxWidth:c,boxPadding:u}=o,h=yt(o.bodyFont),f=wo(this,"left",o),g=s.x(f),_=l<h.lineHeight?(h.lineHeight-l)/2:0,b=i.y+_;if(o.usePointStyle){const v={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},y=s.leftForLtr(g,c)+c/2,E=b+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,Za(t,v,y,E),t.strokeStyle=r.borderColor,t.fillStyle=r.backgroundColor,Za(t,v,y,E)}else{t.lineWidth=Ne(r.borderWidth)?Math.max(...Object.values(r.borderWidth)):r.borderWidth||1,t.strokeStyle=r.borderColor,t.setLineDash(r.borderDash||[]),t.lineDashOffset=r.borderDashOffset||0;const v=s.leftForLtr(g,c-u),y=s.leftForLtr(s.xPlus(g,1),c-u-2),E=Cn(r.borderRadius);Object.values(E).some(w=>w!==0)?(t.beginPath(),t.fillStyle=o.multiKeyBackground,Gs(t,{x:v,y:b,w:c,h:l,radius:E}),t.fill(),t.stroke(),t.fillStyle=r.backgroundColor,t.beginPath(),Gs(t,{x:y,y:b+1,w:c-2,h:l-2,radius:E}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(v,b,c,l),t.strokeRect(v,b,c,l),t.fillStyle=r.backgroundColor,t.fillRect(y,b+1,c-2,l-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,i,n){const{body:s}=this,{bodySpacing:o,bodyAlign:r,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=n,h=yt(n.bodyFont);let f=h.lineHeight,g=0;const _=Kn(n.rtl,this.x,this.width),b=function(z){i.fillText(z,_.x(t.x+g),t.y+f/2),t.y+=f+o},v=_.textAlign(r);let y,E,w,P,A,O,U;for(i.textAlign=r,i.textBaseline="middle",i.font=h.string,t.x=wo(this,v,n),i.fillStyle=n.bodyColor,qe(this.beforeBody,b),g=a&&v!=="right"?r==="center"?c/2+u:c+2+u:0,P=0,O=s.length;P<O;++P){for(y=s[P],E=this.labelTextColors[P],i.fillStyle=E,qe(y.before,b),w=y.lines,a&&w.length&&(this._drawColorBox(i,t,P,_,n),f=Math.max(h.lineHeight,l)),A=0,U=w.length;A<U;++A)b(w[A]),f=h.lineHeight;qe(y.after,b)}g=0,f=h.lineHeight,qe(this.afterBody,b),t.y-=o}drawFooter(t,i,n){const s=this.footer,o=s.length;let r,a;if(o){const l=Kn(n.rtl,this.x,this.width);for(t.x=wo(this,n.footerAlign,n),t.y+=n.footerMarginTop,i.textAlign=l.textAlign(n.footerAlign),i.textBaseline="middle",r=yt(n.footerFont),i.fillStyle=n.footerColor,i.font=r.string,a=0;a<o;++a)i.fillText(s[a],l.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+n.footerSpacing}}drawBackground(t,i,n,s){const{xAlign:o,yAlign:r}=this,{x:a,y:l}=t,{width:c,height:u}=n,{topLeft:h,topRight:f,bottomLeft:g,bottomRight:_}=Cn(s.cornerRadius);i.fillStyle=s.backgroundColor,i.strokeStyle=s.borderColor,i.lineWidth=s.borderWidth,i.beginPath(),i.moveTo(a+h,l),r==="top"&&this.drawCaret(t,i,n,s),i.lineTo(a+c-f,l),i.quadraticCurveTo(a+c,l,a+c,l+f),r==="center"&&o==="right"&&this.drawCaret(t,i,n,s),i.lineTo(a+c,l+u-_),i.quadraticCurveTo(a+c,l+u,a+c-_,l+u),r==="bottom"&&this.drawCaret(t,i,n,s),i.lineTo(a+g,l+u),i.quadraticCurveTo(a,l+u,a,l+u-g),r==="center"&&o==="left"&&this.drawCaret(t,i,n,s),i.lineTo(a,l+h),i.quadraticCurveTo(a,l,a+h,l),i.closePath(),i.fill(),s.borderWidth>0&&i.stroke()}_updateAnimationTarget(t){const i=this.chart,n=this.$animations,s=n&&n.x,o=n&&n.y;if(s||o){const r=_s[t.position].call(this,this._active,this._eventPosition);if(!r)return;const a=this._size=Ch(this,t),l=Object.assign({},r,this._size),c=xh(i,t,l),u=Mh(t,l,c,i);(s._to!==u.x||o._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=r.x,this.caretY=r.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const i=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(i);const s={width:this.width,height:this.height},o={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const r=Lt(i.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&a&&(t.save(),t.globalAlpha=n,this.drawBackground(o,t,s,i),Wf(t,i.textDirection),o.y+=r.top,this.drawTitle(o,t,i),this.drawBody(o,t,i),this.drawFooter(o,t,i),Gf(t,i.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,i){const n=this._active,s=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),o=!ur(n,s),r=this._positionChanged(s,i);(o||r)&&(this._active=s,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,i,n=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,o=this._active||[],r=this._getActiveElements(t,o,i,n),a=this._positionChanged(r,t),l=i||!ur(r,o)||a;return l&&(this._active=r,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,i))),l}_getActiveElements(t,i,n,s){const o=this.options;if(t.type==="mouseout")return[];if(!s)return i;const r=this.chart.getElementsAtEventForMode(t,o.mode,o,n);return o.reverse&&r.reverse(),r}_positionChanged(t,i){const{caretX:n,caretY:s,options:o}=this,r=_s[o.position].call(this,t,i);return r!==!1&&(n!==r.x||s!==r.y)}}M(ol,"positioners",_s);var Nk={id:"tooltip",_element:ol,positioners:_s,afterInit(e,t,i){i&&(e.tooltip=new ol({chart:e,options:i}))},beforeUpdate(e,t,i){e.tooltip&&e.tooltip.initialize(i)},reset(e,t,i){e.tooltip&&e.tooltip.initialize(i)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const i={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",i)}},afterEvent(e,t){if(e.tooltip){const i=t.replay;e.tooltip.handleEvent(t.event,i,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:gp},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Lk=Object.freeze({__proto__:null,Colors:K8,Decimation:J8,Filler:bk,Legend:Ek,SubTitle:Pk,Title:Ik,Tooltip:Nk});const Bk=(e,t,i,n)=>(typeof t=="string"?(i=e.push(t)-1,n.unshift({index:i,label:t})):isNaN(t)&&(i=null),i);function Dk(e,t,i,n){const s=e.indexOf(t);if(s===-1)return Bk(e,t,i,n);const o=e.lastIndexOf(t);return s!==o?i:s}const Fk=(e,t)=>e===null?null:Et(Math.round(e),0,t);function Oh(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class rl extends Rn{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const i=this._addedLabels;if(i.length){const n=this.getLabels();for(const{index:s,label:o}of i)n[s]===o&&n.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,i){if(Ue(t))return null;const n=this.getLabels();return i=isFinite(i)&&n[i]===t?i:Dk(n,t,Ie(i,t),this._addedLabels),Fk(i,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:n,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),i||(s=this.getLabels().length-1)),this.min=n,this.max=s}buildTicks(){const t=this.min,i=this.max,n=this.options.offset,s=[];let o=this.getLabels();o=t===0&&i===o.length-1?o:o.slice(t,i+1),this._valueRange=Math.max(o.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let r=t;r<=i;r++)s.push({value:r});return s}getLabelForValue(t){return Oh.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const i=this.ticks;return t<0||t>i.length-1?null:this.getPixelForValue(i[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}M(rl,"id","category"),M(rl,"defaults",{ticks:{callback:Oh}});function $k(e,t){const i=[],{bounds:s,step:o,min:r,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:f}=e,g=o||1,_=u-1,{min:b,max:v}=t,y=!Ue(r),E=!Ue(a),w=!Ue(c),P=(v-b)/(h+1);let A=xu((v-b)/_/g)*g,O,U,z,te;if(A<1e-14&&!y&&!E)return[{value:b},{value:v}];te=Math.ceil(v/A)-Math.floor(b/A),te>_&&(A=xu(te*A/_/g)*g),Ue(l)||(O=Math.pow(10,l),A=Math.ceil(A*O)/O),s==="ticks"?(U=Math.floor(b/A)*A,z=Math.ceil(v/A)*A):(U=b,z=v),y&&E&&o&&NS((a-r)/o,A/1e3)?(te=Math.round(Math.min((a-r)/A,u)),A=(a-r)/te,U=r,z=a):w?(U=y?r:U,z=E?a:z,te=c-1,A=(z-U)/te):(te=(z-U)/A,As(te,Math.round(te),A/1e3)?te=Math.round(te):te=Math.ceil(te));const G=Math.max(Mu(A),Mu(U));O=Math.pow(10,Ue(l)?G:l),U=Math.round(U*O)/O,z=Math.round(z*O)/O;let Q=0;for(y&&(f&&U!==r?(i.push({value:r}),U<r&&Q++,As(Math.round((U+Q*A)*O)/O,r,Nh(r,P,e))&&Q++):U<r&&Q++);Q<te;++Q)i.push({value:Math.round((U+Q*A)*O)/O});return E&&f&&z!==a?i.length&&As(i[i.length-1].value,a,Nh(a,P,e))?i[i.length-1].value=a:i.push({value:a}):(!E||z===a)&&i.push({value:z}),i}function Nh(e,t,{horizontal:i,minRotation:n}){const s=di(n),o=(i?Math.sin(s):Math.cos(s))||.001,r=.75*t*(""+e).length;return Math.min(t/o,r)}class _r extends Rn{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,i){return Ue(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:i,maxDefined:n}=this.getUserBounds();let{min:s,max:o}=this;const r=l=>s=i?s:l,a=l=>o=n?o:l;if(t){const l=Pi(s),c=Pi(o);l<0&&c<0?a(0):l>0&&c>0&&r(0)}if(s===o){let l=o===0?1:Math.abs(o*.05);a(o+l),t||r(s-l)}this.min=s,this.max=o}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:i,stepSize:n}=t,s;return n?(s=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),i=i||11),i&&(s=Math.min(i,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,i=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const s={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},o=this._range||this,r=$k(s,o);return t.bounds==="ticks"&&kf(r,this,"value"),t.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){const t=this.ticks;let i=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const s=(n-i)/Math.max(t.length-1,1)/2;i-=s,n+=s}this._startValue=i,this._endValue=n,this._valueRange=n-i}getLabelForValue(t){return Zs(t,this.chart.options.locale,this.options.ticks.format)}}class al extends _r{determineDataLimits(){const{min:t,max:i}=this.getMinMax(!0);this.min=dt(t)?t:0,this.max=dt(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),i=t?this.width:this.height,n=di(this.options.ticks.minRotation),s=(t?Math.sin(n):Math.cos(n))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,o.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}M(al,"id","linear"),M(al,"defaults",{ticks:{callback:Rr.formatters.numeric}});const js=e=>Math.floor(qi(e)),pn=(e,t)=>Math.pow(10,js(e)+t);function Lh(e){return e/Math.pow(10,js(e))===1}function Bh(e,t,i){const n=Math.pow(10,i),s=Math.floor(e/n);return Math.ceil(t/n)-s}function Hk(e,t){const i=t-e;let n=js(i);for(;Bh(e,t,n)>10;)n++;for(;Bh(e,t,n)<10;)n--;return Math.min(n,js(e))}function Uk(e,{min:t,max:i}){t=Yt(e.min,t);const n=[],s=js(t);let o=Hk(t,i),r=o<0?Math.pow(10,Math.abs(o)):1;const a=Math.pow(10,o),l=s>o?Math.pow(10,s):0,c=Math.round((t-l)*r)/r,u=Math.floor((t-l)/a/10)*a*10;let h=Math.floor((c-u)/Math.pow(10,o)),f=Yt(e.min,Math.round((l+u+h*Math.pow(10,o))*r)/r);for(;f<i;)n.push({value:f,major:Lh(f),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(o++,h=2,r=o>=0?1:r),f=Math.round((l+u+h*Math.pow(10,o))*r)/r;const g=Yt(e.max,f);return n.push({value:g,major:Lh(g),significand:h}),n}class ll extends Rn{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,i){const n=_r.prototype.parse.apply(this,[t,i]);if(n===0){this._zero=!0;return}return dt(n)&&n>0?n:null}determineDataLimits(){const{min:t,max:i}=this.getMinMax(!0);this.min=dt(t)?Math.max(0,t):null,this.max=dt(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!dt(this._userMin)&&(this.min=t===pn(this.min,0)?pn(this.min,-1):pn(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:i}=this.getUserBounds();let n=this.min,s=this.max;const o=a=>n=t?n:a,r=a=>s=i?s:a;n===s&&(n<=0?(o(1),r(10)):(o(pn(n,-1)),r(pn(s,1)))),n<=0&&o(pn(s,-1)),s<=0&&r(pn(n,1)),this.min=n,this.max=s}buildTicks(){const t=this.options,i={min:this._userMin,max:this._userMax},n=Uk(i,this);return t.bounds==="ticks"&&kf(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(t){return t===void 0?"0":Zs(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=qi(t),this._valueRange=qi(this.max)-qi(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(qi(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const i=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+i*this._valueRange)}}M(ll,"id","logarithmic"),M(ll,"defaults",{ticks:{callback:Rr.formatters.logarithmic,major:{enabled:!0}}});function cl(e){const t=e.ticks;if(t.display&&e.display){const i=Lt(t.backdropPadding);return Ie(t.font&&t.font.size,pt.font.size)+i.height}return 0}function zk(e,t,i){return i=it(i)?i:[i],{w:JS(e,t.string,i),h:i.length*t.lineHeight}}function Dh(e,t,i,n,s){return e===n||e===s?{start:t-i/2,end:t+i/2}:e<n||e>s?{start:t-i,end:t}:{start:t,end:t+i}}function Wk(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},i=Object.assign({},t),n=[],s=[],o=e._pointLabels.length,r=e.options.pointLabels,a=r.centerPointLabels?ct/o:0;for(let l=0;l<o;l++){const c=r.setContext(e.getPointLabelContext(l));s[l]=c.padding;const u=e.getPointPosition(l,e.drawingArea+s[l],a),h=yt(c.font),f=zk(e.ctx,h,e._pointLabels[l]);n[l]=f;const g=Jt(e.getIndexAngle(l)+a),_=Math.round(Kl(g)),b=Dh(_,u.x,f.w,0,180),v=Dh(_,u.y,f.h,90,270);Gk(i,t,g,b,v)}e.setCenterPoint(t.l-i.l,i.r-t.r,t.t-i.t,i.b-t.b),e._pointLabelItems=Vk(e,n,s)}function Gk(e,t,i,n,s){const o=Math.abs(Math.sin(i)),r=Math.abs(Math.cos(i));let a=0,l=0;n.start<t.l?(a=(t.l-n.start)/o,e.l=Math.min(e.l,t.l-a)):n.end>t.r&&(a=(n.end-t.r)/o,e.r=Math.max(e.r,t.r+a)),s.start<t.t?(l=(t.t-s.start)/r,e.t=Math.min(e.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/r,e.b=Math.max(e.b,t.b+l))}function Vk(e,t,i){const n=[],s=e._pointLabels.length,o=e.options,r=cl(o)/2,a=e.drawingArea,l=o.pointLabels.centerPointLabels?ct/s:0;for(let c=0;c<s;c++){const u=e.getPointPosition(c,a+r+i[c],l),h=Math.round(Kl(Jt(u.angle+ft))),f=t[c],g=qk(u.y,f.h,h),_=jk(h),b=Kk(u.x,f.w,_);n.push({x:u.x,y:g,textAlign:_,left:b,top:g,right:b+f.w,bottom:g+f.h})}return n}function jk(e){return e===0||e===180?"center":e<180?"left":"right"}function Kk(e,t,i){return i==="right"?e-=t:i==="center"&&(e-=t/2),e}function qk(e,t,i){return i===90||i===270?e-=t/2:(i>270||i<90)&&(e-=t),e}function Yk(e,t){const{ctx:i,options:{pointLabels:n}}=e;for(let s=t-1;s>=0;s--){const o=n.setContext(e.getPointLabelContext(s)),r=yt(o.font),{x:a,y:l,textAlign:c,left:u,top:h,right:f,bottom:g}=e._pointLabelItems[s],{backdropColor:_}=o;if(!Ue(_)){const b=Cn(o.borderRadius),v=Lt(o.backdropPadding);i.fillStyle=_;const y=u-v.left,E=h-v.top,w=f-u+v.width,P=g-h+v.height;Object.values(b).some(A=>A!==0)?(i.beginPath(),Gs(i,{x:y,y:E,w,h:P,radius:b}),i.fill()):i.fillRect(y,E,w,P)}Tn(i,e._pointLabels[s],a,l+r.lineHeight/2,r,{color:o.color,textAlign:c,textBaseline:"middle"})}}function mp(e,t,i,n){const{ctx:s}=e;if(i)s.arc(e.xCenter,e.yCenter,t,0,nt);else{let o=e.getPointPosition(0,t);s.moveTo(o.x,o.y);for(let r=1;r<n;r++)o=e.getPointPosition(r,t),s.lineTo(o.x,o.y)}}function Xk(e,t,i,n,s){const o=e.ctx,r=t.circular,{color:a,lineWidth:l}=t;!r&&!n||!a||!l||i<0||(o.save(),o.strokeStyle=a,o.lineWidth=l,o.setLineDash(s.dash),o.lineDashOffset=s.dashOffset,o.beginPath(),mp(e,i,r,n),o.closePath(),o.stroke(),o.restore())}function Jk(e,t,i){return an(e,{label:i,index:t,type:"pointLabel"})}class ys extends _r{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Lt(cl(this.options)/2),i=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+i/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(i,n)/2)}determineDataLimits(){const{min:t,max:i}=this.getMinMax(!1);this.min=dt(t)&&!isNaN(t)?t:0,this.max=dt(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/cl(this.options))}generateTickLabels(t){_r.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((i,n)=>{const s=Ze(this.options.pointLabels.callback,[i,n],this);return s||s===0?s:""}).filter((i,n)=>this.chart.getDataVisibility(n))}fit(){const t=this.options;t.display&&t.pointLabels.display?Wk(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,i,n,s){this.xCenter+=Math.floor((t-i)/2),this.yCenter+=Math.floor((n-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,i,n,s))}getIndexAngle(t){const i=nt/(this._pointLabels.length||1),n=this.options.startAngle||0;return Jt(t*i+di(n))}getDistanceFromCenterForValue(t){if(Ue(t))return NaN;const i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*i:(t-this.min)*i}getValueForDistanceFromCenter(t){if(Ue(t))return NaN;const i=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(t){const i=this._pointLabels||[];if(t>=0&&t<i.length){const n=i[t];return Jk(this.getContext(),t,n)}}getPointPosition(t,i,n=0){const s=this.getIndexAngle(t)-ft+n;return{x:Math.cos(s)*i+this.xCenter,y:Math.sin(s)*i+this.yCenter,angle:s}}getPointPositionForValue(t,i){return this.getPointPosition(t,this.getDistanceFromCenterForValue(i))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:i,top:n,right:s,bottom:o}=this._pointLabelItems[t];return{left:i,top:n,right:s,bottom:o}}drawBackground(){const{backgroundColor:t,grid:{circular:i}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),mp(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,i=this.options,{angleLines:n,grid:s,border:o}=i,r=this._pointLabels.length;let a,l,c;if(i.pointLabels.display&&Yk(this,r),s.display&&this.ticks.forEach((u,h)=>{if(h!==0){l=this.getDistanceFromCenterForValue(u.value);const f=this.getContext(h),g=s.setContext(f),_=o.setContext(f);Xk(this,g,l,r,_)}}),n.display){for(t.save(),a=r-1;a>=0;a--){const u=n.setContext(this.getPointLabelContext(a)),{color:h,lineWidth:f}=u;!f||!h||(t.lineWidth=f,t.strokeStyle=h,t.setLineDash(u.borderDash),t.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,i=this.options,n=i.ticks;if(!n.display)return;const s=this.getIndexAngle(0);let o,r;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&!i.reverse)return;const c=n.setContext(this.getContext(l)),u=yt(c.font);if(o=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=u.string,r=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const h=Lt(c.backdropPadding);t.fillRect(-r/2-h.left,-o-u.size/2-h.top,r+h.width,u.size+h.height)}Tn(t,a.label,0,-o,u,{color:c.color})}),t.restore()}drawTitle(){}}M(ys,"id","radialLinear"),M(ys,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Rr.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),M(ys,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),M(ys,"descriptors",{angleLines:{_fallback:"grid"}});const Br={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},jt=Object.keys(Br);function Qk(e,t){return e-t}function Fh(e,t){if(Ue(t))return null;const i=e._adapter,{parser:n,round:s,isoWeekday:o}=e._parseOpts;let r=t;return typeof n=="function"&&(r=n(r)),dt(r)||(r=typeof n=="string"?i.parse(r,n):i.parse(r)),r===null?null:(s&&(r=s==="week"&&(Qn(o)||o===!0)?i.startOf(r,"isoWeek",o):i.startOf(r,s)),+r)}function $h(e,t,i,n){const s=jt.length;for(let o=jt.indexOf(e);o<s-1;++o){const r=Br[jt[o]],a=r.steps?r.steps:Number.MAX_SAFE_INTEGER;if(r.common&&Math.ceil((i-t)/(a*r.size))<=n)return jt[o]}return jt[s-1]}function Zk(e,t,i,n,s){for(let o=jt.length-1;o>=jt.indexOf(i);o--){const r=jt[o];if(Br[r].common&&e._adapter.diff(s,n,r)>=t-1)return r}return jt[i?jt.indexOf(i):0]}function eI(e){for(let t=jt.indexOf(e)+1,i=jt.length;t<i;++t)if(Br[jt[t]].common)return jt[t]}function Hh(e,t,i){if(!i)e[t]=!0;else if(i.length){const{lo:n,hi:s}=ql(i,t),o=i[n]>=t?i[n]:i[s];e[o]=!0}}function tI(e,t,i,n){const s=e._adapter,o=+s.startOf(t[0].value,n),r=t[t.length-1].value;let a,l;for(a=o;a<=r;a=+s.add(a,1,n))l=i[a],l>=0&&(t[l].major=!0);return t}function Uh(e,t,i){const n=[],s={},o=t.length;let r,a;for(r=0;r<o;++r)a=t[r],s[a]=r,n.push({value:a,major:!1});return o===0||!i?n:tI(e,n,s,i)}class Ks extends Rn{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,i={}){const n=t.time||(t.time={}),s=this._adapter=new fE._date(t.adapters.date);s.init(i),Ps(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=i.normalized}parse(t,i){return t===void 0?null:Fh(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,i=this._adapter,n=t.time.unit||"day";let{min:s,max:o,minDefined:r,maxDefined:a}=this.getUserBounds();function l(c){!r&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!a&&!isNaN(c.max)&&(o=Math.max(o,c.max))}(!r||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=dt(s)&&!isNaN(s)?s:+i.startOf(Date.now(),n),o=dt(o)&&!isNaN(o)?o:+i.endOf(Date.now(),n)+1,this.min=Math.min(s,o-1),this.max=Math.max(s+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(i=t[0],n=t[t.length-1]),{min:i,max:n}}buildTicks(){const t=this.options,i=t.time,n=t.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const o=this.min,r=this.max,a=FS(s,o,r);return this._unit=i.unit||(n.autoSkip?$h(i.minUnit,this.min,this.max,this._getLabelCapacity(o)):Zk(this,a.length,i.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:eI(this._unit),this.initOffsets(s),t.reverse&&a.reverse(),Uh(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let i=0,n=0,s,o;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?i=1-s:i=(this.getDecimalForValue(t[1])-s)/2,o=this.getDecimalForValue(t[t.length-1]),t.length===1?n=o:n=(o-this.getDecimalForValue(t[t.length-2]))/2);const r=t.length<3?.5:.25;i=Et(i,0,r),n=Et(n,0,r),this._offsets={start:i,end:n,factor:1/(i+1+n)}}_generate(){const t=this._adapter,i=this.min,n=this.max,s=this.options,o=s.time,r=o.unit||$h(o.minUnit,i,n,this._getLabelCapacity(i)),a=Ie(s.ticks.stepSize,1),l=r==="week"?o.isoWeekday:!1,c=Qn(l)||l===!0,u={};let h=i,f,g;if(c&&(h=+t.startOf(h,"isoWeek",l)),h=+t.startOf(h,c?"day":r),t.diff(n,i,r)>1e5*a)throw new Error(i+" and "+n+" are too far apart with stepSize of "+a+" "+r);const _=s.ticks.source==="data"&&this.getDataTimestamps();for(f=h,g=0;f<n;f=+t.add(f,a,r),g++)Hh(u,f,_);return(f===n||s.bounds==="ticks"||g===1)&&Hh(u,f,_),Object.keys(u).sort((b,v)=>b-v).map(b=>+b)}getLabelForValue(t){const i=this._adapter,n=this.options.time;return n.tooltipFormat?i.format(t,n.tooltipFormat):i.format(t,n.displayFormats.datetime)}format(t,i){const s=this.options.time.displayFormats,o=this._unit,r=i||s[o];return this._adapter.format(t,r)}_tickFormatFunction(t,i,n,s){const o=this.options,r=o.ticks.callback;if(r)return Ze(r,[t,i,n],this);const a=o.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],h=c&&a[c],f=n[i],g=c&&h&&f&&f.major;return this._adapter.format(t,s||(g?h:u))}generateTickLabels(t){let i,n,s;for(i=0,n=t.length;i<n;++i)s=t[i],s.label=this._tickFormatFunction(s.value,i,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const i=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((i.start+n)*i.factor)}getValueForPixel(t){const i=this._offsets,n=this.getDecimalForPixel(t)/i.factor-i.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const i=this.options.ticks,n=this.ctx.measureText(t).width,s=di(this.isHorizontal()?i.maxRotation:i.minRotation),o=Math.cos(s),r=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:n*o+a*r,h:n*r+a*o}}_getLabelCapacity(t){const i=this.options.time,n=i.displayFormats,s=n[i.unit]||n.millisecond,o=this._tickFormatFunction(t,0,Uh(this,[t],this._majorUnit),s),r=this._getLabelSize(o),a=Math.floor(this.isHorizontal()?this.width/r.w:this.height/r.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],i,n;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(i=0,n=s.length;i<n;++i)t=t.concat(s[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let i,n;if(t.length)return t;const s=this.getLabels();for(i=0,n=s.length;i<n;++i)t.push(Fh(this,s[i]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Af(t.sort(Qk))}}M(Ks,"id","time"),M(Ks,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Eo(e,t,i){let n=0,s=e.length-1,o,r,a,l;i?(t>=e[n].pos&&t<=e[s].pos&&({lo:n,hi:s}=Hi(e,"pos",t)),{pos:o,time:a}=e[n],{pos:r,time:l}=e[s]):(t>=e[n].time&&t<=e[s].time&&({lo:n,hi:s}=Hi(e,"time",t)),{time:o,pos:a}=e[n],{time:r,pos:l}=e[s]);const c=r-o;return c?a+(l-a)*(t-o)/c:a}class ul extends Ks{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(t);this._minPos=Eo(i,this.min),this._tableRange=Eo(i,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:i,max:n}=this,s=[],o=[];let r,a,l,c,u;for(r=0,a=t.length;r<a;++r)c=t[r],c>=i&&c<=n&&s.push(c);if(s.length<2)return[{time:i,pos:0},{time:n,pos:1}];for(r=0,a=s.length;r<a;++r)u=s[r+1],l=s[r-1],c=s[r],Math.round((u+l)/2)!==c&&o.push({time:c,pos:r/(a-1)});return o}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const i=this.getDataTimestamps(),n=this.getLabelTimestamps();return i.length&&n.length?t=this.normalize(i.concat(n)):t=i.length?i:n,t=this._cache.all=t,t}getDecimalForValue(t){return(Eo(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const i=this._offsets,n=this.getDecimalForPixel(t)/i.factor-i.end;return Eo(this._table,n*this._tableRange+this._minPos,!0)}}M(ul,"id","timeseries"),M(ul,"defaults",Ks.defaults);var iI=Object.freeze({__proto__:null,CategoryScale:rl,LinearScale:al,LogarithmicScale:ll,RadialLinearScale:ys,TimeScale:Ks,TimeSeriesScale:ul});const nI=[dE,U8,Lk,iI],zh=1e6,sc=2e3,bp=-sc;function sI(e){switch(e){case 0:return ve.sente;case 1:return ve.gote;case 2:return ve.research;case 3:return ve.research+"2";case 4:return ve.research+"3";case 5:return ve.research+"4"}}function oI(e,t){const i=e.customData;if(i)switch(t){case 0:return e.nextColor===L.BLACK?void 0:i.playerSearchInfo;case 1:return e.nextColor===L.WHITE?void 0:i.playerSearchInfo;case 2:return i.researchInfo;case 3:return i.researchInfo2;case 4:return i.researchInfo3;case 5:return i.researchInfo4}}function Wh(e,t,i){const n=e.score!==void 0?e.score:e.mate!==void 0?e.mate>0?zh:-zh:void 0;if(n!==void 0)switch(t){case yr.RAW:return Math.min(Math.max(n,bp),sc);case yr.WIN_RATE:return Va(n,i)}}function rI(e){switch(e){default:return{main:"black",ticks:"dimgray",grid:"lightgray",head:"red",blackPlayer:"#1480C9",whitePlayer:"#FB7D00",researcher:"#349393",researcher2:"#FF1F4E",researcher3:"#6C22FF",researcher4:"#FFB912"};case xl.DARK:return{main:"white",ticks:"darkgray",grid:"dimgray",head:"red",blackPlayer:"#36A2EB",whitePlayer:"#FF9F40",researcher:"#4BC0C0",researcher2:"#FF6384",researcher3:"#9966FF",researcher4:"#FFCD56"}}}var yr=(e=>(e.RAW="raw",e.WIN_RATE="winRate",e))(yr||{});const aI=Ge({name:"EvaluationChart",props:{size:{type:Ct,required:!0},type:{type:String,required:!0}},setup(e){const t=W(null),i=ot();let n,s=sc,o=bp;e.type==="winRate"&&(s=100,o=0);const r=(g,_,b,v)=>{const y=[],E=b.moves;for(const P of E){const A=oI(P,_);if(!A)continue;const O=Wh(A,e.type,v.coefficientInSigmoid);O!==void 0&&y.push({x:P.number,y:O})}const w=E[E.length-1];if(_===0&&w.nextColor===L.BLACK||_===1&&w.nextColor===L.WHITE){const P=w.customData;if(P&&P.opponentSearchInfo){const A=Wh(P.opponentSearchInfo,e.type,v.coefficientInSigmoid);A!==void 0&&y.push({x:w.number+1,y:A})}}return{label:sI(_),borderColor:g,data:y,showLine:!0}},a=(g,_)=>({label:ve.currentPosition,borderColor:_.head,data:[{x:g.current.number,y:s},{x:g.current.number,y:o}],showLine:!0,pointBorderWidth:0,pointRadius:0}),l=(g,_,b)=>{const v=[{borderColor:b.blackPlayer,type:0},{borderColor:b.whitePlayer,type:1},{borderColor:b.researcher,type:2},{borderColor:b.researcher2,type:3},{borderColor:b.researcher3,type:4},{borderColor:b.researcher4,type:5}],y=[a(g,b)];for(const E of v){const w=r(E.borderColor,E.type,g,_);w.data.length>0&&y.push(w)}return y},c=(g,_)=>({x:{min:0,max:g.length+10,ticks:{color:_.ticks},grid:{color:_.grid}},y:{min:o,max:s,ticks:{color:_.ticks},grid:{color:_.grid}}}),u=(g,_)=>{const b=rI(_.thema);n.data.datasets=l(g,_,b),n.options.color=b.main,n.options.scales=c(g,b),n.update()},h=(g,_,b)=>{if(g.x===null)return;const v=b.scales.x.max-b.scales.x.min,y=b.scales.x.right-b.scales.x.left,E=(g.x-b.scales.x.left)/y*v+b.scales.x.min,w=Math.round(E);i.changePly(w)};st(()=>{const g=$e(),b=t.value.getContext("2d");n=new Bi(b,{type:"scatter",data:{datasets:[]},options:{animation:{duration:0},responsive:!0,maintainAspectRatio:!1,events:["click"],onClick:h}}),n.draw(),u(i.record,g),In(()=>[i.record,g],([v,y])=>u(v,y),{deep:!0})}),Js(()=>{n.destroy()});const f=Me(()=>({height:`${e.size.height}px`,width:`${e.size.width}px`}));return{canvas:t,style:f}}});const lI={ref:"canvas"};function cI(e,t,i,n,s,o){return R(),B("div",null,[p("div",{class:"root",style:Fe(e.style)},[p("canvas",lI,null,512)],4)])}const uI=Ve(aI,[["render",cI],["__scopeId","data-v-8337afe5"]]),hI=Ge({name:"RecordComment",props:{size:{type:Ct,required:!0}},setup(){const e=W(null),t=ot(),i=Me(()=>Object.values(ue).map(s=>{const o=t.record.metadata;return{key:s,displayName:I0(s),value:o.getStandardMetadata(s)||""}}));return st(()=>{e.value.addEventListener("copy",s=>{s.stopPropagation()}),e.value.addEventListener("paste",s=>{s.stopPropagation()})}),{t:ve,root:e,store:t,list:i,change:(s,o)=>{const r=s.target;t.updateStandardRecordMetadata({key:o,value:r.value})}}}});const dI={class:"element"},fI={class:"key"},pI={class:"value"},gI={class:"key"},mI=["value","onInput"];function bI(e,t,i,n,s,o){return R(),B("div",null,[p("div",{ref:"root",class:"root",style:Fe({height:`${e.size.height}px`})},[p("div",dI,[p("div",fI,k(e.t.file),1),p("div",pI,k(e.store.recordFilePath||e.t.newRecordWithBrackets),1)]),(R(!0),B(Ce,null,Ye(e.list,r=>(R(),B("div",{key:r.key,class:"element"},[p("div",gI,k(r.displayName),1),p("input",{class:"value",value:r.value,onInput:a=>e.change(a,r.key)},null,40,mI)]))),128))],4)])}const _I=Ve(hI,[["render",bI],["__scopeId","data-v-f3ebff5f"]]),zo=30,yI=Ge({name:"TabPane",components:{RecordComment:nv,EngineAnalytics:tS,EvaluationChart:uI,RecordInfo:_I,ButtonIcon:Bt},props:{size:{type:Ct,required:!0},visibleTabs:{type:Array,required:!0},activeTab:{type:String,required:!0},displayMinimizeToggle:{type:Boolean,required:!1}},emits:["onChangeTab","onMinimize"],setup(e,{emit:t}){const i=r=>t("onChangeTab",r),n=()=>t("onMinimize"),s=Me(()=>e.size.reduce(new Ct(0,zo))),o={[$t.RECORD_INFO]:{title:ve.recordProperties,icon:tt.DESCRIPTION},[$t.COMMENT]:{title:ve.comments,icon:tt.COMMENT},[$t.SEARCH]:{title:ve.searchLog,icon:tt.BRAIN},[$t.PV]:{title:ve.pv,icon:tt.PV},[$t.CHART]:{title:ve.evaluation,icon:tt.CHART},[$t.PERCENTAGE_CHART]:{title:ve.estimatedWinRate,icon:tt.PERCENT},[$t.INVISIBLE]:{title:ve.hideTabView,icon:tt.ARROW_DROP}};return{t:ve,contentSize:s,changeSelect:i,minimize:n,tabs:o,Tab:$t,Icon:tt,EvaluationChartType:yr}}});const vI={class:"tabs"},SI=["onClick"],wI={class:"tab-contents"};function EI(e,t,i,n,s,o){const r=ye("ButtonIcon"),a=ye("RecordInfo"),l=ye("RecordComment"),c=ye("EngineAnalytics"),u=ye("EvaluationChart");return R(),B("div",null,[p("div",{class:"root",style:Fe({width:`${e.size.width}px`})},[p("div",vI,[(R(!0),B(Ce,null,Ye(e.visibleTabs,h=>(R(),B("div",{key:h,class:Zt(["tab",{selected:e.activeTab===h}]),onClick:f=>e.changeSelect(h)},[Y(r,{class:"icon",icon:e.tabs[h].icon},null,8,["icon"]),Qe(" "+k(e.tabs[h].title),1)],10,SI))),128)),e.displayMinimizeToggle?(R(),B("div",{key:0,class:"tab end",onClick:t[0]||(t[0]=(...h)=>e.minimize&&e.minimize(...h))},[Y(r,{class:"icon",icon:e.Icon.ARROW_DROP},null,8,["icon"]),Qe(" "+k(e.t.hideTabView),1)])):re("",!0)]),p("div",wI,[e.activeTab===e.Tab.RECORD_INFO?(R(),je(a,{key:0,class:"tab-content",size:e.contentSize},null,8,["size"])):re("",!0),e.activeTab===e.Tab.COMMENT?(R(),je(l,{key:1,class:"tab-content"})):re("",!0),e.activeTab===e.Tab.SEARCH?(R(),je(c,{key:2,class:"tab-content",size:e.contentSize,"history-mode":!0},null,8,["size"])):re("",!0),e.activeTab===e.Tab.PV?(R(),je(c,{key:3,class:"tab-content",size:e.contentSize,"history-mode":!1},null,8,["size"])):re("",!0),e.activeTab===e.Tab.CHART?(R(),je(u,{key:4,class:"tab-content",size:e.contentSize,type:e.EvaluationChartType.RAW},null,8,["size","type"])):re("",!0),e.activeTab===e.Tab.PERCENTAGE_CHART?(R(),je(u,{key:5,class:"tab-content",size:e.contentSize,type:e.EvaluationChartType.WIN_RATE},null,8,["size","type"])):re("",!0)])],4)])}const kI=Ve(yI,[["render",EI],["__scopeId","data-v-8bbb4b99"]]);class Ea{constructor(){M(this,"func");M(this,"timeout")}after(t,i){this.func=t,!this.timeout&&(this.timeout=setTimeout(this.invoke.bind(this),i))}invoke(){this.func&&this.func(),this.clear()}clear(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.func=void 0}}const II={name:"splitpanes",emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click"],props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce((e,t)=>(e[t.id]=t)&&e,{})}},methods:{updatePaneComponents(){this.panes.forEach(e=>{e.update&&e.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[e.id].size}%`})})},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(e,t){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=t},onMouseMove(e){this.touch.mouseDown&&(e.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(e)),this.$emit("resize",this.panes.map(t=>({min:t.min,max:t.max,size:t.size}))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map(e=>({min:e.min,max:e.max,size:e.size}))),this.touch.mouseDown=!1,setTimeout(()=>{this.touch.dragging=!1,this.unbindEvents()},100)},onSplitterClick(e,t){"ontouchstart"in window&&(e.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===t?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(e,t),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=t,this.splitterTaps.timeoutId=setTimeout(()=>{this.splitterTaps.splitter=null},500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[t])},onSplitterDblClick(e,t){let i=0;this.panes=this.panes.map((n,s)=>(n.size=s===t?n.max:n.min,s!==t&&(i+=n.min),n)),this.panes[t].size-=i,this.$emit("pane-maximize",this.panes[t]),this.$emit("resized",this.panes.map(n=>({min:n.min,max:n.max,size:n.size})))},onPaneClick(e,t){this.$emit("pane-click",this.indexedPanes[t])},getCurrentMouseDrag(e){const t=this.container.getBoundingClientRect(),{clientX:i,clientY:n}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:i-t.left,y:n-t.top}},getCurrentDragPercentage(e){e=e[this.horizontal?"y":"x"];const t=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(e=t-e),e*100/t},calculatePanesSize(e){const t=this.touch.activeSplitter;let i={prevPanesSize:this.sumPrevPanesSize(t),nextPanesSize:this.sumNextPanesSize(t),prevReachedMinPanes:0,nextReachedMinPanes:0};const n=0+(this.pushOtherPanes?0:i.prevPanesSize),s=100-(this.pushOtherPanes?0:i.nextPanesSize),o=Math.max(Math.min(this.getCurrentDragPercentage(e),s),n);let r=[t,t+1],a=this.panes[r[0]]||null,l=this.panes[r[1]]||null;const c=a.max<100&&o>=a.max+i.prevPanesSize,u=l.max<100&&o<=100-(l.max+this.sumNextPanesSize(t+1));if(c||u){c?(a.size=a.max,l.size=Math.max(100-a.max-i.prevPanesSize-i.nextPanesSize,0)):(a.size=Math.max(100-l.max-i.prevPanesSize-this.sumNextPanesSize(t+1),0),l.size=l.max);return}if(this.pushOtherPanes){const h=this.doPushOtherPanes(i,o);if(!h)return;({sums:i,panesToResize:r}=h),a=this.panes[r[0]]||null,l=this.panes[r[1]]||null}a!==null&&(a.size=Math.min(Math.max(o-i.prevPanesSize-i.prevReachedMinPanes,a.min),a.max)),l!==null&&(l.size=Math.min(Math.max(100-o-i.nextPanesSize-i.nextReachedMinPanes,l.min),l.max))},doPushOtherPanes(e,t){const i=this.touch.activeSplitter,n=[i,i+1];return t<e.prevPanesSize+this.panes[n[0]].min&&(n[0]=this.findPrevExpandedPane(i).index,e.prevReachedMinPanes=0,n[0]<i&&this.panes.forEach((s,o)=>{o>n[0]&&o<=i&&(s.size=s.min,e.prevReachedMinPanes+=s.min)}),e.prevPanesSize=this.sumPrevPanesSize(n[0]),n[0]===void 0)?(e.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach((s,o)=>{o>0&&o<=i&&(s.size=s.min,e.prevReachedMinPanes+=s.min)}),this.panes[n[1]].size=100-e.prevReachedMinPanes-this.panes[0].min-e.prevPanesSize-e.nextPanesSize,null):t>100-e.nextPanesSize-this.panes[n[1]].min&&(n[1]=this.findNextExpandedPane(i).index,e.nextReachedMinPanes=0,n[1]>i+1&&this.panes.forEach((s,o)=>{o>i&&o<n[1]&&(s.size=s.min,e.nextReachedMinPanes+=s.min)}),e.nextPanesSize=this.sumNextPanesSize(n[1]-1),n[1]===void 0)?(e.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach((s,o)=>{o<this.panesCount-1&&o>=i+1&&(s.size=s.min,e.nextReachedMinPanes+=s.min)}),this.panes[n[0]].size=100-e.prevPanesSize-e.nextReachedMinPanes-this.panes[this.panesCount-1].min-e.nextPanesSize,null):{sums:e,panesToResize:n}},sumPrevPanesSize(e){return this.panes.reduce((t,i,n)=>t+(n<e?i.size:0),0)},sumNextPanesSize(e){return this.panes.reduce((t,i,n)=>t+(n>e+1?i.size:0),0)},findPrevExpandedPane(e){return[...this.panes].reverse().find(t=>t.index<e&&t.size>t.min)||{}},findNextExpandedPane(e){return this.panes.find(t=>t.index>e+1&&t.size>t.min)||{}},checkSplitpanesNodes(){Array.from(this.container.children).forEach(e=>{const t=e.classList.contains("splitpanes__pane"),i=e.classList.contains("splitpanes__splitter");!t&&!i&&(e.parentNode.removeChild(e),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))})},addSplitter(e,t,i=!1){const n=e-1,s=document.createElement("div");s.classList.add("splitpanes__splitter"),i||(s.onmousedown=o=>this.onMouseDown(o,n),typeof window<"u"&&"ontouchstart"in window&&(s.ontouchstart=o=>this.onMouseDown(o,n)),s.onclick=o=>this.onSplitterClick(o,n+1)),this.dblClickSplitter&&(s.ondblclick=o=>this.onSplitterDblClick(o,n+1)),t.parentNode.insertBefore(s,t)},removeSplitter(e){e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.parentNode.removeChild(e)},redoSplitters(){const e=Array.from(this.container.children);e.forEach(i=>{i.className.includes("splitpanes__splitter")&&this.removeSplitter(i)});let t=0;e.forEach(i=>{i.className.includes("splitpanes__pane")&&(!t&&this.firstSplitter?this.addSplitter(t,i,!0):t&&this.addSplitter(t,i),t++)})},requestUpdate({target:e,...t}){const i=this.indexedPanes[e._.uid];Object.entries(t).forEach(([n,s])=>i[n]=s)},onPaneAdd(e){let t=-1;Array.from(e.$el.parentNode.children).some(s=>(s.className.includes("splitpanes__pane")&&t++,s===e.$el));const i=parseFloat(e.minSize),n=parseFloat(e.maxSize);this.panes.splice(t,0,{id:e._.uid,index:t,min:isNaN(i)?0:i,max:isNaN(n)?100:n,size:e.size===null?null:parseFloat(e.size),givenSize:e.size,update:e.update}),this.panes.forEach((s,o)=>s.index=o),this.ready&&this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[t]}),this.$emit("pane-add",{index:t,panes:this.panes.map(s=>({min:s.min,max:s.max,size:s.size}))})})},onPaneRemove(e){const t=this.panes.findIndex(n=>n.id===e._.uid),i=this.panes.splice(t,1)[0];this.panes.forEach((n,s)=>n.index=s),this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:{...i,index:t}}),this.$emit("pane-remove",{removed:i,panes:this.panes.map(n=>({min:n.min,max:n.max,size:n.size}))})})},resetPaneSizes(e={}){!e.addedPane&&!e.removedPane?this.initialPanesSizing():this.panes.some(t=>t.givenSize!==null||t.min||t.max<100)?this.equalizeAfterAddOrRemove(e):this.equalize(),this.ready&&this.$emit("resized",this.panes.map(t=>({min:t.min,max:t.max,size:t.size})))},equalize(){const e=100/this.panesCount;let t=0;const i=[],n=[];this.panes.forEach(s=>{s.size=Math.max(Math.min(e,s.max),s.min),t-=s.size,s.size>=s.max&&i.push(s.id),s.size<=s.min&&n.push(s.id)}),t>.1&&this.readjustSizes(t,i,n)},initialPanesSizing(){let e=100;const t=[],i=[];let n=0;this.panes.forEach(o=>{e-=o.size,o.size!==null&&n++,o.size>=o.max&&t.push(o.id),o.size<=o.min&&i.push(o.id)});let s=100;e>.1&&(this.panes.forEach(o=>{o.size===null&&(o.size=Math.max(Math.min(e/(this.panesCount-n),o.max),o.min)),s-=o.size}),s>.1&&this.readjustSizes(e,t,i))},equalizeAfterAddOrRemove({addedPane:e,removedPane:t}={}){let i=100/this.panesCount,n=0;const s=[],o=[];e&&e.givenSize!==null&&(i=(100-e.givenSize)/(this.panesCount-1)),this.panes.forEach(r=>{n-=r.size,r.size>=r.max&&s.push(r.id),r.size<=r.min&&o.push(r.id)}),!(Math.abs(n)<.1)&&(this.panes.forEach(r=>{e&&e.givenSize!==null&&e.id===r.id||(r.size=Math.max(Math.min(i,r.max),r.min)),n-=r.size,r.size>=r.max&&s.push(r.id),r.size<=r.min&&o.push(r.id)}),n>.1&&this.readjustSizes(n,s,o))},readjustSizes(e,t,i){let n;e>0?n=e/(this.panesCount-t.length):n=e/(this.panesCount-i.length),this.panes.forEach((s,o)=>{if(e>0&&!t.includes(s.id)){const r=Math.max(Math.min(s.size+n,s.max),s.min),a=r-s.size;e-=a,s.size=r}else if(!i.includes(s.id)){const r=Math.max(Math.min(s.size+n,s.max),s.min),a=r-s.size;e-=a,s.size=r}s.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[s.id].size}%`})}),Math.abs(e)>.1&&this.$nextTick(()=>{this.ready&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(e){[...this.container.querySelectorAll(".splitpanes__splitter")].forEach((t,i)=>{t.ondblclick=e?n=>this.onSplitterDblClick(n,i):void 0})}},beforeUnmount(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.$emit("ready"),this.ready=!0},render(){return ym("div",{ref:"container",class:["splitpanes",`splitpanes--${this.horizontal?"horizontal":"vertical"}`,{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default())}},PI=(e,t)=>{const i=e.__vccOpts||e;for(const[n,s]of t)i[n]=s;return i},AI={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:null},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeUnmount(){this.onPaneRemove(this)},methods:{update(e){this.style=e}},computed:{sizeNumber(){return this.size||this.size===0?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(e){this.requestUpdate({target:this,size:e})},minSizeNumber(e){this.requestUpdate({target:this,min:e})},maxSizeNumber(e){this.requestUpdate({target:this,max:e})}}};function CI(e,t,i,n,s,o){return R(),B("div",{class:"splitpanes__pane",onClick:t[0]||(t[0]=r=>o.onPaneClick(r,e._.uid)),style:Fe(e.style)},[Ra(e.$slots,"default")],4)}const xI=PI(AI,[["render",CI]]);const ka=8,gn=10,Ia=100,MI=Ge({name:"StandardLayout",components:{BoardPane:my,RecordPane:Qy,TabPane:kI,Splitpanes:II,Pane:xI,ButtonIcon:Bt},setup(){const e=$e(),t=Ci(new Ct(window.innerWidth,window.innerHeight)),i=W(e.topPaneHeightPercentage),n=W(e.bottomLeftPaneWidthPercentage),s=Ci(new Ct(0,0)),o=new Ea,r=()=>{o.after(()=>{t.width=window.innerWidth,t.height=window.innerHeight},Ia)};st(()=>{window.addEventListener("resize",r)}),Js(()=>{window.removeEventListener("resize",r)});const a=G=>{s.width=G.width,s.height=G.height},l=G=>{e.updateAppSetting(G).catch(Q=>{fe.log(mt.WARN,"StandardLayout: failed to update app setting: "+Dd(Q))})},c=G=>{l({tab:G})},u=G=>{l({tab2:G})},h=()=>{i.value=100,l({topPaneHeightPercentage:100})},f=()=>{const G=Math.min(e.topPanePreviousHeightPercentage,(t.height-zo*2-ka)/t.height*100);i.value=G,l({topPaneHeightPercentage:G})},g=new Ea,_=G=>{const Q=G[0].size;g.after(()=>{i.value=Q},Ia)},b=G=>{g.clear();const Q=G[0].size;i.value=Q,l({topPaneHeightPercentage:Q})},v=new Ea,y=G=>{const Q=G[0].size;v.after(()=>{n.value=Q},Ia)},E=G=>{v.clear();const Q=G[0].size;n.value=Q,l({bottomLeftPaneWidthPercentage:Q})},w=Me(()=>t.height*U.value/100>=zo),P=Me(()=>new Ct(Math.max(t.width-Hy-gn*2,0),Math.max((t.height-ka)*(i.value/100)-gn*2-(w.value?0:zo),0))),A=Me(()=>({margin:`${gn}px`})),O=Me(()=>{const G=t.width-s.width-gn*3,Q=s.height;return{margin:`${gn}px ${gn}px ${gn}px 0`,width:`${G}px`,height:`${Q}px`}}),U=Me(()=>100-i.value),z=Me(()=>new Ct(e.tabPaneType===Xo.SINGLE?t.width:(t.width-ka)*(n.value/100),t.height*U.value/100)),te=Me(()=>new Ct(t.width*(1-n.value/100),t.height*U.value/100));return{t:ve,topPaneHeightPercentage:i,bottomPaneHeightPercentage:U,bottomLeftPaneWidthPercentage:n,isBottomPaneVisible:w,boardPaneMaxSize:P,boardPaneStyle:A,recordPaneStyle:O,tabPaneSize:z,tabPaneSize2:te,appSetting:e,onBoardPaneResize:a,onChangeTab:c,onChangeTab2:u,onMinimizeTab:h,onUnhideTabView:f,onResizeMain:_,onResizedMain:b,onResizeBottom:y,onResizedBottom:E,TabPaneType:Xo,Tab:$t,Icon:tt}}});const TI={class:"top-pane"},RI={class:"top-pane-main"};function OI(e,t,i,n,s,o){const r=ye("BoardPane"),a=ye("RecordPane"),l=ye("ButtonIcon"),c=ye("Pane"),u=ye("TabPane"),h=ye("Splitpanes");return R(),B("div",null,[Y(h,{class:"main-frame",horizontal:"","dbl-click-splitter":!1,onResize:e.onResizeMain,onResized:e.onResizedMain},{default:Si(()=>[Y(c,{size:e.topPaneHeightPercentage},{default:Si(()=>[p("div",TI,[p("div",RI,[Y(r,{style:Fe(e.boardPaneStyle),"max-size":e.boardPaneMaxSize,onResize:e.onBoardPaneResize},null,8,["style","max-size","onResize"]),Y(a,{class:"top-right-pane",style:Fe(e.recordPaneStyle)},null,8,["style"])]),e.isBottomPaneVisible?re("",!0):(R(),B("button",{key:0,class:"unhide-tabview-button",onClick:t[0]||(t[0]=(...f)=>e.onUnhideTabView&&e.onUnhideTabView(...f))},[Y(l,{class:"icon",icon:e.Icon.ARROW_UP},null,8,["icon"]),Qe(" "+k(e.t.expandTabView),1)]))])]),_:1},8,["size"]),Y(c,{size:e.bottomPaneHeightPercentage},{default:Si(()=>[e.appSetting.tabPaneType===e.TabPaneType.SINGLE?(R(),je(u,{key:0,class:"tab-pane",size:e.tabPaneSize,"visible-tabs":[e.Tab.RECORD_INFO,e.Tab.COMMENT,e.Tab.SEARCH,e.Tab.PV,e.Tab.CHART,e.Tab.PERCENTAGE_CHART],"active-tab":e.appSetting.tab,"display-minimize-toggle":!0,onOnChangeTab:e.onChangeTab,onOnMinimize:e.onMinimizeTab},null,8,["size","visible-tabs","active-tab","onOnChangeTab","onOnMinimize"])):(R(),je(h,{key:1,class:"bottom-frame",vertical:"","dbl-click-splitter":!1,onResize:e.onResizeBottom,onResized:e.onResizedBottom},{default:Si(()=>[Y(c,{size:e.bottomLeftPaneWidthPercentage},{default:Si(()=>[Y(u,{class:"tab-pane",size:e.tabPaneSize,"visible-tabs":[e.Tab.RECORD_INFO,e.Tab.SEARCH,e.Tab.PV],"active-tab":e.appSetting.tab,onOnChangeTab:e.onChangeTab},null,8,["size","visible-tabs","active-tab","onOnChangeTab"])]),_:1},8,["size"]),Y(c,null,{default:Si(()=>[Y(u,{class:"tab-pane",size:e.tabPaneSize2,"visible-tabs":[e.Tab.COMMENT,e.Tab.CHART,e.Tab.PERCENTAGE_CHART],"active-tab":e.appSetting.tab2,"display-minimize-toggle":!0,onOnChangeTab:e.onChangeTab2,onOnMinimize:e.onMinimizeTab},null,8,["size","visible-tabs","active-tab","onOnChangeTab","onOnMinimize"])]),_:1})]),_:1},8,["onResize","onResized"]))]),_:1},8,["size"])]),_:1},8,["onResize","onResized"])])}const NI=Ve(MI,[["render",OI],["__scopeId","data-v-a30fd9fd"]]);function gt(e){let t=Number(e.value);return e.max&&(t=Math.min(t,Number(e.max))),e.min&&(t=Math.max(t,Number(e.min))),t}const LI=Ge({name:"USIEngineOptionDialog",props:{latestEngineSetting:{type:Object,required:!0},okButtonText:{type:String,required:!1,default:"OK"}},emits:["ok","cancel"],setup(e,t){const i=ot(),n=$e(),s=W(null),o=W(null),r=e.latestEngineSetting,a=W(r),l=Me(()=>Object.values(a.value.options).sort((b,v)=>{const y=b.name.startsWith("USI_"),E=v.name.startsWith("USI_");return y!==E?y?-1:1:b.name<v.name?-1:1}).map((b,v)=>({...b,inputId:"usiEngineOptionDialogOption"+v,value:Sn(b)})));return i.retainBussyState(),st(async()=>{kt(s.value),ei(s.value);try{const b=n.engineTimeoutSeconds;a.value=await fe.getUSIEngineInfo(r.path,b),Ab(a.value,r),o.value.value=a.value.name;for(const v of l.value){const y=co(v.inputId);y&&v.value!==void 0&&(y.value=v.value+"")}}catch(b){i.pushError(b),t.emit("cancel")}finally{i.releaseBussyState()}}),zt(()=>{ti(s.value)}),{t:ve,engine:a,dialog:s,engineNameInput:o,options:l,openEngineDir:()=>{fe.openExplorer(a.value.path)},selectFile:async b=>{i.retainBussyState();try{const v=await fe.showSelectFileDialog(),y=co(b);v&&y&&(y.value=v)}catch(v){i.pushError(v)}finally{i.releaseBussyState()}},sendOption:async b=>{i.retainBussyState();try{const v=n.engineTimeoutSeconds;await fe.sendUSISetOption(a.value.path,b,v)}catch(v){i.pushError(v)}finally{i.releaseBussyState()}},reset:()=>{o.value.value=a.value.defaultName;for(const b of l.value){const v=co(b.inputId);v&&(a.value.options[b.name].default!==void 0?v.value=a.value.options[b.name].default+"":v.value="")}},ok:()=>{a.value.name=o.value.value;for(const b of l.value){const v=co(b.inputId);v&&(a.value.options[b.name].value=v.value?b.type==="spin"?gt(v):v.value:void 0)}t.emit("ok",a.value)},cancel:()=>{t.emit("cancel")}}}});const _p=e=>(qs("data-v-593f25b9"),e=e(),Ys(),e),BI={ref:"dialog"},DI={class:"dialog-title"},FI={class:"dialog-form-area option-list"},$I={class:"option"},HI={class:"option-name"},UI={class:"option-unchangeable"},zI={class:"option"},WI={class:"option-name"},GI={class:"option-unchangeable"},VI={class:"option"},jI={class:"option-name"},KI={class:"option-unchangeable"},qI={class:"option"},YI={class:"option-name"},XI={ref:"engineNameInput",class:"option-value-text",type:"text",name:"ElectronShogiEngineName"},JI={class:"option-name"},QI=["id","min","max","name"],ZI=["id","name"],eP=["id","name"],tP=["onClick"],iP=["id"],nP={value:""},sP=_p(()=>p("option",{value:"true"},"ON",-1)),oP=_p(()=>p("option",{value:"false"},"OFF",-1)),rP=["id"],aP={value:""},lP=["value"],cP=["onClick"],uP={class:"dialog-main-buttons"};function hP(e,t,i,n,s,o){return R(),B("div",null,[p("dialog",BI,[p("div",DI,k(e.t.engineSettings),1),p("div",FI,[p("div",$I,[p("div",HI,k(e.t.engineName),1),p("div",UI,k(e.engine.defaultName),1)]),p("div",zI,[p("div",WI,k(e.t.author),1),p("div",GI,k(e.engine.author),1)]),p("div",VI,[p("div",jI,k(e.t.enginePath),1),p("div",KI,[p("div",null,k(e.engine.path),1),p("button",{class:"dialog-button",onClick:t[0]||(t[0]=(...r)=>e.openEngineDir&&e.openEngineDir(...r))},k(e.t.openDirectory),1)])]),p("div",qI,[p("div",YI,k(e.t.displayName),1),p("input",XI,null,512)]),(R(!0),B(Ce,null,Ye(e.options,r=>(R(),B("div",{key:r.name,class:"option"},[p("div",JI,k(r.name),1),r.type==="spin"?(R(),B("input",{key:0,id:r.inputId,class:"option-value-number",type:"number",min:r.min,max:r.max,step:"1",name:r.name},null,8,QI)):re("",!0),r.type==="string"?(R(),B("input",{key:1,id:r.inputId,class:"option-value-text",type:"text",name:r.name},null,8,ZI)):re("",!0),r.type==="filename"?(R(),B("input",{key:2,id:r.inputId,class:"option-value-filename",type:"text",name:r.name},null,8,eP)):re("",!0),r.type==="filename"?(R(),B("button",{key:3,class:"dialog-button",onClick:a=>e.selectFile(r.inputId)},k(e.t.select),9,tP)):re("",!0),r.type==="check"?(R(),B("select",{key:4,id:r.inputId,class:"option-value-check"},[p("option",nP,k(e.t.defaultValue),1),sP,oP],8,iP)):re("",!0),r.type==="combo"?(R(),B("select",{key:5,id:r.inputId,class:"option-value-combo"},[p("option",aP,k(e.t.defaultValue),1),(R(!0),B(Ce,null,Ye(r.vars,a=>(R(),B("option",{key:a,value:a},k(a),9,lP))),128))],8,rP)):re("",!0),r.type==="button"?(R(),B("button",{key:6,class:"dialog-button",onClick:a=>e.sendOption(r.name)},k(e.t.invoke),9,cP)):re("",!0)]))),128))]),p("button",{class:"dialog-wide-button",onClick:t[1]||(t[1]=r=>e.reset())},k(e.t.resetToEngineDefaultValues),1),p("div",uP,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[2]||(t[2]=r=>e.ok())},k(e.okButtonText),1),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[3]||(t[3]=r=>e.cancel())},k(e.t.cancel),1)])],512)])}const yp=Ve(LI,[["render",hP],["__scopeId","data-v-593f25b9"]]),dP=Ge({name:"PlayerSelector",components:{ButtonIcon:Bt,USIEngineOptionDialog:yp},props:{playerUri:{type:String,required:!0},containsHuman:{type:Boolean,default:!1},engineSettings:{type:Object,required:!0},displayPonderState:{type:Boolean,default:!1},displayThreadState:{type:Boolean,default:!1},displayMultiPvState:{type:Boolean,default:!1}},emits:["select-player","update-engine-setting"],setup(e,t){const i=ot(),n=W(null),s=W(null),o=Me(()=>{if(!ki(e.playerUri))return null;const g=e.engineSettings.getEngine(e.playerUri);return g&&Sn(g.options[of])==="true"?"ON":"OFF"}),r=Me(()=>{if(!ki(e.playerUri))return null;const g=e.engineSettings.getEngine(e.playerUri);return g?Sn(g.options[wb])||Sn(g.options[Eb]):null}),a=Me(()=>{if(!ki(e.playerUri))return null;const g=e.engineSettings.getEngine(e.playerUri);return g?Sn(g.options[Sb])||Sn(g.options[kb]):null}),l=Me(()=>ki(e.playerUri));return{t:ve,playerSelect:n,ponderState:o,threadState:r,multiPVState:a,isPlayerSettingEnabled:l,engineSettingDialog:s,onPlayerChange:()=>{t.emit("select-player",n.value.value)},openPlayerSetting:()=>{if(ki(e.playerUri)){const g=e.engineSettings.getEngine(e.playerUri);if(!g){i.pushError("");return}s.value=g}},savePlayerSetting:async g=>{s.value=null;const _=e.engineSettings.getClone();_.updateEngine(g),i.retainBussyState();try{await fe.saveUSIEngineSetting(_),t.emit("update-engine-setting",_)}catch(b){i.pushError(b)}finally{i.releaseBussyState()}},closePlayerSetting:()=>{s.value=null},Icon:tt,uri:vb}}});const fP={class:"root"},pP=["value"],gP=["value"],mP=["value"],bP={key:0,class:"player-info"},_P={class:"player-info-key"},yP={class:"player-info-value"},vP={key:1,class:"player-info"},SP={class:"player-info-key"},wP={class:"player-info-value"},EP={key:2,class:"player-info"},kP={class:"player-info-key"},IP={class:"player-info-value"},PP=["disabled"];function AP(e,t,i,n,s,o){const r=ye("ButtonIcon"),a=ye("USIEngineOptionDialog");return R(),B(Ce,null,[p("div",null,[p("div",fP,[p("select",{ref:"playerSelect",class:"player-select",size:"1",value:e.playerUri,onChange:t[0]||(t[0]=(...l)=>e.onPlayerChange&&e.onPlayerChange(...l))},[e.containsHuman?(R(),B("option",{key:0,value:e.uri.ES_HUMAN},"",8,gP)):re("",!0),(R(!0),B(Ce,null,Ye(e.engineSettings.engineList,l=>(R(),B("option",{key:l.uri,value:l.uri},k(l.name),9,mP))),128))],40,pP),e.displayPonderState?(R(),B("div",bP,[p("span",_P,k(e.t.ponder)+":",1),p("span",yP,k(e.ponderState||"---"),1)])):re("",!0),e.displayThreadState?(R(),B("div",vP,[p("span",SP,k(e.t.numberOfThreads)+":",1),p("span",wP,k(e.threadState||"---"),1)])):re("",!0),e.displayMultiPvState?(R(),B("div",EP,[p("span",kP,k(e.t.multiPV)+":",1),p("span",IP,k(e.multiPVState||"---"),1)])):re("",!0),p("button",{class:"player-setting",disabled:!e.isPlayerSettingEnabled,onClick:t[1]||(t[1]=(...l)=>e.openPlayerSetting&&e.openPlayerSetting(...l))},[Y(r,{class:"icon",icon:e.Icon.SETTINGS},null,8,["icon"]),Qe(" "+k(e.t.settings),1)],8,PP)])]),e.engineSettingDialog?(R(),je(a,{key:0,"latest-engine-setting":e.engineSettingDialog,"ok-button-text":e.t.save,onOk:e.savePlayerSetting,onCancel:e.closePlayerSetting},null,8,["latest-engine-setting","ok-button-text","onOk","onCancel"])):re("",!0)],64)}const Dr=Ve(dP,[["render",AP],["__scopeId","data-v-cd775422"]]),CP=Ge({name:"GameDialog",components:{ButtonIcon:Bt,PlayerSelector:Dr},setup(){const e=ot(),t=W(null),i=W(null),n=W(null),s=W(null),o=W(null),r=W(null),a=W(null),l=W(null),c=W(null),u=W(null),h=W(null),f=W(null),g=W(null),_=W(ir()),b=W(new Wi),v=W(""),y=W("");e.retainBussyState(),st(async()=>{try{_.value=await fe.loadGameSetting(),b.value=await fe.loadUSIEngineSetting(),v.value=_.value.black.uri,y.value=_.value.white.uri,kt(t.value),ei(t.value)}catch(G){e.pushError(G),e.destroyModalDialog()}finally{e.releaseBussyState()}}),zt(()=>{ti(t.value)});let E=!1;Xs(()=>{E||(i.value.value=Math.floor(_.value.timeLimit.timeSeconds/3600),n.value.value=Math.floor(_.value.timeLimit.timeSeconds/60)%60,s.value.value=_.value.timeLimit.byoyomi,o.value.value=_.value.timeLimit.increment,r.value.value=_.value.startPosition!==void 0?_.value.startPosition:"current",a.value.checked=_.value.enableEngineTimeout,l.value.value=_.value.maxMoves,c.value.checked=_.value.humanIsFront,u.value.value=_.value.repeat,h.value.checked=_.value.swapPlayers,f.value.checked=_.value.enableComment,g.value.checked=_.value.enableAutoSave,E=!0)});const w=G=>{if(ki(G)&&b.value.hasEngine(G)){const Q=b.value.getEngine(G);return{name:Q.name,uri:G,usi:Q}}return{name:"",uri:Qt}};return{t:ve,CommentBehavior:Fi,dialog:t,hours:i,minutes:n,byoyomi:s,increment:o,startPosition:r,enableEngineTimeout:a,maxMoves:l,humanIsFront:c,repeat:u,swapPlayers:h,enableComment:f,enableAutoSave:g,engineSettings:b,blackPlayerURI:v,whitePlayerURI:y,onStart:()=>{const G={black:w(v.value),white:w(y.value),timeLimit:{timeSeconds:(gt(i.value)*60+gt(n.value))*60,byoyomi:gt(s.value),increment:gt(o.value)},startPosition:r.value.value!=="current"?r.value.value:void 0,enableEngineTimeout:a.value.checked,maxMoves:gt(l.value),humanIsFront:c.value.checked,repeat:gt(u.value),swapPlayers:h.value.checked,enableComment:f.value.checked,enableAutoSave:g.value.checked},Q=nr()?rf(G):Tb(G);Q?e.pushError(Q):e.startGame(G)},onCancel:()=>{e.closeModalDialog()},onUpdatePlayerSetting:G=>{b.value=G},onSelectBlackPlayer:G=>{v.value=G},onSelectWhitePlayer:G=>{y.value=G},onSwapColor:()=>{[v.value,y.value]=[y.value,v.value]},Icon:tt}}});const oc=e=>(qs("data-v-8ddf4bc5"),e=e(),Ys(),e),xP={ref:"dialog"},MP={class:"dialog-title"},TP={class:"dialog-form-area"},RP={class:"players"},OP={class:"player"},NP={class:"top-label"},LP={class:"player"},BP={class:"top-label"},DP={class:"players-control"},FP={class:"dialog-form-areas-h"},$P={class:"dialog-form-area time-limit"},HP={class:"top-label"},UP={class:"dialog-form-item"},zP=oc(()=>p("div",{class:"dialog-form-item-label"},"",-1)),WP={ref:"hours",class:"time",type:"number",min:"0",max:"99",step:"1"},GP={class:"dialog-form-item-unit"},VP={ref:"minutes",class:"time",type:"number",min:"0",max:"59",step:"1"},jP={class:"dialog-form-item-unit"},KP={class:"dialog-form-item"},qP=oc(()=>p("div",{class:"dialog-form-item-label"},"",-1)),YP={ref:"byoyomi",class:"time",type:"number",min:"0",max:"60",step:"1"},XP={class:"dialog-form-item-unit"},JP={class:"dialog-form-item"},QP=oc(()=>p("div",{class:"dialog-form-item-label"},"",-1)),ZP={ref:"increment",class:"time",type:"number",min:"0",max:"99",step:"1"},eA={class:"dialog-form-item-unit"},tA={class:"dialog-form-item"},iA={id:"enable-engine-timeout",ref:"enableEngineTimeout",type:"checkbox"},nA={for:"enable-engine-timeout"},sA={class:"dialog-form-area flags"},oA={class:"top-label"},rA={class:"dialog-form-item"},aA={class:"dialog-form-item-label"},lA={ref:"startPosition"},cA={value:"current"},uA={value:"standard"},hA={value:"handicapLance"},dA={value:"handicapRightLance"},fA={value:"handicapBishop"},pA={value:"handicapRook"},gA={value:"handicapRookLance"},mA={value:"handicap2Pieces"},bA={value:"handicap4Pieces"},_A={value:"handicap6Pieces"},yA={value:"handicap8Pieces"},vA={class:"dialog-form-item"},SA={class:"dialog-form-item-label"},wA={ref:"maxMoves",class:"number",type:"number",min:"1"},EA={class:"dialog-form-item"},kA={class:"dialog-form-item-label"},IA={ref:"repeat",class:"number",type:"number",min:"1"},PA={class:"dialog-form-item"},AA={id:"swap-players",ref:"swapPlayers",type:"checkbox"},CA={for:"swap-players"},xA={class:"dialog-form-item"},MA={id:"enable-comment",ref:"enableComment",type:"checkbox"},TA={for:"enable-comment"},RA={class:"dialog-form-item"},OA={id:"enable-auto-save",ref:"enableAutoSave",type:"checkbox"},NA={for:"enable-auto-save"},LA={class:"dialog-form-item"},BA={id:"human-is-front",ref:"humanIsFront",type:"checkbox"},DA={for:"human-is-front"},FA={class:"dialog-main-buttons"};function $A(e,t,i,n,s,o){const r=ye("PlayerSelector"),a=ye("ButtonIcon");return R(),B("div",null,[p("dialog",xP,[p("div",MP,k(e.t.game),1),p("div",TP,[p("div",RP,[p("div",OP,[p("div",NP,k(e.t.senteOrShitate),1),Y(r,{"player-uri":e.blackPlayerURI,"contains-human":!0,"engine-settings":e.engineSettings,"display-ponder-state":!0,"display-thread-state":!0,"display-multi-pv-state":!0,onUpdateEngineSetting:e.onUpdatePlayerSetting,onSelectPlayer:e.onSelectBlackPlayer},null,8,["player-uri","engine-settings","onUpdateEngineSetting","onSelectPlayer"])]),p("div",LP,[p("div",BP,k(e.t.goteOrUwate),1),e.whitePlayerURI?(R(),je(r,{key:0,"player-uri":e.whitePlayerURI,"contains-human":!0,"engine-settings":e.engineSettings,"display-ponder-state":!0,"display-thread-state":!0,"display-multi-pv-state":!0,onUpdateEngineSetting:e.onUpdatePlayerSetting,onSelectPlayer:e.onSelectWhitePlayer},null,8,["player-uri","engine-settings","onUpdateEngineSetting","onSelectPlayer"])):re("",!0)])]),p("div",DP,[p("button",{onClick:t[0]||(t[0]=(...l)=>e.onSwapColor&&e.onSwapColor(...l))},[Y(a,{class:"icon",icon:e.Icon.SWAP_H},null,8,["icon"]),Qe(" "+k(e.t.swapSenteGote),1)])])]),p("div",FP,[p("div",$P,[p("div",HP,k(e.t.time),1),p("div",UP,[zP,p("input",WP,null,512),p("div",GP,k(e.t.hoursSuffix),1),p("input",VP,null,512),p("div",jP,k(e.t.minutesSuffix),1)]),p("div",KP,[qP,p("input",YP,null,512),p("div",XP,k(e.t.secondsSuffix),1)]),p("div",JP,[QP,p("input",ZP,null,512),p("div",eA,k(e.t.secondsSuffix),1)]),p("div",tA,[p("input",iA,null,512),p("label",nA,k(e.t.enableEngineTimeout),1)])]),p("div",sA,[p("div",oA,k(e.t.others),1),p("div",rA,[p("div",aA,k(e.t.startPosition),1),p("select",lA,[p("option",cA,k(e.t.currentPosition),1),p("option",uA,k(e.t.nonHandicap),1),p("option",hA,k(e.t.lanceHandicap),1),p("option",dA,k(e.t.rightLanceHandicap),1),p("option",fA,k(e.t.bishopHandicap),1),p("option",pA,k(e.t.rookHandicap),1),p("option",gA,k(e.t.rookLanceHandicap),1),p("option",mA,k(e.t.twoPiecesHandicap),1),p("option",bA,k(e.t.fourPiecesHandicap),1),p("option",_A,k(e.t.sixPiecesHandicap),1),p("option",yA,k(e.t.eightPiecesHandicap),1)],512)]),p("div",vA,[p("div",SA,k(e.t.maxMoves),1),p("input",wA,null,512)]),p("div",EA,[p("div",kA,k(e.t.gameRepetition),1),p("input",IA,null,512)]),p("div",PA,[p("input",AA,null,512),p("label",CA,k(e.t.swapTurnWhenGameRepetition),1)]),p("div",xA,[p("input",MA,null,512),p("label",TA,k(e.t.outputComments),1)]),p("div",RA,[p("input",OA,null,512),p("label",NA,k(e.t.saveRecordAutomatically),1)]),p("div",LA,[p("input",BA,null,512),p("label",DA,k(e.t.adjustBoardToHumanPlayer),1)])])]),p("div",FA,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[1]||(t[1]=l=>e.onStart())},k(e.t.startGame),1),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[2]||(t[2]=l=>e.onCancel())},k(e.t.cancel),1)])],512)])}const HA=Ve(CP,[["render",$A],["__scopeId","data-v-8ddf4bc5"]]),UA=Ge({name:"CSAGameDialog",components:{PlayerSelector:Dr},setup(){const e=ot(),t=W(null),i=W(null),n=W(Fs.V121),s=W(null),o=W(null),r=W(null),a=W(null),l=W(null),c=W(null),u=W(null),h=W(null),f=W(null),g=W(null),_=W(!1),b=W(U1()),v=W(new Wi),y=W("");let E=!1,w=!1;e.retainBussyState(),st(async()=>{try{_.value=await fe.isEncryptionAvailable(),b.value=await fe.loadCSAGameSettingHistory(),v.value=await fe.loadUSIEngineSetting(),kt(t.value),ei(t.value),E=!0}catch(ae){e.pushError(ae),e.destroyModalDialog()}finally{e.releaseBussyState()}}),zt(()=>{ti(t.value)}),Xs(()=>{if(!E||w)return;const ae=z1(b.value,0);i.value.value=n.value=ae.server.protocolVersion,s.value.value=ae.server.host,o.value.value=ae.server.port,r.value.value=ae.server.id,a.value.value=ae.server.password,c.value.checked=ae.enableComment,u.value.checked=ae.enableAutoSave,h.value.value=ae.repeat,f.value.checked=ae.autoRelogin,g.value.checked=ae.autoFlip,y.value=ae.player.uri,w=!0});const P=ae=>{if(ki(ae)&&v.value.hasEngine(ae)){const Re=v.value.getEngine(ae);return{name:Re.name,uri:ae,usi:Re}}return{name:"",uri:Qt}},A=()=>{const ae={player:P(y.value),server:{protocolVersion:i.value.value,host:String(s.value.value||"").trim(),port:Number(o.value.value),id:String(r.value.value||""),password:String(a.value.value||"")},enableComment:c.value.checked,enableAutoSave:u.value.checked,repeat:gt(h.value),autoRelogin:f.value.checked,autoFlip:g.value.checked},Re=H1(ae);Re?e.pushError(Re):e.loginCSAGame(ae,{saveHistory:l.value.checked})},O=()=>{e.closeModalDialog()},U=async ae=>{v.value=ae},z=ae=>{y.value=ae},te=ae=>{const Re=ae.target;a.value.type=Re.checked?"text":"password"},G=ae=>{const Re=ae.target,Ee=b.value.serverHistory[Number(Re.value)];Ee&&(i.value.value=Ee.protocolVersion,s.value.value=Ee.host,o.value.value=Ee.port,r.value.value=Ee.id,a.value.value=Ee.password)},Q=()=>{n.value=i.value.value},Se=Me(()=>{const ae=$e();return ae.enableCSALog&&ae.enableAppLog&&ae.enableUSILog});return{t:ve,CSAProtocolVersion:Fs,maxServerHistoryLenght:pf,dialog:t,protocolVersion:i,host:s,port:o,id:r,password:a,saveHistory:l,enableComment:c,enableAutoSave:u,repeat:h,autoRelogin:f,autoFlip:g,engineSettings:v,playerURI:y,history:b,selectedProtocolVersion:n,onChangeProtocolVersion:Q,logEnabled:Se,isEncryptionAvailable:_,onStart:A,onCancel:O,onUpdatePlayerSetting:U,onSelectPlayer:z,onTogglePasswordVisibility:te,onChangeHistory:G,Icon:tt}}});const Fr=e=>(qs("data-v-db4f7787"),e=e(),Ys(),e),zA={ref:"dialog",class:"root"},WA={class:"dialog-title"},GA={class:"dialog-scroll-area"},VA={key:0,class:"dialog-form-area dialog-form-warning"},jA={class:"dialog-form-note"},KA={class:"dialog-form-area"},qA={class:"dialog-form-area"},YA={class:"dialog-form-item"},XA={class:"dialog-form-item-label-wide"},JA={key:0,value:"0"},QA=["value"],ZA=Fr(()=>p("hr",null,null,-1)),eC={class:"dialog-form-item"},tC={class:"dialog-form-item-label-wide"},iC=["value"],nC=["value"],sC={key:0,class:"dialog-form-area dialog-form-item dialog-form-warning"},oC={class:"dialog-form-note"},rC={key:1,class:"dialog-form-area dialog-form-item dialog-form-warning"},aC={class:"dialog-form-note"},lC={class:"dialog-form-item"},cC={class:"dialog-form-item-label-wide"},uC={ref:"host",class:"long-text",list:"csa-server-host",type:"text"},hC=Fr(()=>p("datalist",{id:"csa-server-host"},[p("option",{value:"gserver.computer-shogi.org"}),p("option",{value:"wdoor.c.u-tokyo.ac.jp"}),p("option",{value:"localhost"})],-1)),dC={class:"dialog-form-item"},fC={class:"dialog-form-item-label-wide"},pC={ref:"port",class:"number",list:"csa-server-port-number",type:"number"},gC=Fr(()=>p("datalist",{id:"csa-server-port-number"},[p("option",{value:"4081"})],-1)),mC={class:"dialog-form-item"},bC=Fr(()=>p("div",{class:"dialog-form-item-label-wide"},"ID",-1)),_C={ref:"id",class:"long-text",type:"text"},yC={class:"dialog-form-item"},vC={class:"dialog-form-item-label-wide"},SC={ref:"password",class:"long-text",type:"password"},wC={class:"dialog-form-item"},EC={for:"show-password"},kC={class:"dialog-form-area dialog-form-item dialog-form-warning"},IC={key:0,class:"dialog-form-note"},PC={key:1,class:"dialog-form-note"},AC={class:"dialog-form-item"},CC={id:"save-history",ref:"saveHistory",type:"checkbox",checked:""},xC={for:"save-history"},MC={class:"dialog-form-area"},TC={class:"dialog-form-item"},RC={class:"dialog-form-item-label-wide number"},OC={ref:"repeat",class:"number",type:"number",min:"1"},NC={class:"dialog-form-item"},LC={id:"auto-relogin",ref:"autoRelogin",type:"checkbox"},BC={for:"auto-relogin"},DC={class:"dialog-form-item"},FC={id:"enable-comment",ref:"enableComment",type:"checkbox"},$C={for:"enable-comment"},HC={class:"dialog-form-item"},UC={id:"enable-auto-save",ref:"enableAutoSave",type:"checkbox"},zC={for:"enable-auto-save"},WC={class:"dialog-form-item"},GC={id:"auto-flip",ref:"autoFlip",type:"checkbox"},VC={for:"auto-flip"},jC={class:"dialog-main-buttons"};function KC(e,t,i,n,s,o){const r=ye("PlayerSelector");return R(),B("div",null,[p("dialog",zA,[p("div",WA,k(e.t.csaProtocolOnlineGame),1),p("div",GA,[e.logEnabled?re("",!0):(R(),B("div",VA,[p("div",jA,k(e.t.someLogsDisabled)+" "+k(e.t.logsRecommendedForCSAProtocol)+" "+k(e.t.pleaseEnableLogsAndRestart),1)])),p("div",KA,[p("div",null,k(e.t.player),1),Y(r,{"player-uri":e.playerURI,"contains-human":!0,"engine-settings":e.engineSettings,"display-ponder-state":!0,"display-thread-state":!0,"display-multi-pv-state":!0,onUpdateEngineSetting:e.onUpdatePlayerSetting,onSelectPlayer:e.onSelectPlayer},null,8,["player-uri","engine-settings","onUpdateEngineSetting","onSelectPlayer"])]),p("div",qA,[p("div",YA,[p("div",XA,k(e.t.selectFromHistory),1),p("select",{class:"long-text",value:"0",onChange:t[0]||(t[0]=(...a)=>e.onChangeHistory&&e.onChangeHistory(...a))},[e.history.serverHistory.length===0?(R(),B("option",JA,k(e.t.noHistory),1)):re("",!0),(R(!0),B(Ce,null,Ye(e.history.serverHistory,(a,l)=>(R(),B("option",{key:l,value:l},k(a.host)+":"+k(a.port)+" "+k(a.id),9,QA))),128))],32)]),ZA,p("div",eC,[p("div",tC,k(e.t.version),1),p("select",{ref:"protocolVersion",class:"long-text",value:"CSA_v121",onChange:t[1]||(t[1]=(...a)=>e.onChangeProtocolVersion&&e.onChangeProtocolVersion(...a))},[p("option",{value:e.CSAProtocolVersion.V121},k(e.t.csaProtocolV121),9,iC),p("option",{value:e.CSAProtocolVersion.V121_FLOODGATE},k(e.t.csaProtocolV121WithPVComment),9,nC)],544)]),e.selectedProtocolVersion===e.CSAProtocolVersion.V121?(R(),B("div",sC,[p("div",oC,k(e.t.notSendPVOnStandardCSAProtocol),1)])):re("",!0),e.selectedProtocolVersion===e.CSAProtocolVersion.V121_FLOODGATE?(R(),B("div",rC,[p("div",aC,k(e.t.sendPVDoNotUseOnWCSC),1)])):re("",!0),p("div",lC,[p("div",cC,k(e.t.hostToConnect),1),p("input",uC,null,512),hC]),p("div",dC,[p("div",fC,k(e.t.portNumber),1),p("input",pC,null,512),gC]),p("div",mC,[bC,p("input",_C,null,512)]),p("div",yC,[p("div",vC,k(e.t.password),1),p("input",SC,null,512)]),p("div",wC,[p("input",{id:"show-password",type:"checkbox",onChange:t[2]||(t[2]=(...a)=>e.onTogglePasswordVisibility&&e.onTogglePasswordVisibility(...a))},null,32),p("label",EC,k(e.t.showPassword),1)]),p("div",kC,[e.isEncryptionAvailable?(R(),B("div",IC,k(e.t.csaProtocolSendPlaintextPassword),1)):(R(),B("div",PC,k(e.t.passwordWillSavedPlaintextBecauseOSSideEncryptionNotAvailable)+" "+k(e.t.pleaseUncheckSaveHistoryIfNotWantSave)+" "+k(e.t.csaProtocolSendPlaintextPasswordRegardlessOfHistory),1))]),p("div",AC,[p("input",CC,null,512),p("label",xC,k(e.t.saveHistory)+" ("+k(e.t.keepLatest(e.maxServerHistoryLenght))+") ",1)])]),p("div",MC,[p("div",TC,[p("div",RC,k(e.t.gameRepetition),1),p("input",OC,null,512)]),p("div",NC,[p("input",LC,null,512),p("label",BC,k(e.t.autoRelogin),1)]),p("div",DC,[p("input",FC,null,512),p("label",$C,k(e.t.outputComments),1)]),p("div",HC,[p("input",UC,null,512),p("label",zC,k(e.t.saveRecordAutomatically),1)]),p("div",WC,[p("input",GC,null,512),p("label",VC,k(e.t.adjustBoardAutomatically),1)])])]),p("div",jC,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[3]||(t[3]=a=>e.onStart())},k(e.t.startGame),1),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[4]||(t[4]=a=>e.onCancel())},k(e.t.cancel),1)])],512)])}const qC=Ve(UA,[["render",KC],["__scopeId","data-v-db4f7787"]]),YC=Ge({name:"ResearchDialog",components:{PlayerSelector:Dr},setup(){const e=ot(),t=W(null),i=W(Ga()),n=W(new Wi),s=W(""),o=W([]);return e.retainBussyState(),st(async()=>{var c,u;kt(t.value),ei(t.value);try{i.value=await fe.loadResearchSetting(),n.value=await fe.loadUSIEngineSetting(),s.value=((c=i.value.usi)==null?void 0:c.uri)||"",o.value=((u=i.value.secondaries)==null?void 0:u.map(h=>{var f;return((f=h.usi)==null?void 0:f.uri)||""}))||[]}catch(h){e.pushError(h),e.destroyModalDialog()}finally{e.releaseBussyState()}}),zt(()=>{ti(t.value)}),{t:ve,dialog:t,engineSettings:n,engineURI:s,secondaryEngineURIs:o,onStart:()=>{const c=n.value.getEngine(s.value),u=[];for(const g of o.value){const _=n.value.getEngine(g);u.push({usi:_})}const h={usi:c,secondaries:u},f=Rb(h);if(f){e.pushError(f);return}e.startResearch(h)},onCancel:()=>{e.closeModalDialog()},onUpdatePlayerSetting:async c=>{n.value=c}}}});const XC={ref:"dialog",class:"root"},JC={class:"dialog-title"},QC={class:"dialog-form-area"},ZC={class:"dialog-form-area"},ex=["onClick"],tx={class:"dialog-main-buttons"};function ix(e,t,i,n,s,o){const r=ye("PlayerSelector");return R(),B("div",null,[p("dialog",XC,[p("div",JC,k(e.t.research),1),p("div",QC,[p("div",ZC,[Y(r,{"player-uri":e.engineURI,"engine-settings":e.engineSettings,"display-thread-state":!0,"display-multi-pv-state":!0,onUpdateEngineSetting:e.onUpdatePlayerSetting,onSelectPlayer:t[0]||(t[0]=a=>{e.engineURI=a})},null,8,["player-uri","engine-settings","onUpdateEngineSetting"])]),(R(!0),B(Ce,null,Ye(e.secondaryEngineURIs,(a,l)=>(R(),B("div",{key:l,class:"dialog-form-area"},[Y(r,{"player-uri":a,"engine-settings":e.engineSettings,"display-thread-state":!0,"display-multi-pv-state":!0,onUpdateEngineSetting:e.onUpdatePlayerSetting,onSelectPlayer:c=>{e.secondaryEngineURIs[l]=c}},null,8,["player-uri","engine-settings","onUpdateEngineSetting","onSelectPlayer"]),p("button",{class:"remove-button",onClick:c=>e.secondaryEngineURIs.splice(l,1)},k(e.t.remove),9,ex)]))),128)),p("button",{onClick:t[1]||(t[1]=a=>e.secondaryEngineURIs.push(""))},k(e.t.addNthEngine(e.secondaryEngineURIs.length+2)),1)]),p("div",tx,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[2]||(t[2]=a=>e.onStart())},k(e.t.startResearch),1),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[3]||(t[3]=a=>e.onCancel())},k(e.t.cancel),1)])],512)])}const nx=Ve(YC,[["render",ix],["__scopeId","data-v-7f6c52e5"]]),sx=Ge({name:"USIEngineManagementDialog",components:{USIEngineOptionDialog:yp},setup(){const e=ot(),t=W(null),i=W(null),n=W(new Wi);return e.retainBussyState(),st(async()=>{kt(t.value),ei(t.value);try{n.value=await fe.loadUSIEngineSetting()}catch(f){e.pushError(f),e.destroyModalDialog()}finally{e.releaseBussyState()}}),zt(()=>{ti(t.value)}),{t:ve,optionDialog:i,dialog:t,setting:n,add:async()=>{try{e.retainBussyState();const f=await fe.showSelectUSIEngineDialog();if(!f)return;const _=$e().engineTimeoutSeconds;n.value.addEngine(await fe.getUSIEngineInfo(f,_))}catch(f){e.pushError(f)}finally{e.releaseBussyState()}},remove:f=>{n.value.removeEngine(f)},openOptions:f=>{i.value=n.value.getEngine(f)},duplicate:f=>{const g=n.value.getEngine(f),_=Pb(g);n.value.addEngine(_)},saveAndClose:async()=>{try{e.retainBussyState(),await fe.saveUSIEngineSetting(n.value),e.destroyModalDialog()}catch(f){e.pushError(f)}finally{e.releaseBussyState()}},cancel:()=>{e.closeModalDialog()},optionOk:f=>{n.value.updateEngine(f),i.value=null},optionCancel:()=>{i.value=null}}}});const ox={ref:"dialog"},rx={class:"dialog-title"},ax={class:"dialog-form-area engine-list"},lx={key:0,class:"engine"},cx=["value"],ux={class:"engine-name"},hx=["onClick"],dx=["onClick"],fx=["onClick"],px={class:"dialog-main-buttons"};function gx(e,t,i,n,s,o){const r=ye("USIEngineOptionDialog");return R(),B(Ce,null,[p("div",null,[p("dialog",ox,[p("div",rx,k(e.t.engineManagement),1),p("div",ax,[e.setting.engineList.length===0?(R(),B("div",lx,k(e.t.noEngineRegistered),1)):re("",!0),(R(!0),B(Ce,null,Ye(e.setting.engineList,a=>(R(),B("div",{key:a.uri,class:"engine",value:a.uri},[p("div",ux,k(a.name),1),p("button",{onClick:l=>e.openOptions(a.uri)},k(e.t.config),9,hx),p("button",{onClick:l=>e.duplicate(a.uri)},k(e.t.duplicate),9,dx),p("button",{onClick:l=>e.remove(a.uri)},k(e.t.remove),9,fx)],8,cx))),128))]),p("button",{class:"dialog-wide-button",onClick:t[0]||(t[0]=a=>e.add())},k(e.t.add),1),p("div",px,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[1]||(t[1]=a=>e.saveAndClose())},k(e.t.saveAndClose),1),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[2]||(t[2]=a=>e.cancel())},k(e.t.cancel),1)])],512)]),e.optionDialog?(R(),je(r,{key:0,"latest-engine-setting":e.optionDialog,onOk:e.optionOk,onCancel:e.optionCancel},null,8,["latest-engine-setting","onOk","onCancel"])):re("",!0)],64)}const mx=Ve(sx,[["render",gx],["__scopeId","data-v-a428af75"]]),bx={"\r\n":"crlf","\n":"lf","\r":"cr"},_x={crlf:`\r
`,lf:`
`,cr:"\r"},yx=Ge({name:"AppSettingDialog",setup(){const e=ot(),t=$e(),i=W(null),n=W(null),s=W(null),o=W(null),r=W(null),a=W(null),l=W(null),c=W(null),u=W(null),h=W(null),f=W(null),g=W(null),_=W(null),b=W(null),v=W(null),y=W(null),E=W(null),w=W(null),P=W(null),A=W(null),O=W(null),U=W(null),z=W(null),te=W(null);st(()=>{kt(i.value),ei(i.value)}),zt(()=>{ti(i.value)});const G=async()=>{const ae={language:n.value.value,thema:s.value.value,pieceImage:o.value.value,boardImage:r.value.value,boardLabelType:a.value.checked?Es.STANDARD:Es.NONE,tabPaneType:l.value.value,pieceVolume:gt(c.value),clockVolume:gt(u.value),clockPitch:gt(h.value),clockSoundTarget:f.value.value,returnCode:_x[g.value.value],autoSaveDirectory:_.value.value,engineTimeoutSeconds:gt(b.value),evaluationViewFrom:v.value.value,coefficientInSigmoid:gt(y.value),badMoveLevelThreshold1:gt(E.value),badMoveLevelThreshold2:gt(w.value),badMoveLevelThreshold3:gt(P.value),badMoveLevelThreshold4:gt(A.value),enableAppLog:O.value.checked,enableUSILog:U.value.checked,enableCSALog:z.value.checked,logLevel:te.value.value};e.retainBussyState();try{await $e().updateAppSetting(ae),e.closeAppSettingDialog()}catch(Re){e.pushError(Re)}finally{e.releaseBussyState()}},Q=async()=>{e.retainBussyState();try{const ae=await fe.showSelectDirectoryDialog(_.value.value);ae&&(_.value.value=ae)}catch(ae){e.pushError(ae)}finally{e.releaseBussyState()}},Se=()=>{e.closeAppSettingDialog()};return{t:ve,Language:Yo,Thema:xl,PieceImageType:wn,BoardImageType:De,BoardLabelType:Es,TabPaneType:Xo,EvaluationViewFrom:Ml,LogLevel:mt,dialog:i,language:n,thema:s,pieceImage:o,boardImage:r,displayBoardLabels:a,tabPaneType:l,pieceVolume:c,clockVolume:u,clockPitch:h,clockSoundTarget:f,returnCode:g,autoSaveDirectory:_,engineTimeoutSeconds:b,evaluationViewFrom:v,coefficientInSigmoid:y,badMoveLevelThreshold1:E,badMoveLevelThreshold2:w,badMoveLevelThreshold3:P,badMoveLevelThreshold4:A,enableAppLog:O,enableUSILog:U,enableCSALog:z,logLevel:te,appSetting:t,returnCodeToName:bx,isNative:nr(),selectAutoSaveDirectory:Q,saveAndClose:G,cancel:Se}}});const It=e=>(qs("data-v-9204a783"),e=e(),Ys(),e),vx={ref:"dialog"},Sx={class:"dialog-title"},wx={class:"dialog-scroll-area settings"},Ex={class:"section"},kx={class:"section-title"},Ix=It(()=>p("div",{class:"dialog-form-area dialog-form-warning"},[p("div",{class:"dialog-form-note"},"  We'd like your help to translate. "),p("div",{class:"dialog-form-note"},"  You should restart this app to change the language. ")],-1)),Px={class:"dialog-form-item"},Ax={class:"dialog-form-item-label-wide"},Cx=["value"],xx=["value"],Mx=["value"],Tx={class:"dialog-form-item"},Rx={class:"dialog-form-item-label-wide"},Ox=["value"],Nx=["value"],Lx=["value"],Bx=["value"],Dx=["value"],Fx=["value"],$x={class:"dialog-form-item"},Hx={class:"dialog-form-item-label-wide"},Ux=["value"],zx=["value"],Wx=["value"],Gx=["value"],Vx=["value"],jx={class:"dialog-form-item"},Kx={class:"dialog-form-item-label-wide"},qx=["value"],Yx=["value"],Xx=["value"],Jx=["value"],Qx=["value"],Zx=["value"],eM=["value"],tM=["value"],iM=["value"],nM={class:"dialog-form-item"},sM={class:"dialog-form-item-label-wide"},oM=["checked"],rM={class:"dialog-form-item"},aM={class:"dialog-form-item-label-wide"},lM=["value"],cM=["value"],uM=["value"],hM=It(()=>p("hr",null,null,-1)),dM={class:"section"},fM={class:"section-title"},pM={class:"dialog-form-item"},gM={class:"dialog-form-item-label-wide"},mM=["value"],bM=It(()=>p("div",{class:"dialog-form-item-unit"},"%",-1)),_M={class:"dialog-form-item"},yM={class:"dialog-form-item-label-wide"},vM=["value"],SM=It(()=>p("div",{class:"dialog-form-item-unit"},"%",-1)),wM={class:"dialog-form-item"},EM={class:"dialog-form-item-label-wide"},kM=["value"],IM={class:"dialog-form-item-unit"},PM={class:"dialog-form-item"},AM={class:"dialog-form-item-label-wide"},CM=["value"],xM={value:"all"},MM={value:"onlyUser"},TM=It(()=>p("hr",null,null,-1)),RM={class:"section"},OM={class:"section-title"},NM={class:"dialog-form-item"},LM={class:"dialog-form-item-label-wide"},BM=["value"],DM=It(()=>p("option",{value:"crlf"},"CR + LF (Windows)",-1)),FM=It(()=>p("option",{value:"lf"},"LF (UNIX/Mac)",-1)),$M={value:"cr"},HM={class:"dialog-form-item"},UM={class:"dialog-form-item-label-wide"},zM=["value"],WM=It(()=>p("hr",null,null,-1)),GM={class:"section"},VM={class:"section-title"},jM={class:"dialog-form-item"},KM={class:"dialog-form-item-label-wide"},qM=["value"],YM={class:"dialog-form-item-unit"},XM=It(()=>p("hr",null,null,-1)),JM={class:"section"},QM={class:"section-title"},ZM={class:"dialog-form-item"},eT={class:"dialog-form-item-label-wide"},tT=["value"],iT=["value"],nT=["value"],sT={class:"dialog-form-item"},oT={class:"dialog-form-item-label-wide"},rT=["value"],aT={class:"dialog-form-item-unit"},lT={class:"dialog-form-item"},cT=It(()=>p("div",{class:"dialog-form-item-label-wide"},"",-1)),uT=["value"],hT=It(()=>p("div",{class:"dialog-form-item-unit"},"%",-1)),dT={class:"dialog-form-item"},fT=It(()=>p("div",{class:"dialog-form-item-label-wide"},"",-1)),pT=["value"],gT=It(()=>p("div",{class:"dialog-form-item-unit"},"%",-1)),mT={class:"dialog-form-item"},bT=It(()=>p("div",{class:"dialog-form-item-label-wide"},"",-1)),_T=["value"],yT=It(()=>p("div",{class:"dialog-form-item-unit"},"%",-1)),vT={class:"dialog-form-item"},ST=It(()=>p("div",{class:"dialog-form-item-label-wide"},"",-1)),wT=["value"],ET=It(()=>p("div",{class:"dialog-form-item-unit"},"%",-1)),kT=It(()=>p("hr",null,null,-1)),IT={class:"section"},PT={class:"section-title"},AT={class:"dialog-form-area dialog-form-warning"},CT={key:0,class:"dialog-form-note"},xT={key:1,class:"dialog-form-note"},MT={key:2,class:"dialog-form-note"},TT={key:3,class:"dialog-form-note"},RT={class:"dialog-form-item"},OT={class:"dialog-form-item-label-wide"},NT=["checked"],LT={class:"dialog-form-item"},BT={class:"dialog-form-item-label-wide"},DT=["checked"],FT={class:"dialog-form-item"},$T={class:"dialog-form-item-label-wide"},HT=["checked"],UT={class:"dialog-form-item"},zT={class:"dialog-form-item-label-wide"},WT=["value"],GT=["value"],VT=["value"],jT=["value"],KT=["value"],qT={class:"dialog-main-buttons"};function YT(e,t,i,n,s,o){return R(),B("div",null,[p("dialog",vx,[p("div",Sx,k(e.t.appSettings),1),p("div",wx,[p("div",Ex,[p("div",kx,k(e.t.view),1),Ix,p("div",Px,[p("div",Ax,k(e.t.language),1),p("select",{ref:"language",value:e.appSetting.language},[p("option",{value:e.Language.JA},"",8,xx),p("option",{value:e.Language.EN},"English",8,Mx)],8,Cx)]),p("div",Tx,[p("div",Rx,k(e.t.theme),1),p("select",{ref:"thema",value:e.appSetting.thema},[p("option",{value:e.Thema.STANDARD},k(e.t.standardGreen),9,Nx),p("option",{value:e.Thema.CHERRY_BLOSSOM},k(e.t.cherryBlossom),9,Lx),p("option",{value:e.Thema.AUTUMN},k(e.t.autumn),9,Bx),p("option",{value:e.Thema.SNOW},k(e.t.snow),9,Dx),p("option",{value:e.Thema.DARK},k(e.t.dark),9,Fx)],8,Ox)]),p("div",$x,[p("div",Hx,k(e.t.pieceImages),1),p("select",{ref:"pieceImage",value:e.appSetting.pieceImage},[p("option",{value:e.PieceImageType.HITOMOJI},k(e.t.singleKanjiPiece),9,zx),p("option",{value:e.PieceImageType.HITOMOJI_GOTHIC},k(e.t.singleKanjiGothicPiece),9,Wx),p("option",{value:e.PieceImageType.HITOMOJI_DARK},k(e.t.singleKanjiDarkPiece),9,Gx),p("option",{value:e.PieceImageType.HITOMOJI_GOTHIC_DARK},k(e.t.singleKanjiGothicDarkPiece),9,Vx)],8,Ux)]),p("div",jx,[p("div",Kx,k(e.t.boardImage),1),p("select",{ref:"boardImage",value:e.appSetting.boardImage},[p("option",{value:e.BoardImageType.LIGHT},k(e.t.lightWoodyTexture),9,Yx),p("option",{value:e.BoardImageType.WARM},k(e.t.warmWoodTexture),9,Xx),p("option",{value:e.BoardImageType.RESIN},k(e.t.regin),9,Jx),p("option",{value:e.BoardImageType.RESIN2},k(e.t.regin)+"2",9,Qx),p("option",{value:e.BoardImageType.RESIN3},k(e.t.regin)+"3",9,Zx),p("option",{value:e.BoardImageType.DARK},k(e.t.dark),9,eM),p("option",{value:e.BoardImageType.GREEN},k(e.t.green),9,tM),p("option",{value:e.BoardImageType.CHERRY_BLOSSOM},k(e.t.cherryBlossom),9,iM)],8,qx)]),p("div",nM,[p("div",sM,k(e.t.displayFileAndRank),1),p("input",{ref:"displayBoardLabels",class:"toggle",checked:e.appSetting.boardLabelType!=e.BoardLabelType.NONE,type:"checkbox"},null,8,oM)]),p("div",rM,[p("div",aM,k(e.t.tabViewStyle),1),p("select",{ref:"tabPaneType",value:e.appSetting.tabPaneType},[p("option",{value:e.TabPaneType.SINGLE},k(e.t.oneColumn),9,cM),p("option",{value:e.TabPaneType.DOUBLE},k(e.t.twoColumns),9,uM)],8,lM)])]),hM,p("div",dM,[p("div",fM,k(e.t.sounds),1),p("div",pM,[p("div",gM,k(e.t.pieceLoudness),1),p("input",{ref:"pieceVolume",value:e.appSetting.pieceVolume,type:"number",max:"100",min:"0"},null,8,mM),bM]),p("div",_M,[p("div",yM,k(e.t.clockLoudness),1),p("input",{ref:"clockVolume",value:e.appSetting.clockVolume,type:"number",max:"100",min:"0"},null,8,vM),SM]),p("div",wM,[p("div",EM,k(e.t.clockPitch),1),p("input",{ref:"clockPitch",value:e.appSetting.clockPitch,type:"number",max:"880",min:"220"},null,8,kM),p("div",IM," Hz ("+k(e.t.between(220,880))+") ",1)]),p("div",PM,[p("div",AM,k(e.t.clockSoundTarget),1),p("select",{ref:"clockSoundTarget",value:e.appSetting.clockSoundTarget},[p("option",xM,k(e.t.anyTurn),1),p("option",MM,k(e.t.onlyHumanTurn),1)],8,CM)])]),TM,p("div",RM,[p("div",OM,k(e.t.file),1),p("div",NM,[p("div",LM,k(e.t.newlineCharacter),1),p("select",{ref:"returnCode",value:e.returnCodeToName[e.appSetting.returnCode]},[DM,FM,p("option",$M,"CR ("+k(e.t.old90sMac)+")",1)],8,BM)]),p("div",HM,[p("div",UM,k(e.t.autoSavingDirectory),1),p("input",{ref:"autoSaveDirectory",class:"directory",value:e.appSetting.autoSaveDirectory,type:"text"},null,8,zM),p("button",{class:"dialog-button",onClick:t[0]||(t[0]=(...r)=>e.selectAutoSaveDirectory&&e.selectAutoSaveDirectory(...r))},k(e.t.select),1)])]),WM,p("div",GM,[p("div",VM,k(e.t.usiProtocol),1),p("div",jM,[p("div",KM,k(e.t.maxStartupTime),1),p("input",{ref:"engineTimeoutSeconds",value:e.appSetting.engineTimeoutSeconds,type:"number",max:"300",min:"1"},null,8,qM),p("div",YM,k(e.t.secondsSuffix)+" ("+k(e.t.between(1,300))+") ",1)])]),XM,p("div",JM,[p("div",QM,k(e.t.evaluationAndEstimatedWinRate),1),p("div",ZM,[p("div",eT,k(e.t.signOfEvaluation),1),p("select",{ref:"evaluationViewFrom",value:e.appSetting.evaluationViewFrom},[p("option",{value:e.EvaluationViewFrom.EACH},k(e.t.swapEachTurnChange),9,iT),p("option",{value:e.EvaluationViewFrom.BLACK},k(e.t.alwaysSenteIsPositive),9,nT)],8,tT)]),p("div",sT,[p("div",oT,k(e.t.winRateCoefficient),1),p("input",{ref:"coefficientInSigmoid",value:e.appSetting.coefficientInSigmoid,type:"number",max:"10000",min:"1"},null,8,rT),p("div",aT," ("+k(e.t.recommended)+": "+k(e.t.between(600,1500))+") ",1)]),p("div",lT,[cT,p("input",{ref:"badMoveLevelThreshold1",value:e.appSetting.badMoveLevelThreshold1,type:"number",max:"100",min:"0"},null,8,uT),hT]),p("div",dT,[fT,p("input",{ref:"badMoveLevelThreshold2",value:e.appSetting.badMoveLevelThreshold2,type:"number",max:"100",min:"0"},null,8,pT),gT]),p("div",mT,[bT,p("input",{ref:"badMoveLevelThreshold3",value:e.appSetting.badMoveLevelThreshold3,type:"number",max:"100",min:"0"},null,8,_T),yT]),p("div",vT,[ST,p("input",{ref:"badMoveLevelThreshold4",value:e.appSetting.badMoveLevelThreshold4,type:"number",max:"100",min:"0"},null,8,wT),ET])]),kT,p("div",IT,[p("div",PT,k(e.t.forDevelopers),1),p("div",AT,[e.isNative?re("",!0):(R(),B("div",CT,k(e.t.inBrowserLogsOutputToConsoleAndIgnoreThisSetting),1)),e.isNative?(R(),B("div",xT,k(e.t.shouldRestartToApplyLogSettings),1)):re("",!0),e.isNative?(R(),B("div",MT,k(e.t.canOpenLogDirectoryFromMenu),1)):re("",!0),e.isNative?(R(),B("div",TT,k(e.t.hasNoOldLogCleanUpFeature),1)):re("",!0)]),p("div",RT,[p("div",OT,k(e.t.enableAppLog),1),p("input",{ref:"enableAppLog",class:"toggle",checked:e.appSetting.enableAppLog,type:"checkbox"},null,8,NT)]),p("div",LT,[p("div",BT,k(e.t.enableUSILog),1),p("input",{ref:"enableUSILog",class:"toggle",checked:e.appSetting.enableUSILog,type:"checkbox"},null,8,DT)]),p("div",FT,[p("div",$T,k(e.t.enableCSALog),1),p("input",{ref:"enableCSALog",class:"toggle",checked:e.appSetting.enableCSALog,type:"checkbox"},null,8,HT)]),p("div",UT,[p("div",zT,k(e.t.logLevel),1),p("select",{ref:"logLevel",value:e.appSetting.logLevel},[p("option",{value:e.LogLevel.DEBUG},"DEBUG",8,GT),p("option",{value:e.LogLevel.INFO},"INFO",8,VT),p("option",{value:e.LogLevel.WARN},"WARN",8,jT),p("option",{value:e.LogLevel.ERROR},"ERROR",8,KT)],8,WT)])])]),p("div",qT,[p("button",{class:"dialog-button","data-hotkey":"Enter",autofocus:"",onClick:t[1]||(t[1]=r=>e.saveAndClose())},k(e.t.saveAndClose),1),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[2]||(t[2]=r=>e.cancel())},k(e.t.cancel),1)])],512)])}const XT=Ve(yx,[["render",YT],["__scopeId","data-v-9204a783"]]),JT=Ge({name:"PasteDialog",setup(){const e=ot(),t=W(null),i=W(null);return e.retainBussyState(),st(async()=>{try{kt(t.value),ei(t.value),nr()&&(i.value.value=await navigator.clipboard.readText())}finally{e.releaseBussyState()}}),zt(()=>{ti(t.value)}),{t:ve,dialog:t,textarea:i,onOk:()=>{const o=i.value.value;if(!o){e.pushError(new Error(""));return}e.closeModalDialog(),e.pasteRecord(o)},onCancel:()=>{e.closeModalDialog()},isNative:nr()}}});const QT={ref:"dialog"},ZT={ref:"content"},e4={class:"dialog-form-area"},t4={class:"message"},i4={class:"message"},n4={key:0,class:"message"},s4={key:1,class:"message"},o4={ref:"textarea"},r4={class:"dialog-main-buttons"};function a4(e,t,i,n,s,o){return R(),B("div",null,[p("dialog",QT,[p("div",ZT,[p("div",e4,[p("div",t4,k(e.t.importingFollowingRecordOrPosition),1),p("div",i4,k(e.t.supportsKIFCSAUSI),1),e.isNative?re("",!0):(R(),B("div",n4,k(e.t.plesePasteRecordIntoTextArea),1)),e.isNative?re("",!0):(R(),B("div",s4,k(e.t.desktopVersionPastesAutomatically),1)),p("textarea",o4,null,512)])],512),p("div",r4,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[0]||(t[0]=(...r)=>e.onOk&&e.onOk(...r))},k(e.t.import),1),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[1]||(t[1]=(...r)=>e.onCancel&&e.onCancel(...r))},k(e.t.cancel),1)])],512)])}const l4=Ve(JT,[["render",a4],["__scopeId","data-v-459b0e1d"]]),c4=Ge({name:"BussyMessage",components:{ButtonIcon:Bt},setup(){const e=W(null);return st(()=>{kt(e.value)}),{t:ve,dialog:e,Icon:tt}}});const u4={ref:"dialog",class:"bussy"},h4={class:"message-box"},d4={class:"message"};function f4(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",u4,[p("div",h4,[Y(r,{class:"icon",icon:e.Icon.BUSSY},null,8,["icon"]),p("div",d4,k(e.t.processingPleaseWait),1)])],512)])}const p4=Ve(c4,[["render",f4],["__scopeId","data-v-69aad45c"]]),g4=Ge({name:"InfoMessage",components:{ButtonIcon:Bt},setup(){const e=ot(),t=W(null),i=()=>{e.confirmationOk()},n=()=>{e.confirmationCancel()};return st(()=>{kt(t.value,n),ei(t.value)}),zt(()=>{ti(t.value)}),{t:ve,dialog:t,store:e,onOk:i,onClose:n,Icon:tt}}});const m4={ref:"dialog",class:"confirm"},b4={class:"message-box"},_4={class:"message"},y4={class:"dialog-main-buttons"};function v4(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",m4,[p("div",b4,[Y(r,{class:"icon",icon:e.Icon.QUESTION},null,8,["icon"]),p("div",_4,k(e.store.confirmation),1)]),p("div",y4,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[0]||(t[0]=a=>e.onOk())}," OK "),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[1]||(t[1]=a=>e.onClose())},k(e.t.cancel),1)])],512)])}const S4=Ve(g4,[["render",v4],["__scopeId","data-v-b8fd7926"]]),w4=Ge({name:"InfoMessage",components:{ButtonIcon:Bt},setup(){const e=ot(),t=W(null);return st(()=>{kt(t.value),ei(t.value)}),zt(()=>{ti(t.value)}),{t:ve,dialog:t,store:e,onClose:()=>{e.dequeueMessage()},Icon:tt}}});const E4={ref:"dialog",class:"info"},k4={class:"message-box"},I4={class:"message"},P4={key:0,class:"list"},A4={class:"dialog-main-buttons"};function C4(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",E4,[p("div",k4,[Y(r,{class:"icon",icon:e.Icon.INFO},null,8,["icon"]),p("div",I4,k(e.store.message.text),1)]),(R(!0),B(Ce,null,Ye(e.store.message.attachments,(a,l)=>(R(),B("div",{key:l,class:"attachment"},[a.type==="list"?(R(),B("ul",P4,[(R(!0),B(Ce,null,Ye(a.items,(c,u)=>(R(),B("li",{key:u,class:"list-item"},[Qe(k(c.text)+" ",1),p("ul",null,[(R(!0),B(Ce,null,Ye(c.children,(h,f)=>(R(),B("li",{key:f,class:"list-child-item"},k(h),1))),128))])]))),128))])):re("",!0)]))),128)),p("div",A4,[p("button",{autofocus:"","data-hotkey":"Escape",onClick:t[0]||(t[0]=a=>e.onClose())},k(e.t.close),1)])],512)])}const x4=Ve(w4,[["render",C4],["__scopeId","data-v-1ee5da51"]]),M4=Ge({name:"ErrorMessage",components:{ButtonIcon:Bt},setup(){const e=ot(),t=W(null);return st(()=>{kt(t.value),ei(t.value)}),zt(()=>{ti(t.value)}),{t:ve,dialog:t,store:e,onClose:()=>{e.clearErrors()},Icon:tt}}});const T4={ref:"dialog",class:"error"},R4={class:"message-box"},O4={class:"items"},N4={class:"notice"},L4={class:"index"},B4={key:0},D4={class:"message"},F4={class:"dialog-main-buttons"};function $4(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",T4,[p("div",R4,[Y(r,{class:"icon",icon:e.Icon.ERROR},null,8,["icon"]),p("div",O4,[p("div",N4,k(e.t.errorsOccurred(e.store.errors.length)),1),(R(!0),B(Ce,null,Ye(e.store.errors,(a,l)=>(R(),B("div",{key:l,class:"item"},[p("p",L4,[Qe(k(l+1)+" ",1),a.count>=2?(R(),B("span",B4,"("+k(a.count)+" )",1)):re("",!0)]),p("p",D4,k(a.message),1)]))),128))])]),p("div",F4,[p("button",{autofocus:"","data-hotkey":"Escape",onClick:t[0]||(t[0]=a=>e.onClose())},k(e.t.close),1)])],512)])}const H4=Ve(M4,[["render",$4],["__scopeId","data-v-eb107e17"]]),U4=Ge({name:"ResearchDialog",components:{PlayerSelector:Dr},setup(){const e=ot(),t=W(null),i=W(null),n=W(null),s=W(null),o=W(null),r=W(null),a=W(null),l=W(tr()),c=W(new Wi),u=W("");e.retainBussyState(),st(async()=>{var y;kt(t.value),ei(t.value);try{l.value=await fe.loadAnalysisSetting(),c.value=await fe.loadUSIEngineSetting(),u.value=((y=l.value.usi)==null?void 0:y.uri)||""}catch(E){e.pushError(E),e.destroyModalDialog()}finally{e.releaseBussyState()}}),zt(()=>{ti(t.value)});const h=()=>{n.value.disabled=!i.value.checked,o.value.disabled=!s.value.checked},f=()=>{if(!u.value||!c.value.hasEngine(u.value)){e.pushError("");return}const E={usi:c.value.getEngine(u.value),startCriteria:{enableNumber:i.value.checked,number:gt(n.value)},endCriteria:{enableNumber:s.value.checked,number:gt(o.value)},perMoveCriteria:{maxSeconds:gt(r.value)},commentBehavior:a.value.value};e.startAnalysis(E)},g=()=>{e.closeModalDialog()},_=async y=>{c.value=y},b=y=>{u.value=y},v=Me(()=>({enableStartNumber:l.value.startCriteria.enableNumber,startNumber:l.value.startCriteria.number,enableEndNumber:l.value.endCriteria.enableNumber,endNumber:l.value.endCriteria.number,maxSecondsPerMove:l.value.perMoveCriteria.maxSeconds,commentBehavior:l.value.commentBehavior}));return{t:ve,CommentBehavior:Fi,dialog:t,engineSettings:c,engineURI:u,enableStartNumber:i,startNumber:n,enableEndNumber:s,endNumber:o,maxSecondsPerMove:r,commentBehavior:a,defaultValues:v,updateToggle:h,onStart:f,onCancel:g,onUpdatePlayerSetting:_,onSelectPlayer:b}}});const z4={ref:"dialog",class:"root"},W4={class:"dialog-title"},G4={class:"dialog-form-area"},V4={class:"dialog-form-area"},j4={class:"dialog-form-item"},K4=["checked"],q4={class:"dialog-form-item-unit"},Y4=["disabled","value"],X4={class:"dialog-form-item-unit"},J4={class:"dialog-form-area"},Q4={class:"dialog-form-item"},Z4=["checked"],e2={class:"dialog-form-item-unit"},t2=["disabled","value"],i2={class:"dialog-form-item-unit"},n2={class:"dialog-form-area"},s2={class:"dialog-form-item"},o2={class:"dialog-form-item-unit"},r2=["value"],a2={class:"dialog-form-item-unit"},l2={class:"dialog-form-area"},c2={class:"dialog-form-item"},u2={class:"dialog-form-item-label-wide"},h2=["value"],d2=["value"],f2=["value"],p2=["value"],g2=["value"],m2={class:"dialog-main-buttons"};function b2(e,t,i,n,s,o){const r=ye("PlayerSelector");return R(),B("div",null,[p("dialog",z4,[p("div",W4,k(e.t.recordAnalysis),1),p("div",G4,[p("div",null,k(e.t.searchEngine),1),Y(r,{"player-uri":e.engineURI,"engine-settings":e.engineSettings,"display-thread-state":!0,"display-multi-pv-state":!0,onUpdateEngineSetting:e.onUpdatePlayerSetting,onSelectPlayer:e.onSelectPlayer},null,8,["player-uri","engine-settings","onUpdateEngineSetting","onSelectPlayer"])]),p("div",V4,[p("div",null,k(e.t.startCriteria),1),p("div",j4,[p("input",{ref:"enableStartNumber",class:"toggle",type:"checkbox",checked:e.defaultValues.enableStartNumber,onChange:t[0]||(t[0]=(...a)=>e.updateToggle&&e.updateToggle(...a))},null,40,K4),p("div",q4,k(e.t.fromPrefix),1),p("input",{ref:"startNumber",class:"small",type:"number",min:"1",step:"1",disabled:!e.defaultValues.enableStartNumber,value:e.defaultValues.startNumber},null,8,Y4),p("div",X4,k(e.t.plySuffix)+k(e.t.fromSuffix),1)])]),p("div",J4,[p("div",null,k(e.t.endCriteria),1),p("div",Q4,[p("input",{ref:"enableEndNumber",class:"toggle",type:"checkbox",checked:e.defaultValues.enableEndNumber,onChange:t[1]||(t[1]=(...a)=>e.updateToggle&&e.updateToggle(...a))},null,40,Z4),p("div",e2,k(e.t.toPrefix),1),p("input",{ref:"endNumber",class:"small",type:"number",min:"1",step:"1",disabled:!e.defaultValues.enableEndNumber,value:e.defaultValues.endNumber},null,8,t2),p("div",i2,k(e.t.plySuffix)+k(e.t.toSuffix),1)])]),p("div",n2,[p("div",null,k(e.t.endCriteria1Move),1),p("div",s2,[p("div",o2,k(e.t.toPrefix),1),p("input",{ref:"maxSecondsPerMove",class:"small",type:"number",min:"0",step:"1",value:e.defaultValues.maxSecondsPerMove},null,8,r2),p("div",a2,k(e.t.secondsSuffix)+k(e.t.toSuffix),1)])]),p("div",l2,[p("div",null,k(e.t.outputSettings),1),p("div",c2,[p("div",u2,k(e.t.moveComments),1),p("select",{ref:"commentBehavior",size:"1",value:e.defaultValues.commentBehavior},[p("option",{value:e.CommentBehavior.NONE},k(e.t.noOutputs),9,d2),p("option",{value:e.CommentBehavior.INSERT},k(e.t.insertCommentToTop),9,f2),p("option",{value:e.CommentBehavior.APPEND},k(e.t.appendCommentToBottom),9,p2),p("option",{value:e.CommentBehavior.OVERWRITE},k(e.t.overwrite),9,g2)],8,h2)])]),p("div",m2,[p("button",{"data-hotkey":"Enter",autofocus:"",class:"dialog-button",onClick:t[2]||(t[2]=a=>e.onStart())},"  "),p("button",{class:"dialog-button","data-hotkey":"Escape",onClick:t[3]||(t[3]=a=>e.onCancel())},"  ")])],512)])}const _2=Ve(U4,[["render",b2],["__scopeId","data-v-c3584c0d"]]),y2=Ge({name:"CSAGameReadyDialog",components:{ButtonIcon:Bt},setup(){const e=ot(),t=W(null);return st(()=>{kt(t.value),ei(t.value)}),zt(()=>{ti(t.value)}),{dialog:t,Icon:tt,store:e,CSAGameState:An,loginRetryIntervalSeconds:gf,onLogout:()=>{e.cancelCSAGame()}}}});const v2={ref:"dialog",class:"bussy"},S2={class:"message-box"},w2={class:"message"},E2={key:0},k2={key:1},I2={key:2},P2={key:0,class:"dialog-main-buttons"};function A2(e,t,i,n,s,o){const r=ye("ButtonIcon");return R(),B("div",null,[p("dialog",v2,[p("div",S2,[Y(r,{class:"icon",icon:e.Icon.BUSSY},null,8,["icon"]),p("div",w2,[e.store.csaGameState===e.CSAGameState.READY?(R(),B("span",E2,"  ")):re("",!0),e.store.csaGameState===e.CSAGameState.LOGIN_RETRY_INTERVAL?(R(),B("span",k2," CSA"+k(e.loginRetryIntervalSeconds)+" ",1)):re("",!0),e.store.csaGameState===e.CSAGameState.WAITING_LOGIN?(R(),B("span",I2," CSA ")):re("",!0)])]),e.store.csaGameState===e.CSAGameState.READY||e.store.csaGameState===e.CSAGameState.LOGIN_RETRY_INTERVAL?(R(),B("div",P2,[p("button",{autofocus:"","data-hotkey":"Escape",onClick:t[0]||(t[0]=a=>e.onLogout())},"  ")])):re("",!0)],512)])}const C2=Ve(y2,[["render",A2],["__scopeId","data-v-f8f78f54"]]),x2=Ge({name:"App",components:{StandardLayout:NI,GameDialog:HA,CSAGameDialog:qC,ResearchDialog:nx,USIEngineManagementDialog:mx,AppSettingDialog:XT,PasteDialog:l4,BussyMessage:p4,ConfirmDialog:S4,InfoMessage:x4,ErrorMessage:H4,AnalysisDialog:_2,CSAGameReadyDialog:C2},setup(){const e=$e(),t=ot(),i=Me(()=>({game:t.appState===K.GAME_DIALOG,csaGame:t.appState===K.CSA_GAME_DIALOG,research:t.appState===K.RESEARCH_DIALOG,analysis:t.appState===K.ANALYSIS_DIALOG,usiEngineSetting:t.appState===K.USI_ENGINE_SETTING_DIALOG,appSetting:t.isAppSettingDialogVisible,paste:t.appState===K.PASTE_DIALOG,bussy:t.isBussy,confirm:t.confirmation!==void 0,csaGameReady:t.csaGameState===An.WAITING_LOGIN||t.csaGameState===An.READY||t.csaGameState===An.LOGIN_RETRY_INTERVAL}));return st(()=>{const n=document.getElementsByTagName("body")[0];n.addEventListener("copy",s=>{t.copyRecordKIF(),s.preventDefault()}),n.addEventListener("paste",s=>{t.showPasteDialog(),s.preventDefault()}),n.addEventListener("dragover",s=>{s.preventDefault()}),n.addEventListener("drop",s=>{if(s.dataTransfer&&s.dataTransfer.files[0]){const o=s.dataTransfer.files[0].path;t.openRecord(o)}s.preventDefault()})}),{appSetting:e,store:t,dialogVisibilities:i}}});function M2(e,t,i,n,s,o){const r=ye("StandardLayout"),a=ye("GameDialog"),l=ye("CSAGameDialog"),c=ye("ResearchDialog"),u=ye("AnalysisDialog"),h=ye("USIEngineManagementDialog"),f=ye("AppSettingDialog"),g=ye("PasteDialog"),_=ye("BussyMessage"),b=ye("ConfirmDialog"),v=ye("CSAGameReadyDialog"),y=ye("InfoMessage"),E=ye("ErrorMessage");return R(),B("div",{class:Zt(["root",e.appSetting.thema])},[Y(r,{class:"main"}),e.dialogVisibilities.game?(R(),je(a,{key:0})):re("",!0),e.dialogVisibilities.csaGame?(R(),je(l,{key:1})):re("",!0),e.dialogVisibilities.research?(R(),je(c,{key:2})):re("",!0),e.dialogVisibilities.analysis?(R(),je(u,{key:3})):re("",!0),e.dialogVisibilities.usiEngineSetting?(R(),je(h,{key:4})):re("",!0),e.dialogVisibilities.appSetting?(R(),je(f,{key:5})):re("",!0),e.dialogVisibilities.paste?(R(),je(g,{key:6})):re("",!0),e.dialogVisibilities.bussy?(R(),je(_,{key:7})):re("",!0),e.dialogVisibilities.confirm?(R(),je(b,{key:8})):re("",!0),e.dialogVisibilities.csaGameReady?(R(),je(v,{key:9})):re("",!0),e.store.hasMessage?(R(),je(y,{key:10})):re("",!0),e.store.hasError?(R(),je(E,{key:11})):re("",!0)],2)}const T2=Ve(x2,[["render",M2],["__scopeId","data-v-9363c50e"]]);var _e=(e=>(e.NEW_RECORD="newRecord",e.OPEN_RECORD="openRecord",e.SAVE_RECORD="saveRecord",e.SAVE_RECORD_AS="saveRecordAs",e.COPY_RECORD="copyRecord",e.COPY_RECORD_CSA="copyRecordCsa",e.COPY_RECORD_USI_BEFORE="copyRecordUsiBefore",e.COPY_RECORD_USI_ALL="copyRecordUsiAll",e.COPY_BOARD_SFEN="copyRecordSfen",e.PASTE_RECORD="pasteRecord",e.INSERT_INTERRUPT="insertInterrupt",e.INSERT_RESIGN="insertResign",e.INSERT_DRAW="insertDraw",e.INSERT_IMPASS="insertImpass",e.INSERT_REPETITION_DRAW="insertRepetitionDraw",e.INSERT_MATE="insertMate",e.INSERT_TIMEOUT="insertTimeout",e.INSERT_FOUL_WIN="insertFoulWin",e.INSERT_FOUL_LOSE="insertFoulLose",e.INSERT_ENTERING_OF_KING="insertEnteringOfKing",e.INSERT_WIN_BY_DEFAULT="insertWinByDefault",e.INSERT_LOSE_BY_DEFAULT="insertLossByDefault",e.REMOVE_CURRENT_MOVE="remvoeCurrentMove",e.START_POSITION_EDITING="startPositionEditing",e.END_POSITION_EDITING="endPositionEditing",e.CHANGE_TURN="changeTurn",e.INIT_POSITION_STANDARD="initPositionStandard",e.INIT_POSITION_HANDICAP_LANCE="initPositionHandicapLance",e.INIT_POSITION_HANDICAP_RIGHT_LANCE="initPositionHandicapRightLance",e.INIT_POSITION_HANDICAP_BISHOP="initPositionHandicapBishop",e.INIT_POSITION_HANDICAP_ROOK="initPositionHandicapRook",e.INIT_POSITION_HANDICAP_ROOK_LANCE="initPositionHandicapRookLance",e.INIT_POSITION_HANDICAP_2PIECES="initPositionHandicap2Pieces",e.INIT_POSITION_HANDICAP_4PIECES="initPositionHandicap4Pieces",e.INIT_POSITION_HANDICAP_6PIECES="initPositionHandicap6Pieces",e.INIT_POSITION_HANDICAP_8PIECES="initPositionHandicap8Pieces",e.INIT_POSITION_TSUME_SHOGI="initPositionTsumeShogi",e.INIT_POSITION_TSUME_SHOGI_2KINGS="initPositionTsumeShogi2Kings",e.START_RESEARCH="startResearch",e.STOP_RESEARCH="stopResearch",e.START_ANALYSIS="startAnalysis",e.STOP_ANALYSIS="stopAnalysis",e.START_GAME="startGame",e.START_CSA_GAME="startCSAGame",e.STOP_GAME="stopGame",e.RESIGN="resign",e.WIN="win",e.LOGOUT="logout",e.FLIP_BOARD="flipBoard",e.APP_SETTING_DIALOG="appSetting",e.USI_ENGINE_SETTING_DIALOG="usiEngineSetting",e))(_e||{});function R2(){const e=ot();ze.onSendError(t=>{e.pushError(t)}),ze.onMenuEvent(t=>{if(!e.isBussy)switch(t){case _e.NEW_RECORD:e.resetRecord();break;case _e.OPEN_RECORD:e.openRecord();break;case _e.SAVE_RECORD:e.saveRecord({overwrite:!0});break;case _e.SAVE_RECORD_AS:e.saveRecord();break;case _e.COPY_RECORD:e.copyRecordKIF();break;case _e.COPY_RECORD_CSA:e.copyRecordCSA();break;case _e.COPY_RECORD_USI_BEFORE:e.copyRecordUSIBefore();break;case _e.COPY_RECORD_USI_ALL:e.copyRecordUSIAll();break;case _e.COPY_BOARD_SFEN:e.copyBoardSFEN();break;case _e.PASTE_RECORD:e.showPasteDialog();break;case _e.INSERT_INTERRUPT:e.insertSpecialMove(le.INTERRUPT);break;case _e.INSERT_RESIGN:e.insertSpecialMove(le.RESIGN);break;case _e.INSERT_DRAW:e.insertSpecialMove(le.DRAW);break;case _e.INSERT_IMPASS:e.insertSpecialMove(le.IMPASS);break;case _e.INSERT_REPETITION_DRAW:e.insertSpecialMove(le.REPETITION_DRAW);break;case _e.INSERT_MATE:e.insertSpecialMove(le.MATE);break;case _e.INSERT_TIMEOUT:e.insertSpecialMove(le.TIMEOUT);break;case _e.INSERT_FOUL_WIN:e.insertSpecialMove(le.FOUL_WIN);break;case _e.INSERT_FOUL_LOSE:e.insertSpecialMove(le.FOUL_LOSE);break;case _e.INSERT_ENTERING_OF_KING:e.insertSpecialMove(le.ENTERING_OF_KING);break;case _e.INSERT_WIN_BY_DEFAULT:e.insertSpecialMove(le.WIN_BY_DEFAULT);break;case _e.INSERT_LOSE_BY_DEFAULT:e.insertSpecialMove(le.LOSE_BY_DEFAULT);break;case _e.REMOVE_CURRENT_MOVE:e.removeCurrentMove();break;case _e.START_POSITION_EDITING:e.startPositionEditing();break;case _e.END_POSITION_EDITING:e.endPositionEditing();break;case _e.CHANGE_TURN:e.changeTurn();break;case _e.INIT_POSITION_STANDARD:e.initializePosition(be.STANDARD);break;case _e.INIT_POSITION_HANDICAP_LANCE:e.initializePosition(be.HANDICAP_LANCE);break;case _e.INIT_POSITION_HANDICAP_RIGHT_LANCE:e.initializePosition(be.HANDICAP_RIGHT_LANCE);break;case _e.INIT_POSITION_HANDICAP_BISHOP:e.initializePosition(be.HANDICAP_BISHOP);break;case _e.INIT_POSITION_HANDICAP_ROOK:e.initializePosition(be.HANDICAP_ROOK);break;case _e.INIT_POSITION_HANDICAP_ROOK_LANCE:e.initializePosition(be.HANDICAP_ROOK_LANCE);break;case _e.INIT_POSITION_HANDICAP_2PIECES:e.initializePosition(be.HANDICAP_2PIECES);break;case _e.INIT_POSITION_HANDICAP_4PIECES:e.initializePosition(be.HANDICAP_4PIECES);break;case _e.INIT_POSITION_HANDICAP_6PIECES:e.initializePosition(be.HANDICAP_6PIECES);break;case _e.INIT_POSITION_HANDICAP_8PIECES:e.initializePosition(be.HANDICAP_8PIECES);break;case _e.INIT_POSITION_TSUME_SHOGI:e.initializePosition(be.TSUME_SHOGI);break;case _e.INIT_POSITION_TSUME_SHOGI_2KINGS:e.initializePosition(be.TSUME_SHOGI_2KINGS);break;case _e.START_GAME:e.showGameDialog();break;case _e.START_CSA_GAME:e.showCSAGameDialog();break;case _e.STOP_GAME:e.stopGame();break;case _e.RESIGN:Vn.resign();break;case _e.WIN:Vn.win();break;case _e.LOGOUT:e.cancelCSAGame();break;case _e.START_RESEARCH:e.showResearchDialog();break;case _e.STOP_RESEARCH:e.stopResearch();break;case _e.START_ANALYSIS:e.showAnalysisDialog();break;case _e.STOP_ANALYSIS:e.stopAnalysis();break;case _e.FLIP_BOARD:$e().flipBoard();break;case _e.APP_SETTING_DIALOG:e.showAppSettingDialog();break;case _e.USI_ENGINE_SETTING_DIALOG:e.showUsiEngineManagementDialog();break}}),ze.onUSIBestMove((t,i,n,s)=>{P1(t,i,n,s)}),ze.onUSIInfo((t,i,n,s)=>{const o=JSON.parse(s);e.updateUSIInfo(t,i,n,o),gu(t,i,o)}),ze.onUSIPonderInfo((t,i,n,s)=>{const o=JSON.parse(s);e.updateUSIPonderInfo(t,i,n,o),gu(t,i,o)}),ze.onCSAGameSummary((t,i)=>{K1(t,JSON.parse(i))}),ze.onCSAReject(t=>{q1(t)}),ze.onCSAStart((t,i)=>{Y1(t,JSON.parse(i))}),ze.onCSAMove((t,i,n)=>{X1(t,i,JSON.parse(n))}),ze.onCSAGameResult((t,i,n)=>{J1(t,i,n)}),ze.onCSAClose(t=>{Q1(t)}),In(()=>[e.appState,e.isBussy],([t,i])=>{ze.updateAppState(t,i)}),ze.updateAppState(e.appState,e.isBussy)}fe.log(mt.INFO,`start renderer process: APP_VERSION=${af.appVersion}`);Bi.register(...nI);R2();const Pa=ot();Promise.allSettled([$e().reloadAppSetting().catch(e=>{Pa.pushError(new Error(": "+e))}),fe.getRecordPathFromProcArg().then(e=>{e&&Pa.openRecord(e)}).catch(e=>{Pa.pushError(new Error(": "+e))})]).finally(()=>{const e=$e().language;fe.log(mt.INFO,`set language: ${e}`),Km(e),fe.log(mt.INFO,"mount app"),zm(T2).mount("#app")});
